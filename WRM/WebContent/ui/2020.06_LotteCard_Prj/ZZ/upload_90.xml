<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head>
    	<w2:type>DEFAULT</w2:type>
        <w2:buildDate/>
        <xf:model>
            <xf:instance>
                <data xmlns=""/>
            </xf:instance>
            <w2:dataCollection baseNode="map">
            </w2:dataCollection>
            <w2:workflowCollection>
            </w2:workflowCollection>
        </xf:model>
        <script type="javascript"><![CDATA[ 
//	       ###################################################
//	        파일명 : upload.xml
//	        프로그램명 : 파일 업로드 화면
//	        설 명 :   
//	        작성자 : 진태만
//	        작성일 : 2020.06.26
//	
//	        수정일자            수정자                  수정내용
//	       ==================================================
//	       2020.06.26       진태만     				 최초작성
//	       ###################################################

	var pageSize = "10";		//  페이지수(총 조회 수)
	var pageCount = "10";		//  보여지는 페이지수[총 8 Page]
	var sToday = ""; 
	var bAuthFlag = false;		//전역변수
	var slevel = "";
	var medt_Str_Event;	// medt_Str(InputBox) MaskEdit 정규식 입력

	/**
	 * 초기 스크립트 수행 함수 정의
	 */ 
	function multiupload1_ondone(data) {
		console.log("[/upload.xml] [onpageload()] ==> [TEST_01] [파일 업로드 화면 로딩]" );
		alert("[/upload.xml] [onpageload()] ==> [폼 로딩] [TEST_01]" );
 	
	};
 
	scwin.trigger1_onclick = function(e) {
		console.log("하이브리드 파일 선택 시작########");
		console.log("[/upload.xml] [trigger1_onclick()] ==> [TEST_01] [파일 선택 시작]" );
		
        var opt = {};
        opt.multiselect = true;
        opt.extension = "xlsx,docx,pptx,jpg,png,pdf,txt,mp4"; // 디바이스 파일탐색기에서 보여줄 확장자
        opt.start = "" //default : document
        opt.maxcount = 2;
            
        //$h.contents.filePicker(scwin.filePickerSuccess, scwin.filePickerFail, opt);   // /storage/emulated/0/Download/{파일명}
	};
	
	scwin.trigger2_onclick = function(e) {
        console.log("하이브리드 파일 업로드 시작########");
        var url = "http://172.30.1.43:3131/websquare/upload.wq" // upload 모듈 url
        var filePath = scwin.filePath;
        
        // alert(WebSquare.xml.serialize(retXml))
        
        // 확장자 확인
        var ext = filePath.substr(filePath.lastIndexOf(".")+1, filePath.length);
        // 확장자에 따라 contentType 지정 
        var contType = "";
        switch(ext) {
            case "doc": contType = "application/msword"; break;
            case "docx": contType = "application/vnd.openxmlformats-officedocument.wordprocessingml.document"; break;
            case "xls": contType = "application/vnd.ms-excel"; break;
            case "xlsx": contType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"; break;
            case "ppt": contType = "application/vnd.ms-powerpoint"; break;
            case "pptx": contType = "application/vnd.openxmlformats-officedocument.presentationml.presentation"; break;
            case "gif": contType = "image/gif"; break;
            case "jpg": contType = "image/jpg"; break;
            case "jpeg": contType = "image/jpeg"; break;
            case "png": contType = "image/png"; break;
            case "pdf": contType = "application/pdf"; break;
        }
        
        // 하이브리드 업로드 옵션
        var opt = {
            "url": url,
            "path": filePath,
            "contentType":contType
        };
        console.log("업로드 요청: ", opt);
        
        $h.file.uploadFile(function(xhr) {
            console.log(xhr);
            if(xhr.readyState==4 && xhr.status==200) {
                console.log("업로드 성공!!");
                alert("업로드 성공!!");
                input1.setValue("");
            }
        }, function(err) {
            // console.error("err: ", err);
        }, opt);
        console.log("업로드 끝: ");
	};
 
	/* ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■
	+------------------------------------------------// script 종료 //------------------------------------------------------------+
	■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ */
]]></script>
    </head>
    <body>
    	<xf:group class="contentWrap" id="" style="">
    		<xf:group class="section" id="" style="">
    			<w2:upload disabled="" id="upd_upload1" imageStyle="position:absolute;vertical-align:middle;word-wrap:break-word"
    				inputStyle="position:absolute;vertical-align:middle;word-wrap:break-word" style="width: 250px;height: 23px;" type="">
    			</w2:upload>
    			<xf:trigger ev:onclick="scwin.trigger2_onclick" id="btn_trigger3" style="position: relative;width: 80px;height: 23px;"
    				type="button">
    				<xf:label><![CDATA[업로드 ]]></xf:label>
    			</xf:trigger>
    		</xf:group>
    		<xf:group class="section" id="" style="position: relative;width: 80px;height: 23px;">
    		</xf:group>
    		<xf:group class="section" id="" style="">
    			<xf:trigger ev:onclick="scwin.trigger1_onclick" id="btn_trigger4"
    				style="position: relative;width: 80px;height: 23px;margin-left:0px;" type="button">
    				<xf:label><![CDATA[파일 선택]]></xf:label>
    			</xf:trigger>
    			<xf:trigger ev:onclick="scwin.trigger2_onclick" id="btn_trigger5" style="position: relative;width: 80px;height: 23px;"
    				type="button">
    				<xf:label><![CDATA[업로드 ]]></xf:label>
    			</xf:trigger>
    			<xf:input adjustMaxLength="false" id="ibx_input2" readOnly="true" style="position: relative;width: 144px;height: 21px;"></xf:input>
    		</xf:group>
    	</xf:group>
    </body>
</html>
