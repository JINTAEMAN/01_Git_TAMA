<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="/cm/css/all.css" type="text/css"?>
<?xml-stylesheet href="/cm/css/new.css" type="text/css"?>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare"
	xmlns:xf="http://www.w3.org/2002/xforms">
	<head>
		<w2:type>DEFAULT</w2:type>
		<w2:buildDate />
		<xf:model>
			<xf:instance>
				<data xmlns="" />
			</xf:instance>
			<w2:dataCollection baseNode="map">
				<w2:dataMap baseNode="map" id="dst_LginAuthInqrVo">
					<w2:keyInfo>
						<w2:key id="empNo" name="사번" dataType="text">
						</w2:key>
						<w2:key id="name" name="이름" dataType="text">
						</w2:key>
						<w2:key id="pstnDeptCd" name="소속부서코드"
							dataType="text">
						</w2:key>
						<w2:key id="bizAdmrYn" name="업무관리자"
							dataType="text">
						</w2:key>
						<w2:key id="agncyAdmrYn" name="대리점사용인관리자여부"
							dataType="text">
						</w2:key>
						<w2:key id="geafAdmrYn" name="대면총무여부,지점장여부"
							dataType="text">
						</w2:key>
						<w2:key id="gaEducMngrAdmrYn" name="GA교육매니저여부"
							dataType="text">
						</w2:key>
						<w2:key id="drctMangYn" name="직영여부"
							dataType="text">
						</w2:key>
						<w2:key id="crossYn" name="교차여부"
							dataType="text">
						</w2:key>
						<w2:key id="atchYn" name="전속여부"
							dataType="text">
						</w2:key>
						<w2:key id="gAYn" name="GA여부" dataType="text">
						</w2:key>
						<w2:key id="superAuthYn" name="전체권한여부"
							dataType="text">
						</w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataMap baseNode="map"
					id="dst_SamePstnAuthInqrVo">
					<w2:keyInfo>
						<w2:key id="empno" name="사번" dataType="text"
							col_id="empno">
						</w2:key>
						<w2:key id="pstnDeptCd" name="소속부서코드"
							dataType="text" col_id="pstnDeptCd">
						</w2:key>
						<w2:key id="cmprEmpno" name="비교사번"
							dataType="text" col_id="cmprEmpno">
						</w2:key>
						<w2:key id="cmprPstnDeptCd" name="비교사번소속부서코드"
							dataType="text" col_id="cmprPstnDeptCd">
						</w2:key>
						<w2:key id="samePstnAuthYn" name="동일소속여부"
							dataType="text" col_id="samePstnAuthYn">
						</w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataList id="dst_BussActCstListInfoVo"
					baseNode="list" saveRemovedData="true" repeatNode="map">
					<w2:columnInfo>
						<w2:column id="doerCd" name="취급자코드"
							dataType="text" ignoreStatus="true">
						</w2:column>
						<w2:column id="stndYmd" name="기준일자"
							dataType="text">
						</w2:column>
						<w2:column id="custNo" name="고객번호"
							dataType="text">
						</w2:column>
						<w2:column id="name" name="성명"
							dataType="text">
						</w2:column>
						<w2:column id="cellPhone1" name="핸드폰번호1"
							dataType="text">
						</w2:column>
						<w2:column id="cellPhone2" name="핸드폰번호2"
							dataType="text">
						</w2:column>
						<w2:column id="cellPhone3" name="핸드폰번호3"
							dataType="text">
						</w2:column>
						<w2:column id="email1" name="EMAIL"
							dataType="text">
						</w2:column>
						<w2:column id="email2" name="EMAIL"
							dataType="text">
						</w2:column>
						<w2:column id="magAgreYn" name="마케팅동의여부"
							dataType="text">
						</w2:column>
						<w2:column id="emailRejectYn" name="이메일거부여부"
							dataType="text">
						</w2:column>
						<w2:column id="sMSRejectYn" name="sms거부여부"
							dataType="text">
						</w2:column>
						<w2:column id="agmYn" name="수집동의여부"
							dataType="text">
						</w2:column>
						<w2:column id="expireDate" name="고객정보만료일"
							dataType="text">
						</w2:column>
						<w2:column id="totCstCnt" name="name15"
							dataType="number">
						</w2:column>
						<w2:column id="selectCstCnt" name="name21"
							dataType="number">
						</w2:column>
						<w2:column id="sendFlgcd" name="name16"
							dataType="text">
						</w2:column>
						<w2:column id="cstFlgcd" name="name17"
							dataType="text">
						</w2:column>
						<w2:column id="dateFr" name="name18"
							dataType="text">
						</w2:column>
						<w2:column id="dateTo" name="name19"
							dataType="text">
						</w2:column>
						<w2:column id="nextKey" name="name20"
							dataType="text">
						</w2:column>
					</w2:columnInfo>
					<w2:data use="false"></w2:data>
				</w2:dataList>
				<w2:dataMap baseNode="map" id="dst_BussActCstInfoVo">
					<w2:keyInfo>
						<w2:key id="doerCd" name="name1"
							dataType="text">
						</w2:key>
						<w2:key id="stndYmd" name="name2"
							dataType="text">
						</w2:key>
						<w2:key id="custNo" name="name3"
							dataType="text">
						</w2:key>
						<w2:key id="name" name="name4"
							dataType="text">
						</w2:key>
						<w2:key id="cellPhone1" name="name5"
							dataType="text">
						</w2:key>
						<w2:key id="cellPhone2" name="name6"
							dataType="text">
						</w2:key>
						<w2:key id="cellPhone3" name="name7"
							dataType="text">
						</w2:key>
						<w2:key id="email1" name="name8"
							dataType="text">
						</w2:key>
						<w2:key id="email2" name="name9"
							dataType="text">
						</w2:key>
						<w2:key id="magAgreYn" name="name10"
							dataType="text">
						</w2:key>
						<w2:key id="emailRejectYn" name="name11"
							dataType="text">
						</w2:key>
						<w2:key id="sMSRejectYn" name="name12"
							dataType="text">
						</w2:key>
						<w2:key id="agmYn" name="name13"
							dataType="text">
						</w2:key>
						<w2:key id="expireDate" name="name14"
							dataType="text">
						</w2:key>
						<w2:key id="totCstCnt" name="name15"
							dataType="text">
						</w2:key>
						<w2:key id="selectCstCnt" name="name21"
							dataType="text">
						</w2:key>
						<w2:key id="sendFlgcd" name="name17"
							dataType="text">
						</w2:key>
						<w2:key id="cstFlgcd" name="name17"
							dataType="text">
						</w2:key>
						<w2:key id="dateFr" name="name18"
							dataType="text">
						</w2:key>
						<w2:key id="dateTo" name="name19"
							dataType="text">
						</w2:key>
						<w2:key id="nextKey" name="name20"
							dataType="text">
						</w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataList id="dsl_cstInfoList" baseNode="list"
					saveRemovedData="true" repeatNode="map">
					<w2:columnInfo>
						<w2:column id="chk_flag" name="name5"
							dataType="text">
						</w2:column>
						<w2:column id="custNo" name="name1"
							dataType="text">
						</w2:column>
						<w2:column id="name" name="name2"
							dataType="text">
						</w2:column>
						<w2:column id="sendFlgInfo" name="name3"
							dataType="text">
						</w2:column>
						<w2:column id="magAgreYn" name="name4"
							dataType="text">
						</w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList id="dsl_sendCstList" baseNode="list"
					saveRemovedData="true" repeatNode="map">
					<w2:columnInfo>
						<w2:column id="chk_flag" name="name5"
							dataType="text">
						</w2:column>
						<w2:column id="custNo" name="name1"
							dataType="text">
						</w2:column>
						<w2:column id="name" name="name2"
							dataType="text">
						</w2:column>
						<w2:column id="sendFlgInfo" name="name3"
							dataType="text">
						</w2:column>
						<w2:column id="magAgreYn" name="name4"
							dataType="text">
						</w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList id="dst_BussActDataSendInfoVo"
					baseNode="list" saveRemovedData="true" repeatNode="map">
					<w2:columnInfo>
						<w2:column id="sendDate" name="name2"
							dataType="text">
						</w2:column>
						<w2:column id="sendSeqno" name="name3"
							dataType="text">
						</w2:column>
						<w2:column id="custNo" name="name4"
							dataType="text">
						</w2:column>
						<w2:column id="name" name="name5"
							dataType="text">
						</w2:column>
						<w2:column id="cstFlgcd" name="name6"
							dataType="text">
						</w2:column>
						<w2:column id="rgtrEmpno" name="name7"
							dataType="text">
						</w2:column>
						<w2:column id="rgstDate" name="name8"
							dataType="text">
						</w2:column>
						<w2:column id="seqno" name="name9"
							dataType="text">
						</w2:column>
						<w2:column id="bussActDataFlag" name="name10"
							dataType="text">
						</w2:column>
						<w2:column id="sendFlgcd" name="name11"
							dataType="text">
						</w2:column>
						<w2:column id="sendHms" name="name12"
							dataType="text">
						</w2:column>
						<w2:column id="senrEmpno" name="name13"
							dataType="text">
						</w2:column>
						<w2:column id="sndrTitl" name="name14"
							dataType="text">
						</w2:column>
						<w2:column id="sndrCont" name="name15"
							dataType="text">
						</w2:column>
						<w2:column id="cellPhone" name="name16"
							dataType="text">
						</w2:column>
						<w2:column id="email" name="name17"
							dataType="text">
						</w2:column>
						<w2:column id="sndrTelno" name="name18"
							dataType="text">
						</w2:column>
						<w2:column id="sndrEmail" name="name19"
							dataType="text">
						</w2:column>
						<w2:column id="delYn" name="name20"
							dataType="text">
						</w2:column>
						<w2:column id="inptDler" name="name21"
							dataType="text">
						</w2:column>
						<w2:column id="inptDlerIP" name="name22"
							dataType="text">
						</w2:column>
						<w2:column id="inptDate" name="name23"
							dataType="text">
						</w2:column>
						<w2:column id="inptHms" name="name24"
							dataType="text">
						</w2:column>
						<w2:column id="mdfcDler" name="name25"
							dataType="text">
						</w2:column>
						<w2:column id="mdfcDlerIP" name="name26"
							dataType="text">
						</w2:column>
						<w2:column id="mdfcDate" name="name27"
							dataType="text">
						</w2:column>
						<w2:column id="mdfcHms" name="name28"
							dataType="text">
						</w2:column>
						<w2:column id="dateFr" name="name29"
							dataType="text">
						</w2:column>
						<w2:column id="dateTo" name="name30"
							dataType="text">
						</w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataMap baseNode="map"
					id="dst_BussActDataSendListInfoVo">
					<w2:keyInfo>
						<w2:key id="sendDate" name="name1"
							dataType="text">
						</w2:key>
						<w2:key id="custNo" name="name2"
							dataType="text">
						</w2:key>
						<w2:key id="name" name="name3"
							dataType="text">
						</w2:key>
						<w2:key id="cstFlgcd" name="name4"
							dataType="text">
						</w2:key>
						<w2:key id="rgtrEmpno" name="name5"
							dataType="text">
						</w2:key>
						<w2:key id="rgstDate" name="name6"
							dataType="text">
						</w2:key>
						<w2:key id="sendFlgcd" name="name7"
							dataType="text">
						</w2:key>
						<w2:key id="sendHms" name="name8"
							dataType="text">
						</w2:key>
						<w2:key id="senrEmpno" name="name9"
							dataType="text">
						</w2:key>
						<w2:key id="sndrTitl" name="name10"
							dataType="text">
						</w2:key>
						<w2:key id="sndrCont" name="name11"
							dataType="text">
						</w2:key>
						<w2:key id="bussActDataSendId" name="name12"
							dataType="text">
						</w2:key>
						<w2:key id="sndrTelno" name="name13"
							dataType="text">
						</w2:key>
						<w2:key id="sndrEmail" name="name14"
							dataType="text">
						</w2:key>
						<w2:key id="sndrCont1" name="name15"
							dataType="text">
						</w2:key>
						<w2:key id="sndrCont2" name="name16"
							dataType="text">
						</w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataMap baseNode="map"
					id="dst_rstBussActCstListInfoVo">
					<w2:keyInfo>
						<w2:key id="doerCd" name="name1"
							dataType="text">
						</w2:key>
						<w2:key id="stndYmd" name="name2"
							dataType="text">
						</w2:key>
						<w2:key id="smsSendCnt" name="name3"
							dataType="text">
						</w2:key>
						<w2:key id="emailSendCnt" name="name4"
							dataType="text">
						</w2:key>
						<w2:key id="totCstCnt" name="name5"
							dataType="number">
						</w2:key>
						<w2:key id="selectCstCnt" name="name7"
							dataType="number">
						</w2:key>
						<w2:key id="nextKey" name="name6"
							dataType="text">
						</w2:key>
						<w2:key id="doerNm" name="name8"
							dataType="text">
						</w2:key>
						<w2:key id="senderTelNo" name="name9"
							dataType="text">
						</w2:key>
						<w2:key id="senderEmail" name="name10"
							dataType="text">
						</w2:key>
					</w2:keyInfo>
				</w2:dataMap>
			</w2:dataCollection>
			<w2:workflowCollection>
			</w2:workflowCollection>
			
		</xf:model>
<script src="/cm/js/common.js"/>
<script src="/cm/js/val_lib.js"/>
<script src="/cm/js/util.js"/>
<script src="/cm/js/transSub.js"/>
<script src="/cm/js/callService.js"/>
<script src="/cm/js/gds.js"/>
<script src="/cm/js/wconv.js"/>
<script src="/cm/js/wprom.js"/>		
<script src="/cm/js/convertJs/Global_Script.js"/>
<script src="/cm/js/convertJs/comm_Webservice.js"/>
<script src="/cm/js/convertJs/NewGen_Script.js"/>
<script src="/cm/js/convertJs/LongTerm_Script.js"/>		<script type="javascript"><![CDATA[
	/*
 	 *===================================File description================================================
 	 * Create Date : 2017/09/27
 	 * Creater     : KMJ
 	 *====================================================================================================
	 */

	var gsSysDate;			// global 현재일자
	var gUserID; 			// global 사용자 ID
	var gUserEmpName; 	    // global 부서명
	var gBussActDataId;		// global 영업활동자료Id
	var gRowCnt = 0;		// 가져온건수
	var gSendCnt = 10;	// 한번에 보낼수있는 건수
	var gMaxSendCnt = 200;	// 한달최대가능발송건수 200건
	var gApdxFileUrl = "";//첨부파일 url
	var ggelementId = "";
	var ggfileName = "";
	var gUserDepartCode = "";
			
	//**********************************************************
	// 초기화
	//**********************************************************
	scwin.init = function() {
		gfn_getServerTime();//서버시간
		gsSysDate = wconv.substr(gds.gDs_ServerTime.getCellData(0, "sToday"), 0, 8);
		
		gUserID 		= util.getGdsValue("gUserID");    					// global 사용자 ID
		gUserEmpName 	= util.getGdsValue("gUserEmpName");    				// global 부서명
		gUserDepartCode = util.getGdsValue("gUserDepartCode"); 
		
		// 발신자 로그인자 명(사번)으로 세팅후 비활성 
		ib_senrEmpno.setValue(gUserEmpName +"(" + gUserID + ")");
						
	    //Parent에서 넘어온 값을 설정한다.
		var indata = $w.getParameter("param");
		var args;
		try {
			args = JSON.parse(indata);
		} catch(e) {
		
		}					
		
	    // 상위화면(CBSB030P)에서 영업활동자료Id 를 넘겨주면 글로벌변수로 담아둔다.   
	    if(!util.isNull(args) && !util.isNull(args.bussActDataId)){
	    	gBussActDataId = args.bussActDataId;
	    	gApdxFileUrl = args.apdxFileUrl;
	    	ggelementId = args.ggelementId;
	    	ggfileName = args.ggfileName;	    	
	    	ta_ApdxFileInfo.setValue(ggfileName);	    	
	    }
	           	
	   	var promise = Promise.resolve();
	    promise = promise.then(function(rtnVal) {
	     	// /common/CBSO0015.do 로그인자 권한조회	 
			return scwin.getLginAuthInfo();				  			
	    });
	    return;			
	};
	
	//**********************************************************
	// 
	//**********************************************************
	scwin.subCallBackfunction = function(e){
		// e.subID : 서브미션 ID
		// e.flag  : S성공;
		// e.msg   : 트렌젝션 처리후 메세지
		// e."받을데이타셋"
		switch(e.subID){
			// 로그인ID권한조회
			case "retrieveLginIDAuthInqr":
				dst_LginAuthInqrVo.setJSON(e.result);	
				// 권한에 따라 버튼및 게시조직 체크 		
				scwin.setCtrlByAuth();		
					
				var promise = Promise.resolve();
				promise = promise.then(function(rtnVal) {
					// 영업활동가망고객정보조회
					if(!util.isNull(gBussActDataId)) {	
						gRowCnt = 0;// 가져온건수
			   			//scwin.btn_Search_onclick();	
			   			scwin.getBussActPossCstInfo();
			   		}  
			   	}); 									
			break;
			// 동일소속조회
			case "retrieveSamePstnAuthInqr":
				if(e.flag == "s") {
						dst_SamePstnAuthInqrVo.setJSON(e.result);	
					if( gUserDepartCode != dst_SamePstnAuthInqrVo.get("cmprPstnDeptCd") ) {
						wprom.alertF("부서코드불일치.동일소속사번만 입력가능합니다.\n 사번을 다시 입력하세요", {}, ib_rgtrEmpno);	
						ib_rgtrEmpno.setValue("");
						ib_rgtrEmpNm.setValue("");
						return;
					}	
					else {
						//조회
						ib_rgtrEmpNm.setValue("");
						scwin.btn_Search_onclick();
					}
						
				}else {					
					wprom.alert(e.msg);
				}						
			// 영업활동가망고객정보조회
			case "retrieveBussActPossCstInfo":
				if(e.flag == "s") {
					dst_BussActCstListInfoVo.setJSON(e.result.bussActCstInfoVo);	
					dst_rstBussActCstListInfoVo.setJSON(e.result);
					var totCstCnt = dst_rstBussActCstListInfoVo.get("totCstCnt");
					console.log("가망전체고객수:"+totCstCnt);
										
					ib_senrEmpno.setValue(dst_rstBussActCstListInfoVo.get("doerNm") +"(" + dst_rstBussActCstListInfoVo.get("doerCd") + ")");
					ib_rgtrEmpNm.setValue(dst_rstBussActCstListInfoVo.get("doerNm"));
					
					if(totCstCnt>0){	
						//SMS발송건수
						var smsSendCnt = dst_rstBussActCstListInfoVo.get("smsSendCnt");
						//EMAIL발송건수
						var emailSendCnt = dst_rstBussActCstListInfoVo.get("emailSendCnt");
						console.log("[가망]sms:"+smsSendCnt+"-email:"+emailSendCnt);
						//if(smsSendCnt >= gMaxSendCnt || emailSendCnt >= gMaxSendCnt) {
						if(smsSendCnt >= gMaxSendCnt ) {
							wprom.alert("발송건수 200건 초과 발송불가합니다.");
							return;
						}							
												
						var nextKey = dst_rstBussActCstListInfoVo.get("nextKey");														
						//조회고객건수
						var selectCstCnt = dst_rstBussActCstListInfoVo.get("selectCstCnt");
						console.log("가망조회고객수:"+selectCstCnt);						
						gRowCnt = wconv.toNumber(gRowCnt) + wconv.toNumber(selectCstCnt);
						console.log("빼기:"+wconv.toNumber(totCstCnt-gRowCnt));
						if(wconv.toNumber(totCstCnt-gRowCnt)>0) {
							scwin.getBussActPossCstInfo(nextKey);
						}
						// 조회데이터로 화면세팅 		
						scwin.setBussActCstInfo();	
					}else{
						wprom.alert("조회 결과가 없습니다.");
						return;
					}
					
				} else {
					wprom.alert(e.msg);
				}														
			break;
			// 영업활동계약고객정보조회
			case "retrieveBussActCrCstInfo":
				if(e.flag == "s") {
					
					dst_BussActCstListInfoVo.setJSON(e.result.bussActCstInfoVo);	
					dst_BussActCstInfoVo.setJSON(e.result);
					var totCstCnt = dst_BussActCstInfoVo.get("totCstCnt");
					console.log("계약전체고객수:"+totCstCnt);
										
					ib_senrEmpno.setValue(dst_rstBussActCstListInfoVo.get("doerNm") +"(" + dst_rstBussActCstListInfoVo.get("doerCd") + ")");
					ib_rgtrEmpNm.setValue(dst_rstBussActCstListInfoVo.get("doerNm"));
					
					if(totCstCnt>0){				  	 	
				  	 	//SMS발송건수
						var smsSendCnt = dst_rstBussActCstListInfoVo.get("smsSendCnt");
						//EMAIL발송건수
						var emailSendCnt = dst_rstBussActCstListInfoVo.get("emailSendCnt");
						console.log("[계약]sms:"+smsSendCnt+"-email:"+emailSendCnt);
						//if(smsSendCnt >= gMaxSendCnt || emailSendCnt >= gMaxSendCnt) {
						if(smsSendCnt >= gMaxSendCnt ) {
							wprom.alert("발송건수 200건 초과 발송불가합니다.");
							return;
						}												
						var nextKey = dst_rstBussActCstListInfoVo.get("nextKey");																											
						//조회고객건수
						var selectCstCnt = dst_rstBussActCstListInfoVo.get("selectCstCnt");
						console.log("계약전체고객수:"+totCstCnt);
						gRowCnt = wconv.toNumber(gRowCnt) + wconv.toNumber(selectCstCnt);
						console.log("빼기:"+wconv.toNumber(totCstCnt-gRowCnt));
						if(wconv.toNumber(totCstCnt-gRowCnt)>0) {
							scwin.getBussActCrCstInfo(nextKey);
						} 							 				  	 		
						// 조회데이터로 화면세팅 		
						scwin.setBussActCstInfo();
					}else{
						wprom.alert("조회 결과가 없습니다.");
						return;
					}
				} else {
					wprom.alert(e.msg);
				}
														
			break;
			// 영업활동자료발송등록
			case "registerBussActDataSendInfo":
				if(e.flag == "s") {
				//	dst_BussActDataSendListInfoVo.setJSON(e.result);
					wprom.alert("등록이 완료되었습니다.");
												
				} else {
					wprom.alert(e.msg);
				}
			break;				
		}
	};
	
	//**********************************************************
	// 로그인자 권한조회 /common/CBSO0015.do 로그인자 권한조회
	//**********************************************************
	scwin.getLginAuthInfo = function() {
		// 사번으로 로그인자 권한조회	
		dst_LginAuthInqrVo.set("empNo" , gUserID);
		
		var trans = new transSub();                  	// transaction 보낼 객체 생성
		trans.setId("retrieveLginIDAuthInqr");        	// transaction 보낼 SubmissionID
		trans.setUrl("/common/CBSO0015.do");   			// Controller 쪽으로 보낼 주소
		trans.setDs("dst_LginAuthInqrVo");					
		trans.targetDs("dst_LginAuthInqrVo");		
		trans.callBack("scwin.subCallBackfunction");  	// 받을 Dataset을 처리시 콜백함수
		trans.send();
	
	};
	
	//**********************************************************
	// 권한에 따라 화면컨트롤 
	//**********************************************************
	scwin.setCtrlByAuth = function() {
		// 영업활동자료id 세팅 
		ib_bussActDataId.setValue(gBussActDataId);
		// 등록자 : 로그인자 이름(사번) 세팅     	
	    ib_rgtrEmpno.setValue(gUserID);
	    ib_rgtrEmpNm.setValue(gUserEmpName);	

		// 본사 설계사 및 대리점 사용인은 본인 고객만 조회 가능하도록.
		ib_rgtrEmpno.setDisabled(true);
		//∙ 조직 관리자 SuperAuthYn='Y' 는 본인 조직의 취급자 사번 입력 가능 - 권한코드 : 34024(대면총무권한) /21013(대리점사용인관리자)
		if(dst_LginAuthInqrVo.get("geafAdmrYn") == "Y"
			|| dst_LginAuthInqrVo.get("agncyAdmrYn") == "Y")
  		{
  			ib_rgtrEmpno.setDisabled(false);
  			ib_rgtrEmpNm.setDisabled(false);
  		}
		//∙ 본사 관리자 bizAdmrYn='Y'는 전체 취급자 사번 입력 가능 - 권한코드 : 4000103(장기보험부기본)
		if(dst_LginAuthInqrVo.get("bizAdmrYn") == "Y")
  		{
  			ib_rgtrEmpno.setDisabled(false);
  			ib_rgtrEmpNm.setDisabled(false);
  		}	
  		
	};	
	
	//**********************************************************
	// 동일소속조회 /common/CBSO0016.do 
	//**********************************************************
	scwin.getSamePstnAuthInqr = function() {
		// 사번
		dst_SamePstnAuthInqrVo.set("empno", gUserID);
		// 소속부서코드
		dst_SamePstnAuthInqrVo.set("pstnDeptCd", gUserDepartCode);
		// 비교사번
		dst_SamePstnAuthInqrVo.set("cmprEmpno", ib_rgtrEmpno.getValue());
		
		var trans = new transSub();                  	// transaction 보낼 객체 생성
		trans.setId("retrieveSamePstnAuthInqr");        // transaction 보낼 SubmissionID
		trans.setUrl("/common/CBSO0016.do");   			// Controller 쪽으로 보낼 주소
		trans.setDs("dst_SamePstnAuthInqrVo");					
		trans.targetDs("dst_SamePstnAuthInqrVo");		
		trans.callBack("scwin.subCallBackfunction");  	// 받을 Dataset을 처리시 콜백함수
		trans.send();
		
	};	
	
	
	//**********************************************************
	// 영업활동가망고객정보조회
	//**********************************************************
	scwin.getBussActPossCstInfo = function(nextKey) {
		// 영업활동자료ID   		
//		dst_BussActCstInfoVo.set("bussActDataId" , gBussActDataId);
		// 기준일자
		dst_BussActCstInfoVo.set("stndYmd", gsSysDate);
		// 취급자
		dst_BussActCstInfoVo.set("doerCd" , ib_rgtrEmpno.getValue());
		// 발송방법 (SMS/EMAIL)
		dst_BussActCstInfoVo.set("sendFlgcd" , rad_sendFlgCd.getValue());
		// 고객번호 nextKey
		dst_BussActCstInfoVo.set("nextKey" , nextKey);		
				
		var trans = new transSub();                  // transaction 보낼 객체 생성
		trans.setId("retrieveBussActPossCstInfo");    // transaction 보낼 SubmissionID
		trans.setUrl("/sales/support/CBSB0008.do");   // Controller 쪽으로 보낼 주소
		trans.setDs("dst_BussActCstInfoVo");		  // IN	 DS		
		trans.targetDs("dst_BussActCstListInfoVo");	  // OUT DS	
		trans.callBack("scwin.subCallBackfunction");  // 받을 Dataset을 처리시 콜백함수
		trans.send();
	
	};		
	
	//**********************************************************
	// 영업활동계약고객정보조회
	//**********************************************************
	scwin.getBussActCrCstInfo = function(nextKey) {
		// 영업활동자료ID   		
//		dst_BussActCstInfoVo.set("bussActDataId" , gBussActDataId);
		// 기준일자
		dst_BussActCstInfoVo.set("stndYmd", gsSysDate);
		// 취급자
		dst_BussActCstInfoVo.set("doerCd" , ib_rgtrEmpno.getValue());
		// 발송방법 (SMS/EMAIL)
		dst_BussActCstInfoVo.set("sendFlgcd" , rad_sendFlgCd.getValue());
		// 고객번호 nextKey
		dst_BussActCstInfoVo.set("nextKey" , nextKey);		
				
		var trans = new transSub();                  	// transaction 보낼 객체 생성
		trans.setId("retrieveBussActCrCstInfo");    	// transaction 보낼 SubmissionID
		trans.setUrl("/sales/support/CBSB0009.do");   	// Controller 쪽으로 보낼 주소
		trans.setDs("dst_BussActCstInfoVo");		  	// IN	 DS		
		trans.targetDs("dst_BussActCstListInfoVo");	  	// OUT DS	
		trans.callBack("scwin.subCallBackfunction");  	// 받을 Dataset을 처리시 콜백함수
		trans.send();
	
	};				
	
	//**********************************************************
	// 조회버튼 클릭이벤트
	//**********************************************************
	scwin.btn_Search_onclick = function() {
		// 취급자
		if(util.isNull(ib_rgtrEmpno.getValue())) {
			wprom.alertF("조회할 취급자사번을 입력하세요", {}, ib_rgtrEmpno);
			return;
		}
		
		gRowCnt = 0;			// 가져온건수
		dsl_cstInfoList.removeAll();
		dsl_sendCstList.removeAll();
		dst_BussActCstListInfoVo.removeAll();
						
		// 발송관련 입력컨트롤 초기화
		//ib_senrEmpno.setValue("");
		
		ib_sendInfo.setValue("");
		ib_sndrTitl.setValue("");
		ta_sndrCont.setValue("");
		btn_send.setDisabled(true);
//		dst_rstBussActCstListInfoVo.clear();
		// 고객구분코드 : 01:가망고객, 02:계약고객
		var cstFlgcd = rad_cstFlgcd.getValue();	
		if(cstFlgcd == "01") {
			// 영업활동가망고객정보조회
			scwin.getBussActPossCstInfo("");
		}
		else if(cstFlgcd == "02") {
			// 영업활동계약고객정보조회
			scwin.getBussActCrCstInfo("");
		}
	};
		
	//**********************************************************
	// 조회데이터로 화면세팅 	
	//**********************************************************
	scwin.setBussActCstInfo  = function() {
		// 조회조건 
		// 고객구분코드 : 01:가망고객, 02:계약고객
		var cstFlgcd = rad_cstFlgcd.getValue();	
		// 발송구분코드 - sms :01, 이메일 :02
		var sendFlgCd = rad_sendFlgCd.getValue();
	
		for(var i=0; i<dst_BussActCstListInfoVo.getRowCount(); i++) {
			// 고객번호
			var custNo = dst_BussActCstListInfoVo.getCellData(i, "custNo");
			// 이름
			var name = dst_BussActCstListInfoVo.getCellData(i, "name");
			// 핸드폰정보 cellPhone1-cellPhone2-cellPhone3
			var cellPhone1 = dst_BussActCstListInfoVo.getCellData(i, "cellPhone1");
			var cellPhone2 = dst_BussActCstListInfoVo.getCellData(i, "cellPhone2");
			var cellPhone3 = dst_BussActCstListInfoVo.getCellData(i, "cellPhone3");
			
			// 이메일정보 둘중하나 존재 
			var email1 = dst_BussActCstListInfoVo.getCellData(i, "email1");
	//		var email2 = dst_BussActCstListInfoVo.getCellData(i, "email2");
						
			//마케팅동의여부	
			var magAgreYn = dst_BussActCstListInfoVo.getCellData(i, "magAgreYn");
			var magAgre = "";
			util.appendRow(dsl_cstInfoList); 
			var nRow = dsl_cstInfoList.getRowPosition();
			dsl_cstInfoList.setCellData(nRow, "custNo", custNo);
			dsl_cstInfoList.setCellData(nRow, "name", name); 
			
			if(magAgreYn == "Y") {
				magAgre = "동의";
			}else if(magAgreYn == "N") {
				magAgre = "미동의";			
				grd_cstList.setRowDisabled( nRow , true );			
			}
			dsl_cstInfoList.setCellData(nRow, "magAgreYn", magAgre); 
			
			if(sendFlgCd == "01") {
				// 핸드폰번호가 널이면 비활성
				if(util.isNull(cellPhone1) || util.isNull(cellPhone3) || util.isNull(cellPhone3)
				 	|| cellPhone1.trim() == "" || cellPhone2.trim() == "" || cellPhone3.trim() == "" 
				) {
					grd_cstList.setRowDisabled( nRow , true );	
				}
			}
			else if(sendFlgCd == "02") {
				// 이메일 주소가 널이면 비활성
				if(util.isNull(email1) || email1.trim() == "") {
					grd_cstList.setRowDisabled( nRow , true );	
				}
			}
			var sendFlgInfo;
			// 조회 발송구분코드가  sms 이면  핸드폰 번호 
			if(sendFlgCd == "01") {
				cellPhone1 = cellPhone1.trim();
				cellPhone2 = cellPhone2.trim();
				cellPhone3 = cellPhone3.trim();
				sendFlgInfo = cellPhone1 + cellPhone2 + cellPhone3;
				//sendFlgInfo = common.transPhone(cellPhone1 + cellPhone2 + cellPhone3);
			} // 조회 발송구분코드가  이메일 이면  이메일정보
			else if(sendFlgCd == "02") {
				sendFlgInfo = email1;
			}
			dsl_cstInfoList.setCellData(nRow, "sendFlgInfo", sendFlgInfo); 
			
		}
		
		// 고객명으로 정렬
		//dsl_cstInfoList.sort('name', 0);
		
		// 발송관련 컨트롤 활성 
	//	ib_senrEmpno.setDisabled(false);
		ib_sendInfo.setDisabled(false);	
		// sms선택시 제목 비활성화. 이메일 선택시 제목입력가능.	
		if(sendFlgCd == "01") {
			gr_title.setStyle("display", "none");	
			ta_sndrCont1.setStyle("display", "");
			ib_sndrTitl.setDisabled(true);			
			ib_sendInfo.setDisabled(true);
			ib_sendInfo.setValue(dst_rstBussActCstListInfoVo.get("senderTelNo"));
			ta_sndrCont1.setValue("(광고)[The-K손해보험/"
									+dst_rstBussActCstListInfoVo.get("doerNm")
									+"매니저/세일즈안내]\n"
									+"무료수신거부 0808603300"
									);
			
		} else if(sendFlgCd == "02") {
			gr_title.setStyle("display", "");
			ta_sndrCont1.setStyle("display", "none");	
			ib_sndrTitl.setDisabled(false);
			ib_sendInfo.setDisabled(true);
			ib_sendInfo.setValue(dst_rstBussActCstListInfoVo.get("senderEmail"));
			ta_sndrCont1.setValue("");
		}
		ib_senrEmpno.setValue(dst_rstBussActCstListInfoVo.get("doerNm") +"(" + dst_rstBussActCstListInfoVo.get("doerCd") + ")");
		ta_sndrCont.setDisabled(false);
		btn_send.setDisabled(false);
		ib_rgtrEmpNm.setValue(dst_rstBussActCstListInfoVo.get("doerNm"));
	};
	
	//**********************************************************
	// 발송리스트 전화번호 포매팅 displayFormatter
	//**********************************************************
	scwin.transphone = function(data, formattedData, rowIndex, colIndex) {
		var sendFlgCd = rad_sendFlgCd.getValue();
		// SMS인 경우 전화번호 포매팅 처리. EMAIL인 경우는 그대로 표시
		if(sendFlgCd == "01") {
			formattedData = common.transPhone(data);
		}
		else {
			formattedData = data;
		}
		return formattedData;	
	}
	
	//**********************************************************
	// 발송대상 추가 버튼 클릭이벤트 	
	//**********************************************************
	scwin.btn_add_onclick = function() {	
		var nAddCnt = 0;
		for(var i=0; i<dsl_cstInfoList.getRowCount(); i++) {
			// 체크된 데이터만 발송할수 있음 
			var chkFlg = dsl_cstInfoList.getCellData(i, "chk_flag");
			if(chkFlg == "1") {
				if(nAddCnt >=10) {
					wprom.alert("한번에 보낼 수 있는 건수는 10건입니다");
					return;
				}
				// 고객번호
				var custNo = dsl_cstInfoList.getCellData(i, "custNo");
				// 이름
				var name = dsl_cstInfoList.getCellData(i, "name");
				// 발송정보 
				var sendFlgInfo = dsl_cstInfoList.getCellData(i, "sendFlgInfo");
				var sameCstYn = scwin.chk_sameCstYn(custNo);
				// 이미 추가한 발송고객이 아니면 발송리스트에 추가 
				if(sameCstYn == "N") {			
					util.appendRow(dsl_sendCstList); 
					var nRow = dsl_sendCstList.getRowPosition();
					dsl_sendCstList.setCellData(nRow, "custNo", custNo);
					dsl_sendCstList.setCellData(nRow, "name", name); 
					dsl_sendCstList.setCellData(nRow, "sendFlgInfo", sendFlgInfo); 
		//			dsl_sendCstList.setCellData(nRow, "magAgreYn", magAgreYn);
					nAddCnt++;
				}
			} 
		}		
	};
	
	//**********************************************************
	// 발송리스트  	
	//**********************************************************	
	scwin.chk_sameCstYn = function(addCustNo) {
		for(var i=0; i<dsl_sendCstList.getRowCount(); i++) {
			// 고객번호
			var custNo = dsl_sendCstList.getCellData(i, "custNo");
			if(addCustNo == custNo) {
				wprom.alertF("이미 추가한 고객입니다. 확인하세요", {}, grd_cstList);
				return "Y";
			}
		}
		return "N";
	};
	
	//**********************************************************
	// 발송대상 삭제 버튼 클릭이벤트 	
	//**********************************************************	
	scwin.btn_del_onclick = function() {
		for(var i=dsl_sendCstList.getRowCount(); i>=0; i--) {
			// 체크된 데이터만 발송할수 있음 
			var chkFlg = dsl_sendCstList.getCellData(i, "chk_flag");
			if(chkFlg == "1") {
				dsl_sendCstList.removeRow(i);
			}			
		}
	};
	
	
	//**********************************************************
	// 발송자료정보 세팅
	//**********************************************************
	scwin.rgstBussActDataSendInfo = function() {
		// 입력값 체크 
		//고객구분코드 
		var cstFlgCd = rad_cstFlgcd.getValue();
		//발송구분코드
		var sendFlgCd = rad_sendFlgCd.getValue();
		
		var nSendCnt =0;
		for(var i=0; i<dsl_sendCstList.getRowCount(); i++) {
			if(dsl_sendCstList.getCellData(i, "chk_flag") == "1") {
				nSendCnt++;
			}
		}
		if(nSendCnt == 0) {
			wprom.alert("선택된 발송고객리스트가 없습니다. 확인하세요");	
			return;
		}
		//SMS발송건수
		var smsSendCnt = dst_rstBussActCstListInfoVo.get("smsSendCnt");
		//EMAIL발송건수
		var emailSendCnt = dst_rstBussActCstListInfoVo.get("emailSendCnt");
		
		// sms발송이면 
		if(sendFlgCd == "01") {
			smsSendCnt = wconv.toNumber(smsSendCnt) + wconv.toNumber(nSendCnt);
		}
		else if	(sendFlgCd == "02") {// 이메일발송이면 
			emailSendCnt = wconv.toNumber(emailSendCnt) + wconv.toNumber(nSendCnt);
		}
		//if(smsSendCnt > gMaxSendCnt || emailSendCnt > gMaxSendCnt ) {			
		if(smsSendCnt > gMaxSendCnt ) {		
			wprom.alert("발송건수 200건 초과 발송불가합니다.\n"+(smsSendCnt-gMaxSendCnt)+"건 발송 하실 수 있습니다.");
			return;
		}

		// 발신자
		var senrEmpno = ib_senrEmpno.getValue();
		if(util.isNull(senrEmpno)){
			wprom.alertF("발신자를 입력하세요", {}, ib_senrEmpno);		
			return;
		}
		// 발신 번호/이메일
		var sendInfo = ib_sendInfo.getValue();
		if(util.isNull(sendInfo)){
			wprom.alertF("발신 번호/이메일을 입력하세요", {}, ib_sendInfo);	
			return;	
		}
		// 제목 	
		var sndrTitl = ib_sndrTitl.getValue();	
		if(util.isNull(sndrTitl) && sendFlgCd == "02") {
			wprom.alertF("제목을 입력하세요", {}, ib_sndrTitl);	
			return;	
		}
		// 내용
		if(util.isNull(ta_sndrCont.getValue())) {
				wprom.alertF("내용을 입력하세요", {}, ta_sndrCont);	
				return;	
		}
		// 발송정보 param 				
		//발송일자  
		dst_BussActDataSendListInfoVo.set("sendDate", gsSysDate);
		//고객구분코드 
		dst_BussActDataSendListInfoVo.set("cstFlgcd", cstFlgCd);
		//등록자사번		
		dst_BussActDataSendListInfoVo.set("rgtrEmpno", gUserID);
		//등록일자
		dst_BussActDataSendListInfoVo.set("rgstDate", gsSysDate);
		//발송구분코드
		dst_BussActDataSendListInfoVo.set("sendFlgcd", sendFlgCd);
		//발송자사번 로그인자사번으로 세팅 
		dst_BussActDataSendListInfoVo.set("senrEmpno", ib_rgtrEmpno.getValue()); //senrEmpno);
		//발신제목
		dst_BussActDataSendListInfoVo.set("sndrTitl", sndrTitl);
		//발신내용
		dst_BussActDataSendListInfoVo.set("sndrCont1", ta_sndrCont1.getValue()); //멘트
		dst_BussActDataSendListInfoVo.set("sndrCont2", gApdxFileUrl); //첨부파일
		dst_BussActDataSendListInfoVo.set("sndrCont", ta_sndrCont.getValue()); //내용
		//영업활동자료발송id
		dst_BussActDataSendListInfoVo.set("bussActDataSendId", gBussActDataId);
				
		//발신번호
		if(sendFlgCd == "01") {
			dst_BussActDataSendListInfoVo.set("sndrTelno", sendInfo);
		}		
		//발신메일주소
		else if(sendFlgCd == "02") {
			dst_BussActDataSendListInfoVo.set("sndrEmail", sendInfo);		
		}
		
		
		var textMsg = "";
		if(gApdxFileUrl == ""){			
			textMsg = ta_sndrCont1.getValue()+"\n"+ta_sndrCont.getValue();						
		//첨부파일이 있는 경우.	
		}else{		
			textMsg = ta_sndrCont1.getValue()+"\n"+ta_sndrCont.getValue()+"\n"+gApdxFileUrl
		}
		//첨부파일이 없는 경우.
		console.log("첨부파일url=======>"+gApdxFileUrl);
		console.log("첨부파일byte=======>"+wconv.lengthb(textMsg));
		if(wconv.lengthb(textMsg)>2000){
			wprom.alertF("SMS는 2000byte까지 발송 가능합니다.\n현재 내용은 "+wconv.lengthb(textMsg)+"byte입니다.", {}, ib_sndrTitl);	
			return;	
		}
			
		//발송대상 고객리스트 	
		dst_BussActDataSendInfoVo.removeAll();
		for(var i=0; i<dsl_sendCstList.getRowCount(); i++) {	
			util.appendRow(dst_BussActDataSendInfoVo); 
			var nRow = dst_BussActDataSendInfoVo.getRowPosition();
			
			// 고객번호
			var custNo = dsl_sendCstList.getCellData(i, "custNo");
			dst_BussActDataSendInfoVo.setCellData(nRow, "custNo", custNo);
			
			// 고객명
			var name = dsl_sendCstList.getCellData(i, "name");			
			dst_BussActDataSendInfoVo.setCellData(nRow, "name", name);
			
			// 고객구분코드
			dst_BussActDataSendInfoVo.setCellData(nRow, "cstFlgcd", cstFlgCd);
			
			// 고객 핸드폰/이메일	
			var sendFlgInfo = dsl_sendCstList.getCellData(i, "sendFlgInfo");	
			
			//발송구분코드 
			dst_BussActDataSendInfoVo.setCellData(nRow, "sendFlgcd", sendFlgCd);
			//발신번호
			if(sendFlgCd == "01") {
				dst_BussActDataSendInfoVo.setCellData(nRow, "cellPhone", sendFlgInfo);
			}
			//발신메일주소
			else if(sendFlgCd == "02") {
				dst_BussActDataSendInfoVo.setCellData(nRow, "email", sendFlgInfo);
				dst_BussActDataSendInfoVo.setCellData(nRow, "sndrEmail", ib_sendInfo.getValue());
			}		
			
			dst_BussActDataSendInfoVo.setCellData(nRow, "senrEmpno", ib_rgtrEmpno.getValue());
			//dst_BussActDataSendInfoVo.setCellData(nRow, "name", ib_rgtrEmpNm.getValue());
			
		}
	
		var trans = new transSub();                  // transaction 보낼 객체 생성
		trans.setId("registerBussActDataSendInfo");   // transaction 보낼 SubmissionID
		trans.setUrl("/sales/support/CBSB0007.do");   // Controller 쪽으로 보낼 주소
		trans.setDs("dst_BussActDataSendInfoVo:I:bussActDataSendList");	
		
		trans.addDs("dst_BussActDataSendListInfoVo");					
		trans.targetDs("dst_BussActDataSendListInfoVo");		
		trans.callBack("scwin.subCallBackfunction");  // 받을 Dataset을 처리시 콜백함수
		trans.send();
	
	};
	
	//**********************************************************
	// 발송 버튼 클릭이벤트 
	//**********************************************************
	scwin.btn_send_onclick = function() {
		scwin.rgstBussActDataSendInfo();	
	};
	
	//**********************************************************
	// 고객명 조회(그리드 필터처리) 
	//**********************************************************
	scwin.btn_searchByCstNm_onclick = function() {
		var searchNm = ib_searchByCstNm.getValue();		
		if(util.isNull(searchNm)) {
			dsl_cstInfoList.removeColumnFilterAll();
		}
		else {
			dsl_cstInfoList.setColumnFilter( {type:'row', colIndex:'name', key:searchNm, condition:'and'});
		}
	};
	
	//**********************************************************
	// 고객명 조회(그리드 필터처리) 
	//**********************************************************
	scwin.ib_searchByCstNm_onkeydown = function(e) {
		// 고객명 인풋박스 엔터키 키다운이벤트시 조회버튼 클릭이벤트와 연결  
		if(e.keyCode == 13) {
			scwin.btn_searchByCstNm_onclick();
		}				
	};
	
	//**********************************************************
	// 취급자조회
	//**********************************************************
	scwin.ib_rgtrEmpno_onkeydown = function(e) {
		// 검색어 인풋박스 키다운이벤트시  조회버튼 클릭이벤트와 연결  
		if(e.keyCode == 13) {		
			// 취급자
			if(util.isNull(ib_rgtrEmpno.getValue())) {
				wprom.alertF("조회할 취급자사번을 입력하세요", {}, ib_rgtrEmpno);
				return;
			}
			
			//권한있는자인지 확인 - 동일소속인지 확인
			if(dst_LginAuthInqrVo.get("bizAdmrYn") != "Y"){
				scwin.getSamePstnAuthInqr();			
			}	
			else {
				//조회
				ib_rgtrEmpNm.setValue("");
				scwin.btn_Search_onclick();
			}
		}	
	};
	
	scwin.rad_sendFlgCd_onviewchange = function(info) {
		scwin.btn_Search_onclick();
	};
	
	scwin.rad_cstFlgcd_onviewchange = function(info) {
		scwin.btn_Search_onclick();
	};

	
	scwin.ta_ApdxFileInfo_onclick = function(e) {
		if(ggelementId != "" && ggfileName != ""){
			util.fileDownload(ggelementId, ggfileName);		
		}		
	};
	
	scwin.btn_close_onclick = function() {
		wprom.close();
	};
	]]></script>
	</head>
	<body>
		<xf:group class="contentWrap layer" id="" style="">

			<!-- group:s -->
			<xf:group id="" style="" class="section">
				<xf:group id="" style="" class="defaultbox">
					<w2:textbox id="" style="" class="df_tt fl"
						label="개인고객조회">
					</w2:textbox>
					<w2:anchor class="btn_nml fr"
						ev:onclick="scwin.btn_close_onclick" id="btn_close"
						outerDiv="true" style="">
						<xf:label><![CDATA[닫기]]></xf:label>
					</w2:anchor>
				</xf:group>
				<xf:group id="" style="" class="tbl_search">
					<xf:group id="" style="" adaptive=""
						class="w2tb tbl_sc" adaptiveThreshold="" tagname="table">
						<w2:attributes>
							<w2:summary></w2:summary>
						</w2:attributes>
						<xf:group tagname="colgroup">
							<xf:group style="width:90px"
								tagname="col">
							</xf:group>
							<xf:group style="width:185px"
								tagname="col">
							</xf:group>
							<xf:group style="width:80px"
								tagname="col">
							</xf:group>
							<xf:group style="" tagname="col"></xf:group>
						</xf:group>
						<xf:group tagname="tr" style="">
							<xf:group style="" class="w2tb_th"
								tagname="th">
								영업활동자료
							</xf:group>
							<xf:group style="" class="w2tb_td"
								tagname="td">
								<xf:input id="ib_bussActDataId"
									style="" disabled="true">
								</xf:input>
							</xf:group>
							<xf:group style="" class="w2tb_th"
								tagname="th">
								취급자
							</xf:group>
							<xf:group style="" class="w2tb_td"
								tagname="td">

								<xf:input id="ib_rgtrEmpno"
									style="width:70px" disabled="true" minlength="7" maxlength="7" dataType="text" ev:onkeydown="scwin.ib_rgtrEmpno_onkeydown"/>
								<xf:input id="ib_rgtrEmpNm"
									style="width:70px" disabled="true">
								</xf:input>
							</xf:group>
						</xf:group>
						<xf:group tagname="tr" style="">
							<xf:group style="" class="w2tb_th"
								tagname="th">
								고객상태
							</xf:group>
							<xf:group style="" class="w2tb_td"
								tagname="td">
								<xf:select1 appearance="full"
									id="rad_cstFlgcd" selectedIndex="0" style="" cols=""
									rows="1" ev:onviewchange="scwin.rad_cstFlgcd_onviewchange">
									<xf:choices>
										<xf:item>
											<xf:label><![CDATA[가망]]></xf:label>
											<xf:value><![CDATA[01]]></xf:value>
										</xf:item>
										<xf:item>
											<xf:label><![CDATA[계약]]></xf:label>
											<xf:value><![CDATA[02]]></xf:value>
										</xf:item>
									</xf:choices>
								</xf:select1>

							</xf:group>
							<xf:group style="" class="w2tb_th"
								tagname="th">
								발송방법
							</xf:group>
							<xf:group style="" class="w2tb_td"
								tagname="td">
								<xf:select1 appearance="full" cols=""
									id="rad_sendFlgCd" rows="1" selectedIndex="0" style=""
									ev:onviewchange="scwin.rad_sendFlgCd_onviewchange">
									<xf:choices>
										<xf:item>
											<xf:label><![CDATA[SMS]]></xf:label>
											<xf:value><![CDATA[01]]></xf:value>
										</xf:item>
										<xf:item>
											<xf:label><![CDATA[이메일]]></xf:label>
											<xf:value><![CDATA[02]]></xf:value>
										</xf:item>
									</xf:choices>
								</xf:select1>
							</xf:group>
						</xf:group>
					</xf:group>
					<w2:anchor id="btn_Search" style=""
						ev:onclick="scwin.btn_Search_onclick" class="btn_sh"
						outerDiv="true" disabled="false">
						<xf:label><![CDATA[조회]]></xf:label>
					</w2:anchor>
				</xf:group>
			</xf:group>
			<!-- group:e -->

			<!-- group:s -->
			<xf:group id="" style="" class="section hori">

				<xf:group id="" style="" class="defaultbox">
					<xf:group class="l">
						<w2:textbox id="" style="" class="df_tt fl"
							label="고객 리스트">
						</w2:textbox>
						<xf:group id="" style="" class="fr">
							<w2:textbox id="" style="" class="txt_label"
								label="고객명">
							</w2:textbox>
							<xf:input id="ib_searchByCstNm"
								style="width:105px"
								ev:onkeydown="scwin.ib_searchByCstNm_onkeydown" />
							<w2:anchor class="btn_icon sch" disabled=""
								ev:onclick="scwin.btn_searchByCstNm_onclick" id="btn_searchByCstNm" outerDiv="" style="">
								<xf:label><![CDATA[저장]]></xf:label>
							</w2:anchor>
						</xf:group>
					</xf:group>
					<w2:textbox id="" style="left:0px;top:0px;margin-left:20px;"
						class="df_tt fl" label="발송 리스트">
					</w2:textbox>
				</xf:group>
				<xf:group id="" style="" class="pr cb">
					<xf:group class="l">
						<w2:gridView ignoreCellClick="false"
							ev:onrowindexchange="" autoFit="allColumn" rowStatusWidth="20"
							visibleRowNum="" class="cm_grid" wheelRows="" ev:onviewchange=""
							fixedColumnWithHidden="" dataList="dsl_cstInfoList" id="grd_cstList"
							style="height:168px" scrollByColumn="false" useShiftKey="true"
							rowStatusVisible="" ev:onafteredit="" rowStatusHeaderValue="상태"
							ev:oncellclick="" rowNumVisible="" rowNumWidth="10" focusMode="row">
							<w2:header id="header1" style="">
								<w2:row id="row2" style="">
									<w2:column id="col_chk"
										blockSelect="false" style="height:20px;" width="40"
										inputType="checkbox" value="" displayMode="label">
									</w2:column>
									<w2:column id="column2"
										blockSelect="false" style="height:20px;" width="50"
										inputType="text" value="번호" displayMode="label">
									</w2:column>
									<w2:column id="column3"
										blockSelect="false" style="height:20px;" width="65"
										inputType="text" value="고객명" displayMode="label">
									</w2:column>
									<w2:column id="column4"
										blockSelect="false" style="height:20px;" width="105"
										inputType="text" value="핸드폰/이메일" displayMode="label">
									</w2:column>
									<w2:column id="column5"
										blockSelect="false" style="height:20px;" width="110"
										inputType="text" value="마케팅 동의여부" displayMode="label">
									</w2:column>
								</w2:row>
							</w2:header>
							<w2:gBody id="gBody4" style="">
								<w2:row id="row5" style="">
									<w2:column id="chk_flag"
										blockSelect="false" style="" width="40" inputType="checkbox"
										displayMode="label">
									</w2:column>
									<w2:column id="custNo"
										blockSelect="false" style="" width="50" inputType=""
										displayMode="label" readOnly="true">
									</w2:column>
									<w2:column id="name"
										blockSelect="false" style="" width="65" inputType=""
										displayMode="label" readOnly="true">
									</w2:column>
									<w2:column id="sendFlgInfo"
										blockSelect="false" style="" width="105" inputType=""
										displayMode="label" readOnly="true" displayFormatter="scwin.transphone">
									</w2:column>
									<w2:column id="magAgreYn"
										blockSelect="false" style="" width="110" inputType=""
										displayMode="label" readOnly="true">
									</w2:column>
								</w2:row>
							</w2:gBody>
						</w2:gridView>
					</xf:group>
					<xf:group class="r">
						<w2:gridView ignoreCellClick="false"
							ev:onrowindexchange="" autoFit="allColumn" rowStatusWidth="20"
							visibleRowNum="" class="cm_grid" wheelRows="" ev:onviewchange=""
							fixedColumnWithHidden="" dataList="dsl_sendCstList" id=""
							style="height:168px" scrollByColumn="false" useShiftKey="true"
							rowStatusVisible="" ev:onafteredit="" rowStatusHeaderValue="상태"
							ev:oncellclick="" rowNumVisible="" rowNumWidth="10" focusMode="row">
							<w2:header id="header1" style="">
								<w2:row id="row2" style="">
									<w2:column id="col_chk"
										blockSelect="false" style="height:20px;" width="40"
										inputType="checkbox" value="선택" displayMode="label">
									</w2:column>
									<w2:column id="column2"
										blockSelect="false" style="height:20px;" width="50"
										inputType="text" value="번호" displayMode="label">
									</w2:column>
									<w2:column id="column3"
										blockSelect="false" style="height:20px;" width="80"
										inputType="text" value="고객명" displayMode="label">
									</w2:column>
									<w2:column id="column4"
										blockSelect="false" style="height:20px;" width="140"
										inputType="text" value="핸드폰/이메일" displayMode="label">
									</w2:column>
								</w2:row>
							</w2:header>
							<w2:gBody id="gBody4" style="">
								<w2:row id="row5" style="">
									<w2:column id="chk_flag"
										blockSelect="false" style="" width="40" inputType="checkbox"
										displayMode="label">
									</w2:column>
									<w2:column id="custNo"
										blockSelect="false" style="" width="50" inputType=""
										displayMode="label" readOnly="true">
									</w2:column>
									<w2:column id="name"
										blockSelect="false" style="" width="80" inputType=""
										displayMode="label" readOnly="true">
									</w2:column>
									<w2:column id="sendFlgInfo"
										blockSelect="false" style="" width="140" inputType=""
										displayMode="label" readOnly="true" displayFormatter="scwin.transphone">
									</w2:column>
								</w2:row>
							</w2:gBody>
						</w2:gridView>
					</xf:group>
					<xf:group class="btn_wrap">
						<w2:anchor id="btn_add" ev:onclick="scwin.btn_add_onclick"
							class="add" outerDiv="true" style="margin-left:0px;">
							<xf:label><![CDATA[추가]]></xf:label>
						</w2:anchor>
						<w2:anchor id="btn_del" ev:onclick="scwin.btn_del_onclick"
							class="del" outerDiv="true" style="margin-left:0px;">
							<xf:label><![CDATA[삭제]]></xf:label>
						</w2:anchor>
					</xf:group>
				</xf:group>

			</xf:group>
			<!-- group:e -->

			<!-- group:s -->
			<xf:group id="" style="margin-left:-10px;" class="section">
				<xf:group id="" style="z-index:10; width:700px; position:relative; left:50%; margin-left:-350px;" class="w2tb tb"
					tagname="table">
					<w2:attributes>
						<w2:summary></w2:summary>
					</w2:attributes>
					<xf:group tagname="colgroup">
						<xf:group style="width:100px;" tagname="col"></xf:group>
						<xf:group style="" tagname="col"></xf:group>
						<xf:group style="width:120px;" tagname="col"></xf:group>
						<xf:group style="" tagname="col"></xf:group>
					</xf:group>
					<xf:group style="" tagname="tr">
						<xf:group style="" class="w2tb_th"
							tagname="th">
							발신자
						</xf:group>
						<xf:group style="" class="w2tb_td"
							tagname="td">
							<xf:input id="ib_senrEmpno" style=""
								disabled="true">
							</xf:input>
						</xf:group>
						<xf:group style="" class="w2tb_th"
							tagname="th">
							발신번호/이메일
						</xf:group>
						<xf:group style="" class="w2tb_td"
							tagname="td">
							<xf:input id="ib_sendInfo" style=""
								disabled="true">
							</xf:input>
						</xf:group>
					</xf:group>
					<xf:group style="" tagname="tr" id="gr_title">
						<xf:group style="" class="w2tb_th"
							tagname="th">
							제목
						</xf:group>
						<xf:group style="" class="w2tb_td"
							tagname="td">
							<w2:attributes>
								<w2:colspan>3</w2:colspan>
								<w2:rowspan>1</w2:rowspan>
							</w2:attributes>
							<xf:input id="ib_sndrTitl" style=""
								disabled="true" class="textarea_bg_a" maxlength="40">
							</xf:input>
						</xf:group>
					</xf:group>
					<xf:group style="" tagname="tr">
						<xf:group style="" class="w2tb_th"
							tagname="th">
							내용
						</xf:group>
						<xf:group style="" class="w2tb_td"
							tagname="td">
							<w2:attributes>
								<w2:colspan>3</w2:colspan>
								<w2:rowspan>1</w2:rowspan>
							</w2:attributes>
							<xf:textarea disabled="true"
								id="ta_sndrCont1" style="height:35px;margin-bottom: 3px;">
							</xf:textarea>
							<xf:textarea id="ta_sndrCont"
								style="height:70px;margin-bottom: 3px;" disabled="true"
								maxlength="100" maxByteLength="" class="textarea_bg_a">
							</xf:textarea>
						</xf:group>
					</xf:group><xf:group style="" tagname="tr">
					<xf:group class="w2tb_th" style="" tagname="th">첨부파일</xf:group>
					<xf:group class="w2tb_td" style="" tagname="td">
						<w2:attributes>
							<w2:colspan>3</w2:colspan>
							<w2:rowspan>1</w2:rowspan>
						</w2:attributes>
						<xf:input disabled="true" id="ta_ApdxFileInfo" style="" ev:onclick="scwin.ta_ApdxFileInfo_onclick">
						</xf:input>
					</xf:group>
				</xf:group>
				</xf:group>
				

				<xf:group class="section " id="" style="margin-top:-20px;width:815px; z-index:1; position:relative; left:50%; margin-left:-408px;">
					<w2:anchor class="btn_nml"
						ev:onclick="scwin.btn_send_onclick" id="btn_send" outerDiv="true"
						disabled="true" style="float:right; top:-32px;">
						<xf:label><![CDATA[발송]]></xf:label>
					</w2:anchor>
				</xf:group>
			</xf:group>
			<!-- group:e -->
		</xf:group>
	</body>
</html>