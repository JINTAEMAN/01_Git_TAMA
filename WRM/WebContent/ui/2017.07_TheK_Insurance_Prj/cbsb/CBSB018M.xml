<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="/cm/css/all.css" type="text/css"?>
<?xml-stylesheet href="/cm/css/new.css" type="text/css"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">

	<head>
		<w2:type>DEFAULT</w2:type>
		<w2:buildDate />
		<xf:model>
			<xf:instance>
				<data xmlns="" />
			</xf:instance>
			<w2:dataCollection baseNode="map">
				<w2:dataMap baseNode="map" id="dst_LginAuthInqrVo">
					<w2:keyInfo>
						<w2:key id="empNo" name="사번" dataType="text">
						</w2:key>
						<w2:key id="name" name="이름" dataType="text">
						</w2:key>
						<w2:key id="pstnDeptCd" name="소속부서코드"
							dataType="text">
						</w2:key>
						<w2:key id="bizAdmrYn" name="업무관리자"
							dataType="text">
						</w2:key>
						<w2:key id="agncyAdmrYn" name="대리점사용인관리자여부"
							dataType="text">
						</w2:key>
						<w2:key id="geafAdmrYn" name="대면총무여부,지점장여부"
							dataType="text">
						</w2:key>
						<w2:key id="gaEducMngrAdmrYn" name="GA교육매니저여부"
							dataType="text">
						</w2:key>
						<w2:key id="drctMangYn" name="직영여부"
							dataType="text">
						</w2:key>
						<w2:key id="crossYn" name="교차여부"
							dataType="text">
						</w2:key>
						<w2:key id="atchYn" name="전속여부"
							dataType="text">
						</w2:key>
						<w2:key id="gAYn" name="GA여부" dataType="text">
						</w2:key>
						<w2:key id="superAuthYn" name="전체권한여부"
							dataType="text">
						</w2:key>
						<w2:key id="drctMangAdmrYn" name="name13"
							dataType="text">
						</w2:key>
						<w2:key id="atchAdmrYn" name="name14"
							dataType="text">
						</w2:key>
						<w2:key id="gAAdmrYn" name="name15"
							dataType="text">
						</w2:key>
						<w2:key id="clprAdmrYn" name="name16"
							dataType="text">
						</w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataMap baseNode="map" id="dst_BussActDataInfoVo">
					<w2:keyInfo>
						<w2:key id="bussActDataId" name="영업활동자료Id"
							dataType="int">
						</w2:key>
						<w2:key id="bussActDataFlag" name="영업활동자료구분"
							dataType="text">
						</w2:key>
						<w2:key id="bussActDataName" name="영업활동자료명"
							dataType="text">
						</w2:key>
						<w2:key id="cont" name="내용" dataType="text">
						</w2:key>
						<w2:key id="rgtrEmpno" name="등록자사번"
							dataType="text">
						</w2:key>
						<w2:key id="deptCd" name="부서코드"
							dataType="text">
						</w2:key>
						<w2:key id="rgstDate" name="등록일자"
							dataType="text">
						</w2:key>
						<w2:key id="apdxFileName" name="첨부파일명"
							dataType="text">
						</w2:key>
						<w2:key id="apdxFilePath" name="첨부파일경로"
							dataType="text">
						</w2:key>
						<w2:key id="inqrNum" name="조회수"
							dataType="int">
						</w2:key>
						<w2:key id="drctMangAuthYn" name="직영권한여부"
							dataType="text">
						</w2:key>
						<w2:key id="crossAuthYn" name="교차권한여부"
							dataType="text">
						</w2:key>
						<w2:key id="atchAuthYn" name="전속권한여부"
							dataType="text">
						</w2:key>
						<w2:key id="gAAuthYn" name="GA권한여부"
							dataType="text">
						</w2:key>
						<w2:key id="delYn" name="삭제여부"
							dataType="text">
						</w2:key>
						<w2:key id="inptDler" name="입력처리자"
							dataType="text">
						</w2:key>
						<w2:key id="inptDlerIP" name="입력처리자IP"
							dataType="text">
						</w2:key>
						<w2:key id="inptDate" name="입력일자"
							dataType="text">
						</w2:key>
						<w2:key id="inptHms" name="입력시간"
							dataType="text">
						</w2:key>
						<w2:key id="mdfcDler" name="수정처리자"
							dataType="text">
						</w2:key>
						<w2:key id="mdfcDlerIP" name="수정처리자IP"
							dataType="text">
						</w2:key>
						<w2:key id="mdfcDate" name="수정일자"
							dataType="text">
						</w2:key>
						<w2:key id="mdfcHms" name="수정시간"
							dataType="text">
						</w2:key>
						<w2:key id="rgtrEmpNm" name="등록자이름"
							dataType="text">
						</w2:key>
						<w2:key id="noticDate" name="조회시작일"
							dataType="text">
						</w2:key>
						<w2:key id="noticEnddt" name="조회종료일"
							dataType="text">
						</w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataList id="dst_BussActDataInfoListVo"
					baseNode="list" saveRemovedData="true" repeatNode="map">
					<w2:columnInfo>
						<w2:column id="bussActDataId" name="영업활동자료Id"
							dataType="text">
						</w2:column>
						<w2:column id="bussActDataFlag" name="영업활동자료구분"
							dataType="text">
						</w2:column>
						<w2:column id="bussActDataName" name="영업활동자료명"
							dataType="text">
						</w2:column>
						<w2:column id="cont" name="내용"
							dataType="text">
						</w2:column>
						<w2:column id="rgtrEmpno" name="등록자사번"
							dataType="text">
						</w2:column>
						<w2:column id="deptCd" name="부서코드"
							dataType="text">
						</w2:column>
						<w2:column id="rgstDate" name="등록일자"
							dataType="text">
						</w2:column>
						<w2:column id="apdxFileName" name="첨부파일명"
							dataType="text">
						</w2:column>
						<w2:column id="apdxFilePath" name="첨부파일경로"
							dataType="text">
						</w2:column>
						<w2:column id="inqrNum" name="조회수"
							dataType="int">
						</w2:column>
						<w2:column id="drctMangAuthYn" name="직영권한여부"
							dataType="text">
						</w2:column>
						<w2:column id="crossAuthYn" name="교차권한여부"
							dataType="text">
						</w2:column>
						<w2:column id="atchAuthYn" name="전속권한여부"
							dataType="text">
						</w2:column>
						<w2:column id="gAAuthYn" name="GA권한여부"
							dataType="text">
						</w2:column>
						<w2:column id="delYn" name="삭제여부"
							dataType="text">
						</w2:column>
						<w2:column id="inptDler" name="입력처리자"
							dataType="text">
						</w2:column>
						<w2:column id="inptDlerIP" name="입력처리자IP"
							dataType="text">
						</w2:column>
						<w2:column id="inptDate" name="입력일자"
							dataType="text">
						</w2:column>
						<w2:column id="inptHms" name="입력시간"
							dataType="text">
						</w2:column>
						<w2:column id="mdfcDler" name="수정처리자"
							dataType="text">
						</w2:column>
						<w2:column id="mdfcDlerIP" name="수정처리자IP"
							dataType="text">
						</w2:column>
						<w2:column id="mdfcDate" name="수정일자"
							dataType="text">
						</w2:column>
						<w2:column id="mdfcHms" name="수정시간"
							dataType="text">
						</w2:column>
						<w2:column id="rgtrEmpNm" name="등록자이름"
							dataType="text">
						</w2:column>
						<w2:column id="seqNo" name="테이블시퀀스"
							dataType="text">
						</w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" id="dsl_bussActData" repeatNode="map">
                    <w2:columnInfo>
                        <w2:column dataType="text" id="CODE" name="CODE"></w2:column>
                        <w2:column dataType="text" id="TEXT" name="TEXT"></w2:column>
                    </w2:columnInfo>
                    <w2:data use="true">
                        <w2:row>
                            <CODE><![CDATA[01]]></CODE>
                            <TEXT><![CDATA[교안]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[02]]></CODE>
                            <TEXT><![CDATA[리플렛]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[03]]></CODE>
                            <TEXT><![CDATA[니즈]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[04]]></CODE>
                            <TEXT><![CDATA[안내장]]></TEXT>
                        </w2:row>
                    </w2:data>
                </w2:dataList>
				</w2:dataCollection>
			<w2:workflowCollection>
			</w2:workflowCollection>
			
		</xf:model>
<script src="/cm/js/common.js"/>
<script src="/cm/js/val_lib.js"/>
<script src="/cm/js/util.js"/>
<script src="/cm/js/transSub.js"/>
<script src="/cm/js/callService.js"/>
<script src="/cm/js/gds.js"/>
<script src="/cm/js/wconv.js"/>
<script src="/cm/js/wprom.js"/>		
<script src="/cm/js/convertJs/Global_Script.js"/>
<script src="/cm/js/convertJs/comm_Webservice.js"/>
<script src="/cm/js/convertJs/NewGen_Script.js"/>
<script src="/cm/js/convertJs/LongTerm_Script.js"/>
<script type="javascript"><![CDATA[
	/*
 	 *===================================File description================================================
 	 * Create Date : 2017/09/18
 	 * Creater     : KMJ
 	 *====================================================================================================
	 */

	var gsSysDate;			// global 현재일자
	var gUserID; 			// global 사용자 ID
	var gUserEmpName; 	    // global 부서명
			
	//**********************************************************
	// 초기화
	//**********************************************************
	scwin.init = function() {
		gfn_getServerTime();//서버시간
		gsSysDate = wconv.substr(gds.gDs_ServerTime.getCellData(0, "sToday"), 0, 8);
		gUserID 		= util.getGdsValue("gUserID");    					// global 사용자 ID
		gUserEmpName 	= util.getGdsValue("gUserEmpName");    				// global 부서명
						
	    //----- 버튼 처리(입력, 수정, 삭제, 결재, 취소, 인쇄, 엑셀, 닫기)
		gfn_btnEnable(false, false, false, false, false, false, false, true);

	    ic_dateFr.setValue(gsSysDate.substring(0, 6)+"01");
	    ic_dateTo.setValue(gsSysDate);	    	    
	        
	    var promise = Promise.resolve();
	    promise = promise.then(function(rtnVal) {
	     	// /common/CBSO0015.do 로그인자 권한조회	 
			return scwin.getLginAuthInfo();	  			
	    });	    	
	};
		
	//**********************************************************
	// 
	//**********************************************************
	scwin.subCallBackfunction = function(e){
		// e.subID : 서브미션 ID
		// e.flag  : s성공;
		// e.msg   : 트렌젝션 처리후 메세지
		// e."받을데이타셋"
		switch(e.subID){
			// 로그인ID권한조회
			case "retrieveLginIDAuthInqr":
				if(e.flag == "s") {
					dst_LginAuthInqrVo.setJSON(e.result);	
					var promise = Promise.resolve();
					promise = promise.then(function(rtnVal) {
						// 권한에 따라 버튼및 게시조직 체크 		
						return scwin.setCtrlByAuth();
					});
					promise = promise.then(function(rtnVal) {
						// 로그인자 권한이 하나도 없는 경우 조회 못하도록 조회버튼 비활성
				  		if(util.isNull(dst_LginAuthInqrVo.get("drctMangYn")) && 
				  		   util.isNull(dst_LginAuthInqrVo.get("crossYn")) && 
				  		   util.isNull(dst_LginAuthInqrVo.get("atchYn")) && 
				  		   util.isNull(dst_LginAuthInqrVo.get("gAYn")) && 
				  		   util.isNull(dst_LginAuthInqrVo.get("superAuthYn")))
				 		{
				 			btn_search.setDisabled(true);
        					wprom.alert("조회 권한이 없습니다.");        	
        					return;		
				 		}
						else {// /sales/support/CBSB0002.do 영업활동자료리스트조회 Call
							btn_search.setDisabled(false); 
   							scwin.getBussActDataList();	
   						}
					});
					
				}else {
					wprom.alert(e.msg);
				}															
			break;
			// 영업활동자료리스트조회
			case "retrieveBussActDataList":
				if(e.flag == "s") {
					dst_BussActDataInfoListVo.setJSON(e.result.bussActDataInfoVo);	
					// 등록일자로 정렬
					// (최근일자 부터 나오게 내림차순. 오름차순으로 할거면 0으로 해주면됨)
					//dst_BussActDataInfoListVo.sort('rgstDate', 1);
					
				} else {
					wprom.alert(e.msg);
				}
			break;
			// 영업활동자료조회수수정
			case "modifyBussActDataInqrNum":
				if(e.flag == "s") {
//					dst_BussActDataInfoVo.setJSON(e.result);
					//wprom.alert("수정이 완료되었습니다.");
					// 영업활동자료리스트 재조회
					scwin.getBussActDataList();	
				} else {
					wprom.alert(e.msg);
				}
			break;	
		}
	};
	
	//**********************************************************
	// 로그인자 권한조회 /common/CBSO0015.do 로그인자 권한조회
	//**********************************************************
	scwin.getLginAuthInfo = function() {
		var promise = Promise.resolve();
		// 사번으로 로그인자 권한조회	
	//	gUserID = "2080018";
		dst_LginAuthInqrVo.set("empNo" , gUserID);
		
		var trans = new transSub();                  	// transaction 보낼 객체 생성
		trans.setId("retrieveLginIDAuthInqr");        	// transaction 보낼 SubmissionID
		trans.setUrl("/common/CBSO0015.do");   			// Controller 쪽으로 보낼 주소
		trans.setDs("dst_LginAuthInqrVo");					
		trans.targetDs("dst_LginAuthInqrVo");		
		trans.callBack("scwin.subCallBackfunction");  	// 받을 Dataset을 처리시 콜백함수
		trans.send();
		
	};
	
	
	//**********************************************************
	// 영업활동자료리스트조회
	//**********************************************************
	scwin.getBussActDataList = function() {	
		dst_BussActDataInfoListVo.removeAll();
		
		if(util.isNull(ic_dateFr.getValue())){			
        	wprom.alertF("조회 시작일자를 입력해 주세요.",{}, ic_dateFr);        	
        	return;		
		}		
		if(util.isNull(ic_dateTo.getValue())){			
        	wprom.alertF("조회 종료일자를 입력해 주세요.",{}, ic_dateTo);        	
        	return;		
		}	
		if(parseInt(ic_dateFr.getValue()-ic_dateTo.getValue())>0){
			wprom.alertF("조회시작일이 조회종료일보다 큽니다.",{},ic_dateFr);						
			return;
		}		
		if(WebSquare.date.dateDiff(ic_dateFr.getValue(),ic_dateTo.getValue())>31){
			wprom.alertF("최대 31일까지 조회 가능합니다.",{},ic_dateTo);
			return;
		}	
		
		// INPUT DS 세팅
		// 활동자료구분(전체:NULL, 교안:'01', 리플렛:'02', 니즈:'03', 안내장:'04')	   		
		dst_BussActDataInfoVo.set("bussActDataFlag", sel_bussActDataFlag.getValue());
		// 조회구분(제목:N이면 검색어내용을  bussActDataName로 
		// 내용:C 이면 검색어내용을 cont에 채워보낸다)	
		if(sel_searchFlag.getValue() == "N") {
			dst_BussActDataInfoVo.set("bussActDataName", ib_searchWord.getValue());
			dst_BussActDataInfoVo.set("cont", "");
		}else if(sel_searchFlag.getValue() == "C") {
			dst_BussActDataInfoVo.set("bussActDataName", "");
			dst_BussActDataInfoVo.set("cont", ib_searchWord.getValue());	
		}	
		
		dst_BussActDataInfoVo.set("noticDate", ic_dateFr.getValue());	//게시일자
		dst_BussActDataInfoVo.set("noticEnddt", ic_dateTo.getValue());	//종료일자
			
		
		var trans = new transSub();                  	// transaction 보낼 객체 생성
		trans.setId("retrieveBussActDataList");       	// transaction 보낼 SubmissionID
		trans.setUrl("/sales/support/CBSB0002.do");   	// Controller 쪽으로 보낼 주소
		trans.setDs("dst_BussActDataInfoVo");		// Input DS		
		trans.targetDs("dst_BussActDataInfoListVo");	// Output DS	 	
		trans.callBack("scwin.subCallBackfunction");  	// 받을 Dataset을 처리시 콜백함수
		trans.send();
	
	};	
		

	//**********************************************************
	// 권한에 따라 화면컨트롤 
	//**********************************************************
	scwin.setCtrlByAuth = function() {
		// 권한조회 결과를 dst_BussActDataInfoVo에 세팅해주기 
		// LginAuthInqrVo.superAuthYn 가"Y"이면 아래 4개 모두 Y
    	if(dst_LginAuthInqrVo.get("superAuthYn") == "Y"){
  			//직영권한여부 LginAuthInqrVo.drctMangYn
  			dst_BussActDataInfoVo.set("drctMangAuthYn"	, ""); 
	  		//교차권한여부 LginAuthInqrVo.crossYn    
  			dst_BussActDataInfoVo.set("crossAuthYn"		, "");         
  			//전속권한여부 LginAuthInqrVo.atchYn    
  			dst_BussActDataInfoVo.set("atchAuthYn"		, "");     
			//ga권한여부   LginAuthInqrVo.gAYn  
  			dst_BussActDataInfoVo.set("gAAuthYn"		, ""); 
  		} 
  		else {
			//직영권한여부 LginAuthInqrVo.drctMangYn
  			dst_BussActDataInfoVo.set("drctMangAuthYn"	, dst_LginAuthInqrVo.get("drctMangYn")); 
			//교차권한여부 LginAuthInqrVo.crossYn    
  			dst_BussActDataInfoVo.set("crossAuthYn"		, dst_LginAuthInqrVo.get("crossYn"));         
			//전속권한여부 LginAuthInqrVo.atchYn    
  			dst_BussActDataInfoVo.set("atchAuthYn"		, dst_LginAuthInqrVo.get("atchYn"));     
			//ga권한여부   LginAuthInqrVo.gAYn  
  			dst_BussActDataInfoVo.set("gAAuthYn"		, dst_LginAuthInqrVo.get("gAYn")); 	
			//전체권한여부   LginAuthInqrVo.superAuthYn  
  			dst_BussActDataInfoVo.set("superAuthYn"		, dst_LginAuthInqrVo.get("superAuthYn")); 	
  		} 
		/* 자료등록 버튼 
		LginAuthInqrVo.drctMangAdmrYn
  		LginAuthInqrVo.crossAdmrYn
  		LginAuthInqrVo.atchAdmrYn
  		LginAuthInqrVo.gAAdmrYn
  		LginAuthInqrVo.SuperAuthYn
  		위의 값이 Y인경우 모두 버튼 보이기, 나머지는 버튼 안보이기.*/
  		
  		console.log("로그인자권한================>\n"
  					+"직영:"+ dst_LginAuthInqrVo.get("drctMangAdmrYn")+"/"+dst_LginAuthInqrVo.get("drctMangYn")+"\n"
  					+"교차:"+ "교차관리자없음/"+dst_LginAuthInqrVo.get("crossYn")+"\n"
  					+"전속:"+ dst_LginAuthInqrVo.get("atchAdmrYn")+"/"+dst_LginAuthInqrVo.get("atchYn")+"\n"
  					+"ga:"+ dst_LginAuthInqrVo.get("gAAdmrYn")+"/"+dst_LginAuthInqrVo.get("gAYn")+"\n"
  					+"슈퍼:"+ dst_LginAuthInqrVo.get("superAuthYn")+"\n"  				
  		);	
  		
  		 		  		  	
  		if(dst_LginAuthInqrVo.get("superAuthYn") == "Y"
  			|| dst_LginAuthInqrVo.get("drctMangAdmrYn") == "Y"
  			|| dst_LginAuthInqrVo.get("atchAdmrYn") == "Y"
  			|| dst_LginAuthInqrVo.get("gAAdmrYn") == "Y"
  			)
  		{
			btn_rgstBussActData.visible(true);			  			
  		}else{
  			btn_rgstBussActData.visible(false);
  		}
  		
  		
	};	
	
	//**********************************************************
	// 조회 버튼 클릭이벤트 
	//**********************************************************
	scwin.btn_search_onclick = function() {		
		// 업무관리자는 모든 정보 조회, 취급자는 해당 조직에 등록된 자료만 조회
		// /sales/support/CBSB0002.do 영업활동자료리스트 조회
		scwin.getBussActDataList();	
	};
	
	//**********************************************************
	// 그리드 더블클릭이벤트 
	//**********************************************************	
	scwin.grd_bussActDataList_oncelldblclick = function(row,col) {
		// 영업활동등록[CBSB030P]팝업화면 오픈  	
		var colId = grd_bussActDataList.getColumnID(col);	
		if(colId == "bussActDataName"){
			// 기존 자료조회를 위한 팝업오픈  
			if(row<0) {
				wprom.alertF("자료등록할 활동자료명을 클릭하세요", {}, grd_bussActDataList);	
				return;	
			}
			
			var sBussActDataId = dst_BussActDataInfoListVo.getCellData(row, "bussActDataId"); 
			
			var promise = Promise.resolve();
		    promise = promise.then(function(rtnVal) {
		    	return scwin.openPopupCBSB030P(sBussActDataId);
				// 활동조회수 수정 
				//scwin.modBussActDataInqrNum(sBussActDataId);	
				
			});	
			//  

		//공지사항첨부파일 클릭시	
		}else if(colId == "apdxFileInfo"){
			var apdxFileName = dst_BussActDataInfoListVo.getCellData(row, "apdxFileName"); 
			var apdxFilePath = dst_BussActDataInfoListVo.getCellData(row, "apdxFilePath");
			if(apdxFileName!=null && apdxFileName.trim()!= ""){
				util.fileDownload(apdxFilePath, apdxFileName);
			}			
		}
		
	};
	
	//**********************************************************
	// 영업활동자료조회수수정
	//**********************************************************
	scwin.modBussActDataInqrNum = function(sBussActDataId) {
		// 입력변수 초기화 
		dst_BussActDataInfoVo.set("bussActDataFlag", "");
		dst_BussActDataInfoVo.set("bussActDataName", "");
		dst_BussActDataInfoVo.set("cont", "");
			
		// 영업활동자료Id   		
		dst_BussActDataInfoVo.set("bussActDataId" , sBussActDataId);
			
		var trans = new transSub();                 // transaction 보낼 객체 생성
		trans.setId("modifyBussActDataInqrNum");     // transaction 보낼 SubmissionID
		trans.setUrl("/sales/support/CBSB0004.do");   // Controller 쪽으로 보낼 주소
		trans.setDs("dst_BussActDataInfoVo");					
		trans.targetDs("dst_BussActDataInfoVo");		
		trans.callBack("scwin.subCallBackfunction");  // 받을 Dataset을 처리시 콜백함수
		trans.send();	
	};
	
	//**********************************************************
	// 자료등록 버튼 클릭이벤트 
	//**********************************************************	
	scwin.btn_rgstBussActData_onclick = function() {
		// 영업활동등록[CBSB030P]팝업화면 오픈  	
		// 신규 자료등록을 위한 팝업오픈  
		scwin.openPopupCBSB030P("");
	};
	
	
	//**********************************************************
	// 영업활동등록[CBSB030P]팝업화면 오픈
	//**********************************************************	
	scwin.openPopupCBSB030P = function(sBussActDataId) {
 		var promise = Promise.resolve();	        
        promise = promise.then(function(rtnVal) {	
			var indata  = {"bussActDataId" 	: sBussActDataId};
			var popInfo = {
			    "width"     : 720,
			    "height"    : 350,
			    "indata"    : indata,
			    //"callback"  : scwin.popupCallback,
			    "title"     : "영업활동자료등록및조회"
			};
			return wprom.popupOpen("/ui/cbsb/CBSB030P.xml", popInfo);
		});
		// 등록완료 되면 재조회 
		promise = promise.then(function(rtnVal) {	
          	// 재조회 
           	scwin.getBussActDataList();
		});
	};
	
	//**********************************************************
	// 그리드 첨부파일 컬럼 customFormatter
	//**********************************************************
	scwin.setApdxFileInfo = function(data, formattedData, rowIndex, colIndex) {
		var sApdxFileName = dst_BussActDataInfoListVo.getCellData(rowIndex, "apdxFileName");
		// 첨부파일명이 존재하면 이미지 표시
		if(!util.isNull(wconv.trim(sApdxFileName))){
			formattedData = "<img src='/cm/images/contents/ico_top_save.png'>"
		}
		// 첨부파일명이 널이면 '-' 표시 
		else {
			formattedData = "-";
		}	
		return formattedData;	
	};
	
	
	//**********************************************************
	// 검색어 인풋박스 키다운이벤트
	//**********************************************************	
	scwin.ib_searchWord_onkeydown = function(e) {
		// 로그인자 권한이 하나도 없는 경우 조회 못하도록 조회버튼 비활성
  		if(util.isNull(dst_LginAuthInqrVo.get("drctMangYn")) && 
  		   util.isNull(dst_LginAuthInqrVo.get("crossYn")) && 
  		   util.isNull(dst_LginAuthInqrVo.get("atchYn")) && 
  		   util.isNull(dst_LginAuthInqrVo.get("gAYn")) && 
  		   util.isNull(dst_LginAuthInqrVo.get("superAuthYn")))
 		{
 			btn_search.setDisabled(true);
			//wprom.alert("조회 권한이 없습니다.");        	
			return;		
 		}

		// 검색어 인풋박스 키다운이벤트시  조회버튼 클릭이벤트와 연결  
		if(e.keyCode == 13) {
			scwin.btn_search_onclick();
		}		
	};
	
	]]></script>
	</head>
	<body>
		<xf:group class="contentWrap" id="" style="">

			<!-- group:s -->
			<w2:wframe id="" initScript="scwin.wfTitleFavInit();" src="/cm/common/wf_titleFav.xml" style="" class="common_bu_area">
		</w2:wframe><xf:group id="" style="" class="section">
				<xf:group id="" style="" class="tbl_search">
					<xf:group id="" style="" adaptive=""
						class="w2tb tbl_sc" adaptiveThreshold="" tagname="table">
						<w2:attributes>
							<w2:summary></w2:summary>
						</w2:attributes>
						<xf:group tagname="colgroup">
							<xf:group style="width:100px"
								tagname="col">
							</xf:group>
							<xf:group style="width:100px"
								tagname="col">
							</xf:group>
							
							<xf:group style="width:80px;"
								tagname="col">
							</xf:group>
							<xf:group style="width:230px"
								tagname="col">
							</xf:group>
							<xf:group style="width:80px" tagname="col">

							</xf:group><xf:group style="width:100px"
								tagname="col">
							</xf:group>
							<xf:group style="width:80px"
								tagname="col">
							</xf:group>
							<xf:group style="width:100px" tagname="col"></xf:group>
						</xf:group>
						<xf:group tagname="tr" style="">
							<xf:group style="" class="w2tb_th"
								tagname="th">
								활동자료구분
							</xf:group>
							<xf:group style="" class="w2tb_td"
								tagname="td">
								<xf:select1 allOption=""
									appearance="minimal" chooseOption="true" direction="auto"
									disabled="false" disabledClass="" displayMode="label"
									ev:onviewchange="" id="sel_bussActDataFlag" optionOrder=""
									ref="" style="" submenuSize="" renderType="native"
									chooseOptionLabel="-전체-" class="sty_ipt_search">
									<xf:choices>
										<xf:itemset
											nodeset="data:dsl_bussActData">
											<xf:label ref="TEXT"></xf:label>
											<xf:value ref="CODE"></xf:value>
										</xf:itemset>
									</xf:choices>
								</xf:select1>
							</xf:group>
							<xf:group class="w2tb_th" style=""
								tagname="th">
								조회일자
							</xf:group>
							<xf:group class="w2tb_td" style=""
								tagname="td">
								<w2:inputCalendar
									calendarValueType="yearMonthDate" class="sty_ipt_search"
									ev:onkeydown="scwin.cal_searchPeriod_onkeydown"
									focusOnDateSelect="false" footerDiv="false" id="ic_dateFr"
									renderDiv="true" renderType="component" rightAlign="false"
									style="width:100px" weekStartsOn="0">
								</w2:inputCalendar>
								<w2:textbox class="txt_bw" id=""
									label="~" tagname="span" style="">
								</w2:textbox>
								<w2:inputCalendar
									calendarValueType="yearMonthDate" class="sty_ipt_search"
									ev:onkeydown="scwin.cal_searchPeriod_onkeydown"
									focusOnDateSelect="false" footerDiv="false" id="ic_dateTo"
									renderDiv="true" renderType="component" rightAlign="false"
									style="width:100px" weekStartsOn="0">
								</w2:inputCalendar>
							</xf:group>
							<xf:group style="" class="w2tb_th"
								tagname="th">
								조회구분
							</xf:group>
							<xf:group style="" class="w2tb_td"
								tagname="td">
								<xf:select1 allOption=""
									appearance="minimal" chooseOption="" direction="auto"
									disabled="false" disabledClass="" displayMode="label"
									ev:onviewchange="" id="sel_searchFlag" optionOrder="" ref=""
									style="" submenuSize="" renderType="native"
									class="sty_ipt_search">
									<xf:choices>
										<xf:item>
											<xf:label><![CDATA[제목]]></xf:label>
											<xf:value><![CDATA[N]]></xf:value>
										</xf:item>
										<xf:item>
											<xf:label><![CDATA[내용]]></xf:label>
											<xf:value><![CDATA[C]]></xf:value>
										</xf:item>
									</xf:choices>
								</xf:select1>
							</xf:group>
							<xf:group style="" class="w2tb_th"
								tagname="th">
								검색어
							</xf:group>
							<xf:group style="" class="w2tb_td"
								tagname="td">
								<xf:input id="ib_searchWord"
									style="" class="sty_ipt_search"
									ev:onkeydown="scwin.ib_searchWord_onkeydown">
								</xf:input>
							</xf:group>
							<w2:anchor id="btn_search" style=""
								ev:onclick="scwin.btn_search_onclick" class="btn_sh"
								outerDiv="true" disabled="">
								<xf:label><![CDATA[조회]]></xf:label>
							</w2:anchor>
						</xf:group>
					</xf:group>
				</xf:group>
			</xf:group>
			<!-- group:e -->

			<!-- group:s -->
			<xf:group id="" style="" class="section">

				<w2:gridView ignoreCellClick="false"
					ev:onrowindexchange="" autoFit="allColumn" rowStatusWidth=""
					visibleRowNum="" class="cm_grid" wheelRows="" ev:onviewchange=""
					fixedColumnWithHidden="" dataList="dst_BussActDataInfoListVo"
					id="grd_bussActDataList" style="height:578px;"
					scrollByColumn="false" useShiftKey="true" rowStatusVisible=""
					ev:onafteredit="" rowStatusHeaderValue="상태" ev:oncellclick=""
					rowNumVisible="true" rowNumWidth="30"
					ev:oncelldblclick="scwin.grd_bussActDataList_oncelldblclick" rowNumHeaderValue="No" sortable="">
					<w2:header id="header1" style="">
						<w2:row id="row2" style="">
							<w2:column id="column1" blockSelect="false"
								style="height:10px;" width="65" inputType="text" value="NO"
								displayMode="label" hidden="true">
							</w2:column>
							<w2:column id="column2" blockSelect="false"
								style="height:20px;" width="85" inputType="text" value="구분"
								displayMode="label">
							</w2:column>
							<w2:column id="column3" blockSelect="false"
								style="height:20px;" width="400" inputType="text" value="활동자료명"
								displayMode="label">
							</w2:column>
							<w2:column id="column4" blockSelect="false"
								style="height:20px;" width="80" inputType="text" value="첨부파일"
								displayMode="label">
							</w2:column>
							<w2:column id="column5" blockSelect="false"
								style="height:20px;" width="100" inputType="text" value="등록자"
								displayMode="label">
							</w2:column>
							<w2:column id="column6" blockSelect="false"
								style="height:20px;" width="105" inputType="text" value="등록일자"
								displayMode="label" sortable="">
							</w2:column>
							<w2:column id="column7" blockSelect="false"
								style="height:20px;" width="100" inputType="text" value="조회수"
								displayMode="label">
							</w2:column>
						</w2:row>
					</w2:header>
					<w2:gBody id="gBody4" style="">
						<w2:row id="row5" style="">
							<w2:column id="bussActDataId"
								blockSelect="false" width="65" inputType="text"
								displayMode="label">
							</w2:column>
							<w2:column id="bussActDataFlag"
								blockSelect="false" width="85" displayMode="label"
								readOnly="true" inputType="select">
								<w2:choices>
									<w2:itemset
										nodeset="data:dsl_bussActData">
										<w2:label ref="TEXT"></w2:label>
										<w2:value ref="CODE"></w2:value>
									</w2:itemset>
								</w2:choices>
							</w2:column>
							<w2:column id="bussActDataName"
								blockSelect="false" width="400" displayMode="label"
								readOnly="true" textAlign="left" escape="true">
							</w2:column>
							<w2:column id="apdxFileInfo"
								blockSelect="false" width="80" inputType="text"
								displayMode="label"
								imageSrc="/cm/images/contents/ico_top_save.png" expression=""
								displayFormatter="" customFormatter="scwin.setApdxFileInfo">
							</w2:column>
							<w2:column id="rgtrEmpNm"
								blockSelect="false" width="100" displayMode="label"
								readOnly="true">
							</w2:column>
							<w2:column id="rgstDate" blockSelect="false"
								width="105" displayMode="label" readOnly="true" dataType="date">
							</w2:column>
							<w2:column id="inqrNum" blockSelect="false"
								width="100" displayMode="label" readOnly="true">
							</w2:column>
						</w2:row>
					</w2:gBody>
				</w2:gridView>
			</xf:group>
			<!-- group:e -->

			<!-- group:s -->
			<xf:group id="" style="" class="section bottom_center">
				<xf:group class="fr" id="" style="">
					<w2:anchor class="btn_nml" ev:onclick="scwin.btn_rgstBussActData_onclick"
						id="btn_rgstBussActData" outerDiv="true" style="margin-left:-5px;">
						<xf:label><![CDATA[자료등록]]></xf:label>
					</w2:anchor>
				</xf:group>
			</xf:group>
			<!-- group:e -->

		</xf:group>
		
	</body>
</html>