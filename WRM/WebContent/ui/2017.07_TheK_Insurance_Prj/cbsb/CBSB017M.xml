<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="/cm/css/all.css" type="text/css"?>
<?xml-stylesheet href="/cm/css/convert.css" type="text/css"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head>
        <w2:type>DEFAULT</w2:type>
        <w2:buildDate/>
        <xf:model>
            <xf:instance>
                <data/>
            </xf:instance>
            <w2:dataCollection>
            	<w2:dataList baseNode="list" id="Ds_combo"
            		repeatNode="map">
            		<w2:columnInfo>
            			<w2:column dataType="text" id="sCd" name="sCd" />
            			<w2:column dataType="text" id="sNm" name="sNm" />
            		</w2:columnInfo>
            		<w2:data use="true">
            			<w2:row>
            				<sCd />
            				<sNm><![CDATA[- 전체 -]]></sNm>
            			</w2:row>
            			<w2:row>
            				<sCd><![CDATA[1]]></sCd>
            				<sNm><![CDATA[대면]]></sNm>
            			</w2:row>
            			<w2:row>
            				<sCd><![CDATA[2]]></sCd>
            				<sNm><![CDATA[비대면]]></sNm>
            			</w2:row>
            		</w2:data>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="Ds_lnsFlag"
            		repeatNode="map">
            		<w2:columnInfo>
            			<w2:column dataType="text" id="lnsFlagCd"
            				name="lnsFlagCd" />
            			<w2:column dataType="text" id="lnsFlagValue"
            				name="lnsFlagValue" />
            		</w2:columnInfo>
            		<w2:data use="true">
            			<w2:row>
            				<lnsFlagCd><![CDATA[0]]></lnsFlagCd>
            				<lnsFlagValue><![CDATA[- 전체 -]]></lnsFlagValue>
            			</w2:row>
            			<w2:row>
            				<lnsFlagCd><![CDATA[1]]></lnsFlagCd>
            				<lnsFlagValue><![CDATA[장기]]></lnsFlagValue>
            			</w2:row>
            			<w2:row>
            				<lnsFlagCd><![CDATA[2]]></lnsFlagCd>
            				<lnsFlagValue><![CDATA[일반]]></lnsFlagValue>
            			</w2:row>
            		</w2:data>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="Ds_orgnFlag"
            		repeatNode="map">
            		<w2:columnInfo>
            			<w2:column dataType="text" id="orgnFlagCd"
            				name="orgnFlagCd" />
            			<w2:column dataType="text" id="orgnFlagValue"
            				name="orgnFlagValue" />
            		</w2:columnInfo>
            		<w2:data use="true">
            			<w2:row>
            				<orgnFlagCd><![CDATA[1]]></orgnFlagCd>
            				<orgnFlagValue><![CDATA[조직코드]]></orgnFlagValue>
            			</w2:row>
            			<w2:row>
            				<orgnFlagCd><![CDATA[2]]></orgnFlagCd>
            				<orgnFlagValue><![CDATA[취급자코드]]></orgnFlagValue>
            			</w2:row>
            			<w2:row>
            				<orgnFlagCd><![CDATA[3]]></orgnFlagCd>
            				<orgnFlagValue><![CDATA[사용인코드]]></orgnFlagValue>
            			</w2:row>
            		</w2:data>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="Ds_LinkList"
            		repeatNode="map" />
            	<w2:dataList baseNode="list" id="ds_code"
            		repeatNode="map">
            		<w2:columnInfo>
            			<w2:column id="result" name="result"
            				dataType="text">
            			</w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="Dataset0"
            		repeatNode="map" />
            	<w2:dataList baseNode="list" id="Ds_Team"
            		repeatNode="map">
            		<w2:columnInfo>
            			<w2:column id="sHeadCenterName"
            				name="sHeadCenterName" dataType="text">
            			</w2:column>
            			<w2:column id="sHeadCenterCode"
            				name="sHeadCenterCode" dataType="text">
            			</w2:column>
            			<w2:column id="sTeamCode" name="sTeamCode"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sGroupName" name="sGroupName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sDptOfficeCode"
            				name="sDptOfficeCode" dataType="text">
            			</w2:column>
            			<w2:column id="sPartCode" name="sPartCode"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sTeamName" name="sTeamName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sCenterCode" name="sCenterCode"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sCenterName" name="sCenterName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sAgentName" name="sAgentName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sPartName" name="sPartName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sDptOfficeName"
            				name="sDptOfficeName" dataType="text">
            			</w2:column>
            			<w2:column id="sInputTime" name="sInputTime"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sGroupCode" name="sGroupCode"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sAgentCode" name="sAgentCode"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sInputDate" name="sInputDate"
            				dataType="text">
            			</w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="Ds_TMAuth"
            		repeatNode="map">
            		<w2:columnInfo>
            			<w2:column id="sAuthFlag" name="sAuthFlag"
            				dataType="text">
            			</w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="DsWs_sCrStatCd"
            		repeatNode="map" />
            	<w2:dataList baseNode="list" id="DsWs_List"
            		repeatNode="map" userData2="//*/vector/data/CCCBF00">
            		<w2:columnInfo>
            			<w2:column id="nBussPrem2" name="nBussPrem2"
            				dataType="text">
            			</w2:column>
            			<w2:column id="nBussPrem1" name="nBussPrem1"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sGdName" name="sGdName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sCenterCode" name="sCenterCode"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sGnrzCd" name="sGnrzCd"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sInsurStrtdate"
            				name="sInsurStrtdate" dataType="text">
            			</w2:column>
            			<w2:column id="sTeamCenterNm"
            				name="sTeamCenterNm" dataType="text">
            			</w2:column>
            			<w2:column id="sCenterName" name="sCenterName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sInsTypeNm" name="sInsTypeNm"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sInsType" name="sInsType"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sInskdFlagCd" name="sInskdFlagCd"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sCrtorName" name="sCrtorName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sGnrzName" name="sGnrzName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sInrpsName" name="sInrpsName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sPaymCyclCd" name="sPaymCyclCd"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sCellPhone" name="sCellPhone"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sFrstDoerName"
            				name="sFrstDoerName" dataType="text">
            			</w2:column>
            			<w2:column id="sApplPlanName"
            				name="sApplPlanName" dataType="text">
            			</w2:column>
            			<w2:column id="nRealInsurTerm"
            				name="nRealInsurTerm" dataType="text">
            			</w2:column>
            			<w2:column id="sJugmNm" name="sJugmNm"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sCrtorCd" name="sCrtorCd"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sInrpsCd" name="sInrpsCd"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sCrNo" name="sCrNo"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sAdrs" name="sAdrs"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sCmMetdNm" name="sCmMetdNm"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sCrStatCd" name="sCrStatCd"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sFrstDoerUser"
            				name="sFrstDoerUser" dataType="text">
            			</w2:column>
            			<w2:column id="sApplPlanCd" name="sApplPlanCd"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sTeamCode" name="sTeamCode"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sFrstDoerUserNm"
            				name="sFrstDoerUserNm" dataType="text">
            			</w2:column>
            			<w2:column id="sTeamName" name="sTeamName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="nCnt" name="nCnt"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sCmMetd" name="sCmMetd"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sChngStndDate"
            				name="sChngStndDate" dataType="text">
            			</w2:column>
            			<w2:column id="sScanObjtYn" name="sScanObjtYn"
            				dataType="text">
            			</w2:column>
            			<w2:column id="nApplPrem2" name="nApplPrem2"
            				dataType="text">
            			</w2:column>
            			<w2:column id="nApplPrem1" name="nApplPrem1"
            				dataType="text">
            			</w2:column>
            			<w2:column id="nRealPaymTerm"
            				name="nRealPaymTerm" dataType="text">
            			</w2:column>
            			<w2:column id="sCrStatName" name="sCrStatName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sGdCd" name="sGdCd"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sJobCode" name="sJobCode"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sPaymCyclNm" name="sPaymCyclNm"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sPlanNo" name="sPlanNo"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sAqamtChnlCd" name="sAqamtChnlCd"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sTrnfAsmtDate"
            				name="sTrnfAsmtDate" dataType="text">
            			</w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="DsWs_ListCnt"
            		repeatNode="map"
            		userData2="//*/hashtable/data/CCCBF00COUNT">
            		<w2:columnInfo>
            			<w2:column id="nApplPrem2" name="nApplPrem2"
            				dataType="text">
            			</w2:column>
            			<w2:column id="nApplPrem1" name="nApplPrem1"
            				dataType="text">
            			</w2:column>
            			<w2:column id="nBussPrem2" name="nBussPrem2"
            				dataType="text">
            			</w2:column>
            			<w2:column id="nBussPrem1" name="nBussPrem1"
            				dataType="text">
            			</w2:column>
            			<w2:column id="nTotalCnt" name="nTotalCnt"
            				dataType="text">
            			</w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="warning"
            		repeatNode="map" userData2="//*/WARNING" />
            	<w2:dataList baseNode="list" id="DsWs_Excel"
            		repeatNode="map" userData2="//*/vector/data/CCCBF00" />
            	<w2:dataList baseNode="list" id="DsWs_chekCrInqrAuth"
            		repeatNode="map" userData2="//*/AXR931">
            		<w2:columnInfo>
            			<w2:column id="sInqrAvaYn" name="sInqrAvaYn"
            				dataType="text">
            			</w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="DsWs_AqamtChnlCd"
            		repeatNode="map" />
            	<w2:dataList baseNode="list" id="DsWs_BDUT_List"
            		repeatNode="map" userData2="//*/vector/data/CCCBF03_BDUT" />
            	<w2:dataList baseNode="list" id="warningBdut"
            		repeatNode="map" userData2="//*/WARNING" />
            	<w2:dataList baseNode="list" id="DsWs_Team"
            		repeatNode="map" userData2="//*/ADMAC03">
            		<w2:columnInfo>
            			<w2:column id="sHeadCenterName"
            				name="sHeadCenterName" dataType="text">
            			</w2:column>
            			<w2:column id="sHeadCenterCode"
            				name="sHeadCenterCode" dataType="text">
            			</w2:column>
            			<w2:column id="sTeamCode" name="sTeamCode"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sGroupName" name="sGroupName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sDptOfficeCode"
            				name="sDptOfficeCode" dataType="text">
            			</w2:column>
            			<w2:column id="sPartCode" name="sPartCode"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sTeamName" name="sTeamName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sCenterCode" name="sCenterCode"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sCenterName" name="sCenterName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sAgentName" name="sAgentName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sPartName" name="sPartName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sDptOfficeName"
            				name="sDptOfficeName" dataType="text">
            			</w2:column>
            			<w2:column id="sInputTime" name="sInputTime"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sGroupCode" name="sGroupCode"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sAgentCode" name="sAgentCode"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sInputDate" name="sInputDate"
            				dataType="text">
            			</w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="DsWs_TMAuth"
            		repeatNode="map" userData2="//*/GAG021">
            		<w2:columnInfo>
            			<w2:column id="sAuthFlag" name="sAuthFlag"
            				dataType="text">
            			</w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataList id="WARNING" baseNode="list"
            		saveRemovedData="true" repeatNode="map">
            		<w2:columnInfo>
            			<w2:column id="msg" name="msg"
            				dataType="text">
            			</w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            </w2:dataCollection>
            <w2:workflowCollection/>
        </xf:model>
	    <script src="/cm/js/convertJs/Global_Script.js"/>
	    <script src="/cm/js/convertJs/comm_Webservice.js"/>
	    <script src="/cm/js/convertJs/NewGen_Script.js"/>
	    <script src="/cm/js/convertJs/LongTerm_Script.js"/>
	    <script src="/cm/js/convertJs/Marine_Script.js"/>        
        <script><![CDATA[
/****************************************************************************
 * 프로그램번호   : CBSB017M.xml
 * 프로그램명     : 신계약개별명세.
 * 파일명         : CBSB017M.xml - P020.xml
 * 프로그램 내용  : 신계약개별명세
 * 관련 프로그램  : 
 * 작성자         : 구종식
 * 작성일         : 2017-09-04
 * 저작권         : Copyright ⓒ 2004. the K 손해보험㈜. All Right Reserved.
 * 변경내역       : 
 ****************************************************************************/
var pageSize = 20;
var pageCount = 20;
var sToday = "";
//전역변수
// 날자 변수
var sysDate = "";
var sDate = "";
var sTime = "";
var sChkBdut = false;
var nKeyCnt = 0;
//MaskEdit 정규식 입력
var Edt_sCrNo_Event;

//---------------------------------------------------------------------------
// function 명 : P020_OnLoadCompleted
// 내용        : 화면오픈시 클릭시 처리
//---------------------------------------------------------------------------
scwin.init = function() {
//wprom.alert(gfn_getDepartName("8105005"));	
   	// 서버시간 조회
   	
    sysDate = WebSquare.date.getCurrentServerDate( "yyyyMMdd" );
    
    sDate = wconv.mid(sysDate, 0, 8);
    sDateYYYYMM = wconv.mid(sysDate, 0, 6);
    sTime = wconv.mid(sysDate, 8, 6);
    //addMonth(sDate,-1);
    
    // 화면 ID세팅
    //goo gfn_GetLinkList("P020");
	cmb_linkMenu.hide();//goo

    // 공통 콤보 세팅
    scwin.lfn_commCodeSetting();

    //버튼 처리        (입력, 수정, 삭제, 결제, 취소, 인쇄, 엑셀, 닫기)
    gfn_btnEnable(false, false, false, false, false, false, true, true);
    //Mi와 차이로 초기에 선언함. 
    if (nfn_checkAuthByID("ds_code", util.getGdsValue("gUserID"), "34025") == true) {    
        grd_List.hide();
        Grid0.show();
    } else {
        Grid0.hide();
        grd_List.show();
    }

    //이하는 초기값 설정
    cal_sFromDate.setValue(sDateYYYYMM + "01"); //from 일자
    cal_sToDate.setValue(sDate); //to 일자
    cmd_sInskd.setValue("1"); //보종구분:장기

    //설계자 여부 (48:DP, 49:DPM, 50:재정전문위원)
    //대리점인지 여부(30:대리점,33:사용인,35:TM사용인)
    if (util.getGdsValue("gUserDuty") == "50" //|| util.getGdsValue("gUserID") == "2140026" 
     || util.getGdsValue("gUserDuty") == "62" || util.getGdsValue("gUserDuty") == "65") {
        cmb_sOrgnFlag.setValue(2);
        edt_sOrgnCd.setValue(util.getGdsValue("gUserID"));
        edt_sOrgnCdName.setValue((parent||opener).gds.gUserEmpName);
        cmb_sOrgnFlag.setDisabled(true);
        edt_sOrgnCd.setDisabled(true);
        Button1.setDisabled(true);
    } else if (util.getGdsValue("gUserDuty") == "30" || util.getGdsValue("gUserDuty") == "33" 
            || util.getGdsValue("gUserDuty") == "35") {
        //이하는 사용인 관리자 체크
        scwin.chkBdut();
        if (sChkBdut) {
            cmb_sOrgnFlag.setValue(2);
            edt_sOrgnCd.setValue(util.getGdsValue("gDoer"));
            //this.edt_sOrgnCdName.Text = ;
            scwin.edt_common_OnCharChanged(edt_sOrgnCd, "", edt_sOrgnCd.getValue());
            cmb_sOrgnFlag.setDisabled(true);
            edt_sOrgnCd.setDisabled(true);
            Button1.setDisabled(true);
        } else {
            if (util.getGdsValue("gUserDuty") == "30" || util.getGdsValue("gUserDuty") == "33" || util.getGdsValue("gUserDuty") == "35") {
                //TM 사용인
                cmb_sOrgnFlag.setValue("3"); //조직구분(사용인)
                edt_sOrgnCd.setValue(util.getGdsValue("gUserID")); //코드
                edt_sOrgnCdName.setValue(util.getGdsValue("gUserEmpName")); //명
                cmb_sOrgnFlag.setDisabled(true); //조직구분
                edt_sOrgnCd.setDisabled(true); //코드
                Button1.setDisabled(true); //팝업
                edt_sOrgnCdName.setDisabled(true); //명
            } else {}
        }
    }

	/*orign
    SOBJ_TEAM.WSDL = gds.gWsdlBasis; // 서비스 Obj WSDC 설정
    var MethodObj = gfn_CreateMethodObj(SOBJ_TEAM, "com.inswave.longterm.com.com.task.AXR930Task", "getAgentList", "", "");
    gfn_SetParam(MethodObj, "sAgentCode", gds.gUserID); //조직구조
    gfn_CallService(SOBJ_TEAM, DOBJ_TEAM, MethodObj);
	*/
    wconv.clear(Ds_Team);
    wconv.clear(DsWs_Team);
	var MethodObj = new callService("com.inswave.longterm.com.com.task.AXR930Task", "getAgentList", "", "");
	MethodObj.setId("getAgentList");
	MethodObj.setParam("sAgentCode", util.getGdsValue("gUserID"));
	MethodObj.setUrl("/sales/CBSB017MController.do");
	MethodObj.setXPath("//*/ADMAC03");
	MethodObj.addXPath("//WARNING");
	MethodObj.sync();
	MethodObj.send();
	
    Ds_Team.setJSON(_tranSync.getDsJson("ADMAC03") );
    DsWs_Team.setJSON(_tranSync.getDsJson("ADMAC03"));
    //wconv.copy(Ds_Team, "DsWs_Team");
    
    var sTeamCd = DsWs_Team.getCellData(0, "sTeamCode");
    //======================================================================================================================
	/*orign
    //직영 TM실 실장들 개별 조건
    wconv.clear(Ds_TMAuth);
    SOBJ_AUTH.WSDL = gds.gWsdlBasis; // 서비스 Obj WSDC 설정
    var MethodObj = gfn_CreateMethodObj(SOBJ_AUTH, "com.inswave.longterm.pay.pdg.task.GAG021Task", "selectForAuthCheck", "", "");
    gfn_SetParam(MethodObj, "sUserID", gds.gUserID); //조직구조
    gfn_SetParam(MethodObj, "nAuthType", "1");
    gfn_SetParam(MethodObj, "nAuthID", "200196");
    gfn_CallService(SOBJ_AUTH, DOBJ_AUTH, MethodObj);
    wconv.copy(Ds_TMAuth, "DsWs_TMAuth");
	*/
    //직영 TM실 실장들 개별 조건
    wconv.clear(Ds_TMAuth);
	var MethodObj1 = new callService("com.inswave.longterm.pay.pdg.task.GAG021Task", "selectForAuthCheck");
	MethodObj1.setId("selectForAuthCheck");
	MethodObj1.setParam("sUserID",util.getGdsValue("gUserID")); //조직구조
	MethodObj1.setParam("nAuthType","1");
	MethodObj1.setParam("nAuthID","200196");
	MethodObj1.setUrl("/sales/CBSB017MController.do");
	MethodObj1.setXPath("//*/GAG021");   
	MethodObj1.addXPath("//WARNING");  
	MethodObj1.sync();
	MethodObj1.send();	

	//util.interfaceKey(_tranSync.result.serviceDs);
    Ds_TMAuth.setJSON(_tranSync.getDsJson("GAG021"));
    DsWs_TMAuth.setJSON(_tranSync.getDsJson("GAG021"));

    var sAuthFlag = DsWs_TMAuth.getCellData(0, "sAuthFlag");   
    //======================================================================================================================
    if ((util.getGdsValue("gUserDuty") == "49") && (sAuthFlag == "Y")) {
        cmb_sOrgnFlag.setValue("1");
        edt_sOrgnCd.setValue(sTeamCd);
        cmb_sOrgnFlag.setDisabled(true);
        edt_sOrgnCd.setDisabled(true);
        Button1.setDisabled(true);
    }
	//Mask Edit 정규식 입력
	// "A-####-#######" 청약번호
	var maskRegExp = [ /^[A-Z\s]{1}[0-9\s]{11}$/];
	var maxLength  = [12];
	var chkIndex   = 0;
	Edt_sCrNo_Event = new wMaskEditObj(Edt_sCrNo, maskRegExp, maxLength, chkIndex);
   	Edt_sCrNo_Event.setIndex(0); 
    Edt_sCrNo.setDisplayFormat("#-####-#######");    
};

//TM사용인 관리자체크
scwin.chkBdut = function() {
	/*orign	
    //서비스 Obj WSDC 설정
    SOBJ_BDUT_List.WSDL = gds.gWsdlBasis;
    var MethodObj = gfn_CreateMethodObj(SOBJ_BDUT_List, "com.inswave.sales.sam.task.CtnPremRecvTask", "selectChkBdut", "", "");
    gfn_SetParam(MethodObj, "sUserCd", util.getGdsValue("gUserID"));
    gfn_CallService(SOBJ_BDUT_List, DOBJ_BDUT_List, MethodObj);
	*/
	var MethodObj = new callService("com.inswave.sales.sam.task.CtnPremRecvTask", "selectChkBdut", "", "");     
	MethodObj.setId("selectChkBdut");
	MethodObj.setParam("sUserCd", util.getGdsValue("gUserID"));
	MethodObj.setUrl("/sales/CBSB017MController.do");
	MethodObj.setXPath("//*/vector/data/CCCBF03_BDUT");
	MethodObj.addXPath("//WARNING");
	MethodObj.sync();
	MethodObj.send();
	
	//util.interfaceKey(_tranSync.result.serviceDs);
    DsWs_BDUT_List.setJSON(_tranSync.result.serviceDs.data[0].CCCBF03_BDUT);
	
    //if (warningBdut.getRowCount() != 0) {
    if (WARNING.getRowCount() != 0) {
        wprom.alert(WARNING.getCellData(0, "msg"));
        return;
    }
    if (DsWs_BDUT_List.getRowCount() > 0) {
        sChkBdut = true;
    }
};

//---------------------------------------------------------------------------
// function 명 : lfn_commCodeSetting
// 내용        : 공통코드 조회
//---------------------------------------------------------------------------
scwin.lfn_commCodeSetting = function() {
    var dataSets = "DsWs_sCrStatCd DsWs_AqamtChnlCd";
    var columns = "CrStatCd AqamtChnlCd";
    var objects = "cmb_sCrStatCd ";
    var titleTypes = "A N"; //A:전체, S:선택, N:안넣기
    gfn_getCommonCodes(dataSets, columns, objects, titleTypes);
};

//---------------------------------------------------------------------------
// function 명 : lfn_Search
// 내용        : 조회버튼 클릭시
//---------------------------------------------------------------------------
//비동기 호출 
scwin.lfn_Search_sync = function() { //완료
	util.eventAsyncCall(this, scwin.lfn_Search, arguments);	
};

scwin.lfn_Search = function(e) {
    //이하조회
    //리포팅테스트 window.open("http://10.1.1.131:7080/clip/callReportView.jsp");
    scwin.lfn_SearchData(1);
    /*goo
    if (DsWs_List.getRowCount() > 0) {
        gfn_MakePagingData(Ds_Page, DsWs_ListCnt.getCellData(0, "nTotalCnt"), pageSize, pageCount);
        Cmb_Page.setValue("1");
	 	//expr:decode(sInskdFlagCd,'1','blue','default') ;
	 	for(var i=0; i<DsWs_List.getRowCount();i++){
			if(DsWs_List.getCellData(i,"sInskdFlagCd") == "1"){
				grd_List.setColumnColor( 4 , "blue" );
			}
		}        
    }
    */
};
scwin.lfn_makePage = function(){
    if (DsWs_List.getRowCount() > 0) {
        gfn_MakePagingData(Ds_Page, DsWs_ListCnt.getCellData(0, "nTotalCnt"), pageSize, pageCount);
        Cmb_Page.setValue("1");
	 	//expr:decode(sInskdFlagCd,'1','blue','default') ;
	 	for(var i=0; i<DsWs_List.getRowCount();i++){
			if(DsWs_List.getCellData(i,"sInskdFlagCd") == "1"){
				grd_List.setColumnColor( 4 , "blue" );
			}
		}        
    }
};
//---------------------------------------------------------------------------
// function 명 : lfn_Search
// 내용        : 조회버튼 클릭 Event처리
//---------------------------------------------------------------------------
scwin.lfn_SearchData = function(PageNo) {
    //체크
    if (!scwin.lfn_inputChk()){
        return;
	}
    //초기화
    wconv.clear(warning);
    wconv.clear(DsWs_List);
    wconv.clear(DsWs_ListCnt);    
    /*if(nfn_checkAuthByID(SOBJ_List, DOBJ_List, "ds_code", gUserID , "34025") == true){
    	alert("34025");
    	this.grid0.Redraw = false;
    }else{
    	this.grd_List.Redraw = false;
    }
    */
	/*orign  
    //서비스 bj WSDC 설정
    SOBJ_List.WSDL = gds.gWsdlBasis;
    var MethodObj = gfn_CreateMethodObj(SOBJ_List, "com.inswave.sales.sam.task.NwcrListTask", "selectNwcrListList", pageSize, pageNo);
    gfn_SetParam(MethodObj, "sFromDate", wconv.trim(cal_sFromDate.getValue())); //조회기간 년월일 시작
    gfn_SetParam(MethodObj, "sToDate", wconv.trim(cal_sToDate.getValue())); //조회기간 년월일 종료
    gfn_SetParam(MethodObj, "str", wconv.trim(medt_Str.getValue())); //상품
    gfn_SetParam(MethodObj, "sStatCd", wconv.trim(cmb_sCrStatCd.getValue())); //상태
    gfn_SetParam(MethodObj, "sOrgnFlag", wconv.trim(cmb_sOrgnFlag.getValue())); //조직,사용자 구분
    gfn_SetParam(MethodObj, "sOrgnFlagValue", wconv.trim(edt_sOrgnCd.getValue())); //구분 코드
    gfn_SetParam(MethodObj, "sScanObjtYn", wconv.trim(cmd_sScanObjtYn.getValue())); //대면/비대면
    gfn_SetParam(MethodObj, "sInskd", wconv.trim(cmd_sInskd.getValue())); //보종구분	
    gfn_SetParam(MethodObj, "sCrNo", wconv.trim(Edt_sCrNo.getValue())); //계약번호
    gfn_CallService(SOBJ_List, DOBJ_List, MethodObj);
	*/
	var MethodObj = new callService("com.inswave.sales.sam.task.NwcrListTask", "selectNwcrListList", pageSize, PageNo); 
	MethodObj.setId("selectNwcrListList");
    MethodObj.setParam("sFromDate", wconv.trim(cal_sFromDate.getValue())); //조회기간 년월일 시작
    MethodObj.setParam("sToDate", wconv.trim(cal_sToDate.getValue())); //조회기간 년월일 종료
    MethodObj.setParam("str", wconv.trim(medt_Str.getValue())); //상품
    MethodObj.setParam("sStatCd", wconv.trim(cmb_sCrStatCd.getValue())); //상태
    MethodObj.setParam("sOrgnFlag", wconv.trim(cmb_sOrgnFlag.getValue())); //조직,사용자 구분
    MethodObj.setParam("sOrgnFlagValue", wconv.trim(edt_sOrgnCd.getValue())); //구분 코드
    MethodObj.setParam("sScanObjtYn", wconv.trim(cmd_sScanObjtYn.getValue())); //대면/비대면
    MethodObj.setParam("sInskd", wconv.trim(cmd_sInskd.getValue())); //보종구분	
    MethodObj.setParam("sCrNo", wconv.trim(Edt_sCrNo.getValue())); //계약번호
	MethodObj.setUrl("/sales/CBSB017MController.do");
	MethodObj.setXPath("//*/vector/data/CCCBF00");
	MethodObj.addXPath("//*/hashtable/data/CCCBF00COUNT");	
	MethodObj.addXPath("//WARNING");
	MethodObj.callBack("scwin.fn_callback");
	//MethodObj.sync();
	MethodObj.send();

    
};
scwin.fn_callback = function(e)
{

	DsWs_List.setJSON(_tranSync.getDsJson("CCCBF00"));
	DsWs_ListCnt.setJSON(_tranSync.getDsJson("CCCBF00COUNT"));
    DsWs_ListCnt.setRowPosition(0);//

    //trace(replace(gfn_XmlEncoder(DOBJ_List.Value), "><", ">\n<"));
    //trace("DsWs_List    : " + this.DsWs_List.SaveXML());
    //trace("DsWs_ListCnt : " + this.DsWs_ListCnt.SaveXML());
    	
    if (WARNING.getRowCount() != 0) {
        wprom.alert(WARNING.getCellData(0, "msg"));
        return;
    }
    if (DsWs_List.getRowCount() != 0) {
        //이하는 mask 처리
        for (var i = 0; i < DsWs_List.getRowCount(); i++) {
            DsWs_List.setCellData(i, "sCrtorName", gfn_changeMask(DsWs_List.getCellData(i, "sCrtorName"), "4")); //계약자
            DsWs_List.setCellData(i, "sInrpsName", gfn_changeMask(DsWs_List.getCellData(i, "sInrpsName"), "4")); //피보험자
        }
    } else if (DsWs_List.getRowCount() == 0) {
        wprom.alert("조회결과가 없습니다.");
        return;
    }

    if (nfn_checkAuthByID("ds_code", util.getGdsValue("gUserID"), "34025") == true) {
        //this.grid0.Redraw = true;
        grd_List.hide();
        Grid0.show();
    } else {
        //this.grd_List.Redraw = true;
        Grid0.hide();
        grd_List.show();
    }	
    scwin.lfn_makePage();
}
//---------------------------------------------------------------------------
// function 명 : lfn_inputChk
// 내용        : 입력값체크(조회시)
// js.goo 수정
//---------------------------------------------------------------------------
scwin.lfn_inputChk = function(obj) {

    if (cal_sFromDate.getValue() == "") {
        wprom.alert("조회기간 시작일이 입력되지 않았습니다.");
        cal_sFromDate.focus();
        return false;
    }
    if (cal_sToDate.getValue() == "") {
        wprom.alert("조회기간 종료일이 입력되지 않았습니다.");
        cal_sToDate.focus();
        return false;
    }
    if ($w.dateDiff(cal_sFromDate.getValue(), cal_sToDate.getValue()) < 0) {
        wprom.alert("조회기간 종료일이 시작일 이전 날짜입니다.");
        cal_sToDate.focus();
        return;
    }
    if ($w.dateDiff(cal_sFromDate.getValue(), cal_sToDate.getValue()) > 31) {
        wprom.alert("조회기간을 한달 이내로 지정하셔야 합니다");
        return;
    }
    return true;
};

//---------------------------------------------------------------------------
// function 명 : lfn_Exel
// 내용        : EXCEL 다운로드
//---------------------------------------------------------------------------
//scwin.lfn_Exel = function(obj) {
scwin.cm_btnExDown = function() {
    //체크
    if (!scwin.lfn_inputChk())
        return;
    var sResult=true;

    //sResult = FileDialog0.Open();

    if (sResult) {
        //초기화
        wconv.clear(WARNING);
        wconv.clear(DsWs_List);
        var npageSize = DsWs_ListCnt.getCellData(0, "nTotalCnt");
        //wconv.trace(npageSize);
		/*orig
        //서비스 bj WSDC 설정
        SOBJ_List.WSDL = gds.gWsdlBasis;
        var MethodObj = gfn_CreateMethodObj(SOBJ_List, "com.inswave.sales.sam.task.NwcrListTask", "selectNwcrListList", npageSize, "");
        gfn_SetParam(MethodObj, "sFromDate", wconv.trim(cal_sFromDate.getValue())); //조회기간 년월일 시작
        gfn_SetParam(MethodObj, "sToDate", wconv.trim(cal_sToDate.getValue())); //조회기간 년월일 종료
        gfn_SetParam(MethodObj, "str", wconv.trim(medt_Str.getValue())); //상품
        gfn_SetParam(MethodObj, "sStatCd", wconv.trim(cmb_sCrStatCd.getValue())); //상태
        gfn_SetParam(MethodObj, "sOrgnFlag", wconv.trim(cmb_sOrgnFlag.getValue())); //조직,사용자 구분
        gfn_SetParam(MethodObj, "sOrgnFlagValue", wconv.trim(edt_sOrgnCd.getValue())); //구분 코드
        gfn_SetParam(MethodObj, "sScanObjtYn", wconv.trim(cmd_sScanObjtYn.getValue())); //대면/비대면
        gfn_SetParam(MethodObj, "sInskd", wconv.trim(cmd_sInskd.getValue())); //보종구분	
        gfn_SetParam(MethodObj, "sCrNo", wconv.trim(Edt_sCrNo.getValue())); //계약번호
        gfn_CallService(SOBJ_List, DOBJ_List, MethodObj);
		*/
		//서비스 bj WSDC 설정
        var MethodObj = new callService("com.inswave.sales.sam.task.NwcrListTask", "selectNwcrListList", npageSize, "");
        MethodObj.setId("selectNwcrListList");
        MethodObj.setParam("sFromDate", wconv.trim(cal_sFromDate.getValue())); //조회기간 년월일 시작
        MethodObj.setParam("sToDate", wconv.trim(cal_sToDate.getValue())); //조회기간 년월일 종료
        MethodObj.setParam("str", wconv.trim(medt_Str.getValue())); //상품
        MethodObj.setParam("sStatCd", wconv.trim(cmb_sCrStatCd.getValue())); //상태
        MethodObj.setParam("sOrgnFlag", wconv.trim(cmb_sOrgnFlag.getValue())); //조직,사용자 구분
        MethodObj.setParam("sOrgnFlagValue", wconv.trim(edt_sOrgnCd.getValue())); //구분 코드
        MethodObj.setParam("sScanObjtYn", wconv.trim(cmd_sScanObjtYn.getValue())); //대면/비대면
        MethodObj.setParam("sInskd", wconv.trim(cmd_sInskd.getValue())); //보종구분	
        MethodObj.setParam("sCrNo", wconv.trim(Edt_sCrNo.getValue())); //계약번호
		MethodObj.setUrl("/sales/CBSB017MController.do");
		MethodObj.setXPath("//*/vector/data/CCCBF00");
		MethodObj.addXPath("//*/hashtable/data/CCCBF00COUNT");
		MethodObj.addXPath("//WARNING");
		MethodObj.sync();
		MethodObj.send();
        
		//util.interfaceKey(_tranSync.result.serviceDs);
	    DsWs_List.setJSON (_tranSync.getDsJson("CCCBF00"));  
	    DsWs_ListCnt.setJSON(_tranSync.getDsJson("CCCBF00COUNT"));
		
        //trace(replace(gfn_XmlEncoder(DOBJ_List.Value), "><", ">\n<"));
        //trace("DsWs_List    : " + this.DsWs_List.SaveXML());
        //trace("DsWs_ListCnt : " + this.DsWs_ListCnt.SaveXML());
        if (WARNING.getRowCount() != 0) {
            wprom.alert(WARNING.getCellData(0, "msg"));
            return;
        }
        if (DsWs_List.getRowCount() != 0) {
              //이하는 mask 처리
            for (var i = 0; i < DsWs_List.getRowCount(); i++) {
                DsWs_List.setCellData(i, "sCrtorName", gfn_changeMask(DsWs_List.getCellData(i, "sCrtorName"), "4")); //계약자
                DsWs_List.setCellData(i, "sInrpsName", gfn_changeMask(DsWs_List.getCellData(i, "sInrpsName"), "4")); //피보험자
            }
        } else if (DsWs_List.getRowCount() == 0) {
            wprom.alert("조회결과가 없습니다.");
            return;
        }
		var option={};
		option.fileName= "신계약명세.xlsx";
		var infoArr = {};
        if (nfn_checkAuthByID("ds_code", util.getGdsValue("gUserID"), "34025") == true) {
			common.downLoadExcel("Grid0",option,infoArr);	
        } else {
			common.downLoadExcel("grd_List",option,infoArr);	
        }
    }
};

//---------------------------------------------------------------------------
// function 명 : medt_Str_OnKeyDown()
// 내용        : keyDown시 처리
//---------------------------------------------------------------------------
scwin.medt_Str_OnKeyDown = function(e){//obj, nChar, bShift, bCtrl, bAlt, LLParam, HLParam) {
	
    //13자리이면 조회처리
    if (e.keyCode == 13) {
        scwin.lfn_Search();
    }
};
scwin.Medt_Str_OnKeyUp = function(e){
	if(e.keyCode > 95 && e.keyCode < 106 && e.keyCode != null){
		nKeyCnt++;
	}

	if(nKeyCnt == 4){// || wconv.length(medt_Str.getValue())==4 ){
		scwin.btn_Goods_OnClick();
		nKeyCnt = 0;
	} 	
}
//---------------------------------------------------------------------------
// function 명 : btn_Goods_OnClick()
// 내용        : 상품버튼 클릭시처리
// 수정
//---------------------------------------------------------------------------
scwin.btn_Goods_OnClick = function(e) {
    var promise = Promise.resolve();
    //상품군 팝업
    //prd_att::A610_Pop.xml
    //parentInfo=상품코드^기준일자(from)^기준일자(to)
    //var sArg = "parentInfo=";
    //sArg += medt_Str.getValue();
    //sArg += "^" + cal_sFromDate.getValue();
    //sArg += "^" + cal_sToDate.getValue();
               
    promise = promise.then(function(result) {
	    var sArg = {"sGoods":medt_Str.getValue()
	               ,"sFromDate":cal_sFromDate.getValue()
	               ,"sToDate":cal_sToDate.getValue()
	               };
		var popInfo = {
				"width"     : 832,
				"height"    : 465,
				"indata"    : sArg,
				"callback"  : "",
				"title"     : "상품리스트조회"
			};
			return wprom.popupOpen("/ui/cbsc/CBSC065P.xml", popInfo);
    });
/*
    var sArg = {};
		var popInfo = {
				"width"     : 1255,
				"height"    : 850,
				"top"       : 100,
				"left"      : 100,
				"indata"    : sArg,
				"callback"  : "",
				"title"     : "상품리스트조회"
			};
			return $w.openPopup("/ui/cbsc/CBSC084P.xml", popInfo );
    });
*/
    promise = promise.then(function(result) {
        var resultArr = result.split("^");
        if (resultArr.length > 0) {
            medt_Str.setValue(resultArr[0]);
            medt_StrNm.setValue(resultArr[1]);
        } else {
            medt_Str.setValue("");
            medt_StrNm.setValue("");
        }
    });
    
};

scwin.medt_Str_OnCharChanged = function(){
    if (wconv.length(medt_Str.getValue()) == 4) {
         scwin.btn_Goods_OnClick();
    } else {
        medt_StrNm.setValue("");
    }
};

//**************************************************************************************************
// 페이징 처리 - 이전 페이지 리스트
//**************************************************************************************************
scwin.Btn_PreV_OnClick = function(obj) {
    var ftVal = wconv.toNumber(Ds_Page.getCellData(Ds_Page.getRowPosition(), "FILTERCD")) - 1;
    if (wconv.toNumber(maxFilterVal) < wconv.toNumber(ftVal)) {
        wprom.alert("조회의 처음입니다.");
        return;
    } else if (wconv.toNumber(ftVal) < 1) {
        wprom.alert("조회의 처음입니다.");
        return;
    }
    wconv.filter(Ds_Page, "FILTERCD=='" + ftVal + "'",true);
    Cmb_Page.setValue(Ds_Page.getCellData(0, "CODE"));
    scwin.lfn_SearchData(Cmb_Page.getValue());
};

//**************************************************************************************************
// 페이징 처리 - 이전 페이지
//**************************************************************************************************
scwin.Btn_Pre_OnClick = function(obj) {
    var Idx = Cmb_Page.getValue();
    if (wconv.toNumber(Idx) - 1 < 1) {
        wprom.alert("조회의 처음입니다.");
        return;
    }
    scwin.lfn_SearchData(wconv.toString(wconv.toNumber(Idx) - 1));
    if (Ds_Page.getCellData(0, "CODE") == Idx) {
        wconv.filter(Ds_Page, "FILTERCD=='" + wconv.toString(wconv.toNumber(Ds_Page.getCellData(0, "FILTERCD")) - 1) + "'",true);
        Cmb_Page.setValue(Ds_Page.getCellData((Ds_Page.getRowCount() -1), "CODE"));
    } else
        Cmb_Page.setValue(wconv.toNumber(Idx) - 1);
};

//**************************************************************************************************
// 페이징 처리 - 다음 페이지
//**************************************************************************************************
scwin.Btn_Next_OnClick = function(obj) {
    var Idx = Cmb_Page.getValue();
    if (wconv.toNumber(maxPage) < wconv.toNumber(Idx) + 1) {
        wprom.alert("더이상 자료가 존재하지 않습니다");
        return;
    }
    scwin.lfn_SearchData(wconv.toString(wconv.toNumber(Idx) + 1));
    if (Ds_Page.getCellData((Ds_Page.getRowCount() - 1), "CODE") == Idx) {
        wconv.filter(Ds_Page, "FILTERCD=='" + wconv.toString(wconv.toNumber(Ds_Page.getCellData((Ds_Page.getRowCount() - 1), "FILTERCD")) + 1) + "'",true);
    }
    Cmb_Page.setValue(wconv.toNumber(Idx) + 1);
};

//**************************************************************************************************
// 페이징 처리 - 다음 페이지 리스트
//**************************************************************************************************
scwin.Btn_NextV_OnClick = function(obj) {
    var ftVal = wconv.toNumber(Ds_Page.getCellData(Ds_Page.getRowPosition(), "FILTERCD")) + 1;
    if (wconv.toNumber(maxFilterVal) < wconv.toNumber(ftVal)) {
        wprom.alert("더이상 자료가 존재하지 않습니다");
        return;
    }
    wconv.filter(Ds_Page, "FILTERCD=='" + ftVal + "'",true);
    Cmb_Page.setValue(Ds_Page.getCellData(0, "CODE"));
    scwin.lfn_SearchData(Cmb_Page.getValue());
};

//**************************************************************************************************
// 페이지 처리
//**************************************************************************************************
scwin.Cmb_Page_OnChanged = function(info){
    scwin.lfn_SearchData(info.newValue);
};
//---------------------------------------------------------------------------
// function 명 : cmd_orgnFlag_OnChanged
// 내용        : 조직구분변경시
//---------------------------------------------------------------------------
scwin.cmd_orgnFlag_OnChanged = function(obj, strCode, strText, nOldIndex, nNewIndex) {
    edt_sOrgnCd.setValue("");
    edt_sOrgnCdName.setValue("");
};

//---------------------------------------------------------------------------
// function 명 : common_OnKeyDown
// 내용        : 조회 Key값에 return입력 할경우
// 전환 
//---------------------------------------------------------------------------
scwin.common_OnKeyDown = function(e){//obj, nChar, bShift, bCtrl, bAlt, LLParam, HLParam) {
    if (e.keyCode == 13)
        scwin.lfn_Search(1);
};

//---------------------------------------------------------------------------
// function 명 : edt_common_OnCharChanged
// 내용        : edt box 변경시 명칭 초기화
//---------------------------------------------------------------------------
scwin.edt_common_OnCharChanged = function(info){//obj, strPreText, strPostText) {
	//console.log(info);
    //조직구분에 대한 변경
//    if (obj.ID == "edt_sOrgnCd") {
        if (wconv.length(info.newValue) < 7) {
            edt_sOrgnCdName.setValue("");
        } else if (wconv.length(info.newValue) == 7) {
             //조직명/사원명 조회
              if (!scwin.lfn_SearchEmpName(edt_sOrgnCd, edt_sOrgnCdName)) {
                return false;
            }
        }
//    }
//
//
//
//
    //상품에 대한 변경 
//    if (obj.ID == "edt_sGdCd") {
//        if (wconv.length(strPostText) < 4) {
//            edt_sGdCdName.Text = "";
//        } else if (wconv.length(strPostText) == 4) {
//            if (!lfn_SearchPrd()) {
//                return false;
//            }
//        }
//    }
};

//---------------------------------------------------------------------------
// function 명 : lfn_SearchEmpName
// 내용        : 조직 구분에 대한 조직, 사원 변경
//---------------------------------------------------------------------------
scwin.lfn_SearchEmpName = function(edt_sEmpObj, targetEdtObj) {
    if (wconv.length(edt_sEmpObj.getValue()) != 7) {
        targetEdtObj.setValue("");
        return false;
    }


    // 조직명 조회
    if (cmb_sOrgnFlag.getSelectedIndex() == 0) {
        // 조직명 조회			
        gfn_getDepartName(edt_sOrgnCd.getValue());
        if (gDsWs_getTeam.getRowCount() == 0) {
            return false;
        } else {
            targetEdtObj.setValue(gDsWs_getTeam.getCellData(0, "sDepartName"));
        }
    } else {
        //사원명 조회
        gfn_getEmpName(edt_sOrgnCd.getValue());
        if (gDsWs_SelectEmpName.getRowCount() == 0) {
            return false;
        } else {
            targetEdtObj.setValue(gDsWs_SelectEmpName.getCellData(0, "sEmpName"));
        }
    }
    return true;
};

//---------------------------------------------------------------------------
// function 명 : btn_sDoerPop_OnClick
// 내용        : 조직구분 관련 팝업
//---------------------------------------------------------------------------
scwin.btn_sDoerPop_OnClick = function(e) {
    var promise = Promise.resolve();
      //조직코드
    if (cmb_sOrgnFlag.getSelectedIndex() == 0) {
        promise = promise.then(function(result) {
            //조직팝업
		    var sArg = {};
			var popInfo = {
					"width"     : 735,                  //폭    : 생략시 기본값
					"height"    : 492,                  //높이   : 생략시 기본값  
					"indata"    : sArg,
					"callback"  : "",
					"title"     : "조직찾기"
				};
			return wprom.popupOpen("/ui/cbso/CBSO020P.xml", popInfo);//조직찾기 0120.xml
        });
        
        promise = promise.then(function(result) {
            if (wconv.length(result) != 0) {
                var arrRst = result.split("^");
                edt_sOrgnCd.setValue(arrRst[0]);
                edt_sOrgnCdName.setValue(arrRst[1]);
            }
        });
    } else {
        //사용자팝업
        //조직코드 이외(취급자, 사용인)
        promise = promise.then(function(result) {
	        var sArg = {};
			var popInfo = {
					"width"     : 657,
					"height"    : 437,
					//"top"       : 100,
					//"left"      : 100,
					"indata"    : sArg,
					"callback"  : "",
					"title"     : "사원찾기"
				};
			return wprom.popupOpen("/ui/cbso/CBSO015P.xml", popInfo);//사원찾기 R960_Pop.xml        
        });
        
        promise = promise.then(function(result) {
            if (wconv.length(result) != 0) {
                var arrRst = result.split("^");
                edt_sOrgnCd.setValue(arrRst[0]);
                edt_sOrgnCdName.setValue(arrRst[1]);
            }
        });
    }

};

//---------------------------------------------------------------------------
// function 명 : lfn_CopyGridLTIAX05Cell
// 내용        : Grid Copy
//---------------------------------------------------------------------------
scwin.grd_List_OnKeyDown = function(obj, nChar, bShift, bCtrl, bAlt, nLLParam, nHLParam) {
    //goo nfn_CopyGridCell(obj, nChar, bShift, bCtrl, bAlt, nLLParam, nHLParam);
};

//---------------------------------------------------------------------------
// function 명 : grd_List_OnHeadClick
// 내용        : 그리드 헤더 체크
// property로 가능함.
//---------------------------------------------------------------------------
//scwin.grd_List_OnHeadClick = function(obj, nCell, nX, nY, nPivotIndex) {
//    if (object(obj_BindDataSet).GetRowCount() > 0)
//        gfn_Sort(obj, nCell, nX, nY, nPivotIndex);
//};

//---------------------------------------------------------------------------
// function 명 : grd_List_OnCellClick
// 내용        : 그리드 클릭 이벤트
//---------------------------------------------------------------------------
scwin.grd_List_OnCellClick = function(row,col){//obj, nRow, nCell, nX, nY, nPivotIndex) {
    //일반일경우는 링크 없음
    if (DsWs_List.getCellData(row, "sInskdFlagCd") == "2")
        return;


    //계약번호
    //if (col == 4) {
    if(grd_List.getColumnID(col) =="sCrNo"){
        var sCrNo = grd_List.getCellData(row, "sCrNo");    

        //대리점인지 여부(30:대리점,33:사용인,35:TM사용인)
        //설계사(48:DP)
        if (util.getGdsValue("gUserDuty") == "30" || util.getGdsValue("gUserDuty") == "33" 
         || util.getGdsValue("gUserDuty") == "35" || util.getGdsValue("gUserDuty") == "48" 
         || util.getGdsValue("gUserDuty") == "50" || util.getGdsValue("gUserDuty") == "62" 
         || util.getGdsValue("gUserDuty") == "65") {
            if (gfn_chekCrInqrAuth("DsWs_chekCrInqrAuth", "2", sCrNo) == false) {
                wprom.alert("조회권한이 없습니다.");
                return false;
            }
        }
//        if (parent.Id == "global") {
//             html에 쌓인 상태
            //UserNotify(3, sCrNo);
//        } else {
//            var arg = "sCrNo=" + wconv.quote(sCrNo);
              //trace("arg ==>  " + sCrNo);
//            gds.gDs_LinkArg.removeAll();
//            var insRow = util.insertRow(gds.gDs_LinkArg, 0);
//            /*수작업 변환 개발자 가이드(테스트 중) 
//             dataList에 row를 추가하고 setCellData를 하는 경우 첫 번째 인자를 insRow로 변경해주세요.*/
//            util.insertColumn(gds.gDs_LinkArg, [["sCrNo","sCrNo","text"]]);
//            util.insertColumn(gds.gDs_LinkArg, [["sScrnId","sScrnId", "text"]]);
            //gds.gDs_LinkArg.setCellData(0, "sCrNo", sCrNo);
            //gds.gDs_LinkArg.setCellData(0, "sScrnId", "D010");
            
	        var oDsJson=[{"sCrNo"  :sCrNo ,"sScrnId":"D010"} ];            
	        window.top.util.jSonDsCreate(oDsJson, "gDs_LinkArg");            
            gfn_OpenLinkPage("CBSC028M");//계약사항 상세내역 
//        }
    }
};

scwin.Edt_sCrNo_OnKeyDown = function(e){//obj, nChar, bShift, bCtrl, bAlt, nLLParam, nHLParam) {
    if (e.keyCode == 13){
        scwin.lfn_Search(1);
    }    
};

//사용안함.
scwin.Button3_OnClick = function(obj) {
    var promise = Promise.resolve();
    promise = promise.then(function(rtnVal) {
        return dialog("cmn/T200.xml", "", 820, 612);
        /*★수작업 변환 개발자 주의 사항(가이드 테스트 중)★ 
            (가이드 예시)promise chain을 걸면 팝업이 닫긴 후에 아래의 소스가 실행됩니다.
            */
    });
    return promise;
};

//---------------------------------------------------------------------------
// function 명 : lfn_cal_sFromDate_OnChanged
// 내용        : 시작일자 변경시
//---------------------------------------------------------------------------
scwin.lfn_cal_sFromDate_OnChanged = function(info){//obj, strOldText, strNewText) {
    if (cal_sFromDate.getValue() == "" || cal_sToDate.getValue() == "")
        return false;
    if (wconv.isDate(info.newValue) == false) {
        wprom.alert("날짜형식이 잘못 되었습니다.");
        cal_sFromDate.setValue(info.oldValue);
        return;
    }
};

//---------------------------------------------------------------------------
// function 명 : lfn_cal_sToDate_OnChanged
// 내용        : 종료일자 변경시
//---------------------------------------------------------------------------
scwin.lfn_cal_sToDate_OnChanged = function(info){//obj, strOldText, strNewText) {
    if (cal_sFromDate.getValue() == "" || cal_sToDate.getValue() == "")
        return false;
    if (wconv.isDate(info.newValue) == false) {
        wprom.alert("날짜형식이 잘못 되었습니다.");
        cal_sToDate.setValue(info.oldValue);
        return;
    }
};

	]]></script>
    </head>
    <body>
    	<xf:group class="cont_wrap" id="form"
    		style="position:absolute;  height:612px;left:0px;top:33px; width:100%;"
    		userData1="신계약명세"
    		userData2=" OnLoadCompleted:scwin.lfn_OnLoadCompleted; ">
    		<DataObjects>
    			<DataObject />
    			<DataObject />
    			<DataObject />
    			<DataObject />
    			<DataObject />
    			<DataObject />
    			<DataObject />
    			<DataObject />
    			<DataObject />
    		</DataObjects>
    		<ServiceObjects>
    			<ServiceObject />
    			<ServiceObject />
    			<ServiceObject />
    			<ServiceObject />
    			<ServiceObject />
    			<ServiceObject />
    			<ServiceObject />
    		</ServiceObjects>
    		<xf:group arcsize="6" class="search_area" id="Shape9"
    			style="height:60px;top:0px;left:0px;" userData3="RoundRect">
    			<w2:anchor class="btn_search" disabled=""
    				id="btn_search" outerDiv="false" style="top:25px;" tabIndex="7"
    				ev:onclick="scwin.lfn_Search">
    				<xf:label><![CDATA[조회]]></xf:label>
    			</w2:anchor>
    		</xf:group>
    		<w2:textbox class="sty_lb_Search" id="Static0" label="조회기간"
    			style="position:absolute; VAlign:Middle; height:20px;left:8px;top:8px; width:68px;"
    			tagname="" />
    		<w2:textbox class="sty_lb_Search" id="Static3" label="상품"
    			style="position:absolute; VAlign:Middle;  text-align:right; height:20px;left:497px;top:10px; width:30px;"
    			tagname="" />
    		<xf:select1 appearance="minimal" class="sty_ipt_form"
    			emptyItem="true" id="cmb_linkMenu"
    			style="position:absolute; border-style:solid;  height:20px;left:930px;top:649px; width:153px;"
    			tabIndex="8">
    			<xf:choices />
    		</xf:select1>
    		<PopupDiv />
    		<xf:input class="sty_ipt_search" dataType="number"
    			displayFormat="" ev:onblur=""
    			ev:oneditkeyup="scwin.medt_Str_OnCharChanged" id="medt_Str"
    			style="position:absolute; border-style:solid;  height:20px;left:554px;top:9px; width:35px;"
    			tabIndex="" ev:onkeydown="scwin.medt_Str_OnKeyDown"
    			ev:onchange="" ev:onviewchange="scwin.medt_Str_OnCharChanged"
    			maxlength="4" ev:onkeyup="scwin.Medt_Str_OnKeyUp"
    			placeholder="____" />
    		<xf:trigger class="detail_search"
    			ev:onclick="scwin.btn_Goods_OnClick" id="btn_Goods"
    			style="position:absolute; Transparent:TRUE;  ImageID:btn_Search_Search;  height:20px;left:591px;top:9px; width:20px;"
    			tabIndex="12" type="anchor" />
    		<w2:textbox class="sty_footer_label" id="Static1"
    			label="총건수"
    			style="position:absolute; VAlign:Middle; height:20px;left:13px;top:650px; width:50px;"
    			tagname="" />
    		<xf:input class="sty_ipt_form" dataType="number"
    			disabled="true" displayFormat="" id="medt_nAccuPrem"
    			ref="data:DsWs_ListCnt.nTotalCnt"
    			style="position:absolute; text-align:right;  border-style:solid;  height:20px;left:72px;top:649px; width:58px;"
    			tabIndex="15" />
    		<xf:select1 appearance="minimal" class="sty_ipt_search"
    			emptyItem="true" id="cmb_sCrStatCd"
    			style="position:absolute; ImeMode:none;  INDEX:0;  border-style:solid;  height:20px;left:821px;top:7px; width:91px;"
    			tabIndex="18" renderType="native">
    			<xf:choices>
    				<xf:label ref="sHnglCdName" />
    				<xf:value ref="sCd" />
    			</xf:choices>
    		</xf:select1>
    		<w2:textbox class="sty_lb_Search" id="Static4" label="상태"
    			style="position:absolute; VAlign:Middle;  text-align:right; height:20px;left:763px;top:9px; width:40px;"
    			tagname="" />
    		<xf:switch id="switch_207" style=" ">
    			<xf:case id="Default_207" style=" ">
    				<w2:gridView class="sty_Grid" dataList="DsWs_List"
    					ev:onblur="scwin.grd_List_OnKeyDown"
    					ev:oncellclick="scwin.grd_List_OnCellClick"
    					ev:onheaderclick="scwin.grd_List_OnHeadClick" focusMode="row"
    					id="grd_List" inputType="text" readOnly="true"
    					sortEvent="onclick" sortable="true"
    					style="position:absolute; UseDBuff:true;  InputPanel:FALSE;  EndLineColor:default;  border:Flat;  AutoFitEndLine:Hide;height:522px;left:0px;top:103px;width:100.0%;"
    					tabIndex="16">
    					<w2:header>
    						<w2:row>
    							<w2:column dataType="text"
    								id="head_id_1833" inputType="text" readOnly="true"
    								style="height:20px;" userData1="0" userData3="0" value="No"
    								width="26" />
    							<w2:column dataType="text"
    								id="head_id_1834" inputType="text" readOnly="true"
    								style="height:20px;" userData1="1" userData3="0" value="상태"
    								width="40" />
    							<w2:column dataType="text"
    								id="head_id_1835" inputType="text" readOnly="true"
    								style="height:20px;" userData1="2" userData3="0"
    								value="처리일자" width="80" />
    							<w2:column dataType="text"
    								id="head_id_1836" inputType="text" readOnly="true"
    								style="height:20px;" userData1="3" userData3="0"
    								value="보험시기" width="80" />
    							<w2:column dataType="text"
    								id="head_id_1837" inputType="text" readOnly="true"
    								style="height:20px;" userData1="4" userData3="0"
    								value="계약번호" width="120" />
    							<w2:column dataType="text"
    								id="head_id_1838" inputType="text" readOnly="true"
    								style="height:20px;" userData1="5" userData3="0"
    								value="청약번호" width="120" />
    							<w2:column dataType="text"
    								id="head_id_1839" inputType="text" readOnly="true"
    								style="height:20px;" userData1="6" userData3="0" value="상품명"
    								width="200" />
    							<w2:column dataType="text"
    								id="head_id_1840" inputType="text" readOnly="true"
    								style="height:20px;" userData1="7" userData3="0" value="플랜명"
    								width="100" />
    							<w2:column dataType="text"
    								id="head_id_1841" inputType="text" readOnly="true"
    								style="height:20px;" userData1="8" userData3="0"
    								value="가입유형" width="62" />
    							<w2:column dataType="text"
    								id="head_id_1842" inputType="text" readOnly="true"
    								style="height:20px;" userData1="9" userData3="0" value="종형"
    								width="100" />
    							<w2:column dataType="text"
    								id="head_id_1843" inputType="text" readOnly="true"
    								style="height:20px;" userData1="10" userData3="0"
    								value="계약자명" width="70" />
    							<w2:column dataType="text"
    								id="head_id_1844" inputType="text" readOnly="true"
    								style="height:20px;" userData1="11" userData3="0"
    								value="계약자코드" width="100" />
    							<w2:column dataType="text"
    								id="head_id_1845" inputType="text" readOnly="true"
    								style="height:20px;" userData1="12" userData3="0"
    								value="피보험자명" width="64" />
    							<w2:column dataType="text"
    								id="head_id_1846" inputType="text" readOnly="true"
    								style="height:20px;" userData1="13" userData3="0"
    								value="피보험자코드" width="100" />
    							<w2:column dataType="text"
    								id="head_id_1847" inputType="text" readOnly="true"
    								style="height:20px;" userData1="14" userData3="0"
    								value="최초영업보험료" width="90" />
    							<w2:column dataType="text"
    								id="head_id_1848" inputType="text" readOnly="true"
    								style="height:20px;" userData1="15" userData3="0"
    								value="최초적용보험료" width="90" />
    							<w2:column dataType="text"
    								id="head_id_1849" inputType="text" readOnly="true"
    								style="height:20px;" userData1="16" userData3="0"
    								value="최종영업보험료" width="90" />
    							<w2:column dataType="text"
    								id="head_id_1850" inputType="text" readOnly="true"
    								style="height:20px;" userData1="17" userData3="0"
    								value="최종적용보험료" width="90" />
    							<w2:column dataType="text"
    								id="head_id_1851" inputType="text" readOnly="true"
    								style="height:20px;" userData1="18" userData3="0"
    								value="입금방법" width="90" />
    							<w2:column dataType="text"
    								id="head_id_1852" inputType="text" readOnly="true"
    								style="height:20px;" userData1="19" userData3="0"
    								value="이체일" width="58" />
    							<w2:column dataType="text"
    								id="head_id_1853" inputType="text" readOnly="true"
    								style="height:20px;" userData1="20" userData3="0"
    								value="보험기간" width="58" />
    							<w2:column dataType="text"
    								id="head_id_1854" inputType="text" readOnly="true"
    								style="height:20px;" userData1="21" userData3="0"
    								value="납입기간" width="58" />
    							<w2:column dataType="text"
    								id="head_id_1855" inputType="text" readOnly="true"
    								style="height:20px;" userData1="22" userData3="0"
    								value="납입주기" width="58" />
    							<w2:column dataType="text"
    								id="head_id_1856" inputType="text" readOnly="true"
    								style="height:20px;" userData1="23" userData3="0"
    								value="취급자명" width="75" />
    							<w2:column dataType="text"
    								id="head_id_1857" inputType="text" readOnly="true"
    								style="height:20px;" userData1="24" userData3="0"
    								value="사용인명" width="71" />
    							<w2:column dataType="text"
    								id="head_id_1858" inputType="text" readOnly="true"
    								style="height:20px;" userData1="25" userData3="0"
    								value="사용인코드" width="75" />
    							<w2:column dataType="text"
    								id="head_id_1859" inputType="text" readOnly="true"
    								style="height:20px;" userData1="26" userData3="0"
    								value="팀/센터명" width="130" />
    							<w2:column dataType="text"
    								id="head_id_1860" inputType="text" readOnly="true"
    								style="height:20px;" userData1="27" userData3="0"
    								value="심사구분" width="60" />
    							<w2:column dataType="text"
    								id="head_id_1861" inputType="text" readOnly="true"
    								style="height:20px;" userData1="28" userData3="0" value="채널"
    								width="60" />
    							<w2:column dataType="text"
    								id="head_id_1862" inputType="text" readOnly="true"
    								style="height:20px;" userData1="29" userData3="0"
    								value="개인정보취득경로" width="100" />
    						</w2:row>
    					</w2:header>
    					<w2:gBody>
    						<w2:row>
    							<w2:column dataType="text" id="nCnt"
    								inputType="text" readOnly="true" style="height:20px;"
    								textAlign="right" userData1="0" userData3="0" width="26" />
    							<w2:column dataType="text"
    								id="sCrStatName" inputType="text" readOnly="true"
    								textAlign="center" userData1="1" userData3="0" width="40" style="height:20px;"/>
    							<w2:column dataType="text"
    								displayFormat="####-##-##" id="sChngStndDate"
    								inputType="text" readOnly="true" userData1="2" userData3="0"
    								width="80" style="height:20px;"/>
    							<w2:column dataType="text"
    								displayFormat="####-##-##" id="sInsurStrtdate"
    								inputType="text" readOnly="true" userData1="3" userData3="0"
    								width="80" style="height:20px;"/>
    							<w2:column dataType="text"
    								displayFormat="#-####-#######" id="sCrNo" inputType="text"
    								readOnly="true" userData1="4"
    								userData2=" expr:decode(sInskdFlagCd,'1','blue','default') ;"
    								userData3="0" width="120" textAlign="center" style="cursor: pointer;font-weight: bold;height:20px;" class="bold underline"/>
    							<w2:column dataType="text"
    								displayFormat="#-####-#######" id="sPlanNo" inputType="text"
    								readOnly="true" userData1="5" userData3="0" width="120"
    								textAlign="center" style="height:20px;" value=""/>
    							<w2:column dataType="text" id="sGdName"
    								inputType="text" readOnly="true" userData1="6" userData3="0"
    								width="200" textAlign="left" style="height:20px;"/>
    							<w2:column dataType="text"
    								id="sApplPlanName" inputType="text" readOnly="true"
    								userData1="7" userData3="0" width="100" textAlign="left" style="height:20px;"/>
    							<w2:column dataType="text"
    								id="sInsTypeNm" inputType="text" readOnly="true"
    								textAlign="center" userData1="8" userData3="0" width="62" style="height:20px;"/>
    							<w2:column dataType="text"
    								id="sGnrzName" inputType="text" readOnly="true"
    								textAlign="left" userData1="9" userData3="0" width="100" style="height:20px;"/>
    							<w2:column dataType="text"
    								id="sCrtorName" inputType="text" readOnly="true"
    								userData1="10" userData3="0" width="70" textAlign="center" style="height:20px;"/>
    							<w2:column dataType="text" id="sCrtorCd"
    								inputType="text" readOnly="true" userData1="11"
    								userData3="0" width="100" style="height:20px;"/>
    							<w2:column dataType="text"
    								id="sInrpsName" inputType="text" readOnly="true"
    								userData1="12" userData3="0" width="64" textAlign="center" style="height:20px;"/>
    							<w2:column dataType="text" id="sInrpsCd"
    								inputType="text" readOnly="true" userData1="13"
    								userData3="0" width="100" style="height:20px;"/>
    							<w2:column dataType="text"
    								id="nBussPrem1" inputType="text" readOnly="true"
    								textAlign="right" userData1="14" userData3="0" width="90"
    								displayFormat="#,###" style="height:20px;"/>
    							<w2:column dataType="text"
    								id="nApplPrem1" inputType="text" readOnly="true"
    								textAlign="right" userData1="15" userData3="0" width="90"
    								displayFormat="#,###" style="height:20px;"/>
    							<w2:column dataType="text"
    								id="nBussPrem2" inputType="text" readOnly="true"
    								textAlign="right" userData1="16" userData3="0" width="90"
    								displayFormat="#,###" style="height:20px;"/>
    							<w2:column dataType="text"
    								id="nApplPrem2" inputType="text" readOnly="true"
    								textAlign="right" userData1="17" userData3="0" width="90"
    								displayFormat="#,###" style="height:20px;"/>
    							<w2:column dataType="text"
    								id="sCmMetdNm" inputType="text" readOnly="true"
    								textAlign="center" userData1="18" userData3="0" width="90" style="height:20px;"/>
    							<w2:column dataType="text"
    								id="sTrnfAsmtDate" inputType="text" readOnly="true"
    								textAlign="center" userData1="19" userData3="0" width="58" style="height:20px;"/>
    							<w2:column dataType="text"
    								id="nRealInsurTerm" inputType="text" readOnly="true"
    								textAlign="right" userData1="20" userData3="0" width="58" style="height:20px;"/>
    							<w2:column dataType="text"
    								id="nRealPaymTerm" inputType="text" readOnly="true"
    								textAlign="right" userData1="21" userData3="0" width="58" style="height:20px;"/>
    							<w2:column dataType="text"
    								id="sPaymCyclNm" inputType="text" readOnly="true"
    								textAlign="center" userData1="22" userData3="0" width="58" style="height:20px;"/>
    							<w2:column dataType="text"
    								id="sFrstDoerName" inputType="text" readOnly="true"
    								textAlign="center" userData1="23" userData3="0" width="75" style="height:20px;"/>
    							<w2:column dataType="text"
    								id="sFrstDoerUserNm" inputType="text" readOnly="true"
    								userData1="24" userData3="0" width="71" style="height:20px;" textAlign="center"/>
    							<w2:column dataType="text"
    								id="sFrstDoerUser" inputType="text" readOnly="true"
    								textAlign="center" userData1="25" userData3="0" width="75" style="height:20px;"/>
    							<w2:column dataType="text"
    								id="sTeamCenterNm" inputType="text" readOnly="true"
    								textAlign="left" userData1="26" userData3="0" width="130" style="height:20px;"/>
    							<w2:column dataType="text" id="sJugmNm"
    								inputType="text" readOnly="true" textAlign="center"
    								userData1="27" userData3="0" width="60" style="height:20px;"/>
    							<w2:column dataType="text"
    								id="sScanObjtYn" inputType="text" readOnly="true"
    								textAlign="center" userData1="28" userData3="0" width="60" style="height:20px;"/>
    							<w2:column dataType="text"
    								id="sAqamtChnlCd" inputType="select" readOnly="true"
    								textAlign="center" userData1="29" userData3="0"
    								width="100" style="height:20px;">
    								<w2:choices>
    									<w2:itemset
    										nodeset="data:DsWs_AqamtChnlCd">
    										<w2:value ref="sCd" />
    										<w2:label ref="sHnglCdName" />
    									</w2:itemset>
    								</w2:choices>
    							</w2:column>
    						</w2:row>
    					</w2:gBody>
    				</w2:gridView>
    				<w2:gridView autoFit="" autoFitMinWidth="100"
    					tabIndex="43" sortEvent="onclick" sortable="true"
    					class="sty_Grid" ev:onblur="scwin.grd_List_OnKeyDown"
    					dataList="DsWs_List" id="Grid0" focusMode="row"
    					ev:onheaderclick="scwin.grd_List_OnHeadClick" readOnly="true"
    					style="position:absolute; UseDBuff:true;  InputPanel:FALSE;  EndLineColor:default;  border:Flat;  AutoFitEndLine:Hide;height:522px;left:0px;top:103px;width:-1.8576848E8%;"
    					inputType="text" ev:oncellclick="scwin.grd_List_OnCellClick">
    					<w2:header>
    						<w2:row>
    							<w2:column id="head_id_1864"
    								userData1="0" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="26" inputType="text"
    								value="No">
    							</w2:column>
    							<w2:column id="head_id_1865"
    								userData1="1" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="40" inputType="text"
    								value="상태">
    							</w2:column>
    							<w2:column id="head_id_1866"
    								userData1="2" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="80" inputType="text"
    								value="처리일자">
    							</w2:column>
    							<w2:column id="head_id_1867"
    								userData1="3" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="80" inputType="text"
    								value="보험시기">
    							</w2:column>
    							<w2:column id="head_id_1868"
    								userData1="4" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="120" inputType="text"
    								value="계약번호">
    							</w2:column>
    							<w2:column id="head_id_1869"
    								userData1="5" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="120" inputType="text"
    								value="청약번호">
    							</w2:column>
    							<w2:column id="head_id_1870"
    								userData1="6" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="200" inputType="text"
    								value="상품명">
    							</w2:column>
    							<w2:column id="head_id_1871"
    								userData1="7" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="100" inputType="text"
    								value="플랜명">
    							</w2:column>
    							<w2:column id="head_id_1872"
    								userData1="8" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="62" inputType="text"
    								value="가입유형">
    							</w2:column>
    							<w2:column id="head_id_1873"
    								userData1="9" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="100" inputType="text"
    								value="종형">
    							</w2:column>
    							<w2:column id="head_id_1874"
    								userData1="10" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="70" inputType="text"
    								value="계약자명">
    							</w2:column>
    							<w2:column id="head_id_1875"
    								userData1="11" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="100" inputType="text"
    								value="계약자코드">
    							</w2:column>
    							<w2:column id="head_id_1876"
    								userData1="12" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="64" inputType="text"
    								value="피보험자명">
    							</w2:column>
    							<w2:column id="head_id_1877"
    								userData1="13" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="100" inputType="text"
    								value="피보험자코드">
    							</w2:column>
    							<w2:column id="head_id_1878"
    								userData1="14" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="90" inputType="text"
    								value="최초영업보험료">
    							</w2:column>
    							<w2:column id="head_id_1879"
    								userData1="15" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="90" inputType="text"
    								value="최초적용보험료">
    							</w2:column>
    							<w2:column id="head_id_1880"
    								userData1="16" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="90" inputType="text"
    								value="최종영업보험료">
    							</w2:column>
    							<w2:column id="head_id_1881"
    								userData1="17" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="90" inputType="text"
    								value="최종적용보험료">
    							</w2:column>
    							<w2:column id="head_id_1882"
    								userData1="18" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="90" inputType="text"
    								value="입금방법">
    							</w2:column>
    							<w2:column id="head_id_1883"
    								userData1="19" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="58" inputType="text"
    								value="이체일">
    							</w2:column>
    							<w2:column id="head_id_1884"
    								userData1="20" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="58" inputType="text"
    								value="보험기간">
    							</w2:column>
    							<w2:column id="head_id_1885"
    								userData1="21" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="58" inputType="text"
    								value="납입기간">
    							</w2:column>
    							<w2:column id="head_id_1886"
    								userData1="22" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="58" inputType="text"
    								value="납입주기">
    							</w2:column>
    							<w2:column id="head_id_1887"
    								userData1="23" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="75" inputType="text"
    								value="취급자명">
    							</w2:column>
    							<w2:column id="head_id_1888"
    								userData1="24" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="71" inputType="text"
    								value="사용인명">
    							</w2:column>
    							<w2:column id="head_id_1889"
    								userData1="25" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="75" inputType="text"
    								value="사용인코드">
    							</w2:column>
    							<w2:column id="head_id_1890"
    								userData1="26" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="130" inputType="text"
    								value="팀/센터명">
    							</w2:column>
    							<w2:column id="head_id_1891"
    								userData1="27" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="60" inputType="text"
    								value="심사구분">
    							</w2:column>
    							<w2:column id="head_id_1892"
    								userData1="28" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="60" inputType="text"
    								value="채널">
    							</w2:column>
    							<w2:column id="head_id_1893"
    								userData1="29" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="100" inputType="text"
    								value="개인정보취득경로">
    							</w2:column>
    							<w2:column id="head_id_1894"
    								userData1="30" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="100" inputType="text"
    								value="직업코드">
    							</w2:column>
    							<w2:column id="head_id_1895"
    								userData1="31" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="200" inputType="text"
    								value="주소">
    							</w2:column>
    							<w2:column id="head_id_1896"
    								userData1="32" dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="100" inputType="text"
    								value="휴대폰 번호">
    							</w2:column>
    						</w2:row>
    					</w2:header>
    					<w2:gBody>
    						<w2:row>
    							<w2:column id="nCnt" userData1="0"
    								dataType="text" userData3="0" readOnly="true"
    								style="height:20px;" width="26" inputType="text"
    								textAlign="right">
    							</w2:column>
    							<w2:column id="sCrStatName"
    								userData1="1" dataType="text" userData3="0" readOnly="true"
    								width="40" inputType="text" textAlign="center" style="height:20px;">
    							</w2:column>
    							<w2:column id="sChngStndDate"
    								userData1="2" dataType="text" userData3="0" readOnly="true"
    								width="80" inputType="text" displayFormat="####-##-##" style="height:20px;">
    							</w2:column>
    							<w2:column id="sInsurStrtdate"
    								userData1="3" dataType="text" userData3="0" readOnly="true"
    								width="80" inputType="text" displayFormat="####-##-##" style="height:20px;">
    							</w2:column>
    							<w2:column
    								userData2=" expr:decode(sInskdFlagCd,'1','blue','default') ;"
    								id="sCrNo" userData1="4" dataType="text" userData3="0"
    								readOnly="true" width="120" inputType="text"
    								displayFormat="#-####-#######" textAlign="center" style="cursor: pointer;font-weight: bold;height:20px;" class="bold underline" value="">
    							</w2:column>
    							<w2:column id="sPlanNo" userData1="5"
    								dataType="text" userData3="0" readOnly="true" width="120"
    								inputType="text" displayFormat="#-####-#######"
    								textAlign="center" style="height:20px;">
    							</w2:column>
    							<w2:column id="sGdName" userData1="6"
    								dataType="text" userData3="0" readOnly="true" width="200"
    								inputType="text" textAlign="left" style="height:20px;">
    							</w2:column>
    							<w2:column id="sApplPlanName"
    								dataType="text" readOnly="true" width="100" inputType="text"
    								textAlign="center" style="height:20px;">
    							</w2:column>
    							<w2:column id="sInsTypeNm" userData1="8"
    								dataType="text" userData3="0" readOnly="true" width="62"
    								inputType="text" textAlign="center" style="height:20px;">
    							</w2:column>
    							<w2:column id="sGnrzName" userData1="9"
    								dataType="text" userData3="0" readOnly="true" width="100"
    								inputType="text" textAlign="left" style="height:20px;">
    							</w2:column>
    							<w2:column id="sCrtorName"
    								userData1="10" dataType="text" userData3="0" readOnly="true"
    								width="70" inputType="text" textAlign="center" style="height:20px;">
    							</w2:column>
    							<w2:column id="sCrtorCd" userData1="11"
    								dataType="text" userData3="0" readOnly="true" width="100"
    								inputType="text" style="height:20px;" textAlign="center">
    							</w2:column>
    							<w2:column id="sInrpsName"
    								userData1="12" dataType="text" userData3="0" readOnly="true"
    								width="64" inputType="text" textAlign="center" style="height:20px;">
    							</w2:column>
    							<w2:column id="sInrpsCd" userData1="13"
    								dataType="text" userData3="0" readOnly="true" width="100"
    								inputType="text" style="height:20px;">
    							</w2:column>
    							<w2:column id="nBussPrem1"
    								userData1="14" dataType="text" userData3="0" readOnly="true"
    								width="90" inputType="text" textAlign="right"
    								displayFormat="#,###" style="height:20px;">
    							</w2:column>
    							<w2:column id="nApplPrem1"
    								userData1="15" dataType="text" userData3="0" readOnly="true"
    								width="90" inputType="text" textAlign="right"
    								displayFormat="#,###" style="height:20px;">
    							</w2:column>
    							<w2:column id="nBussPrem2"
    								userData1="16" dataType="text" userData3="0" readOnly="true"
    								width="90" inputType="text" textAlign="right"
    								displayFormat="#,###" style="height:20px;">
    							</w2:column>
    							<w2:column id="nApplPrem2"
    								userData1="17" dataType="text" userData3="0" readOnly="true"
    								width="90" inputType="text" textAlign="right"
    								displayFormat="#,###" style="height:20px;">
    							</w2:column>
    							<w2:column id="sCmMetdNm" userData1="18"
    								dataType="text" userData3="0" readOnly="true" width="90"
    								inputType="text" textAlign="center" style="height:20px;">
    							</w2:column>
    							<w2:column id="sTrnfAsmtDate"
    								userData1="19" dataType="text" userData3="0" readOnly="true"
    								width="58" inputType="text" textAlign="center" style="height:20px;">
    							</w2:column>
    							<w2:column id="nRealInsurTerm"
    								userData1="20" dataType="text" userData3="0" readOnly="true"
    								width="58" inputType="text" textAlign="right" style="height:20px;">
    							</w2:column>
    							<w2:column id="nRealPaymTerm"
    								userData1="21" dataType="text" userData3="0" readOnly="true"
    								width="58" inputType="text" textAlign="right" style="height:20px;">
    							</w2:column>
    							<w2:column id="sPaymCyclNm"
    								userData1="22" dataType="text" userData3="0" readOnly="true"
    								width="58" inputType="text" textAlign="center" style="height:20px;">
    							</w2:column>
    							<w2:column id="sFrstDoerName"
    								userData1="23" dataType="text" userData3="0" readOnly="true"
    								width="75" inputType="text" textAlign="center" style="height:20px;">
    							</w2:column>
    							<w2:column id="sFrstDoerUserNm"
    								userData1="24" dataType="text" userData3="0" readOnly="true"
    								width="71" inputType="text" style="height:20px;" textAlign="center">
    							</w2:column>
    							<w2:column id="sFrstDoerUser"
    								userData1="25" dataType="text" userData3="0" readOnly="true"
    								width="75" inputType="text" textAlign="center" style="height:20px;">
    							</w2:column>
    							<w2:column id="sTeamCenterNm"
    								userData1="26" dataType="text" userData3="0" readOnly="true"
    								width="130" inputType="text" textAlign="left" style="height:20px;">
    							</w2:column>
    							<w2:column id="sJugmNm" userData1="27"
    								dataType="text" userData3="0" readOnly="true" width="60"
    								inputType="text" textAlign="center" style="height:20px;">
    							</w2:column>
    							<w2:column id="sScanObjtYn"
    								userData1="28" dataType="text" userData3="0" readOnly="true"
    								width="60" inputType="text" textAlign="center" style="height:20px;">
    							</w2:column>
    							<w2:column id="sAqamtChnlCd"
    								userData1="29" dataType="text" userData3="0" readOnly="true"
    								width="100" inputType="select" textAlign="center" style="height:20px;">
    								<w2:choices>
    									<w2:itemset
    										nodeset="data:DsWs_AqamtChnlCd">
    										<w2:value ref="sCd"></w2:value>
    										<w2:label
    											ref="sHnglCdName">
    										</w2:label>
    									</w2:itemset>
    								</w2:choices>
    							</w2:column>
    							<w2:column id="sJobCode" userData1="30"
    								dataType="text" userData3="0" readOnly="true" width="100"
    								inputType="text" textAlign="center" style="height:20px;">
    							</w2:column>
    							<w2:column id="sAdrs" userData1="31"
    								dataType="text" userData3="0" readOnly="true" width="200"
    								inputType="text" textAlign="left" style="height:20px;">
    							</w2:column>
    							<w2:column id="sCellPhone"
    								userData1="32" dataType="text" userData3="0" readOnly="true"
    								width="100" inputType="text" textAlign="center" style="height:20px;">
    							</w2:column>
    						</w2:row>
    					</w2:gBody>
    				</w2:gridView>
    			</xf:case>
    		</xf:switch>
    		<w2:textbox class="sty_lb_Search" id="Static6" label="조직구분"
    			style="position:absolute; VAlign:Middle; height:20px;left:8px;top:34px; width:68px;"
    			tagname="" />
    		<w2:textbox class="sty_lb_Search" id="Static7" label="보종"
    			style="position:absolute; VAlign:Middle;  text-align:right; height:20px;left:763px;top:34px; width:40px;"
    			tagname="" />
    		<xf:select1 appearance="minimal" class="sty_ipt_search"
    			emptyItem="true" ev:onchange="scwin.cmd_orgnFlag_OnChanged"
    			id="cmb_sOrgnFlag"
    			style="position:absolute; ImeMode:none;  INDEX:0;  border-style:solid;  height:20px;left:78px;top:34px; width:91px;"
    			tabIndex="21" allOption="" chooseOption="" renderType="native">
    			<xf:choices>
    				<xf:itemset nodeset="data:Ds_orgnFlag">
    					<xf:label ref="orgnFlagValue" />
    					<xf:value ref="orgnFlagCd" />
    				</xf:itemset>
    			</xf:choices>
    		</xf:select1>
    		<xf:input class="sty_ipt_search" ev:onblur=""
    			ev:oneditkeyup="scwin.edt_common_OnCharChanged" id="edt_sOrgnCd"
    			maxlength="7"
    			style="position:absolute; UseIME:FALSE;  text-transform:uppercase;  ImeMode:native;  border-style:solid;  height:20px;left:173px;top:34px; width:72px;"
    			tabIndex="22" ev:onkeydown="scwin.common_OnKeyDown"
    			ev:onviewchange="scwin.edt_common_OnCharChanged" />
    		<xf:trigger class="detail_search"
    			ev:onclick="scwin.btn_sDoerPop_OnClick" id="Button1"
    			style="position:absolute; Transparent:TRUE;  ImageID:btn_Search_Search;  height:20px;left:245px;top:34px; width:20px;"
    			tabIndex="23" type="anchor" />
    		<xf:input class="sty_ipt_search" disabled="true"
    			id="edt_sOrgnCdName"
    			style="position:absolute; border-style:solid;  height:20px;left:272px;top:34px; width:116px;"
    			tabIndex="24" />
    		<xf:select1 appearance="minimal" class="sty_ipt_search"
    			emptyItem="true" id="cmd_sInskd"
    			style="position:absolute; ImeMode:none;  INDEX:0;  border-style:solid;  height:20px;left:821px;top:34px; width:91px;"
    			tabIndex="25" allOption="" chooseOption="" renderType="native">
    			<xf:choices>
    				<xf:itemset nodeset="data:Ds_lnsFlag">
    					<xf:label ref="lnsFlagValue" />
    					<xf:value ref="lnsFlagCd" />
    				</xf:itemset>
    			</xf:choices>
    		</xf:select1>
    		<w2:wframe id="div1" scope="false"
    			src="/cm/common/Main_btn_GridControl.xml"
    			style="position:absolute; height:20px;right:60px;top:69px; width:219px;" />
    		<w2:textbox class="sty_lb_Search" id="Static8" label="채널"
    			style="position:absolute; VAlign:Middle;  text-align:right; height:12px;left:497px;top:34px; width:30px;"
    			tagname="" />
    		<xf:select1 appearance="minimal" class="sty_ipt_search"
    			emptyItem="true" id="cmd_sScanObjtYn"
    			style="position:absolute; ImeMode:none;  INDEX:0;  border-style:solid;  height:20px;left:553px;top:34px; width:81px;"
    			tabIndex="28" renderType="native">
    			<xf:choices>
    				<xf:itemset nodeset="data:Ds_combo">
    					<xf:label ref="sNm" />
    					<xf:value ref="sCd" />
    				</xf:itemset>
    			</xf:choices>
    		</xf:select1>
    		<xf:input class="sty_ipt_search" disabled="true"
    			id="medt_StrNm"
    			style="position:absolute; border-style:solid;  height:20px;left:619px;top:9px; width:140px;"
    			tabIndex="29" />
    		<w2:textbox class="sty_footer_label" id="Static10"
    			label="최종영업/적용보험료합계"
    			style="position:absolute; height:20px;left:536px;top:650px; width:150px;"
    			tagname="" />
    		<w2:textbox class="sty_footer_label" id="Static2"
    			label="최초영업/적용보험료합계"
    			style="position:absolute; VAlign:Middle; height:20px;left:151px;top:650px; width:150px;"
    			tagname="" />
    		<xf:input class="sty_ipt_form" dataType="number"
    			disabled="true" displayFormat="#,###" id="MaskEdit0"
    			ref="data:DsWs_ListCnt.nBussPrem1"
    			style="position:absolute; text-align:right;  border-style:solid;  height:20px;left:309px;top:649px; width:95px;"
    			tabIndex="32" />
    		<xf:input class="sty_ipt_form" dataType="number"
    			disabled="true" displayFormat="#,###" id="MaskEdit3"
    			ref="data:DsWs_ListCnt.nApplPrem1"
    			style="position:absolute; text-align:right;  border-style:solid;  height:20px;left:421px;top:649px; width:95px;"
    			tabIndex="33" />
    		<w2:textbox class="sty_lb_Search" id="Static9" label="/"
    			style="position:absolute; VAlign:Middle; text-align:center;height:20px;left:400px;top:651px;width:-15px;"
    			tagname="" />
    		<xf:input class="sty_ipt_form" dataType="number"
    			disabled="true" displayFormat="#,###" id="MaskEdit1"
    			ref="data:DsWs_ListCnt.nApplPrem2"
    			style="position:absolute; text-align:right;  border-style:solid;  height:20px;left:804px;top:649px; width:95px;"
    			tabIndex="36" />
    		<w2:textbox class="sty_lb_Search" id="Static12" label="/"
    			style="position:absolute; VAlign:Middle; text-align:center; height:20px;left:784px;top:651px;"
    			tagname="" />
    		<xf:input class="sty_ipt_form" dataType="number"
    			disabled="true" displayFormat="#,###" id="MaskEdit2"
    			ref="data:DsWs_ListCnt.nBussPrem2"
    			style="position:absolute; text-align:right;  border-style:solid;  height:20px;left:692px;top:649px; width:95px;"
    			tabIndex="35" />
    		<WebBrowser id="WebBrowser0"
    			style="position:absolute; display:none;  height:22px; left:104px; top:8px; width:33px;"
    			tabIndex="38" />
    		<xf:input class="sty_ipt_search" dataType="text"
    			displayFormat="#-####-#######" ev:onblur="" id="Edt_sCrNo"
    			style="position:absolute; InputPanel:FALSE;  border-style:solid;  height:20px;left:392px;top:8px; width:92px;"
    			tabIndex="" ev:onkeydown="scwin.Edt_sCrNo_onkeydown"
    			placeholder="_-____-_______" allowChar="" />
    		<w2:textbox id="Static45" label="~"
    			style="position:absolute; VAlign:Middle;  text-align:center; height:20px;left:179px;top:9px; width:20px;"
    			tagname="" />
    		<w2:textbox class="sty_lb_Search" id="Static11" label="계약번호"
    			style="position:absolute; VAlign:Middle;  text-align:right; height:20px;left:326px;top:9px; width:50px;"
    			tagname="" />
    		<w2:inputCalendar class="sty_ipt_search" ev:onchange=""
    			id="cal_sToDate"
    			style="position:absolute; SundayTextColor:red;  SaturdayTextColor:blue;  border-style:solid;  height:20px;left:203px;top:9px; width:105px;"
    			tabIndex="" validCheck="true"
    			ev:onviewchange="scwin.lfn_cal_sToDate_OnChanged" />
    		<w2:inputCalendar class="sty_ipt_search" ev:onchange=""
    			id="cal_sFromDate"
    			style="position:absolute; SundayTextColor:red;  SaturdayTextColor:blue;  border-style:solid;  height:20px;left:80px;top:9px; width:105px;"
    			tabIndex="1" validCheck="true"
    			ev:onviewchange="scwin.lfn_cal_sFromDate_OnChanged"
    			dateValidCheck="true" />
    		<xf:switch id="switch_208" style=" ">
    			<xf:case id="Default_208" style=" "></xf:case>
    		</xf:switch>

    	</xf:group>
    	<xf:group class="footer_area_form" id="" style="top:674px;left:0px;"></xf:group>
    	<w2:wframe class="common_bu_area" id=""
    		src="/cm/common/wf_titleFav.xml" style=""
    		initScript="scwin.wfTitleFavInit();">
    	</w2:wframe>
    	<w2:anchor outerDiv="false"
    		style="position: abwidth: 100px;height: 23px;" id="">
    		<xf:label><![CDATA[Insert Text]]></xf:label>
    	</w2:anchor>
    </body>
</html>
