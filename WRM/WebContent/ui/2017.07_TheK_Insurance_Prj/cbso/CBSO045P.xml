<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="/cm/css/all.css" type="text/css"?>
<?xml-stylesheet href="/cm/css/convert.css" type="text/css"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head>
        <w2:type>DEFAULT</w2:type>
        <w2:buildDate/>
        <xf:model>
            <xf:instance>
                <data/>
            </xf:instance>
            <w2:dataCollection>
            	<w2:dataList baseNode="list" id="DS_chk"
            		repeatNode="map">
            		<w2:columnInfo>
            			<w2:column dataType="text" id="code"
            				name="code" />
            			<w2:column dataType="text" id="code_nm"
            				name="code_nm" />
            		</w2:columnInfo>
            		<w2:data use="true">
            			<w2:row>
            				<code><![CDATA[9]]></code>
            				<code_nm><![CDATA[-선택-]]></code_nm>
            			</w2:row>
            			<w2:row>
            				<code />
            				<code_nm><![CDATA[예]]></code_nm>
            			</w2:row>
            			<w2:row>
            				<code><![CDATA[1]]></code>
            				<code_nm><![CDATA[아니오]]></code_nm>
            			</w2:row>
            		</w2:data>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="DS_con"
            		repeatNode="map" />
            	<w2:dataList baseNode="list" id="Ds_UserInfo"
            		repeatNode="map">
            		<w2:columnInfo>
            			<w2:column dataType="text" id="sCustNo"
            				name="sCustNo" />
            			<w2:column dataType="text" id="nSeqNo"
            				name="nSeqNo" />
            			<w2:column dataType="text" id="sCustType"
            				name="sCustType" />
            			<w2:column dataType="text" id="sName"
            				name="sName" />
            			<w2:column dataType="text" id="sMarry"
            				name="sMarry" />
            			<w2:column dataType="text" id="sMutualYn"
            				name="sMutualYn" />
            			<w2:column dataType="text" id="sTeachYn"
            				name="sTeachYn" />
            			<w2:column dataType="text" id="sJobMemo"
            				name="sJobMemo" />
            			<w2:column dataType="text" id="sClass"
            				name="sClass" />
            			<w2:column dataType="text" id="sJobGroup"
            				name="sJobGroup" />
            			<w2:column dataType="text" id="sJobCode"
            				name="sJobCode" />
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="ds_Wanning"
            		repeatNode="map" />
            	<w2:dataList baseNode="list" id="ds_accept"
            		repeatNode="map">
            		<w2:columnInfo>
            			<w2:column dataType="text" id="code"
            				name="code" />
            			<w2:column dataType="text" id="name"
            				name="name" />
            		</w2:columnInfo>
            		<w2:data use="true">
            			<w2:row>
            				<code />
            				<name><![CDATA[예]]></name>
            			</w2:row>
            			<w2:row>
            				<code><![CDATA[1]]></code>
            				<name><![CDATA[아니오]]></name>
            			</w2:row>
            		</w2:data>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="DsWs_CUSAA04"
            		repeatNode="map" userData2="//*/hashtable/data/CUSAA04" />
            	<w2:dataList baseNode="list" id="DsWs_Search"
            		repeatNode="map" userData2="//*/CUSAA27" />
            	<w2:dataList baseNode="list" id="DsWs_Warning"
            		repeatNode="map" userData2="//*/WARNING" />
            	<w2:dataList baseNode="list" id="DsWs_Insert"
            		repeatNode="map" />
            	<w2:dataList baseNode="list" id="DsWs_CUSAA41"
            		repeatNode="map" userData2="//*/hashtable/data/CUSAA41" />
            	<w2:dataList baseNode="list" repeatNode="map"
            		id="WARNING" saveRemovedData="true">
            		<w2:columnInfo>
            			<w2:column id="msg" name="name1"
            				dataType="text">
            			</w2:column>
            			<w2:column id="level" name="name2"
            				dataType="text">
            			</w2:column>
            			<w2:column id="detail" name="name3"
            				dataType="text">
            			</w2:column>
            			<w2:column id="timestamp" name="name4"
            				dataType="text">
            			</w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            </w2:dataCollection>
            <w2:workflowCollection/>
        </xf:model>
 <script src="/cm/js/common.js"/>
 <script src="/cm/js/val_lib.js"/>
 <script src="/cm/js/util.js"/>
 <script src="/cm/js/transSub.js"/>
 <script src="/cm/js/callService.js"/>
 <script src="/cm/js/gds.js"/>
 <script src="/cm/js/wconv.js"/>
 <script src="/cm/js/convertJs/Global_Script.js"/>
 <script src="/cm/js/convertJs/comm_Webservice.js"/>
 <script src="/cm/js/convertJs/LongTerm_Script.js"/>        <script><![CDATA[
/****************************************************************************
 * 프로그램번호   : A097_Pop
 * 프로그램명     : 상품소개를 위한 개인(신용)정보처리 동의
 * 파일명         : A097_Pop.xml
 * 프로그램 내용  : 마케팅 동의 .
 * 관련 프로그램  : 
 * 작성자         : 구종식
 * 작성일         : 2010-09-09
 * 저작권         : Copyright ⓒ 2004. the K 손해보험㈜. All Right Reserved.
 * 변경내역       : 
 ****************************************************************************/
// 변수 
var argss;
var nSeqNo = 0;
var sRejectYN;
var sCrYn = 0;
var flag = 0;
var sSaveClickYn = "";
var sSearchClickYn = "";
var sGdFlag = "";
var sysDate = "";//서버 시간
var sStrtDate = "";//서버 날짜
var sStrtTime = "";//서버 시분초.
var sEndDate = "";//서버 날짜
var sEndTime = "";//서버 시분초.
var sSaveYN = "";//저장여부
var fv_args; 
var sHandlerID = "";	//취급자사번
//---------------------------------------------------------------------------
// function 명 : lfn_OnLoadCompleted
// 내용        : 폼로드할때 처리할 내용 
//---------------------------------------------------------------------------
scwin.init = function() {
	var indata = $w.getParameter("param");//
	try {
		fv_args = JSON.parse(indata);
	} catch(e) {}

    if (wconv.length(fv_args.sHandlerID) > 0) {
        sHandlerID = fv_args.sHandlerID;
    }
	    
    //var resultArr = "";
    // 고객번호넘어올때
    if (wconv.length(fv_args.sCustNo) > 1) {
        //resultArr = wconv.split(replace(argss, " ", ""), "^", "webstyle");
        Edt_CustNo.setValue(fv_args.sCustNo);//wconv.trim(resultArr[0]));
        Edt_Name.setValue(fv_args.sName);//wconv.trim(resultArr[1]));
        sGdType = wconv.trim(fv_args.sGdType);//resultArr[2]);

        //저장 후 닫기 버튼 비활성화
        scwin.lfn_Btn_enable();


        //동의여부,연락방식 초기화
        Div0_chk_agree1.setDisabled(true);
        Div0_chk_reject1.setDisabled(true);
        Div0_chk_All.setDisabled(true);
        Div0_chk_Call.setDisabled(true);
        Div0_chk_SMS.setDisabled(true);
        
        chk_Email.setDisabled(true);
        chk_DM.setDisabled(true);
        chk_Fax.setDisabled(true);

        //다른조건으로 넘어올때 입력/확인 으로 버튼TEXT변경
        if ((fv_args.sGdType == "2")) {
            btn_RecStrt.setValue("입력");
            Btn_save.setValue("확인");
        }
        //조회
        scwin.lfn_bt_search(Edt_CustNo.getValue(), "Y");
    } else {
        wprom.alert("검색 조건이 없습니다.");
        return false;
    }


    //현재시간 가져오기
    gfn_getServerTime();
    var getSysDate = gds.gDs_ServerTime.getCellData(0, "sToday");
    //서버시간으로 pc시간 동기화 처리
    //ext_SetTime(getSysDate);
    
    if (wconv.length(Div0_Edt_sReqDate.getValue()) == 0) {
        //util.appendRow(DsWs_CUSAA04);
        //util.insertColumn(DsWs_CUSAA04, [            [                "sUserID",                "sUserID",                "text"            ]        ]);
        //util.insertColumn(DsWs_CUSAA04, [            [                "sInputDate",                "sInputDate",                "text"            ]        ]);
        Div0_Edt_sReqDate.setValue(getSysDate);
        Div0_Edt_sReqID.setValue(util.getGdsValue("gUserID"));
    }
};

//---------------------------------------------------------------------------
// function 명 : lfn_Btn_enable
// 내용        : 계약상태에 따른 버튼 비활성화
//---------------------------------------------------------------------------
scwin.lfn_Btn_enable = function() {
    Btn_save.setDisabled(true);
};

//---------------------------------------------------------------------------
// function 명 : lfn_Btn_search_OnClick
// 내용        : 조회버튼 클릭 이벤트
//---------------------------------------------------------------------------
scwin.lfn_Btn_search_OnClick = function(e) {
    scwin.lfn_bt_search(Edt_CustNo.getValue(), "Y");
};

//---------------------------------------------------------------------------
// function 명 : lfn_bt_search
// 내용        : 개인신용정보 조회
//---------------------------------------------------------------------------
scwin.lfn_bt_search = function(sCustNo, sSearchYn) {
    wconv.clear(DS_con);
    if (sSearchYn == "Y") {
        wconv.clear(DsWs_CUSAA04);
        wconv.clear(DsWs_CUSAA41);
        /*
        SOBJ.WSDL = gds.gWsdlBasis; // 서비스 Obj WSDC 설정
        //trace(Edt_CustNo.Text);
        var MethodObj = gfn_CreateMethodObj(SOBJ, "com.inswave.customer.task.CustTask", "getCUSAA0441Info", 0, 0); // 자동차보험 Task Call 
        gfn_SetParam(MethodObj, "sCustNo", Edt_CustNo.getValue());
        var result = gfn_CallService(SOBJ, DOBJ, MethodObj);
        */
		var MethodObj = new callService("com.inswave.customer.task.CustTask",  "getCUSAA0441Info", 0, 0); // 자동차보험 Task Call
		//MethodObj.setId("getCUSAA0441Info");
		//MethodObj.setParam("sCustNo", Edt_CustNo.getValue());
		MethodObj.setId("getHandlerCUSAA0441Info");
		MethodObj.setParam("sCustNo", Edt_CustNo.getValue());
		MethodObj.setParam("sHandlerID", sHandlerID);  //추가된 param		
		MethodObj.setUrl("/common/CBSO045PController.do");
		MethodObj.setXPath("//*/hashtable/data/CUSAA04");
		MethodObj.addXPath("//*/hashtable/data/CUSAA41");
		MethodObj.addXPath("//WARNING");
		MethodObj.sync();
		MethodObj.send();
		util.interfaceKey(_tranSync.result.serviceDs);
		//DsWs_Team.setJSON (_tranSync.getDsJson("ADMAC03")); // dataset 데이터 
		util.jSonDsCreate(_tranSync.getDsJson("CUSAA04"), "DsWs_CUSAA04");
		util.setCompBindRefresh("DsWs_CUSAA04");
		util.setRowPosition(DsWs_CUSAA04, 0);
		util.jSonDsCreate(_tranSync.getDsJson("CUSAA41"), "DsWs_CUSAA41");
		util.setCompBindRefresh("DsWs_CUSAA41");
		util.setRowPosition(DsWs_CUSAA41, 0);
        
        //trace(DsWs_CUSAA04.SaveXML());
        //trace(DsWs_CUSAA41.SaveXML());
        //trace(replace(gfn_XmlEncoder(DOBJ.Value), "><", ">\n<"));
        if (WARNING.getRowCount() != 0) {
            wprom.alert("웹서비스 이상입니다.");
        } else {
            sSearchClickYn = "Y";
            //this.status = "정상적으로 조회 되었습니다..";
        }
    }



    //trace(DsWs_CUSAA04.SaveXML());
    //trace("sRejectYN = LDH = :" + sRejectYN); //23조 동의 여부
    //gfn_MakeDsReturn 는 데이터셋 컬럼을 만들고 컬럼 데이터가 있으면 넣고 없으면 컬럼만 만든다..
    //20116.11.25 cho.j.m 연락방식 추가에따른 변경
    if (DsWs_CUSAA04.getCellData(0, "result") > 0 || DsWs_CUSAA41.getCellData(0, "result") > 0) {
        if (DsWs_CUSAA04.getCellData(0, "result") > 0) {
            Div0_chk_agree1.setValue(wconv.iif(DsWs_CUSAA04.getCellData(0, "sAgmYn") == "Y", "1", ""));
            Div0_chk_reject1.setValue(wconv.iif(DsWs_CUSAA04.getCellData(0, "sAgmYn") == "N", "1", ""));
            Div0_chk_Call.setValue(wconv.iif(DsWs_CUSAA04.getCellData(0, "sCallReject") == "1", "", "1"));
            Div0_chk_SMS.setValue(wconv.iif(DsWs_CUSAA04.getCellData(0, "sSMSReject") == "1", "", "1"));
            chk_Email.setValue( wconv.iif(DsWs_CUSAA04.getCellData(0, "sEmailReject") == "1", "", "1") );
            chk_DM.setValue( wconv.iif(DsWs_CUSAA04.getCellData(0, "sDMReject") == "1", "", "1") );
            chk_Fax.setValue( wconv.iif(DsWs_CUSAA04.getCellData(0, "sFaxReject") == "1", "", "1") );
            if (Div0_chk_Call.getValue() == "1" && Div0_chk_SMS.getValue() == "1" && chk_Email.getValue() == "1" && chk_DM.getValue() == "1" && chk_Fax.getValue() == "1") {
                Div0_chk_All.setValue("1");
            } else {
                Div0_chk_All.setValue("0");
            }
        }
        Div0_Edt_sReqDate.setValue(DsWs_CUSAA04.getCellData(0, "sInputDate"));
        Div0_Edt_sReqID.setValue(DsWs_CUSAA04.getCellData(0, "sUserID"));
        var CUSAA04_ExpireDate = wconv.iif(DsWs_CUSAA04.getCellData(0, "sExpireDate") == "", "99991231", DsWs_CUSAA04.getCellData(0, "sExpireDate"));
        var CUSAA41_ExpireDate = wconv.iif(DsWs_CUSAA41.getCellData(0, "sExpireDate") == "", "99991231", DsWs_CUSAA41.getCellData(0, "sExpireDate"));
        Div0_Edt_sExpireDate.setValue(wconv.iif(CUSAA04_ExpireDate < CUSAA41_ExpireDate, CUSAA04_ExpireDate, CUSAA41_ExpireDate));
        if (DsWs_CUSAA04.getCellData(0, "sExpired") == "Y" || DsWs_CUSAA41.getCellData(0, "sExpired") == "Y") {
            Div0_Edt_sExpireDate.Color = "red";
            Div0_Edt_sExpireDate.Font = "굴림,9,Bold";
        }
        var addMsg = "";
        if (DsWs_CUSAA04.getCellData(0, "sExpireDate") == "99991231" && DsWs_CUSAA04.getCellData(0, "sExpired") == "Y") {
            addMsg = "개인정보보호법 시행(2011.9.30) 이전 유입고객으로서 재동의가 필요합니다";
        }
        if (DsWs_CUSAA04.getCellData(0, "sAgmReq") == "Y" || DsWs_CUSAA41.getCellData(0, "sAgmReq") == "Y") {
            if (wconv.length(addMsg) > 0) {
                wprom.alert(addMsg);
            } else {
                wprom.alert("상품소개 동의가 필요합니다.");
            }
        }
    } else {
        gfn_getServerTime();
        sysDate = gds.gDs_ServerTime.getCellData(0, "sToday"); // 서버시간 
        Div0_Edt_sReqDate.setValue(wconv.mid(sysDate, 0, 8));
        Div0_Edt_sReqID.setValue(util.getGdsValue("gUserID")); // Div0.Edt_sUserName.Value  = gUserEmpName;
    }
    
};

//---------------------------------------------------------------------------
// function 명 : lfn_Btn_save_OnClick
// 내용        : 신용정보저장 버튼  클릭 이벤트
//---------------------------------------------------------------------------
scwin.lfn_Btn_save_OnClick = function(e) {
    if (scwin.lfn_validation()) {
        return;
    }
    scwin.btn_RecEnd_OnClick(); //종료시간 체크.
    
    scwin.lfn_save();
    
};

//---------------------------------------------------------------------------
// function 명 : lfn_validation
// 내용        : 체크여부 확인
//---------------------------------------------------------------------------
scwin.lfn_validation = function() {
    if (Div0_chk_reject1.getValue() == "0" && Div0_chk_agree1.getValue() == "0") {
        wprom.alert("상품소개 동의 여부를 선택하세요");
        return true;
    }
    if (Div0_chk_agree1.getValue() == "1") {
        if (!((Div0_chk_Call.getValue() == "1" || Div0_chk_SMS.getValue() == "1" || 
              chk_Email.getValue() == "1" || chk_DM.getValue() == "1" || chk_Fax.getValue() == "1"))) {
            wprom.alert("연락방식중 하나는 필수 선택 사항입니다.");
            return true;
        }
    }
    return false;
};

//---------------------------------------------------------------------------
// function 명 : lfn_save
// 내용        : 신용정보 저장 
//---------------------------------------------------------------------------
scwin.lfn_save = function() {
    var sFUserID = wconv.substr(util.getGdsValue("gUserID"), 0, 1);
    var sContactPath = "";
    var sAffiliatedConcern = "";
    var sEventDiv = "";

    // 1~2 임직원 - 제휴(일반) 임직원캠페인 당사 임직원 캠페인
    if (sFUserID == "1" || sFUserID == "2") {
        sContactPath = "8";
        sAffiliatedConcern = "01005";
        sEventDiv = "128";
    } else if (sFUserID == "3" || sFUserID == "4" || sFUserID == "5") {
        sContactPath = "1";
        sAffiliatedConcern = "01102";
        sEventDiv = "582";
    } else if (sFUserID == "9") {
        sContactPath = "1";
        sAffiliatedConcern = "01102";
        sEventDiv = "583";
    } else if (sFUserID == "C") {
        sContactPath = "1";
        sAffiliatedConcern = "01102";
        sEventDiv = "854";
    }
    wconv.clear(ds_Wanning);
    /*
    SOBJ_SAVE.WSDL = gds.gWsdlBasis; // 서비스 Obj WSDC 설정
    var MethodObj = gfn_CreateMethodObj(SOBJ_SAVE, "com.inswave.customer.task.CustTask", "setCUSAA0441Info", 0, 0); //  
    gfn_SetParam(MethodObj, "sCustNo", Edt_CustNo.getValue());
    gfn_SetParam(MethodObj, "sCUSAA04AgmYn", wconv.iif(Div0_chk_agree1.getValue() == "1", "Y", "N"));
    //gfn_SetParam(MethodObj, "sCUSAA41AgmYn"      , wconv.iif(Div0.chk_agree2.Value == "1", "Y", "N"));
    gfn_SetParam(MethodObj, "sCUSAA41AgmYn", wconv.iif(Div0_chk_agree1.getValue() == "1", "Y", "N")); //마케팅 동의 문구 통합.(201309)
    gfn_SetParam(MethodObj, "sCallReject", wconv.iif(Div0_chk_Call.getValue() == "1", "", "1"));
    gfn_SetParam(MethodObj, "sDMReject", wconv.iif(chk_DM.getValue() == "1", "", "1"));
    gfn_SetParam(MethodObj, "sFaxReject", wconv.iif(chk_Fax.getValue() == "1", "", "1"));
    gfn_SetParam(MethodObj, "sEmailReject", wconv.iif(chk_Email.getValue() == "1", "", "1"));
    gfn_SetParam(MethodObj, "sSMSReject", wconv.iif(Div0_chk_SMS.getValue() == "1", "", "1"));
    gfn_SetParam(MethodObj, "sInputDate", sEndDate);
    gfn_SetParam(MethodObj, "sInputTime", sEndTime);
    gfn_SetParam(MethodObj, "sInputID", util.getGdsValue("gUserID"));
    gfn_SetParam(MethodObj, "sUserID", util.getGdsValue("gUserID"));
    gfn_SetParam(MethodObj, "sInputIP", util.getGdsValue("gUserIP"));
    gfn_SetParam(MethodObj, "sRecStartDate", sStrtDate);
    gfn_SetParam(MethodObj, "sRecStartTime", sStrtTime);
    gfn_SetParam(MethodObj, "sRecEndDate", sEndDate);
    gfn_SetParam(MethodObj, "sRecEndTime", sEndTime);
    gfn_SetParam(MethodObj, "nCallSerial", gds.gCallSerial);
    gfn_SetParam(MethodObj, "sCustType", "");
    //유입경로코드 추가
    gfn_SetParam(MethodObj, "sContactPath", sContactPath);
    gfn_SetParam(MethodObj, "sAffiliatedConcern", sAffiliatedConcern);
    gfn_SetParam(MethodObj, "sEventDiv", sEventDiv);
    var result = gfn_CallService(SOBJ_SAVE, DOBJ_SAVE, MethodObj);
    */
	var MethodObj = new callService("com.inswave.customer.task.CustTask", "setCUSAA0441Info", 0, 0); //  
	MethodObj.setId("setCUSAA0441Info");
    MethodObj.setParam( "sCustNo", Edt_CustNo.getValue());
    MethodObj.setParam( "sCUSAA04AgmYn", wconv.iif(Div0_chk_agree1.getValue() == "1", "Y", "N"));
    //MethodObj.setParam( "sCUSAA41AgmYn"      , wconv.iif(Div0.chk_agree2.Value == "1", "Y", "N"));
    MethodObj.setParam( "sCUSAA41AgmYn", wconv.iif(Div0_chk_agree1.getValue() == "1", "Y", "N")); //마케팅 동의 문구 통합.(201309)
    MethodObj.setParam( "sCallReject", wconv.iif(Div0_chk_Call.getValue() == "1", "", "1"));
    MethodObj.setParam( "sDMReject", wconv.iif(chk_DM.getValue() == "1", "", "1"));
    MethodObj.setParam( "sFaxReject", wconv.iif(chk_Fax.getValue() == "1", "", "1"));
    MethodObj.setParam( "sEmailReject", wconv.iif(chk_Email.getValue() == "1", "", "1"));
    MethodObj.setParam( "sSMSReject", wconv.iif(Div0_chk_SMS.getValue() == "1", "", "1"));
    MethodObj.setParam( "sInputDate", sEndDate);
    MethodObj.setParam( "sInputTime", sEndTime);
    MethodObj.setParam( "sInputID", util.getGdsValue("gUserID"));
    MethodObj.setParam( "sUserID", util.getGdsValue("gUserID"));
    MethodObj.setParam( "sInputIP", util.getGdsValue("gUserIP"));
    MethodObj.setParam( "sRecStartDate", sStrtDate);
    MethodObj.setParam( "sRecStartTime", sStrtTime);
    MethodObj.setParam( "sRecEndDate", sEndDate);
    MethodObj.setParam( "sRecEndTime", sEndTime);
    MethodObj.setParam( "nCallSerial", util.getGdsValue("gCallSerial"));
    MethodObj.setParam( "sCustType", "");
    //유입경로코드 추가
    MethodObj.setParam( "sContactPath", sContactPath);
    MethodObj.setParam( "sAffiliatedConcern", sAffiliatedConcern);
    MethodObj.setParam( "sEventDiv", sEventDiv);

	MethodObj.setUrl("/common/CBSO045PController.do");
	MethodObj.setXPath("//WARNING");
	MethodObj.sync();
	MethodObj.send();
	//util.interfaceKey(_tranSync.result.serviceDs);
	//DsWs_Team.setJSON (_tranSync.getDsJson("ADMAC03")); // dataset 데이터 
	util.jSonDsCreate(_tranSync.getDsJson("WARNING"), "WARNING");
    
    if (WARNING.getRowCount() != 0) {
        wprom.alert("웹서비스 이상입니다.");
        return;
    } else if (WARNING.getRowCount() != 0) {
        wprom.alert(WARNING.getCellData(0, "msg"));
        return;
    } else {
    	var promise = Promise.resolve();
    	promise = promise.then(function(){
    		return wprom.alert("저장 되었습니다.");
    	});
    	promise = promise.then(function(rtn){
		    if (Div0_chk_agree1.getValue() == "1") {
		        wprom.close("N");
		    } else {
		        wprom.close("Y");
		    }
		    return ;
		});
		return promise;    
        
    }
};

//---------------------------------------------------------------------------
// function 명 : lfn_Btn_close_OnClick
// 내용        : 닫기버튼 클릭 이벤트
//---------------------------------------------------------------------------
scwin.lfn_Btn_close_OnClick = function(obj) {
    if (sSaveYN == "Y") {
        sRejectYN = "N";
    } else {
        sRejectYN = "Y";
    }
    wprom.close(sRejectYN);
};

//---------------------------------------------------------------------------
// function 명 : btn_RecStrt_OnClick
// 내용        : 녹취 정보 콜.
//---------------------------------------------------------------------------
scwin.btn_RecStrt_OnClick = function(obj) {
    // 서버시간 조회
    gfn_getServerTime();
    sysDate = gds.gDs_ServerTime.getCellData(0, "sToday"); // 서버시간 
    sStrtDate = wconv.mid(sysDate, 0, 8);
    sStrtTime = wconv.mid(sysDate, 8, 6);
    Btn_save.setDisabled(false);

    //2016.11.25 cho.j.m 동의여부 ,연락방식 초기화
    Div0_chk_agree1.setDisabled(false);
    Div0_chk_reject1.setDisabled(false);
    Div0_chk_All.setDisabled(true);
    Div0_chk_Call.setDisabled(true);
    Div0_chk_SMS.setDisabled(true);
    chk_Email.setDisabled(true);
    chk_DM.setDisabled(true);
    chk_Fax.setDisabled(true);
    Div0_chk_agree1.setValue("");
    Div0_chk_reject1.setValue("");
    Div0_chk_All.setValue("");
    scwin.OnClick_AlllWay();
};

//---------------------------------------------------------------------------
// function 명 : btn_RecEnd_OnClick
// 내용        : 녹취 정보 콜.
//---------------------------------------------------------------------------
scwin.btn_RecEnd_OnClick = function(obj) {
    // 서버시간 조회
    gfn_getServerTime();
    sysDate = gds.gDs_ServerTime.getCellData(0, "sToday"); // 서버시간 
    sEndDate = wconv.mid(sysDate, 0, 8);
    sEndTime = wconv.mid(sysDate, 8, 6); //trace(sysDate);
};

//---------------------------------------------------------------------------
// function 명 : 동의/거부 체크박스선택시
//---------------------------------------------------------------------------
scwin.agree_OnClick = function(obj, strValue) {
    if (Div0_chk_agree1.getValue() == "1") {
        Div0_chk_reject1.setValue("");
        Div0_chk_All.setDisabled(false);
        Div0_chk_Call.setDisabled(false);
        Div0_chk_SMS.setDisabled(false);
        chk_Email.setDisabled(false);
        chk_DM.setDisabled(false);
        chk_Fax.setDisabled(false);
        Div0_chk_All.setValue("1");
        scwin.OnClick_AlllWay();
    } else {
        Div0_chk_agree1.setValue("1");
    }
};

scwin.reject_OnClick = function(obj, strValue) {
    if (Div0_chk_reject1.getValue() == "1") {
        Div0_chk_agree1.setValue("");
        Div0_chk_All.setDisabled(true);
        Div0_chk_Call.setDisabled(true);
        Div0_chk_SMS.setDisabled(true);
        chk_Email.setDisabled(true);
        chk_DM.setDisabled(true);
        chk_Fax.setDisabled(true);
        Div0_chk_All.setValue("");
        scwin.OnClick_AlllWay();
    } else {
        Div0_chk_reject1.setValue("1");
    }
};

//---------------------------------------------------------------------------
// function 명 : 전체 체크박스 선택시
//---------------------------------------------------------------------------
scwin.OnClick_AlllWay = function(obj, strValue) {
    if (Div0_chk_All.getValue() == "1") {
        Div0_chk_Call.setValue("1");
        Div0_chk_SMS.setValue("1");
        chk_Email.setValue( "1" );
        chk_DM.setValue( "1" );
        chk_Fax.setValue( "1" );
    } else {
        Div0_chk_Call.setValue("");
        Div0_chk_SMS.setValue("");
        chk_Email.setValue( "" );
        chk_DM.setValue( "" );
        chk_Fax.setValue( "" );
    }
};

//---------------------------------------------------------------------------
// function 명 : 연락방식 체크박스 선택시
//---------------------------------------------------------------------------
scwin.OnClick_CallWay = function(obj, strValue) {
    if (Div0_chk_Call.getValue() == "1" && Div0_chk_SMS.getValue() == "1" && 
        chk_Email.getValue() == "1" && chk_DM.getValue() == "1" && chk_Fax.getValue() == "1") {
        Div0_chk_All.setValue("1");
    } else {
        Div0_chk_All.setValue("");
    }
};
]]></script>
    </head>
    <body>
        <xf:group class="cont_wrap layer" id="fCut01088s"
        	style="position:absolute; WorkArea:true;/*height:370px;*/ left:0px; top:0px;/*width:696px;*/"
        	userData1="상품소개 동의를 위한 개인(신용)정보처리 동의"
        	userData2=" OnLoadCompleted:scwin.lfn_OnLoadCompleted; ">
        	<DataObjects>
        		<DataObject />
        		<DataObject />
        		<DataObject />
        		<DataObject />
        	</DataObjects>
        	<ServiceObjects>
        		<ServiceObject />
        		<ServiceObject />
        		<ServiceObject />
        		<ServiceObject />
        	</ServiceObjects>
        	<xf:group arcsize="6" class="search_area" id="Shape9" style="left:0px;top:30px;width:700px;" userData3="RoundRect">
        	</xf:group><w2:textbox class="sty_lb_Basic" id="Static13" label="주민번호"
        		style="position:absolute; VAlign:Middle;height:20px;left:5px;top:37px;width:55px;min-width:55px; border:none;"
        		tagname="" />
        	<xf:input class="sty_ipt_form" id="Edt_Name"
        		maxByteLength="30" readOnly="TRUE"
        		style="position:absolute; ImeMode:native;  border-style:solid;  height:20px;left:199px;top:39px; width:100px;"
        		tabIndex="1" />
        	<xf:trigger class="btn_Comm_Search"
        		ev:onclick="scwin.lfn_Btn_search_OnClick" id="Btn_search"
        		style="position:absolute; ImageID:btn_Input_02;  height:20px;left:627px;top:37px; width:45px;"
        		tabIndex="3" type="anchor">
        		<xf:label><![CDATA[조회]]></xf:label>
        	</xf:trigger>
        	<xf:trigger class="btn_Comm_Close"
        		ev:onclick="scwin.lfn_Btn_close_OnClick" id="Btn_close"
        		style="position:absolute; display:none;  ImageID:btn_Comm_Close;  height:20px; left:628px; top:372px; width:58px;"
        		tabIndex="4">
        		<xf:label><![CDATA[닫기]]></xf:label>
        	</xf:trigger>
        	<w2:textbox id="Static0" label="상품소개 동의를 위한 개인(신용)정보처리 동의"
        		style="position:absolute; VAlign:Middle;  height:20px; left:0px; top:0px;"
        		tagname="" class="sub_pop_title01" />
        	<xf:group class="" id="Div0"
        		style="position:absolute; height:304px;left:0px;top:67px; width:682px;"
        		tabIndex="7" userData1="Div0">
        		<xf:group arcsize="6" class="sty_area_form" id="group1" style="position:absolute;  bottom:608px;height:301px;left:0px;top:4px;width:700px;" userData3="RoundRect">
        			<xf:group class="form_w_line" id="" style="top:272px;left:0px;">
        			</xf:group>
        		</xf:group>
        		<w2:textbox class="sty_lb_Detail" id="Div0_Static3"
        			style="position:absolute; VAlign:Middle;  background-color:#e1e1e1; height:273px;left:574px;top:4px; width:125px;"
        			tagname="" />
        		<w2:textbox class="sty_lb_Basic" id="Div0_Static16"
        			label="상품소개 동      의"
        			style="position:absolute; VAlign:Middle;  border-style:solid;  height:272px;left:0px;top:4px; width:100px;"
        			tagname="" />
        		<w2:textbox class="sty_lb_Basic" id="Div0_Static10"
        			label="입력일"
        			style="position:absolute; VAlign:Middle;left:0px;top:277px; width:100px;"
        			tagname="" />
        		<w2:textbox class="sty_lb_Basic" id="Div0_Static17"
        			label="입력자"
        			style="position:absolute; VAlign:Middle;left:221px;top:277px; width:50px; min-width:50px;"
        			tagname="" />
        		<xf:input class="sty_ipt_form" dataType="text"
        			disabled="true" displayFormat="####/##/##"
        			id="Div0_Edt_sReqDate" maxlength="8" readOnly="true"
        			ref="data:DsWs_CUSAA04.sInputDate"
        			style="position:absolute; border-style:solid;  height:20px;left:120px;top:281px; width:93px;"
        			tabIndex="5" />
        		<xf:input class="sty_ipt_form" disabled="true"
        			id="Div0_Edt_sReqID" maxByteLength="30" readOnly="TRUE"
        			ref="data:DsWs_CUSAA04.sUserID"
        			style="position:absolute; ImeMode:native;  border-style:solid;  height:20px;left:293px;top:281px; width:170px;"
        			tabIndex="6" />
        		<xf:select appearance="full" class="sty_ipt_form"
        			ev:onclick="scwin.agree_OnClick" id="Div0_chk_agree1"
        			style="position:absolute;Value:FALSE;height:20px;width:46px;left:582px;border:none;top:69px;"
        			tabIndex="7" falseValue="0" cols="" rows="">
        			<xf:choices>
        				<xf:item>
        					<xf:label><![CDATA[동의]]></xf:label>
        					<xf:value><![CDATA[1]]></xf:value>
        				</xf:item>
        			</xf:choices>
        		</xf:select>
        		<w2:textbox class="sty_lb_Detail"
        			id="Div0_stc_32AgreText"
        			label="※개인식별정보(성명, 생년월일 ,연락처 등) 저희 회사의 상품, 사은행사 홍보 (판매권유) 등의 연락을 위한 선택적 동의 사항으로 거부하셔도 불이익은 없으시며, 동의 내용은 녹음됩니다. 개인식별정보, 보험계약정보 등을 3년간 수집·이용하고 당사 모집조직 및 모집위탁자 등에 제공하는데 동의해 주시는 거죠? (※ 고객 거부 시 종료) (고객 동의 시) 고객님께는 이메일, 문자, 전화 , 우편으로 연락드릴 건데요.  마케팅 중단 요청은 당사 홈페이지, 고객센터(1566-3000), 연락중지시스템 Do not Call(두 낫 콜) 센터(www.donotcall.or.kr)를 통해서 가능합니다. 개인신용정보보호 및 개인신용정보제공에 관한 상세내용(각 제공대상기관 및 이용 목적의 구체적인 정보 및 그 변동내용)은 당사 홈페이지(www.educar.co.kr)에서 확인을 부탁드립니다. ※ 개인정보위탁내용조회 및 개인정보현황열람 확인 안내 시 ☞ 에듀카 홈페이지&gt; 상단 고객센터 클릭&gt;왼쪽 하단 개인정보위탁내용조회 및 개인정보현황열람 가능"
        			style="position:absolute; VAlign:Middle;  height:272px;left:122px;top:5px; width:450px; line-height: 15px;"
        			tagname="" />
        		<xf:select appearance="full" class="sty_ipt_form"
        			ev:onclick="scwin.reject_OnClick" id="Div0_chk_reject1"
        			style="position:absolute;Value:FALSE;height:20px;width:46px;left:582px;border:none;top:88px;"
        			tabIndex="10" cols="" rows="" falseValue="0">
        			<xf:choices>
        				<xf:item>
        					<xf:label><![CDATA[거부]]></xf:label>
        					<xf:value><![CDATA[1]]></xf:value>
        				</xf:item>
        			</xf:choices>
        		</xf:select>
        		<w2:textbox class="sty_lb_Basic" id="Div0_Static1"
        			label="이용만료일"
        			style="position:absolute; VAlign:Middle;left:483px;top:277px; width:70px; min-width:70px;"
        			tagname="" />
        		<xf:input class="sty_ipt_form" dataType="text"
        			disabled="true" displayFormat="####/##/##"
        			id="Div0_Edt_sExpireDate" maxlength="8" readOnly="true"
        			style="position:absolute; border-style:solid;  height:20px;left:575px;top:281px; width:116px;"
        			tabIndex="12" />
        		<w2:textbox id="Div0_Static20" label="동의여부"
        			style="position:absolute; VAlign:Middle;  height:20px;left:581px;top:41px; width:52px;"
        			tagname="" />
        		<w2:textbox id="Div0_Static0" label="연락방식"
        			style="position:absolute; VAlign:Middle;  height:20px;left:637px;top:41px; width:52px;"
        			tagname="" />
        		<xf:select appearance="full" class="sty_ipt_form"
        			ev:onclick="scwin.OnClick_AlllWay" id="Div0_chk_All"
        			style="position:absolute;Value:FALSE;height:20px;width:46px;left:637px;border:none;top:69px;"
        			tabIndex="15" cols="" rows="" falseValue="0">
        			<xf:choices>
        				<xf:item>
        					<xf:label><![CDATA[전체]]></xf:label>
        					<xf:value><![CDATA[1]]></xf:value>
        				</xf:item>
        			</xf:choices>
        		</xf:select>
        		<xf:select appearance="full" class="sty_ipt_form"
        			ev:onclick="scwin.OnClick_CallWay" id="Div0_chk_Call"
        			style="position:absolute;Value:FALSE;height:20px;width:46px;left:637px;border:none;top:90px;"
        			tabIndex="16" falseValue="0" cols="" rows="">
        			<xf:choices>
        				<xf:item>
        					<xf:label><![CDATA[전화]]></xf:label>
        					<xf:value><![CDATA[1]]></xf:value>
        				</xf:item>
        			</xf:choices>
        		</xf:select>
        		<xf:select appearance="full" class="sty_ipt_form"
        			ev:onclick="scwin.OnClick_CallWay" id="Div0_chk_SMS"
        			style="position:absolute;Value:FALSE;height:20px;width:46px;left:637px;border:none;top:111px;"
        			tabIndex="17" falseValue="0" cols="" rows="">
        			<xf:choices>
        				<xf:item>
        					<xf:label><![CDATA[SMS]]></xf:label>
        					<xf:value><![CDATA[1]]></xf:value>
        				</xf:item>
        			</xf:choices>
        		</xf:select>

        	</xf:group>
        	<xf:trigger class="popup_top_btn"
        		ev:onclick="scwin.btn_RecStrt_OnClick" id="btn_RecStrt"
        		style="position:absolute; ImageID:btn_Input_04;  height:20px;left:528px;top:0px; width:65px;"
        		tabIndex="9" type="anchor">
        		<xf:label><![CDATA[녹취 시작]]></xf:label>
        	</xf:trigger>
        	<xf:trigger class="popup_top_btn"
        		ev:onclick="scwin.lfn_Btn_save_OnClick" id="Btn_save"
        		style="position:absolute; ImageID:btn_Input_06;  height:20px;left:607px;top:0px;width:75px;"
        		tabIndex="10" type="anchor">
        		<xf:label><![CDATA[저장 후 닫기]]></xf:label>
        	</xf:trigger>
        	<xf:input class="sty_ipt_search" dataType="text"
        		disabled="true" displayFormat="######-######" id="Edt_CustNo"
        		style="position:absolute; cursor:text;  border-style:solid;  height:20px;left:75px;top:39px; width:120px;"
        		tabIndex="11" />
        	<xf:select appearance="full" class="sty_ipt_form"
        		ev:onclick="scwin.OnClick_CallWay" id="chk_Email"
        		style="position:absolute;Value:FALSE;height:20px;width:57px;left:636px;border:none;top:198px;"
        		tabIndex="12" falseValue="0" cols="" rows="">
        		<xf:choices>
        			<xf:item>
        				<xf:label><![CDATA[이메일]]></xf:label>
        				<xf:value><![CDATA[1]]></xf:value>
        			</xf:item>
        		</xf:choices>
        	</xf:select>
        	<xf:select appearance="full" class="sty_ipt_form"
        		ev:onclick="scwin.OnClick_CallWay" id="chk_DM"
        		style="position:absolute;Value:FALSE;height:20px;width:57px;left:636px;border:none;top:218px;"
        		tabIndex="13" falseValue="0" cols="" rows="">
        		<xf:choices>
        			<xf:item>
        				<xf:label><![CDATA[DM]]></xf:label>
        				<xf:value><![CDATA[1]]></xf:value>
        			</xf:item>
        		</xf:choices>
        	</xf:select>
        	<xf:select appearance="full" class="sty_ipt_form"
        		ev:onclick="scwin.OnClick_CallWay" id="chk_Fax"
        		style="position:absolute;Value:FALSE;height:20px;width:57px;left:636px;border:none;top:238px;"
        		tabIndex="14" falseValue="0" cols="" rows="">
        		<xf:choices>
        			<xf:item>
        				<xf:label><![CDATA[FAX]]></xf:label>
        				<xf:value><![CDATA[1]]></xf:value>
        			</xf:item>
        		</xf:choices>
        	</xf:select>

        </xf:group>
    </body>
</html>
