<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="/cm/css/all.css" type="text/css"?>
<?xml-stylesheet href="/cm/css/new.css" type="text/css"?>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare"
	xmlns:xf="http://www.w3.org/2002/xforms">
	<head>
		<w2:type>DEFAULT</w2:type>
		<w2:buildDate />
		<xf:model>
			<xf:instance>
				<data xmlns="" />
			</xf:instance>
			<w2:dataCollection baseNode="map">
				<w2:dataList id="data1" baseNode="list"
					saveRemovedData="true" repeatNode="map">
					<w2:columnInfo>
						<w2:column id="id1" name="" dataType="text"
							ignoreStatus="true">
						</w2:column>
						<w2:column id="id2" name="" dataType="text"></w2:column>
						<w2:column id="id3" name="" dataType="text"></w2:column>
						<w2:column id="id4" name="" dataType="text"></w2:column>
						<w2:column id="id5" name="" dataType="number"></w2:column>
						<w2:column id="id6" name="" dataType="text"></w2:column>
						<w2:column id="id7" name="" dataType="number"></w2:column>
						<w2:column id="id8" name="" dataType="text"></w2:column>
					</w2:columnInfo>
					<w2:data use="true">
						<w2:row>
							<id1><![CDATA[1]]></id1>
							<id2><![CDATA[내국인]]></id2>
							<id3><![CDATA[3]]></id3>
							<id4><![CDATA[45]]></id4>
							<id5><![CDATA[5]]></id5>
							<id6><![CDATA[7]]></id6>
							<id7><![CDATA[8]]></id7>
							<id8><![CDATA[1]]></id8>
							<id9><![CDATA[0]]></id9>
							<id10><![CDATA[1]]></id10>
						</w2:row>
						<w2:row>
							<id1><![CDATA[2]]></id1>
						</w2:row>
						<w2:row>
							<id1><![CDATA[3]]></id1>
						</w2:row>
						<w2:row>
							<id1><![CDATA[4]]></id1>
						</w2:row>
						<w2:row>
							<id1><![CDATA[5]]></id1>
						</w2:row>
					</w2:data>
				</w2:dataList>
				<w2:dataMap baseNode="map" id="dst_NotcMattInfoVo">
					<w2:keyInfo>
						<w2:key id="noticMattId" name="공지사항id"
							dataType="text">
						</w2:key>
						<w2:key id="rgtrEmpNo" name="등록자사번"
							dataType="text">
						</w2:key>
						<w2:key id="rgtrEmpNm" name="등록자이름"
							dataType="text">
						</w2:key>
						<w2:key id="rgstDate" name="등록일자"
							dataType="text">
						</w2:key>
						<w2:key id="seqno" name="순번" dataType="text">
						</w2:key>
						<w2:key id="noticMattFlag" name="공지사항구분"
							dataType="text">
						</w2:key>
						<w2:key id="noticMattName" name="공지사항명"
							dataType="text">
						</w2:key>
						<w2:key id="noticMattCont" name="공지사항내용"
							dataType="text">
						</w2:key>
						<w2:key id="rgtrPstnCd" name="등록자소속코드"
							dataType="text">
						</w2:key>
						<w2:key id="apdxFileName" name="첨부파일명"
							dataType="text">
						</w2:key>
						<w2:key id="apdxFilePath" name="첨부파일경로"
							dataType="text">
						</w2:key>
						<w2:key id="inqrNum" name="조회수"
							dataType="text">
						</w2:key>
						<w2:key id="drctMangAuthYn" name="직영권한여부"
							dataType="text">
						</w2:key>
						<w2:key id="crossAuthYn" name="교차권한여부"
							dataType="text">
						</w2:key>
						<w2:key id="atchAuthYn" name="전속권한여부"
							dataType="text">
						</w2:key>
						<w2:key id="gAAuthYn" name="GA권한여부"
							dataType="text">
						</w2:key>
						<w2:key id="noticDate" name="게시일자"
							dataType="text">
						</w2:key>
						<w2:key id="noticEnddt" name="게시종료일자"
							dataType="text">
						</w2:key>
						<w2:key id="delYn" name="삭제여부"
							dataType="text">
						</w2:key>
						<w2:key id="inptDler" name="입력처리자"
							dataType="text">
						</w2:key>
						<w2:key id="inptDlerIP" name="입력처리자IP"
							dataType="text">
						</w2:key>
						<w2:key id="inptDate" name="입력일자"
							dataType="text">
						</w2:key>
						<w2:key id="inptHms" name="입력시간"
							dataType="text">
						</w2:key>
						<w2:key id="mdfcDler" name="수정처리자"
							dataType="text">
						</w2:key>
						<w2:key id="mdfcDlerIP" name="수정처리자IP"
							dataType="text">
						</w2:key>
						<w2:key id="mdfcDate" name="수정일자"
							dataType="text">
						</w2:key>
						<w2:key id="mdfcHms" name="수정시간"
							dataType="text">
						</w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataList id="dsl_noticMattFlag" baseNode="list"
					saveRemovedData="true" repeatNode="map">
					<w2:columnInfo>
						<w2:column id="CODE" name="CODE"
							dataType="text">
						</w2:column>
						<w2:column id="TEXT" name="TEXT"
							dataType="text">
						</w2:column>
					</w2:columnInfo>
					<w2:data use="true">
						<w2:row>
							<CODE><![CDATA[01]]></CODE>
							<TEXT><![CDATA[중요공지]]></TEXT>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[02]]></CODE>
							<TEXT><![CDATA[상품]]></TEXT>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[03]]></CODE>
							<TEXT><![CDATA[인수]]></TEXT>
						</w2:row>
					</w2:data>
				</w2:dataList>
				<w2:dataMap baseNode="map"
					id="dst_LginAuthInqrVo">
					<w2:keyInfo>
						<w2:key id="empNo" name="사번" dataType="text">
						</w2:key>
						<w2:key id="name" name="이름" dataType="text">
						</w2:key>
						<w2:key id="pstnDeptCd" name="소속부서코드"
							dataType="text">
						</w2:key>
						<w2:key id="bizAdmrYn" name="업무관리자"
							dataType="text">
						</w2:key>
						<w2:key id="agncyAdmrYn" name="대리점사용인관리자여부"
							dataType="text">
						</w2:key>
						<w2:key id="geafAdmrYn" name="대면총무여부,지점장여부"
							dataType="text">
						</w2:key>
						<w2:key id="gaEducMngrAdmrYn" name="GA교육매니저여부"
							dataType="text">
						</w2:key>
						<w2:key id="drctMangYn" name="직영여부"
							dataType="text">
						</w2:key>
						<w2:key id="crossYn" name="교차여부"
							dataType="text">
						</w2:key>
						<w2:key id="atchYn" name="전속여부"
							dataType="text">
						</w2:key>
						<w2:key id="gAYn" name="GA여부" dataType="text">
						</w2:key>
						<w2:key id="superAuthYn" name="전체권한여부"
							dataType="text">
						</w2:key>
					</w2:keyInfo>
				</w2:dataMap>
			</w2:dataCollection>
			<w2:workflowCollection>
			</w2:workflowCollection>
			
		</xf:model>
 <script src="/cm/js/common.js"/>
 <script src="/cm/js/gds.js"/>
 <script src="/cm/js/init.js"/>
 <script src="/cm/js/main.js"/>
 <script src="/cm/js/transSub.js"/>
 <script src="/cm/js/util.js"/>
 <script src="/cm/js/val_lib.js"/>
 <script src="/cm/js/callService.js"/>
 <script src="/cm/js/wconv.js"/>
 <script src="/cm/js/wprom.js"/>
		<script type="javascript"><![CDATA[
			
	var gsSysDate;			// global 현재일자
	var gUserID; 			// global 사용자 ID
	var gUserEmpName; 	    // global 부서명
	var gNoticMattId;		// global 공지사항Id
	var ggelementId;
	var ggfileName;	
			
	//**********************************************************
	// 초기화
	//**********************************************************
	scwin.init = function() {
		gsSysDate 		= WebSquare.date.getCurrentServerDate("yyyyMMdd"); 	// global 현재일자
		gUserID 		= util.getGdsValue("gUserID");    					// global 사용자 ID
		gUserEmpName 	= util.getGdsValue("gUserEmpName");    				// global 부서명
	    
	    //Parent에서 넘어온 값을 설정한다.
		var indata = $w.getParameter("param");
		var args;
		try {
			args = JSON.parse(indata);
		} catch(e) {
		
		}							
		
		//파일업로드초기화
		scwin.fileUploadInit();
		
	    // 상위화면(CBSO005M)에서 공지사항Id 를 넘겨주면 글로벌변수로 담아둔다.   
	    if(!util.isNull(args) && !util.isNull(args.noticMattId)){
	    	gNoticMattId = args.noticMattId;
	    	tb_noticMattId.setValue( gNoticMattId );
	    	// 화면명 [공지사항 상세조회]  로 세팅 
	    	txt_popupTitle.setValue("[공지사항 상세조회]");
	    	btn_save.setValue("수정");
	    }
	    else{
	    	// 신규 자료 등록시, 
 			// 화면 명은 [공지사항 신규등록]으로 SETTING				    
	    	txt_popupTitle.setValue("[공지사항 신규등록]");
	    	ib_rgtrEmp.setValue( gUserEmpName+"("+gUserID+")" );	//등록자사번
	    	ib_rgstDate.setValue( gsSysDate );		//등록일자
	    	ic_noticDate.setValue( gsSysDate );		//게시시작일자
	    	ic_noticEnddt.setValue(wconv.addDateSimple(gsSysDate,364));	//게시종료일자	    	
	    	//ic_noticEnddt.setValue(wconv.addMonth(gsSysDate, 12));
	    	btn_save.setValue("등록");
	    }
	           	
	   	var promise = Promise.resolve();
	    promise = promise.then(function(rtnVal) {
	     	// /common/CBSO0015.do 로그인자 권한조회	 
			scwin.getLginAuthInfo();					 				   			
	    });
	    return promise;	
		
	};
	
	//**********************************************************
	// 
	//**********************************************************
	scwin.subCallBackfunction = function(e){
		// e.subID : 서브미션 ID
		// e.flag  : S성공;
		// e.msg   : 트렌젝션 처리후 메세지
		// e."받을데이타셋"
		switch(e.subID){
			// 로그인ID권한조회
			case "retrieveLginIDAuthInqr":
				dst_LginAuthInqrVo.setJSON(e.result);	
				// 권한에 따라 버튼및 게시조직 체크 		
				scwin.setCtrlByAuth();			
				var promise = Promise.resolve();
				promise = promise.then(function(rtnVal) {
					// /common/CBSO0010.do 공지사항단건조회
					if(!util.isNull(gNoticMattId)) {	
			   			scwin.getNotcMattData();
			   		}  
			   	}); 											
			break;
			// 공지사항조회
			case "retrieveNotcMatt":
				if(e.flag == "s") {
					dst_NotcMattInfoVo.setJSON(e.result);	
					// 조회데이터로 화면세팅 		
					scwin.setNotcMattAdm();	
				} else {
					wprom.alert(e.msg);
				}
														
			break;
			// 공지사항등록
			case "registerNotcMatt":
				if(e.flag == "s") {
					dst_NotcMattInfoVo.setJSON(e.result);
					wprom.alert("등록/수정이 완료되었습니다.");
					// 재조회 
					gNoticMattId = dst_NotcMattInfoVo.get("noticMattId");
					tb_noticMattId.setValue( gNoticMattId );	
					// 등록완료후 화면 닫기 
					var returnMsg = "I";
                	if (wprom.isPopup()){
			        	wprom.close(returnMsg);
			        }	 
				} else {
					wprom.alert(e.msg);
				}
			break;

			// 공지사항삭제
			case "modifyNotcMattDelete":
				if(e.flag == "s") {
					dst_NotcMattInfoVo.setJSON(e.result);
					wprom.alert("삭제가 완료되었습니다.");	
					// 조회데이터로 화면세팅 		
					scwin.setNotcMattAdm();	
					var returnMsg = "I";
                	if (wprom.isPopup()){
			        	wprom.close(returnMsg);
			        }	
				} else {
					wprom.alert(e.msg);
				}		
			break;
			
		}
	};
	
	//**********************************************************
	// 로그인자 권한조회 /common/CBSO0015.do 로그인자 권한조회
	//**********************************************************
	scwin.getLginAuthInfo = function() {
		// 사번으로 로그인자 권한조회	
//		gUserID = "2080018";
		dst_LginAuthInqrVo.set("empNo" , gUserID);
		
		var trans = new transSub();                  	// transaction 보낼 객체 생성
		trans.setId("retrieveLginIDAuthInqr");        	// transaction 보낼 SubmissionID
		trans.setUrl("/common/CBSO0015.do");   			// Controller 쪽으로 보낼 주소
		trans.setDs("dst_LginAuthInqrVo");					
		trans.targetDs("dst_LginAuthInqrVo");		
		trans.callBack("scwin.subCallBackfunction");  	// 받을 Dataset을 처리시 콜백함수
		trans.send();
	
	};
	
	//**********************************************************
	// 공지사항조회
	//**********************************************************
	scwin.getNotcMattData = function() {		
		// 공지사항Id로 공지사항조회 	   		
		dst_NotcMattInfoVo.set("noticMattId" , tb_noticMattId.getValue());
				
		var trans = new transSub();            		// transaction 보낼 객체 생성
		trans.setId("retrieveNotcMatt");           	// transaction 보낼 SubmissionID
		trans.setUrl("/common/CBSO0010.do");   		// Controller 쪽으로 보낼 주소
		trans.setDs("dst_NotcMattInfoVo");					
		trans.targetDs("dst_NotcMattInfoVo");		
		trans.callBack("scwin.subCallBackfunction");// 받을 Dataset을 처리시 콜백함수
		trans.send();
	
	};
	
	//**********************************************************
	// 공지사항등록
	//**********************************************************
	scwin.rgstNotcMattData = function() {
		
		if(util.isNull(sel_noticMattFlag.getValue())){			
        	wprom.alertF("공지구분 값을 선택해 주세요.",{},sel_noticMattFlag);
        	return;
		}	
		
		if(util.isNull(ic_noticDate.getValue())){			
        	wprom.alertF("게시 시작일을 입력해 주세요.",{},ic_noticDate);        	
        	return;			
		}
			
		if(util.isNull(ic_noticEnddt.getValue())){			
        	wprom.alertF("게시 종료일을 입력해 주세요.",{},ic_noticEnddt);        	
        	return;			
		}
		
		if(util.isNull(tb_noticMattId.getValue())){
			if(parseInt(gsSysDate-ic_noticDate.getValue())>0){			
        		wprom.alertF("게시 시작일은 현재일 이전이 될 수 없습니다.",{},ic_noticDate);        	
        		return;			
			}			
		}
				
		if(parseInt(ic_noticDate.getValue()-ic_noticEnddt.getValue())>0){
			wprom.alertF("게시 시작일이 게시 종료일보다 큽니다.",{},ic_noticDate);						
			return;
		}				
		
		if(util.isNull(ib_noticMattName.getValue())){			
        	wprom.alertF("공지사항 제목을 입력해 주세요.",{},ib_noticMattName);        	
        	return;			
		}
		
		if(util.isNull(ic_noticEnddt.getValue())){			
        	wprom.alertF("공지사항 내용을 입력해 주세요",{},ta_noticMattCont);        	
        	return;			
		}
		
		//게시조직체크
		if(util.isNull(ic_noticEnddt.getValue())){			
        	wprom.alertF("공지사항 내용을 입력해 주세요",{},ta_noticMattCont);        	
        	return;			
		}											
				
		if(gNoticMattId!= null && gNoticMattId.trim()!= ""){
			dst_NotcMattInfoVo.set("noticMattId",gNoticMattId);//공지사항id	
		}
		
		if(chk_superAuthYn.getValue() != "Y"
			&& chk_drctMangAuthYn.getValue() != "Y"
			&& chk_crossAuthYn.getValue() != "Y"
			&& chk_atchAuthYn.getValue() != "Y"
			&& chk_gAAuthYn.getValue() != "Y"){
			
        	wprom.alertF("게시조직을 입력해 주세요",{});        	
        	return;			
		}		
		dst_NotcMattInfoVo.set("noticMattFlag",sel_noticMattFlag.getValue());	//공지사항구분
		dst_NotcMattInfoVo.set("noticMattName",ib_noticMattName.getValue());	//공지사항명
		dst_NotcMattInfoVo.set("noticMattCont",ta_noticMattCont.getValue());	//공지사항내용
		dst_NotcMattInfoVo.set("noticDate",ic_noticDate.getValue());			//게시시작일자
		dst_NotcMattInfoVo.set("noticEnddt",ic_noticEnddt.getValue());			//게시종료일자
		
		// 첨부파일명 
		dst_NotcMattInfoVo.set("apdxFileName", ggfileName);
		// 첨부파일경로 
		dst_NotcMattInfoVo.set("apdxFilePath", ggelementId);
		// 등록자사번 
		dst_NotcMattInfoVo.set("rgtrEmpNo", gUserID);
		// 등록일자 
		dst_NotcMattInfoVo.set("rgstDate", gsSysDate);
		// 직영권한여부 
		dst_NotcMattInfoVo.set("drctMangAuthYn", chk_drctMangAuthYn.getValue());	   
		// 교차권한여부 
		dst_NotcMattInfoVo.set("crossAuthYn", chk_crossAuthYn.getValue());	   
		// 전속권한여부 
		dst_NotcMattInfoVo.set("atchAuthYn", chk_atchAuthYn.getValue());	   
		// GA권한여부 
		dst_NotcMattInfoVo.set("gAAuthYn", chk_gAAuthYn.getValue());	   
		// 삭제여부 				
		dst_NotcMattInfoVo.set("delYn", "N");	   	
					
		var trans = new transSub();              	// transaction 보낼 객체 생성
		trans.setId("registerNotcMatt");           	// transaction 보낼 SubmissionID
		trans.setUrl("/common/CBSO0011.do");   		// Controller 쪽으로 보낼 주소
		trans.setDs("dst_NotcMattInfoVo");					
		trans.targetDs("dst_NotcMattInfoVo");		
		trans.callBack("scwin.subCallBackfunction");// 받을 Dataset을 처리시 콜백함수
		trans.send();
	
	};
	
	//**********************************************************
	// 공지사항삭제
	//**********************************************************
	scwin.modifyNotcMattDeleteYn = function() {
		// 삭제여부 Y로 세팅 				
		dst_NotcMattInfoVo.set("noticMattId" , tb_noticMattId.getValue());	
			
		var trans = new transSub();                  // transaction 보낼 객체 생성
		trans.setId("modifyNotcMattDelete");        // transaction 보낼 SubmissionID
		trans.setUrl("/common/CBSO0013.do");   // Controller 쪽으로 보낼 주소
		trans.setDs("dst_NotcMattInfoVo");					
		trans.targetDs("dst_NotcMattInfoVo");		
		trans.callBack("scwin.subCallBackfunction");  // 받을 Dataset을 처리시 콜백함수
		trans.send();
	
	};
	
	//**********************************************************
	// 권한에 따라 화면컨트롤 
	//**********************************************************
	scwin.setCtrlByAuth = function() {
	
		//업무담당자
    	if(dst_LginAuthInqrVo.get("bizAdmrYn") == "Y") {	
   			// 게시조직 전체, 직영, 교차, 전속, GA 모두 활성화.
   			chk_superAuthYn.setDisabled(false);
   			chk_drctMangAuthYn.setDisabled(false);
   			chk_crossAuthYn.setDisabled(false);
   			chk_atchAuthYn.setDisabled(false);
   			chk_gAAuthYn.setDisabled(false);
   			
	   		chk_superAuthYn.setStyle("display" , "");
			chk_drctMangAuthYn.setStyle("display" , "");
	   		chk_crossAuthYn.setStyle("display" , "");
	   		chk_atchAuthYn.setStyle("display" , "");
			chk_gAAuthYn.setStyle("display" , "");  
			
			if(dst_LginAuthInqrVo.get("drctMangYn") == "Y") {
				chk_drctMangAuthYn.setValue("Y");
			}
			if(dst_LginAuthInqrVo.get("crossYn") == "Y") {
				chk_crossAuthYn.setValue("Y");
			}
			if(dst_LginAuthInqrVo.get("atchYn") == "Y") {
				chk_atchAuthYn.setValue("Y");
			}
			if(dst_LginAuthInqrVo.get("gAYn") == "Y") {
				chk_gAAuthYn.setValue("Y");
			}

   		}else{
   			chk_superAuthYn.setDisabled(true);
   			chk_drctMangAuthYn.setDisabled(true);
   			chk_crossAuthYn.setDisabled(true);
   			chk_atchAuthYn.setDisabled(true);
   			chk_gAAuthYn.setDisabled(true);
   			
	   		chk_superAuthYn.setStyle("display" , "none");
			chk_drctMangAuthYn.setStyle("display" , "none");
	   		chk_crossAuthYn.setStyle("display" , "none");
	   		chk_atchAuthYn.setStyle("display" , "none");
			chk_gAAuthYn.setStyle("display" , "none");  
			
			if(dst_LginAuthInqrVo.get("drctMangYn") == "Y") {
				chk_drctMangAuthYn.setValue("Y");
				chk_drctMangAuthYn.setStyle("display" , "");
			}
			if(dst_LginAuthInqrVo.get("crossYn") == "Y") {
				chk_crossAuthYn.setValue("Y");
				chk_crossAuthYn.setStyle("display" , "");
			}
			if(dst_LginAuthInqrVo.get("atchYn") == "Y") {
				chk_atchAuthYn.setValue("Y");
				chk_atchAuthYn.setStyle("display" , "");
			}
			if(dst_LginAuthInqrVo.get("gAYn") == "Y") {
				chk_gAAuthYn.setValue("Y");
				chk_gAAuthYn.setStyle("display" , "");
			}   		
   		}
	
		// 공지한사번과 로그인사번이 동일하면 수정, 삭제가능.
		// 수퍼권한자는 수정, 삭제가능.		
		var authYn = "N";
		//기존자료 조회인 경우,
		if(!util.isNull(gNoticMattId)){		
			if(dst_LginAuthInqrVo.get("bizAdmrYn") == "Y"){
				authYn = "Y"
			}			
			if(gUserID == dst_NotcMattInfoVo.get("rgtrEmpNo")){
				authYn = "Y"
			}		
		
		//신규자료 등록인 경우,
		}else{
			authYn = "Y"
		}
						
		//공지사항 수정, 삭제 불가의 경우.
	    if(authYn == "N"){	    	  
	    
	   		// 기존자료 등록 
	   		// 기존 자료값 활동자료구분 비활성 
	   		sel_noticMattFlag.setDisabled(true);
	   		// 활동자료명 비활성 
	   		ib_noticMattName.setDisabled(true);
	   		// 내용 비활성 
	   		ta_noticMattCont.setDisabled(true);
	   		// 첨부서류 비활성 
	   		SingleFileUploadText.setDisabled(true);
	   		SingleFileUploadComponent.setDisabled(true);
	   		// 등록자 
	   		ib_rgtrEmp.setDisabled(true);
	    	// 등록일자  
	    	ib_rgstDate.setDisabled(true);
	    	//게시시작일자
			ic_noticDate.setDisabled(true);
			//게시종료일자
			ic_noticEnddt.setDisabled(true);	    	
	   		// 등록버튼 비활성화
	 		btn_save.setDisabled(true); 
	 		// 삭제버튼 비활성화 			 
	 		btn_delete.setDisabled(true);	 		 	
    	
    		
		//공지사항 수정, 삭제 가능의 경우.
	    }else{
	    	// 신규 자료 등록시, 
 			// 등록자, 등록일자는 로그인자 사번 및 현재일자 SETTING 비활성화.   	
	    	// 등록자 : 로그인자 이름(사번) 세팅     	
	    	//ib_rgtrEmp.setValue(gUserEmpName + "(" + gUserID + ")");
	    	// 등록일자 : 현재일자 세팅 
	    	ib_rgstDate.setValue(gsSysDate);	    	
	   		// 등록자 
	   		ib_rgtrEmp.setDisabled(true);
	    	// 등록일자  
	    	ib_rgstDate.setDisabled(true);
	    	//게시시작일자
			ic_noticDate.setDisabled(false);
			//게시종료일자
			ic_noticEnddt.setDisabled(false);
	    	
	    	// 활동자료구분 활성 
	   		sel_noticMattFlag.setDisabled(false);
	   		// 활동자료명 활성 
	   		ib_noticMattName.setDisabled(false);
	   		// 내용 비활성 
	   		ta_noticMattCont.setDisabled(false);
	   		// 첨부서류 비활성 
	   		SingleFileUploadText.setDisabled(false);
	   		SingleFileUploadComponent.setDisabled(false);
	    	
 			// 등록버튼 활성화.
	 		btn_save.setDisabled(false); 
 			// 삭제버튼 비활성화.
 			btn_delete.setDisabled(false); 				 			 
	    }
	};
	
	//**********************************************************
	// 게시조직 전체 체크박스 뷰체인지이벤트 발생 
	//**********************************************************
	scwin.chk_superAuthYn_onviewchange = function(info) {
		// 전체 클릭시, 직영, 교차, 전속, GA모두 비활성화 및 체크
		if(info.checked){
			chk_drctMangAuthYn.setDisabled(true);
   			chk_crossAuthYn.setDisabled(true);
   			chk_atchAuthYn.setDisabled(true);
   			chk_gAAuthYn.setDisabled(true);
   			
  			chk_drctMangAuthYn.setValue("Y");
   			chk_crossAuthYn.setValue("Y");
   			chk_atchAuthYn.setValue("Y");
   			chk_gAAuthYn.setValue("Y");
		}
		else{
			 //전체 클릭이 안된경우,직영, 교차, 전속,GA 활성화.
			chk_drctMangAuthYn.setDisabled(false);
   			chk_crossAuthYn.setDisabled(false);
   			chk_atchAuthYn.setDisabled(false);
   			chk_gAAuthYn.setDisabled(false);
   			
   			chk_drctMangAuthYn.setValue("");
   			chk_crossAuthYn.setValue("");
   			chk_atchAuthYn.setValue("");
   			chk_gAAuthYn.setValue("");  			
		}
		
	};
	
		
	//**********************************************************
	// 공지사항조회데이터로 화면 세팅
	//**********************************************************
	scwin.setNotcMattAdm = function() {
		// 첨부서류는 첨부 다운로드 가능 및 활성화. 나머지 조회 값은 비활성화
		// 공지사항구분 
		sel_noticMattFlag.setValue(dst_NotcMattInfoVo.get("noticMattFlag"));
		// 공지사항명 
		ib_noticMattName.setValue(dst_NotcMattInfoVo.get("noticMattName"));
		// 공지사항내용
		ta_noticMattCont.setValue(dst_NotcMattInfoVo.get("noticMattCont"));
		// 첨부파일		
		SingleFileUploadText.setValue(dst_NotcMattInfoVo.get("apdxFileName"));
		ggelementId = dst_NotcMattInfoVo.get("apdxFilePath"); 
		ggfileName = dst_NotcMattInfoVo.get("apdxFileName");		
		
		// 게시조직
		// 직영권한여부 Y/N 
		chk_drctMangAuthYn.setValue(dst_NotcMattInfoVo.get("drctMangAuthYn"));
   		chk_crossAuthYn.setValue(dst_NotcMattInfoVo.get("crossAuthYn"));
   		chk_atchAuthYn.setValue(dst_NotcMattInfoVo.get("atchAuthYn"));
   		chk_gAAuthYn.setValue(dst_NotcMattInfoVo.get("gAAuthYn"));
	
		// 등록자이름(등록자사번)  
		var rgstEmpInfo = dst_NotcMattInfoVo.get("rgtrEmpNm") + "(" + dst_NotcMattInfoVo.get("rgtrEmpNo") + ")";  	
    	ib_rgtrEmp.setValue(rgstEmpInfo);
    	console.log("ib_rgtrEmp:"+ib_rgtrEmp.getValue());
    	
    	// 등록일자 
    	ib_rgstDate.setValue(dst_NotcMattInfoVo.get("rgstDate"));
    	
    	ic_noticDate.setValue(dst_NotcMattInfoVo.get("noticDate"));		//게시시작일자
    	ic_noticEnddt.setValue(dst_NotcMattInfoVo.get("noticEnddt"));	//게시종료일자
    	
		// 삭제버튼: 로그인사번과 등록사번이 동일 한 경우,
      	// BUT LginAuthInqrVo.bizAdmrYn "Y"인경우 삭제 가능.	
      	if(gUserID == dst_NotcMattInfoVo.get("rgtrEmpNo")) {
	 		btn_delete.setDisabled(false);
    	}
    	else if(dst_LginAuthInqrVo.get("bizAdmrYn") == "Y") { 	
    		btn_delete.setDisabled(false);
    	}
    	else {
    		btn_delete.setDisabled(true);
    	}
    	
    	//게시조직 권한 컨트롤 설정
    	scwin.setCtrlByAuth();
    	
	};
	
	//**********************************************************
	// 등록 버튼 클릭이벤트 
	//**********************************************************
	scwin.btn_save_onclick = function() {			
		
		console.log("******제목byte:"+wconv.lengthb(ib_noticMattName.getValue())+"/제목length:"+wconv.length(ib_noticMattName.getValue()));
		console.log("******내용byte:"+wconv.lengthb(ta_noticMattCont.getValue())+"/내용length:"+wconv.length(ta_noticMattCont.getValue()));
		
		//첨부파일이 있는 경우 ggfileName
		if(SingleFileUploadText.getValue() != null
			&& SingleFileUploadText.getValue().trim() != ""
			&& SingleFileUploadComponent.getFileCount()>0){
			//첨부파일업로드 후, 내용저장.
			util.startSingleFileUpload(SingleFileUploadComponent, "support");	   	
		
		//첨부하일이 없는 경우
		}else{	
			// /common/CBSO0011.do 공지사항등록
			scwin.rgstNotcMattData();	
		}		
	};
	
	//**********************************************************
	// 삭제 버튼 클릭이벤트 
	//**********************************************************
	scwin.btn_delete_onclick = function() {
		///common/CBSO0013.do 공지사항삭제	
		scwin.modifyNotcMattDeleteYn();
	};
	
	//**********************************************************
	// 파일업로드 완료후 CALLBACK 
	//**********************************************************
	scwin.fileUploadCallback = function(status, upCompId, UpFileCount, UpFileInfo) {		
		switch (status) {
			case "SUCCESS" :
				console.log("upCompId : " + upCompId);
				console.log("UpFileCount : " + UpFileCount);
				console.log("UpFileCount : ");
				console.log(UpFileInfo);
				console.log("elementId : " + UpFileInfo[0].elementId);
				
				ggelementId = UpFileInfo[0].elementId;
				ggfileName  = UpFileInfo[0].fileName;
								
				// /common/CBSO0011.do 공지사항등록
				scwin.rgstNotcMattData();	
				
				break;
			case "ERROR" :
				alert("파일 업로드 실패");
				return;
				break;
		}			
	};

	//**********************************************************
	// 첨부파일업로드 초기화
	//**********************************************************
	scwin.fileUploadInit = function() {	
	
		var info = {};
		info = {
			 "uploadObj"  : SingleFileUploadComponent  //UPLOAD Component ID
			,"uploadText" : SingleFileUploadText       //파일명표시 InputBox ID
			,"maxsize"    : 1                          //첨부파일 최대 크기 (MB)
			,"callback"   : "scwin.fileUploadCallback"
		};
		util.setSingleFileUploadInit(info);
	}
	

	
	//**********************************************************
	// 첨부파일다운로드
	//**********************************************************
	scwin.SingleFileUploadText_onclick = function(e) {
		if(!util.isNull(SingleFileUploadText.getValue())
			&& SingleFileUploadText.getValue().trim()!= ""){
			util.fileDownload(ggelementId, ggfileName);
		}
	};
	
	//**********************************************************
	// 첨부파일삭제
	//**********************************************************
	scwin.btn_fileDel_onclick = function() {
		ggelementId = "";
		ggfileName  = "";
		SingleFileUploadText.setValue("");		
	};
	
	//**********************************************************
	// 닫기
	//**********************************************************
	scwin.btn_close_onclick = function() {
		var returnMsg = "I";
             	if (wprom.isPopup()){
        	wprom.close(returnMsg);
        }	
	};
	]]></script>
	</head>
	<body>
		<xf:group class="contentWrap layer" id="" style="">

			<!-- group:s -->
	    	<xf:group id="" style="" class="section">
	    		<xf:group id="" style="" class="defaultbox">
	    			<w2:textbox label="" id="txt_popupTitle"
	    				style="position: relative;width: 150px;height: 23px;" class="df_tt fl">
	    			</w2:textbox>
	    			<xf:group id="" style="" class="fr">
	    				<w2:anchor id="btn_save" ev:onclick="scwin.btn_save_onclick" class="btn_nml"
	    					outerDiv="true">
	    					<xf:label><![CDATA[등록]]></xf:label>
	    				</w2:anchor>
	    				<w2:anchor id="btn_delete" ev:onclick="scwin.btn_delete_onclick" class="btn_nml"
	    					outerDiv="true">
	    					<xf:label><![CDATA[삭제]]></xf:label>
	    				</w2:anchor>
	    				<w2:anchor class="btn_nml" ev:onclick="scwin.btn_close_onclick" id="btn_close"
	    					outerDiv="true" style="">
	    					<xf:label><![CDATA[닫기]]></xf:label>
	    				</w2:anchor>
	    			</xf:group>
	    		</xf:group>
	    		<xf:group id="" style="" class="w2tb tb" tagname="table">
					<w2:attributes>
						<w2:summary></w2:summary>
					</w2:attributes>
					<xf:group tagname="colgroup">
						<xf:group style="width:80.00px;" tagname="col"></xf:group>
						<xf:group style="width:300.00px;" tagname="col"></xf:group>
						<xf:group style="width:80.00px;" tagname="col"></xf:group>
						<xf:group style="" tagname="col"></xf:group>
					</xf:group>
					<xf:group style="" tagname="tr">
						<xf:group style="" class="w2tb_th" tagname="th">공지ID</xf:group>
						<xf:group style="" class="w2tb_td" tagname="td">
							<w2:textbox id="tb_noticMattId" label="" style="" tagname="span"></w2:textbox>
						</xf:group>
						<xf:group class="w2tb_th" tagname="th">공지구분</xf:group>
						<xf:group class="w2tb_td" tagname="td">
							<xf:select1
								disabledClass="w2selectbox_disabled" appearance="minimal"
								direction="auto" chooseOption="true" id="sel_noticMattFlag"
								style="position: relative;width: 148px;height: 21px;"
								displayMode="label" selectedData="true" optionOrder="false"
								allOption="" disabled="false" submenuSize="auto"
								chooseOptionLabel="- 전체 -">
								<xf:choices>
									<xf:itemset
										nodeset="data:dsl_noticMattFlag">
										<xf:label ref="TEXT"></xf:label>
										<xf:value ref="CODE"></xf:value>
									</xf:itemset>
								</xf:choices>
							</xf:select1>
						</xf:group>
					</xf:group>
					<xf:group style="" tagname="tr">
						<xf:group style="" class="w2tb_th" tagname="th">게시기간</xf:group>
						<xf:group style="" class="w2tb_td" tagname="td">
							<w2:attributes>
								<w2:colspan>3</w2:colspan>
								<w2:rowspan>1</w2:rowspan>
							</w2:attributes>
							<xf:group class="" style="">
								<w2:inputCalendar calendarValueType="yearMonthDate" focusOnDateSelect="false" footerDiv="false" id="ic_noticDate" renderDiv="true" renderType="component" rightAlign="false"
									style="width:100px" weekStartsOn="0">
								</w2:inputCalendar>
								<w2:textbox class="txt_bw" id="" label="~" tagname="span"></w2:textbox>
								<w2:inputCalendar calendarValueType="yearMonthDate" focusOnDateSelect="false" footerDiv="false" id="ic_noticEnddt" renderDiv="true" renderType="component" rightAlign="false"
									style="width:100px" weekStartsOn="0">
								</w2:inputCalendar>
							</xf:group>
						</xf:group>
					</xf:group>
					<xf:group style="" tagname="tr">
						<xf:group style="" class="w2tb_th" tagname="th">제목</xf:group>
						<xf:group style="" class="w2tb_td" tagname="td">
							<w2:attributes>
								<w2:colspan>3</w2:colspan>
								<w2:rowspan>1</w2:rowspan>
							</w2:attributes>
							<xf:input id="ib_noticMattName" style="" maxByteLength="" maxlength="40"></xf:input>
						</xf:group>
					</xf:group>
					<xf:group style="" tagname="tr">
						<xf:group style="" class="w2tb_th" tagname="th">내용</xf:group>
						<xf:group style="" class="w2tb_td" tagname="td"><w2:attributes><w2:colspan>3</w2:colspan><w2:rowspan>1</w2:rowspan></w2:attributes>
							<xf:textarea id="ta_noticMattCont" style="height: 100px;" maxByteLength="" maxlength="1800"/>
						</xf:group>
					</xf:group>
					<xf:group style="" tagname="tr">
						<xf:group style="" class="w2tb_th"
							tagname="th">
							첨부서류
						</xf:group>
						<xf:group style="" class="w2tb_td"
							tagname="td">
							<xf:group class="" id=""
								style="position: relative ;width:230px;height:20px;">
								<xf:group class="" id=""
									style="position: absolute ;left: 0px;top: 0px;right : 50px;height:100%;">
									<xf:input id="SingleFileUploadText"
										readOnly="true"
										style="position: absolute;width: 100%;height: 100%;"
										ev:onchange="" ev:onfocus="scwin.SingleFileUploadText_onfocus"
										ev:onclick="scwin.SingleFileUploadText_onclick">
									</xf:input>
								</xf:group>
								<xf:group class="" id=""
									style="position: absolute ;right:0px;top: 0px;width: 50px;height: 100%;">
									<w2:anchor class="btn_nml"
										ev:onclick="scwin.trigger1_onclick"
										id="SingleFileUploadButton"
										style="position: absolute;width: 100%;height: 100%;"
										type="">
										<xf:label><![CDATA[첨부]]></xf:label>
									</w2:anchor>
									<w2:multiupload action=""
										ev:onComplete="" ev:ondone="util._setSingleFileCallback"
										ev:onerror="" filter="*:*.*" fireEventOnError=""
										id="SingleFileUploadComponent" maxcount="" maxsize="10000"
										mode="html5_transparent" selectCallback=""
										style="position: absolute;width: 100%;height: 100%;"
										uploadButton="true" wmode="false">
									</w2:multiupload>

								</xf:group>
							</xf:group>
							<w2:anchor class="btn_nml"
								ev:onclick="scwin.btn_fileDel_onclick" id="btn_fileDel" outerDiv="true"
								style="margin-top:-20px;margin-left:233px;">
								<xf:label><![CDATA[삭제]]></xf:label>
							</w2:anchor>
						</xf:group>

						<xf:group class="w2tb_th" tagname="th">
							공지조직
						</xf:group>
						<xf:group class="w2tb_td" tagname="td">
							<xf:select appearance="full" class="ml0"
								cols="" disabled="true" ev:oncheckboxclick=""
								ev:onviewchange="scwin.chk_superAuthYn_onviewchange"
								id="chk_superAuthYn" ref="" rows="1" selectedindex="-1"
								style="">
								<xf:choices>
									<xf:item>
										<xf:label><![CDATA[전체]]></xf:label>
										<xf:value><![CDATA[Y]]></xf:value>
									</xf:item>
								</xf:choices>
							</xf:select>
							<xf:select appearance="full" class="ml0"
								cols="" disabled="true" id="chk_drctMangAuthYn" ref="" rows="1"
								selectedindex="-1" style="margin-left:1px;">
								<xf:choices>
									<xf:item>
										<xf:label><![CDATA[직영]]></xf:label>
										<xf:value><![CDATA[Y]]></xf:value>
									</xf:item>
								</xf:choices>
							</xf:select>
							<xf:select appearance="full" class="ml0"
								cols="" disabled="true" id="chk_crossAuthYn" ref="" rows="1"
								selectedindex="-1" style="margin-left:1px;">
								<xf:choices>
									<xf:item>
										<xf:label><![CDATA[교차]]></xf:label>
										<xf:value><![CDATA[Y]]></xf:value>
									</xf:item>
								</xf:choices>
							</xf:select>
							<xf:select appearance="full" class="ml0"
								cols="" disabled="true" id="chk_atchAuthYn" ref="" rows="1"
								selectedindex="-1" style="margin-left:1px;">
								<xf:choices>
									<xf:item>
										<xf:label><![CDATA[전속]]></xf:label>
										<xf:value><![CDATA[Y]]></xf:value>
									</xf:item>
								</xf:choices>
							</xf:select>
							<xf:select appearance="full" class="ml0"
								cols="" disabled="true" id="chk_gAAuthYn" ref="" rows="1"
								selectedindex="-1" style="margin-left:1px;">
								<xf:choices>
									<xf:item>
										<xf:label><![CDATA[GA]]></xf:label>
										<xf:value><![CDATA[Y]]></xf:value>
									</xf:item>
								</xf:choices>
							</xf:select>
						</xf:group>
					</xf:group>
					<xf:group style="" tagname="tr">
						<xf:group style="" class="w2tb_th" tagname="th">등록자</xf:group>
						<xf:group style="" class="w2tb_td" tagname="td">
							<w2:textbox id="ib_rgtrEmp" label="" style="" tagname="span"></w2:textbox>
						</xf:group>
						<xf:group class="w2tb_th" tagname="th">등록일자</xf:group>
						<xf:group class="w2tb_td" tagname="td">
							<w2:textbox id="ib_rgstDate" label="" style="" tagname="span"></w2:textbox>
						</xf:group>
					</xf:group>
				</xf:group>
			</xf:group>
			<!-- group:e -->
			
			<!-- group:s -->
			<!-- group:e -->
			
		</xf:group>
	</body>
</html>