<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="/cm/css/all.css" type="text/css"?>
<?xml-stylesheet href="/cm/css/convert.css" type="text/css"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head>
    <!-- 
        ###################################################
         파일명 : CBSO015P.xml
         프로그램명 : 사원찾기
         설 명 :  사원정보찾기
         작성자 : 이경일
         작성일 : 2017.09.06
 
         수정일자            수정자                  수정내용
        ==================================================
        2017.09.06        이경일          최초작성
        ###################################################
     -->
        <w2:type>DEFAULT</w2:type>
        <w2:buildDate></w2:buildDate>
        <xf:model>
            <xf:instance>
                <data></data>
            </xf:instance>
            <w2:dataCollection>
                <w2:dataList baseNode="list" id="Ds_Condi" repeatNode="map">
                    <w2:columnInfo>
                        <w2:column dataType="text" id="sIndex" name="sIndex"></w2:column>
                        <w2:column dataType="text" id="sValue" name="sValue"></w2:column>
                    </w2:columnInfo>
                    <w2:data use="true">
                        <w2:row>
                            <sIndex><![CDATA[01]]></sIndex>
                            <sValue><![CDATA[사원명]]></sValue>
                        </w2:row>
                        <w2:row>
                            <sIndex><![CDATA[02]]></sIndex>
                            <sValue><![CDATA[조직별]]></sValue>
                        </w2:row>
                    </w2:data>
                </w2:dataList>
                <w2:dataList baseNode="list" id="Ds_Duty" repeatNode="map">
                    <w2:columnInfo>
                        <w2:column dataType="text" id="CODE" name="CODE"></w2:column>
                        <w2:column dataType="text" id="TEXT" name="TEXT"></w2:column>
                    </w2:columnInfo>
                    <w2:data use="true">
                        <w2:row>
                            <CODE></CODE>
                            <TEXT><![CDATA[-선택-]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[01]]></CODE>
                            <TEXT><![CDATA[사장]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[02]]></CODE>
                            <TEXT><![CDATA[임원]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[03]]></CODE>
                            <TEXT><![CDATA[센터장]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[04]]></CODE>
                            <TEXT><![CDATA[팀장]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[20]]></CODE>
                            <TEXT><![CDATA[교육실장]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[22]]></CODE>
                            <TEXT><![CDATA[지원실장]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[21]]></CODE>
                            <TEXT><![CDATA[교육]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[05]]></CODE>
                            <TEXT><![CDATA[SV]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[06]]></CODE>
                            <TEXT><![CDATA[LQAD]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[07]]></CODE>
                            <TEXT><![CDATA[QAD]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[08]]></CODE>
                            <TEXT><![CDATA[교육]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[09]]></CODE>
                            <TEXT><![CDATA[사원]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[11]]></CODE>
                            <TEXT><![CDATA[센터실장]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[12]]></CODE>
                            <TEXT><![CDATA[TSR]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[13]]></CODE>
                            <TEXT><![CDATA[CSR]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[14]]></CODE>
                            <TEXT><![CDATA[ASR]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[15]]></CODE>
                            <TEXT><![CDATA[WSR]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[16]]></CODE>
                            <TEXT><![CDATA[TSR P.L]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[17]]></CODE>
                            <TEXT><![CDATA[CSR P.L]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[18]]></CODE>
                            <TEXT><![CDATA[ASR P.L]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[19]]></CODE>
                            <TEXT><![CDATA[법인전담]]></TEXT>
                        </w2:row>
                    </w2:data>
                </w2:dataList>
                <w2:dataList baseNode="list" id="Ds_Position" repeatNode="map">
                    <w2:columnInfo>
                        <w2:column dataType="text" id="CODE" name="CODE"></w2:column>
                        <w2:column dataType="text" id="TEXT" name="TEXT"></w2:column>
                    </w2:columnInfo>
                    <w2:data use="true">
                        <w2:row>
                            <CODE></CODE>
                            <TEXT><![CDATA[-선택-]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[05]]></CODE>
                            <TEXT><![CDATA[임원]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[10]]></CODE>
                            <TEXT><![CDATA[1급(부장)]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[15]]></CODE>
                            <TEXT><![CDATA[2급(차장)]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[20]]></CODE>
                            <TEXT><![CDATA[3급(과장)]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[25]]></CODE>
                            <TEXT><![CDATA[4급(대리)]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[30]]></CODE>
                            <TEXT><![CDATA[5급(사원)]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[35]]></CODE>
                            <TEXT><![CDATA[6급(사원)]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[40]]></CODE>
                            <TEXT><![CDATA[7급(사원)]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[45]]></CODE>
                            <TEXT><![CDATA[전문상담직]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[50]]></CODE>
                            <TEXT><![CDATA[기타]]></TEXT>
                        </w2:row>
                    </w2:data>
                </w2:dataList>
                <w2:dataList baseNode="list" id="DsWs_TotCnt"
                	keyNode="//*/vector" repeatNode="map">
                	<w2:columnInfo>
                		<w2:column id="result" name="name1"
                			dataType="text">
                		</w2:column>
                		<w2:column id="totalRows" name="name2"
                			dataType="text">
                		</w2:column>
                		<w2:column id="currPage" name="name3"
                			dataType="text">
                		</w2:column>
                		<w2:column id="afterEJBCall" name="name4"
                			dataType="text">
                		</w2:column>
                		<w2:column id="beforeEJBCall" name="name5"
                			dataType="text">
                		</w2:column>
                		<w2:column id="pageSize" name="name6"
                			dataType="text">
                		</w2:column>
                	</w2:columnInfo>
                </w2:dataList>
                <w2:dataList baseNode="list" id="DsWs_Search_ADMAB01"
                	keyNode="//*/vector/data/ADMAB01" repeatNode="map">
                	<w2:columnInfo>
                		<w2:column id="sResignDate" name="name1"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sRecmdEmpNo" name="name2"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sPositionName" name="name3"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sAdrs3" name="name4"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sAdrs2" name="name5"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sAdrs1" name="name6"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sUpperName" name="name7"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sBirthDate" name="name8"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sOfficeTel2" name="name9"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sOfficeTel3" name="name10"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sEmpNo" name="name11"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sOfficeTel1" name="name12"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sSalesChannel" name="name13"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sUserID" name="name14"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sDepartName" name="name15"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sMajor" name="name16"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sPosition" name="name17"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sReligion" name="name18"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sBirthDateType" name="name19"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sMarryYN" name="name20"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sFaxNum" name="name21"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCompNm" name="name22"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sSchool" name="name23"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sEndDate" name="name24"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sManageEmpName" name="name25"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sEmail" name="name26"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sManageEmpNo" name="name27"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sDutyName" name="name28"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sIPAddress" name="name29"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInnerPhone" name="name30"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sEmpName" name="name31"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sJoiningDate" name="name32"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sSpeciality" name="name33"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sPwd" name="name34"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sZip2" name="name35"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sFax2" name="name36"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sDuty" name="name37"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sFax3" name="name38"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sAdrsAdd" name="name39"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sZip1" name="name40"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sFax1" name="name41"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sRegistrationNo" name="name42"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sRecmdEmpName" name="name43"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sHomeTel2" name="name44"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sHomeTel1" name="name45"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sOddNumber" name="name46"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sHomeTel3" name="name47"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInputDate" name="name48"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sEnterDate" name="name49"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sScholarship" name="name50"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCellPhone3" name="name51"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCellPhone1" name="name52"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCellPhone2" name="name53"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sDepartCode" name="name54"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sGraduteDate" name="name55"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInputUser" name="name56"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sRecmdEmpDptName" name="name57"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sApplyDate" name="name58"
                			dataType="text">
                		</w2:column>
                	</w2:columnInfo>
                </w2:dataList>
                <w2:dataList baseNode="list" id="Ds_Search_ADMAC01"
                	keyNode="//*/vector/data/ADMAC01" repeatNode="map">
                	<w2:columnInfo>
                		<w2:column id="sOpenDate" name="name1"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCloseYN" name="name2"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sLevel" name="name3"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sAcctUnit" name="name4"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sDepartName" name="name5"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sDepartCode" name="name6"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sUpperCode" name="name7"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sDepartType" name="name8"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCloseDate" name="name9"
                			dataType="text">
                		</w2:column>
                	</w2:columnInfo>
                </w2:dataList>
                <w2:dataList baseNode="list" id="DsWs_SearchWarning" keyNode="//*/WARNING" repeatNode="map"></w2:dataList>
            </w2:dataCollection>
            <w2:workflowCollection></w2:workflowCollection>
        </xf:model>
        <script src="/cm/js/common.js"/>
		<script src="/cm/js/val_lib.js"/>
		<script src="/cm/js/util.js"/>
		<script src="/cm/js/transSub.js"/>
		<script src="/cm/js/callService.js"/>
		<script src="/cm/js/gds.js"/>
		<script src="/cm/js/wconv.js"/>
 		<script src="/cm/js/wprom.js"/>
		<script src="/cm/js/convertJs/Global_Script.js"/>
		<script src="/cm/js/convertJs/comm_Webservice.js"/>
        <script><![CDATA[
/*■■■■■■■■■■■■■■■■■■■■■스크립트 변환 결과■■■■■■■■■■■■■■■■■■■■■
※본 주석은 수작업 변환 참고용입니다. ★개발완료 후에는 필히 삭제해주세요.★
변환시간:  Fri Sep 01 2017 14:10:41 GMT+0900 (대한민국 표준시)
파일ID:  R960_Pop.xml

아래의 작업을 먼저 해주세요.


1. scwin.init() 함수에 아래의 글로벌 데이터리스트를 선언합니다.
gds.gDsWs_getTeam();

2. 공통.JS 파일을 include해주세요.
</xf:model>
 ***include 위치(하단에 주석처리 되어 있습니다.)***
<script><![CDATA[

예시)
</xf:model>
<script src="/cm/js/convertJs/예시입니다.js"/>
<script src="/cm/js/convertJs/예시입니다.js"/>
<script src="/cm/js/convertJs/예시입니다.js"/>
<script><![CDATA[

3. 표준에 어긋난 코딩인 경우 ✖ 으로 return 되어 있습니다. 검색으로 ✖이 나온다면 ASIS 소스를 확인해주세요.
ex) ASIS if(a = 1 and b = 2) {} ------> TOBE if (✖ = 2) {}

4. dialog함수로 팝업을 호출 할 경우에는 실제 파일이 있는 경로로 변경해주세요
ex) 현재 PROJECT_PATH_TEMP입니다. 

-호출구조-

호출구조는 모든 화면이 아닌 변환대상화면을 기준으로 분석하였습니다.
선언하지 않은 변수를 사용중이라면 caller 에서 넘겼을 가능성이 높습니다.
파일 ID는 소스의 form ID로 가정했습니다. 아래의 결과는 따로 확인해주세요.
R960_Pop.xml에서 호출 (callee ID):  0120
R960_Pop.xml을 호출   (caller ID):  F010,D010,D011_Pop,D720,B120,B160,B240,O310,O320,P600,P620,Q010,Q030,P020
■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■*/
/****************************************************************************
 * 프로그램번호   : R960_Pop
 * 프로그램명     : 취급자찾기
 * 파일명         : R960_Pop.xml
 * 프로그램 내용  : 취급자찾기
 * 관련 프로그램  : 
 * 작성자         : 김중한
 * 작성일         : 2010-10-04
 * 저작권         : Copyright ⓒ 2004. the K 손해보험㈜. All Right Reserved.
 * 변경내역       : 
 ****************************************************************************/
// <script src="/cm/js/common.js"/>
// <script src="/cm/js/val_lib.js"/>
// <script src="/cm/js/util.js"/>
// <script src="/cm/js/transSub.js"/>
// <script src="/cm/js/callService.js"/>
// <script src="/cm/js/gds.js"/>
// <script src="/cm/js/convertJs/conv.js"/>
// <script src="/cm/js/convertJs/Global_Script.js"/>
// <script src="/cm/js/convertJs/comm_Webservice.js"/>
//---------------------------------------------------------------------------
// function 명 : lfn_OnLoadCompleted
// 내용        : 폼로드할때 처리할 내용 
//---------------------------------------------------------------------------
scwin.init = function() {
    edit_empName.show();
    Div0.hide();
    edit_empName.focus();
};

//---------------------------------------------------------------------------
// function 명 : lfn_Btn_Search_OnClick
// 내용        : 조회버튼 Event처리
//---------------------------------------------------------------------------
scwin.lfn_Btn_Search_OnClick_async = function(obj) {
	util.eventAsyncCall(this, scwin.lfn_Btn_Search_OnClick, arguments);
}
scwin.lfn_Btn_Search_OnClick = function(obj) {
    var rst = scwin.Search("1");
    if (rst == false) {
        return;
    }

	gfn_MakePagingData(Ds_Page, DsWs_TotCnt.getCellData(0, "totalRows"), "10", "10");
    Cmb_Page.setValue("1"); //----- End
};

//---------------------------------------------------------------------------
// function 명 : Search
// 내용        : 조회
//---------------------------------------------------------------------------
scwin.Search = function(pageNo) {

	wconv.clear(DsWs_Search_ADMAB01);
	wconv.clear(DsWs_SearchWarning);
	wconv.clear(DsWs_TotCnt);

	var transCall;
	if (cmb_Condi.getSelectedIndex() == 0) {
		transCall = new callService("com.inswave.admin.task.AdminTask", "getAllEmployee", "10", pageNo);
		transCall.setParam("sEmpName", wconv.trim(edit_empName.getValue()));
	} else if (cmb_Condi.getSelectedIndex() == 1) {
		transCall = new callService("com.inswave.admin.task.AdminTask", "getEmployeeByDepart", "10", pageNo);
		transCall.setParam("sDepartCode", wconv.trim(Div0_edit_deptCode.getValue()));
	}
	transCall.setUrl("/common/CBSO015PController.do");
	transCall.setId("transCall");
	transCall.setXPath("//*/vector");
	transCall.addXPath("//*/vector/data/ADMAB01");
	//transCall.addXPath("//*/vector/data/ADMAC01");
	transCall.addXPath("//*/WARNING");
	//transCall.callBack("scwin.subCallBackfunction");
	transCall.sync();
	transCall.send();
	//util.interfaceKey(_tranSync.result.serviceDs);
	
	DsWs_Search_ADMAB01.setJSON(_tranSync.getDsJson("ADMAB01"));
	DsWs_SearchWarning.setJSON(_tranSync.getDsJson("WARNING"));
	DsWs_TotCnt.setJSON(_tranSync.getDsJson("vector"));

	if (DsWs_SearchWarning.getRowCount() != 0) {
        wprom.alert(DsWs_SearchWarning.getCellData(0, "msg"));
        return false;
    }
    if (DsWs_Search_ADMAB01.getRowCount() > 0) {
    	util.setRowPosition(DsWs_Search_ADMAB01, 0);
    }
    return true;
};

//---------------------------------------------------------------------------
// function 명 : lfn_getJojik
// 내용        : 조직코드에 해당하는 하위 조직 조회
//---------------------------------------------------------------------------
scwin.lfn_getJojik = function() {

	var transCall;
	transCall = new callService("com.inswave.longterm.com.com.task.AXR970Task", "getDepartName", "", "");
	transCall.setParam("sDepartCode", wconv.trim(Div0_edit_deptCode.getValue()));
	
	transCall.setUrl("/common/CBSO015PController.do");
	transCall.setId("transCall");
	transCall.setXPath("//*/vector/data/ADMAC01");
	transCall.addXPath("//*/WARNING");	
	//transCall.callBack("scwin.subCallBackfunction");
	transCall.sync();
	transCall.send();
	util.interfaceKey(_tranSync.result.serviceDs);

	Ds_Search_ADMAC01.setJSON(_tranSync.getDsJson("ADMAC01"));
	DsWs_SearchWarning.setJSON(_tranSync.getDsJson("WARNING"));
	
	if (DsWs_SearchWarning.getRowCount() != 0) {
        wprom.alert(DsWs_SearchWarning.getCellData(0, "msg"));
        return false;
    }
    
    Div0_edit_deptName.setValue(Ds_Search_ADMAC01.getCellData(0, "sDepartName"));
    
	/*
    wconv.clear(DsWs_SearchWarning);
    wconv.clear(gds.gDsWs_getTeam);
    gSOBJ_getTeam.WSDL = gds.gWsdlBasis;
    var MethodObj = gfn_CreateMethodObj(gSOBJ_getTeam, "com.inswave.longterm.com.com.task.AXR970Task", "getDepartName", "", "");
    gfn_SetParam(MethodObj, "sDepartCode", Div0_edit_deptCode.getValue());
    gfn_CallService(gSOBJ_getTeam, gDOBJ_getTeam, MethodObj);

    //trace(replace(gfn_XmlEncoder(gDOBJ_getTeam.Value), "><", ">\n<"));
    if (DsWs_SearchWarning.getRowCount() != 0) {
        wprom.alert(DsWs_SearchWarning.getCellData(0, "msg"));
        return false;
    }
    wconv.copy(Ds_Search_ADMAC01, gDsWs_getTeam);
    Div0_edit_deptName.setValue(Ds_Search_ADMAC01.getCellData(0, "sDepartName"));
    */
};

//---------------------------------------------------------------------------
// function 명 : lfn_Ed_KeyWord_OnKeyDown
// 내용        : KeyDown Event처리
//---------------------------------------------------------------------------
scwin.lfn_Ed_KeyWord_OnKeyDown = function(e) {
    if (e.keyCode == 13)
        scwin.lfn_Btn_Search_OnClick();
};

//---------------------------------------------------------------------------
// function 명 : lfn_Ed_KeyWord_OnKeyDown
// 내용        : 닫기버튼 Event처리
//---------------------------------------------------------------------------
scwin.lfn_Btn_Close_OnClick = function(obj) {
    wprom.close("");
};

//---------------------------------------------------------------------------
// function 명 : lfn_cmb_Condi_OnChanged
// 내용        :  조회조건 OnChanged Event처리
//---------------------------------------------------------------------------
scwin.lfn_cmb_Condi_OnChanged = function(info) {
    edit_empName.setValue("");
    Div0_edit_deptCode.setValue("");
    Div0_edit_deptName.setValue("");
    if (cmb_Condi.getSelectedIndex() == 0) {
        edit_empName.show();
        Div0.hide();
        edit_empName.focus();
    } else {
        edit_empName.hide();
        Div0.show();
        Div0_edit_deptCode.focus();
    }
};

//---------------------------------------------------------------------------
// function 명 : lfn_Div0_edit_deptCode_OnCharChanged
// 내용        :  부서코드 OnCharChanged Event처리
//---------------------------------------------------------------------------
scwin.lfn_Div0_edit_deptCode_OnCharChanged = function(e) {

    if (wconv.length(Div0_edit_deptCode.getValue()) != 7) {
		Div0_edit_deptName.setValue("");
    } else if (wconv.length(Div0_edit_deptCode.getValue()) == 7) {
		scwin.lfn_getJojik();
    }
};

//---------------------------------------------------------------------------
// function 명 : Div0_btn_Pop_Search_OnClick
// 내용        :  조직찾기 POPUP
//---------------------------------------------------------------------------
scwin.Div0_btn_Pop_Search_OnClick = function(obj) {
	var pro = Promise.resolve();
	pro = pro.then(function(rv) {
		//팝업창으로 보낼 자료
		//var indata  = {"id" : "ddd", "name" : "ddd"};
		//팜업창 위치
		var popInfo = {
			"width"     : 735,                  //폭    : 생략시 기본값
			"height"    : 492,                  //높이   : 생략시 기본값  
			//"top"       : 20,                   //top   : 생략시 중심
			//"left"      : 20,                   //left  : 생략시 중심
			//"indata"    : indata,             //보낼 자료
			"title"     : "조직찾기"            //팝업창에 표시할 TITLE 명칭 : 생략시 기본값 출력
			//,"callback"  : scwin.popupCallback,  //팝업창 종료시 실행될 callback 함수 특별한경우가 아닌경우 사용하지 말것
		};
		return wprom.popupOpen("/ui/cbso/CBSO020P.xml", popInfo);
	});
	
	pro = pro.then(function(rst) {
        if (wconv.length(rst) != 0) {
            var arrRst = rst.split("^");
            Div0_edit_deptCode.setValue(arrRst[0]);
            Div0_edit_deptName.setValue(arrRst[1]);
        }
    });
};

//---------------------------------------------------------------------------
// function 명 : Grd_List_OnCellClick
// 내용        :  조회된 그리드에서 선택된 조직 메인으로 리턴
//---------------------------------------------------------------------------
scwin.Grd_List_OnCellClick = function(nRow, nCol) {
    var ind = nRow;
    if (ind < 0) return;
    wprom.close(DsWs_Search_ADMAB01.getCellData(ind, "sEmpNo") + "^" + DsWs_Search_ADMAB01.getCellData(ind, "sEmpName"));
};

//**************************************************************************************************
// 페이징 처리 - 페이지 콤보 박스
//**************************************************************************************************
scwin.Cmb_Page_OnChanged = function(info) {
    scwin.Search(info.newValue);
};

//**************************************************************************************************
// 페이징 처리 - 이전 페이지 리스트
//**************************************************************************************************
scwin.Btn_PreV_OnClick = function(obj) {
	var ftVal = wconv.toNumber(Ds_Page.getCellData(0, "FILTERCD")) - 1;
    if (wconv.toNumber(maxFilterVal) < wconv.toNumber(ftVal)) {
        wprom.alert("조회의 처음입니다.");
        return;
    } else if (wconv.toNumber(ftVal) < 1) {
        wprom.alert("조회의 처음입니다.");
        return;
    }
    wconv.filter(Ds_Page, "FILTERCD=='" + ftVal + "'", true);
    Cmb_Page.setValue(Ds_Page.getCellData(0, "CODE"));
    scwin.Search(Cmb_Page.getValue());
};

//**************************************************************************************************
// 페이징 처리 - 이전 페이지
//**************************************************************************************************
scwin.Btn_Pre_OnClick = function(obj) {
	var Idx = Cmb_Page.getValue();
    if (wconv.toNumber(Idx) - 1 < 1) {
        wprom.alert("조회의 처음입니다.");
        return;
    }
    scwin.Search(wconv.toString(wconv.toNumber(Idx) - 1));
    if (Ds_Page.getCellData(0, "CODE") == Idx) {
        wconv.filter(Ds_Page, "FILTERCD=='" + wconv.toString(wconv.toNumber(Ds_Page.getCellData(0, "FILTERCD")) - 1) + "'", true);
        Cmb_Page.setValue(Ds_Page.getCellData((Ds_Page.getRowCount() - 1), "CODE"));
    } else {
        Cmb_Page.setValue(wconv.toNumber(Idx) - 1);
	}
};

//**************************************************************************************************
// 페이징 처리 - 다음 페이지
//**************************************************************************************************
scwin.Btn_Next_OnClick = function(obj) {
	var Idx = Cmb_Page.getValue();
	if (wconv.toNumber(maxPage) < wconv.toNumber(Idx) + 1) {
		wprom.alert("더이상 자료가 존재하지 않습니다");
		return;
	}
	scwin.Search(wconv.toString(wconv.toNumber(Idx) + 1));
	if (Ds_Page.getCellData((Ds_Page.getRowCount() - 1), "CODE") == Idx) {
		wconv.filter(Ds_Page, "FILTERCD=='" + wconv.toString(wconv.toNumber(Ds_Page.getCellData((Ds_Page.getRowCount() - 1), "FILTERCD")) + 1) + "'", true);
	}
	Cmb_Page.setValue(wconv.toNumber(Idx) + 1);
};

//**************************************************************************************************
// 페이징 처리 - 다음 페이지 리스트
//**************************************************************************************************
scwin.Btn_NextV_OnClick = function(obj) {
	var ftVal = wconv.toNumber(Ds_Page.getCellData((Ds_Page.getRowCount() - 1), "FILTERCD")) + 1;
    if (wconv.toNumber(maxFilterVal) < wconv.toNumber(ftVal)) {
        wprom.alert("더이상 자료가 존재하지 않습니다");
        return;
    }
    wconv.filter(Ds_Page, "FILTERCD=='" + ftVal + "'", true);
    Cmb_Page.setValue(Ds_Page.getCellData(0, "CODE"));
    scwin.Search(Cmb_Page.getValue());
};
]]></script>
    </head>
    <body>
    	<xf:group class="cont_wrap layer" id="R960_Pop" style="position:absolute; left:0px; top:0px;" userData1="사원찾기 [R960_Pop]"
    		userData2=" OnLoadCompleted:scwin.lfn_OnLoadCompleted; ">
    		<DataObjects>
    			<DataObject></DataObject>
    		</DataObjects>
    		<ServiceObjects>
    			<ServiceObject></ServiceObject>
    		</ServiceObjects><w2:textbox id="Static5" label="사원찾기" style="position:absolute; VAlign:Middle;  height:20px; left:0px; top:0px; width:197px;" tagname="" class="sub_pop_title01"></w2:textbox>
    		<xf:trigger class="btn_Comm_Search " ev:onclick="scwin.lfn_Btn_Search_OnClick_async" id="btn_search" style="position:absolute;left:550px;top:38px;width:45px;" tabIndex="1" type="anchor">
    			<xf:label><![CDATA[조회]]></xf:label>
    		</xf:trigger>
    		<xf:trigger class="popup_top_btn" ev:onclick="scwin.lfn_Btn_Close_OnClick" id="btn_close" style="position:absolute;left:573px;top:1px;" tabIndex="2" type="anchor">
    			<xf:label><![CDATA[닫기]]></xf:label>
    		</xf:trigger>
    		<xf:switch id="switch_81" style=" ">
    			<xf:case id="Default_82" style=" ">
    				<w2:gridView autoFit="allColumn" autoFitMinWidth="100" class="sty_Grid" dataList="DsWs_Search_ADMAB01" ev:oncellclick="scwin.Grd_List_OnCellClick" focusMode="" id="Grd_List"
    					inputType="text" readOnly="true"
    					style="position:absolute; UseDBuff:true;  InputPanel:FALSE;  EndLineColor:default;  border:Flat;  AutoFitEndLine:Hide;height:270px; left:0px; right:631px;top:101px;width:622px;"
    					tabIndex="6" evenRowBackgroundColor="" rowMouseOverColor="" selectedCellColor="">
    					<w2:header>
    						<w2:row>
    							<w2:column dataType="text" id="head_id_612" inputType="text" readOnly="true" style="height:20px;" textAlign="center" userData1="0" userData3="0" value="사원번호"
    								width="80">
    							</w2:column>
    							<w2:column dataType="text" id="head_id_613" inputType="text" readOnly="true" style="height:20px;" textAlign="center" userData1="1" userData3="0" value="사원명"
    								width="80">
    							</w2:column>
    							<w2:column dataType="text" id="head_id_614" inputType="text" readOnly="true" style="height:20px;" textAlign="center" userData1="2" userData3="0" value="소속"
    								width="140">
    							</w2:column>
    							<w2:column dataType="text" id="head_id_615" inputType="text" readOnly="true" style="height:20px;" textAlign="center" userData1="3" userData3="0" value="직책"
    								width="80">
    							</w2:column>
    							<w2:column dataType="text" id="head_id_616" inputType="text" readOnly="true" style="height:20px;" textAlign="center" userData1="4" userData3="0" value="직급"
    								width="80">
    							</w2:column>
    							<w2:column dataType="text" id="head_id_617" inputType="text" readOnly="true" style="height:20px;" textAlign="center" userData1="5" userData3="0" value="입사일"
    								width="80">
    							</w2:column>
    							<w2:column dataType="text" id="head_id_618" inputType="text" readOnly="true" style="height:20px;" textAlign="center" userData1="6" userData3="0" value="퇴사일"
    								width="80">
    							</w2:column>
    						</w2:row>
    					</w2:header>
    					<w2:gBody>
    						<w2:row>
    							<w2:column dataType="text" id="sEmpNo" inputType="text" readOnly="true" style="height:20px;" textAlign="center" userData1="0" userData3="0" width="80"></w2:column>
    							<w2:column dataType="text" id="sEmpName" inputType="text" readOnly="true" style="height:20px;" textAlign="left" userData1="1" userData3="0" width="80"></w2:column>
    							<w2:column dataType="text" id="sDepartName" inputType="text" readOnly="true" style="height:20px;" textAlign="center" userData1="2" userData3="0" width="140" value=""></w2:column>
    							<w2:column dataType="text" id="sDuty" inputType="select" readOnly="true" style="height:20px;" textAlign="center" userData1="3" userData3="0" width="80">
    								<w2:choices>
    									<w2:itemset nodeset="data:Ds_Duty">
    										<w2:value ref="CODE"></w2:value>
    										<w2:label ref="TEXT"></w2:label>
    									</w2:itemset>
    								</w2:choices>
    							</w2:column>
    							<w2:column dataType="text" id="sPosition" inputType="select" readOnly="true" style="height:20px;" textAlign="center" userData1="4" userData3="0" width="80">
    								<w2:choices>
    									<w2:itemset nodeset="data:Ds_Position">
    										<w2:value ref="CODE"></w2:value>
    										<w2:label ref="TEXT"></w2:label>
    									</w2:itemset>
    								</w2:choices>
    							</w2:column>
    							<w2:column dataType="text" id="sJoiningDate" inputType="text" readOnly="true" style="height:20px;" textAlign="center" userData1="5"
    								userData2=" expr:decode(sJoiningDate, '', 'none', null, 'none','date') ;" userData3="0" width="80" displayFormat="####-##-##">
    							</w2:column>
    							<w2:column dataType="text" id="sResignDate" inputType="text" readOnly="true" style="height:20px;" textAlign="center" userData1="6"
    								userData2=" expr:decode(sResignDate, '', 'none', null, 'none','date') ;" userData3="0" width="80" displayFormat="####-##-##">
    							</w2:column>
    						</w2:row>
    					</w2:gBody>
    				</w2:gridView>
    			</xf:case>
    		</xf:switch>
    		<w2:textbox class="sty_lb_Search" id="Static6" label="조회조건" style="position:absolute; VAlign:Middle; height:20px;left:9px;top:39px; width:68px;" tagname=""></w2:textbox>
    		<xf:select1 appearance="minimal" class="sty_ipt_search" emptyItem="true" ev:onchange="" id="cmb_Condi" ref="data:Ds_Condi.sIndex"
    			style="position:absolute; border-style:solid;  height:20px;left:88px;top:38px; width:96px;" tabIndex="9" renderType="native" ev:onviewchange="scwin.lfn_cmb_Condi_OnChanged">
    			<xf:choices>
    				<xf:itemset nodeset="data:Ds_Condi">
    					<xf:label ref="sValue"></xf:label>
    					<xf:value ref="sIndex"></xf:value>
    				</xf:itemset>
    			</xf:choices>
    		</xf:select1>
    		<xf:input class="sty_ipt_search" ev:onblur="" id="edit_empName"
    			style="position:absolute; ImeMode:native;  border-style:solid;  height:20px;left:190px;top:38px; width:152px;" tabIndex="8" ev:onkeydown="scwin.lfn_Ed_KeyWord_OnKeyDown">
    		</xf:input>
    		<xf:group class="" id="Div0" style="position:absolute; height:20px;left:190px;top:38px; width:298px;" tabIndex="11" userData1="Div0">
    			<xf:input class="sty_ipt_search" dataType="number" ev:onblur="" ev:oneditkeyup="scwin.lfn_Div0_edit_deptCode_OnCharChanged" id="Div0_edit_deptCode"
    				maxlength="7" style="position:absolute; ImeMode:none;  border-style:solid;  height:20px; width:84px;" tabIndex="1" ev:onkeydown="scwin.lfn_Ed_KeyWord_OnKeyDown" ev:onchange="scwin.lfn_Div0_edit_deptCode_OnCharChanged">
    			</xf:input>
    			<xf:input class="sty_ipt_search" disabled="true" id="Div0_edit_deptName" style="position:absolute; border-style:solid;  height:20px;left:110px; width:168px;top:0px;" tabIndex="2"></xf:input>
    			<xf:trigger class="detail_search" ev:onclick="scwin.Div0_btn_Pop_Search_OnClick" id="Div0_btn_Pop_Search"
    				style="position:absolute; Transparent:TRUE;  ImageID:btn_Search_Search;  height:18px;left:84px; width:18px;top:0px;" tabIndex="3" type="anchor">
    			</xf:trigger>
    		</xf:group>
    		<w2:wframe id="div1" scope="false" src="/cm/common/Main_btn_GridControl.xml" style="position:absolute; height:20px;left:353px;top:68px; width:219px;"></w2:wframe>
    	</xf:group>
    	<xf:group arcsize="6" class="search_area" id="Shape9" style="left:0px;top:30px;width:622px;" userData3="RoundRect"></xf:group>
    	
    </body>
</html>