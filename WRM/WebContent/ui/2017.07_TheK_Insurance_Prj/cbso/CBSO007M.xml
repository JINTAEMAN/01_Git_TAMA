<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="/cm/css/all.css" type="text/css"?>
<?xml-stylesheet href="/cm/css/convert.css" type="text/css"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head>
        <w2:type>DEFAULT</w2:type>
        <w2:buildDate></w2:buildDate>
        <xf:model>
            <xf:instance>
                <data></data>
            </xf:instance>
            <w2:dataCollection>
                <w2:dataList baseNode="list" id="DsWs_Search_ADMAC01_0" keyNode="//*/vector/data/ADMAC01" repeatNode="map"></w2:dataList>
                <w2:dataList baseNode="list" id="DsWs_Search_ADMAC01_1" keyNode="//*/vector/data/ADMAC01" repeatNode="map"></w2:dataList>
                <w2:dataList baseNode="list" id="DsWs_Search_ADMAC01_2" keyNode="//*/vector/data/ADMAC01" repeatNode="map"></w2:dataList>
                <w2:dataList baseNode="list" id="DsWs_Search_ADMAC01_3" keyNode="//*/vector/data/ADMAC01" repeatNode="map"></w2:dataList>
                <w2:dataList baseNode="list" id="DsWs_Search_ADMAC01_4" keyNode="//*/vector/data/ADMAC01" repeatNode="map"></w2:dataList>
                <w2:dataList baseNode="list" id="DsWs_Search_ADMAC01_5" keyNode="//*/vector/data/ADMAC01" repeatNode="map"></w2:dataList>
                <w2:dataList baseNode="list" id="Ds_AuthDiv" repeatNode="map">
                    <w2:columnInfo>
                        <w2:column dataType="text" id="CODE" name="CODE"></w2:column>
                        <w2:column dataType="text" id="TEXT" name="TEXT"></w2:column>
                    </w2:columnInfo>
                    <w2:data use="true">
                        <w2:row>
                            <CODE><![CDATA[0000000]]></CODE>
                            <TEXT><![CDATA[전체]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[0]]></CODE>
                            <TEXT><![CDATA[공통]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[1]]></CODE>
                            <TEXT><![CDATA[자보계약]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[2]]></CODE>
                            <TEXT><![CDATA[콜]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[3]]></CODE>
                            <TEXT><![CDATA[재무]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[4]]></CODE>
                            <TEXT><![CDATA[일반]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[5]]></CODE>
                            <TEXT><![CDATA[보상]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[9]]></CODE>
                            <TEXT><![CDATA[장기계약]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[6]]></CODE>
                            <TEXT><![CDATA[시스템]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[8]]></CODE>
                            <TEXT><![CDATA[감사]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[7]]></CODE>
                            <TEXT><![CDATA[기타]]></TEXT>
                        </w2:row>
                        <w2:row>
                            <CODE><![CDATA[D]]></CODE>
                            <TEXT><![CDATA[정보계]]></TEXT>
                        </w2:row>
                    </w2:data>
                </w2:dataList>
                <w2:dataList baseNode="list" id="DsWs_SearchWarning" keyNode="//*/WARNING" repeatNode="map"></w2:dataList>
                <w2:dataList baseNode="list" id="DsWs_Search" keyNode="//*/vector/data/ADMAC01" repeatNode="map"></w2:dataList>
                <w2:dataList baseNode="list" id="DsWs_getTeam" keyNode="//*/vector/data/ADMAA09" repeatNode="map"></w2:dataList>
                <w2:dataList baseNode="list" id="DsWs_GroupAuthList" keyNode="//*/ADMAA09" repeatNode="map"></w2:dataList>
                <w2:dataList baseNode="list" id="DsWs_UpperOrg" keyNode="//*/vector/data/ADMAA10" repeatNode="map"></w2:dataList>
                <w2:dataList baseNode="list" id="DsWs_CodeSelect" repeatNode="map"></w2:dataList>
            </w2:dataCollection>
            <w2:workflowCollection></w2:workflowCollection>
        </xf:model>
 <script src="/cm/js/convertJs/Global_Script.js"/>
 <script src="/cm/js/convertJs/comm_Webservice.js"/>
 <script src="/cm/js/convertJs/Accounting_Script.js"/>
        <script><![CDATA[
/****************************************************************************
 * 프로그램번호   : 0120
 * 프로그램명      : 조직찾기
 * 파일명            : 0120.xml
 * 프로그램 내용  : 조직찾기
 * 관련 프로그램  : 
 * 작성자            : 김상열
 * 작성일            : 2011-10-25
 * 저작권            : Copyright ⓒ 2004. the K 손해보험㈜. All Right Reserved.
 * 변경내역         : 
 ****************************************************************************/

var sThisLevel = " ";//row선택한 부서 레벨
var sThisDeptCode = " ";//row선택한 부서
var sThisDeptName = " ";//row선택한 부서명
var sHeadCenter = " ";//2Level 본부
var sDptOffice = " ";//4Level 부/실
var sCenter = " ";//5Level 팀/센터
var sTeam = " ";//6Level 보상팀/실
var sGroup = " ";//7Level 그룹
var sPart = " ";//8Level 파트
var sHeadCenterName = " ";
var sDptOfficeName = " ";
var sCenterName = " ";
var sTeamName = " ";
var sGroupName = " ";
var sPartName = " ";
var sType;//개별권한
var nAuthID;
var sAuthName;
var sAuthType;
var sDescription;
var sDepartCode;
var sDepartName;//그룹권한
var nAuthGroupID;
var sAuthGroupName;
//var sDescription;		//중복
var sGroupType;
var sGroupTypeName;
var sGroupDetType;
var sGroupDetTypeName;
var sUserID;
var sInputDate;
var sInputTime;
//---------------------------------------------------------------------------
// function 명 : lOnLoadCompleted
//---------------------------------------------------------------------------
scwin.init = function() { 
    //Tab0_tab1_edt_sCenterCode.setValue( util.getGdsValue("gUserDepartCode"));
    //Tab0_tab1_edt_sCenterName.setValue( util.getGdsValue("gUserDepartName"));
	var pro = Promise.resolve();
	window.top.util.winTopShowModalChk = "T";
	util.winTopShowModal();
	pro = pro.then(function(rv) {
	    return util.winTopShowModalPromise();
	});
	pro = pro.then(function(rv) {
	//init s            
    gfn_btnEnable(false, false, false, false, false, false, false, true);
    scwin.view_authgroup();
    //init e
    return;
    });
	pro = pro.then(function(rv) {
	    util.winTopHideModal();
	});
	return pro;    
};

scwin.view_auth = function() {
    Tab0.setSelectedTabIndex( 1 );
    scwin.get_auth();
};

scwin.view_authgroup = function() {
    Tab0.setSelectedTabIndex( 0 );
    scwin.get_authgroup();
};

scwin.get_auth = function() {
	/*
    SOBJ_getTeam.WSDL = gds.gWsdlBasis;
    //처리 메소드 새로 생성
    var MethodObj = gfn_CreateMethodObj(SOBJ_getTeam, "com.inswave.admin.task.AuthTask", "selectAuthGroupAll", "", "");
    if (wconv.length(wconv.trim(Tab0_tab2_edt_sCenterCode.Text)) > 0) {
        gfn_SetParam(MethodObj, "sDepartCode", Tab0_tab2_edt_sCenterCode.Text);
    }
    if (wconv.length(wconv.trim(Tab0_tab2_edt_sAuthGroupID.Text)) > 0) {
        gfn_SetParam(MethodObj, "nAuthGroupID", Tab0_tab2_edt_sAuthGroupID.Text);
    }
    if (wconv.length(wconv.trim(Tab0_tab2_Edit0.Text)) > 0) {
        if (agf_isNum(Tab0_tab2_Edit0.Text)) {
            gfn_SetParam(MethodObj, "nAuthID", Tab0_tab2_Edit0.Text); // 권한코드
        } else {
            gfn_SetParam(MethodObj, "sAuthName", Tab0_tab2_Edit0.Text); // 권한명
        }
    }
    if (Tab0_tab2_Combo7.Index > 0) {
        gfn_SetParam(MethodObj, "sAuthType", Tab0_tab2_Combo7.getValue());
    }
    if (wconv.length(wconv.trim(Tab0_tab2_edt_sCenterDesc.Text)) > 0) {
        gfn_SetParam(MethodObj, "sDescription", Tab0_tab2_edt_sCenterDesc.Text);
    }
    gfn_CallService(SOBJ_getTeam, DOBJ_getTeam, MethodObj);
    */
	var MethodObj = new callService("com.inswave.admin.task.AuthTask", "selectAuthGroupAll");
	MethodObj.setId("selectAuthGroupAll");
    if (wconv.length(wconv.trim(Tab0_tab2_edt_sCenterCode.getValue())) > 0) {
        MethodObj.setParam( "sDepartCode", Tab0_tab2_edt_sCenterCode.getValue());
    }
    if (wconv.length(wconv.trim(Tab0_tab2_edt_sAuthGroupID.getValue())) > 0) {
        MethodObj.setParam( "nAuthGroupID", Tab0_tab2_edt_sAuthGroupID.getValue());
    }
    if (wconv.length(wconv.trim(Tab0_tab2_Edit0.getValue())) > 0) {
        if (agf_isNum(Tab0_tab2_Edit0.getValue())) {
            MethodObj.setParam( "nAuthID", Tab0_tab2_Edit0.getValue()); // 권한코드
        } else {
            MethodObj.setParam( "sAuthName", Tab0_tab2_Edit0.getValue()); // 권한명
        }
    }
    if (Tab0_tab2_Combo7.Index > 0) {
        MethodObj.setParam( "sAuthType", Tab0_tab2_Combo7.getValue());
    }
    if (wconv.length(wconv.trim(Tab0_tab2_edt_sCenterDesc.getValue())) > 0) {
        MethodObj.setParam( "sDescription", Tab0_tab2_edt_sCenterDesc.getValue());
    }
	
	MethodObj.setUrl("/common/CBSO007MController.do");
	MethodObj.setXPath("//*/vector/data/ADMAA10");
	MethodObj.addXPath("//WARNING");
	MethodObj.sync();
	MethodObj.send();
	//util.interfaceKey(_tranSync.result.serviceDs);
	//DsWs_Team.setJSON (_tranSync.getDsJson("ADMAC03")); // dataset 데이터 
	util.jSonDsCreate(_tranSync.getDsJson("ADMAA10"), "DsWs_UpperOrg");
	util.setCompBindRefresh("DsWs_UpperOrg");
	util.setRowPosition(DsWs_UpperOrg, 0);
    
    //wconv.trace(wconv.saveXml(DsWs_UpperOrg));
    /*	
    	if( DsWs_UpperOrg.GetCount() < 1 ){
    		alert("해당 데이터가 존재하지 않습니다.");
    		return;
    	}
    */
};

scwin.get_authgroup = function() {
    wconv.clear(DsWs_GroupAuthList);
    /*
    SOBJ_getTeam.WSDL = gds.gWsdlBasis;
    var MethodObj = gfn_CreateMethodObj(SOBJ_getTeam, "com.inswave.admin.task.AuthTask", "selectAuthGroupsByAuth", "", "");
    if (wconv.length(wconv.trim(Tab0_tab1_edt_sCenterCode.Text)) > 0) {
        //gfn_SetParam(MethodObj, "sDepartCode", Tab0.tab1.edt_sCenterCode.Text);	
        //20130306  관리부서는 부.실코드로 대체하여 조회 (로긴사원의 부실코드)
        gfn_SetParam(MethodObj, "sDptOfficeCode", Tab0_tab1_edt_sCenterCode.Text);
    }
    if (wconv.length(wconv.trim(Tab0_tab1_Edit0.Text)) > 0) {
        if (agf_isNum(Tab0_tab1_Edit0.Text)) {
            gfn_SetParam(MethodObj, "nAuthGroupID", Tab0_tab1_Edit0.Text); // 그룹권한코드			
        } else {
            gfn_SetParam(MethodObj, "sAuthGroupName", Tab0_tab1_Edit0.Text); // 그룹권한명
        }
    }
    if (Tab0_tab1_rdo_sAuthView.getValue() == "1") {
        Tab0_tab1_Grd_List2.SetColProp(5, "Width", 96);
        Tab0_tab1_Grd_List2.SetColProp(6, "Width", 262);
    } else {
        Tab0_tab1_Grd_List2.SetColProp(5, "Width", 0);
        Tab0_tab1_Grd_List2.SetColProp(6, "Width", 0);
    }
    gfn_SetParam(MethodObj, "sViewType", Tab0_tab1_rdo_sAuthView.getValue()); // 그룹권한명	
    gfn_CallService(SOBJ_getTeam, DOBJ_GroupAuthList, MethodObj);
	*/
	var MethodObj = new callService("com.inswave.admin.task.AuthTask", "selectAuthGroupsByAuth");
	MethodObj.setId("selectAuthGroupsByAuth");
	
    if (wconv.length(wconv.trim(Tab0_tab1_edt_sCenterCode.getValue())) > 0) {
        //MethodObj.setParam( "sDepartCode", Tab0.tab1.edt_sCenterCode.getValue());	
        //20130306  관리부서는 부.실코드로 대체하여 조회 (로긴사원의 부실코드)
        console.log("1 Tab0_tab1.edt_sCenterCode.getValue())) > 0)"  + Tab0_tab1_edt_sCenterCode.getValue());
        MethodObj.setParam( "sDptOfficeCode", Tab0_tab1_edt_sCenterCode.getValue());
    }
    if (wconv.length(wconv.trim(Tab0_tab1_Edit0.getValue())) > 0) {
        if (agf_isNum(Tab0_tab1_Edit0.getValue())) {
            MethodObj.setParam( "nAuthGroupID", Tab0_tab1_Edit0.getValue()); // 그룹권한코드			
        } else {
            MethodObj.setParam( "sAuthGroupName", Tab0_tab1_Edit0.getValue()); // 그룹권한명
        }
    }
    
    MethodObj.setParam( "sViewType", Tab0_tab1_rdo_sAuthView.getValue()); // 그룹권한명
    	
	MethodObj.setUrl("/common/CBSO007MController.do");
	MethodObj.setXPath("//*/ADMAA09");
	MethodObj.addXPath("//WARNING");
	MethodObj.sync();
	MethodObj.send();
	util.jSonDsCreate(_tranSync.getDsJson("ADMAA09"), "DsWs_GroupAuthList");
	util.setCompBindRefresh("DsWs_GroupAuthList");
	util.setRowPosition(DsWs_GroupAuthList, 0);    	

    if (DsWs_GroupAuthList.getRowCount() < 1) {
        wprom.alert("해당 데이터가 존재하지 않습니다.");
        return;
    }
    if (Tab0_tab1_rdo_sAuthView.getValue() == "1") {
        //Tab0_tab1_Grd_List2.setColumnWidth(5,  96);
        //Tab0_tab1_Grd_List2.setColumnWidth(6,  262);
    	Tab0_tab1_Grd_List2.setColumnVisible(5,true)
    	Tab0_tab1_Grd_List2.setColumnVisible(6,true)
    } else {
        //Tab0_tab1_Grd_List2.setColumnWidth(5,  0);
        //Tab0_tab1_Grd_List2.setColumnWidth(6,  0); 
	    Tab0_tab1_Grd_List2.setColumnVisible(5,false)
	    Tab0_tab1_Grd_List2.setColumnVisible(6,false)
    }

};

//---------------------------------------------------------------------------
// function 명 : lfn_Btn_Action_OnClick
// 내용        : 확인버튼 Event처리
//---------------------------------------------------------------------------
scwin.lfn_Btn_Action_OnClick = function(e) {
    if (sType == "group")
        scwin.set_result_authgroup(); //Tab0.TabIndex = 0; else scwin.set_result_auth();//Tab0.TabIndex = 1;
    /*
    	if(length(trim(this.edit_deptCode.getValue())) == 0){
    		alert("조직을 선택하세요.");
    		return;
    	}
    	
    	this.Close(sThisDeptCode   +"^"+
    			   sThisDeptName   +"^"+
    			   sThisLevel      +"^"+
    			   sHeadCenterName + " " + sDptOfficeName + " " + sCenterName + " " + sTeamName + " " + sGroupName + " " + sPartName +"^"+
    			   sHeadCenter     +" ^"+ sDptOffice     +" ^"+ sCenter     +" ^"+ sTeam     +" ^"+ sGroup     +" ^"+ sPart +" ^"+
    			   sHeadCenterName +" ^"+ sDptOfficeName +" ^"+ sCenterName +" ^"+ sTeamName +" ^"+ sGroupName +" ^"+ sPartName
    			   );         
    */
};

scwin.set_result_authgroup = function() {
    wprom.close(nAuthGroupID + "^" + sAuthGroupName + "^" + sDescription + "^" + sGroupType + "^" + sGroupTypeName + "^" + sGroupDetType + "^" + sGroupDetTypeName + "^" + sUserID + "^" + sInputDate + "^" + sInputTime);
};

scwin.set_result_auth = function() {
    wprom.close(nAuthID + "^" + sAuthName + "^" + sAuthType + "^" + sDescription + "^" + sDepartCode + "^" + sDepartName);
};

//---------------------------------------------------------------------------
// function 명 : lfn_Btn_Action_OnClick
// 내용        : 닫기버튼 Event처리
//---------------------------------------------------------------------------
scwin.lfn_Btn_Close_OnClick = function(e) {
    wprom.close("" + "^" + "" + "^" + "" + "^" + "" + "^");
};

//---------------------------------------------------------------------------
// function 명 : lfn_getJojik
// 내용        : 조직코드에 해당하는 하위 조직 조회
//---------------------------------------------------------------------------
//사용안함.
scwin.lfn_getJojik = function(obj, DepartLevel, UpperDepart) {
    
    //eval(obj_BindDataset).Clear();
    wconv.clear(DsWs_GroupAuthList);    
    wconv.clear(DsWs_UpperOrg);    
    
    wconv.clear(DsWs_SearchWarning);
    wconv.clear(DsWs_getTeam);
    /*
    SOBJ_getTeam.WSDL = gds.gWsdlBasis;
    var MethodObj = gfn_CreateMethodObj(SOBJ_getTeam, "com.inswave.admin.task.OrgTask", "getOrgList", "", "");
    gfn_SetParam(MethodObj, "sLevel", DepartLevel);
    gfn_SetParam(MethodObj, "sUpperCode", UpperDepart);
    gfn_CallService(SOBJ_getTeam, DOBJ_getTeam, MethodObj);
    */
	var MethodObj = new callService("com.inswave.admin.task.OrgTask", "getOrgList");
	MethodObj.setId("getOrgList");
    MethodObj.setParam( "sLevel", DepartLevel);
    MethodObj.setParam( "sUpperCode", UpperDepart);
	MethodObj.setUrl("/contract/CBSB017MController.do");
	MethodObj.setXPath("//*/vector/data/ADMAA10");
	MethodObj.addXPath("//WARNING");
	MethodObj.sync();
	MethodObj.send();
	util.jSonDsCreate(_tranSync.getDsJson("ADMAA10"), "DsWs_UpperOrg");
	util.jSonDsCreate(_tranSync.getDsJson("WARNING"), "DsWs_SearchWarning");
	util.setCompBindRefresh("DsWs_UpperOrg");
	util.setRowPosition(DsWs_UpperOrg, 0);
    
    //trace(replace(gfn_XmlEncoder(DOBJ_getTeam.getValue()), "><", ">\n<"));
    if (DsWs_SearchWarning.getRowCount() != 0) {
        wprom.alert(DsWs_SearchWarning.getCellData(0, "msg"));
        return false;
    }
    //eval(obj_BindDataset).Copy(DsWs_getTeam);
};

//---------------------------------------------------------------------------
// function 명 : lfn_grd_List0_OnCellClick
// 내용        : grd_List0에서 선택된 조직코드에 해당하는 하위 조직 조회
//---------------------------------------------------------------------------
//사용안함.
scwin.lfn_grd_List0_OnCellClick = function(obj, nRow, nCell, nX, nY, nPivotIndex) {
    wconv.clear(DsWs_Search_ADMAC01_1);
    wconv.clear(DsWs_Search_ADMAC01_2);
    wconv.clear(DsWs_Search_ADMAC01_3);
    wconv.clear(DsWs_Search_ADMAC01_4);
    wconv.clear(DsWs_Search_ADMAC01_5);
    Tab0_tab1_edit_deptName0.setValue("");
    Tab0_tab1_edit_deptName1.setValue("");
    Tab0_tab1_edit_deptName2.setValue("");
    Tab0_tab1_edit_deptName3.setValue("");
    Tab0_tab1_edit_deptName4.setValue("");
    Tab0_tab1_edit_deptName5.setValue("");
    var ind = nRow;
    Tab0_tab1_edit_deptName0.Text = eval(obj_BindDataset).GetColumn(ind, "sDepartName");
    edit_deptCode.Text = eval(obj_BindDataset).GetColumn(ind, "sDepartCode");
    edit_deptName.Text = eval(obj_BindDataset).GetColumn(ind, "sDepartName");
    edit_level.Text = eval(obj_BindDataset).GetColumn(ind, "sLevel") + "레벨";
    sThisLevel = eval(obj_BindDataset).GetColumn(ind, "sLevel");
    sThisDeptCode = eval(obj_BindDataset).GetColumn(ind, "sDepartCode");
    sThisDeptName = eval(obj_BindDataset).GetColumn(ind, "sDepartName");
    sHeadCenter = eval(obj_BindDataset).GetColumn(ind, "sDepartCode");
    sHeadCenterName = eval(obj_BindDataset).GetColumn(ind, "sDepartName");
    sDptOffice = "";
    sCenter = "";
    sTeam = "";
    sGroup = "";
    sPart = "";
    sDptOfficeName = "";
    sCenterName = "";
    sTeamName = "";
    sGroupName = "";
    sPartName = "";
    scwin.lfn_getJojik(Tab0_tab1.grd_List1, parseInt(eval(obj_BindDataset).GetColumn(ind, "sLevel")) + 2, eval(obj_BindDataset).GetColumn(ind, "sDepartCode"));
};

//---------------------------------------------------------------------------
// function 명 : lfn_grd_List1_OnCellClick
// 내용        : grd_List1에서 선택된 조직코드에 해당하는 하위 조직 조회
//---------------------------------------------------------------------------
//사용안함. 
scwin.lfn_grd_List1_OnCellClick = function(obj, nRow, nCell, nX, nY, nPivotIndex) {
    wconv.clear(DsWs_Search_ADMAC01_2);
    wconv.clear(DsWs_Search_ADMAC01_3);
    wconv.clear(DsWs_Search_ADMAC01_4);
    wconv.clear(DsWs_Search_ADMAC01_5);
    Tab0_tab1_edit_deptName1.setValue("");
    Tab0_tab1_edit_deptName2.setValue("");
    Tab0_tab1_edit_deptName3.setValue("");
    Tab0_tab1_edit_deptName4.setValue("");
    Tab0_tab1_edit_deptName5.setValue("");
    var ind = nRow;
    Tab0_tab1_edit_deptName1.Text = eval(obj_BindDataset).GetColumn(ind, "sDepartName");
    edit_deptCode.Text = eval(obj_BindDataset).GetColumn(ind, "sDepartCode");
    edit_deptName.Text = eval(obj_BindDataset).GetColumn(ind, "sDepartName");
    edit_level.Text = eval(obj_BindDataset).GetColumn(ind, "sLevel") + "레벨";
    sThisLevel = eval(obj_BindDataset).GetColumn(ind, "sLevel");
    sThisDeptCode = eval(obj_BindDataset).GetColumn(ind, "sDepartCode");
    sThisDeptName = eval(obj_BindDataset).GetColumn(ind, "sDepartName");
    sDptOffice = eval(obj_BindDataset).GetColumn(ind, "sDepartCode");
    sDptOfficeName = eval(obj_BindDataset).GetColumn(ind, "sDepartName");
    sCenter = "";
    sTeam = "";
    sGroup = "";
    sPart = "";
    sCenterName = "";
    sTeamName = "";
    sGroupName = "";
    sPartName = "";
    scwin.lfn_getJojik(Tab0_tab1.grd_List2, parseInt(eval(obj_BindDataset).GetColumn(ind, "sLevel")) + 1, eval(obj_BindDataset).GetColumn(ind, "sDepartCode"));
};

//---------------------------------------------------------------------------
// function 명 : lfn_grd_List2_OnCellClick
// 내용        : grd_List2에서 선택된 조직코드에 해당하는 하위 조직 조회
//---------------------------------------------------------------------------
//사용안함.
scwin.lfn_grd_List2_OnCellClick = function(obj, nRow, nCell, nX, nY, nPivotIndex) {
    wconv.clear(DsWs_Search_ADMAC01_3);
    wconv.clear(DsWs_Search_ADMAC01_4);
    wconv.clear(DsWs_Search_ADMAC01_5);
    Tab0_tab1_edit_deptName2.setValue("");
    Tab0_tab1_edit_deptName3.setValue("");
    Tab0_tab1_edit_deptName4.setValue("");
    Tab0_tab1_edit_deptName5.setValue("");
    var ind = nRow;
    Tab0_tab1_edit_deptName2.Text = eval(obj_BindDataset).GetColumn(ind, "sDepartName");
    edit_deptCode.Text = eval(obj_BindDataset).GetColumn(ind, "sDepartCode");
    edit_deptName.Text = eval(obj_BindDataset).GetColumn(ind, "sDepartName");
    edit_level.Text = eval(obj_BindDataset).GetColumn(ind, "sLevel") + "레벨";
    sThisLevel = eval(obj_BindDataset).GetColumn(ind, "sLevel");
    sThisDeptCode = eval(obj_BindDataset).GetColumn(ind, "sDepartCode");
    sThisDeptName = eval(obj_BindDataset).GetColumn(ind, "sDepartName");
    sCenter = eval(obj_BindDataset).GetColumn(ind, "sDepartCode");
    sCenterName = eval(obj_BindDataset).GetColumn(ind, "sDepartName");
    sTeam = "";
    sGroup = "";
    sPart = "";
    sTeamName = "";
    sGroupName = "";
    sPartName = "";
    scwin.lfn_getJojik(Tab0_tab1.grd_List3, parseInt(eval(obj_BindDataset).GetColumn(ind, "sLevel")) + 1, eval(obj_BindDataset).GetColumn(ind, "sDepartCode"));
};

//---------------------------------------------------------------------------
// function 명 : lfn_grd_List3_OnCellClick
// 내용        : grd_List3에서 선택된 조직코드에 해당하는 하위 조직 조회
//---------------------------------------------------------------------------
//사용안함.
scwin.lfn_grd_List3_OnCellClick = function(obj, nRow, nCell, nX, nY, nPivotIndex) {
    wconv.clear(DsWs_Search_ADMAC01_4);
    wconv.clear(DsWs_Search_ADMAC01_5);
    Tab0_tab1_edit_deptName3.setValue("");
    Tab0_tab1_edit_deptName4.setValue("");
    Tab0_tab1_edit_deptName5.setValue("");
    var ind = nRow;
    Tab0_tab1_edit_deptName3.Text = eval(obj_BindDataset).GetColumn(ind, "sDepartName");
    edit_deptCode.Text = eval(obj_BindDataset).GetColumn(ind, "sDepartCode");
    edit_deptName.Text = eval(obj_BindDataset).GetColumn(ind, "sDepartName");
    edit_level.Text = eval(obj_BindDataset).GetColumn(ind, "sLevel") + "레벨";
    sThisLevel = eval(obj_BindDataset).GetColumn(ind, "sLevel");
    sThisDeptCode = eval(obj_BindDataset).GetColumn(ind, "sDepartCode");
    sThisDeptName = eval(obj_BindDataset).GetColumn(ind, "sDepartName");
    sTeam = eval(obj_BindDataset).GetColumn(ind, "sDepartCode");
    sTeamName = eval(obj_BindDataset).GetColumn(ind, "sDepartName");
    sGroup = "";
    sPart = "";
    sGroupName = "";
    sPartName = "";
    scwin.lfn_getJojik(Tab0_tab1.grd_List4, parseInt(eval(obj_BindDataset).GetColumn(ind, "sLevel")) + 1, eval(obj_BindDataset).GetColumn(ind, "sDepartCode"));
};

//---------------------------------------------------------------------------
// function 명 : lfn_grd_List4_OnCellClick
// 내용        : grd_List4에서 선택된 조직코드에 해당하는 하위 조직 조회
//---------------------------------------------------------------------------
//사용안함.
scwin.lfn_grd_List4_OnCellClick = function(obj, nRow, nCell, nX, nY, nPivotIndex) {
    wconv.clear(DsWs_Search_ADMAC01_5);
    Tab0_tab1_edit_deptName4.setValue("");
    Tab0_tab1_edit_deptName5.setValue("");
    var ind = nRow;
    Tab0_tab1_edit_deptName4.Text = eval(obj_BindDataset).GetColumn(ind, "sDepartName");
    edit_deptCode.Text = eval(obj_BindDataset).GetColumn(ind, "sDepartCode");
    edit_deptName.Text = eval(obj_BindDataset).GetColumn(ind, "sDepartName");
    edit_level.Text = eval(obj_BindDataset).GetColumn(ind, "sLevel") + "레벨";
    sThisLevel = eval(obj_BindDataset).GetColumn(ind, "sLevel");
    sThisDeptCode = eval(obj_BindDataset).GetColumn(ind, "sDepartCode");
    sThisDeptName = eval(obj_BindDataset).GetColumn(ind, "sDepartName");
    sGroup = eval(obj_BindDataset).GetColumn(ind, "sDepartCode");
    sGroupName = eval(obj_BindDataset).GetColumn(ind, "sDepartName");
    sPart = "";
    sPartName = "";
    scwin.lfn_getJojik(Tab0_tab1.grd_List5, parseInt(eval(obj_BindDataset).GetColumn(ind, "sLevel")) + 1, eval(obj_BindDataset).GetColumn(ind, "sDepartCode"));
};

//---------------------------------------------------------------------------
// function 명 : lfn_grd_List5_OnCellClick
// 내용        : grd_List5에서 선택된 조직코드에 해당하는 하위 조직 조회
//---------------------------------------------------------------------------
//사용안함.
scwin.lfn_grd_List5_OnCellClick = function(obj, nRow, nCell, nX, nY, nPivotIndex) {
    var ind = nRow;
    Tab0_tab1_edit_deptName5.Text = eval(obj_BindDataset).GetColumn(ind, "sDepartName");
    edit_deptCode.Text = eval(obj_BindDataset).GetColumn(ind, "sDepartCode");
    edit_deptName.Text = eval(obj_BindDataset).GetColumn(ind, "sDepartName");
    edit_level.Text = eval(obj_BindDataset).GetColumn(ind, "sLevel") + "레벨";
    sThisLevel = eval(obj_BindDataset).GetColumn(ind, "sLevel");
    sThisDeptCode = eval(obj_BindDataset).GetColumn(ind, "sDepartCode");
    sThisDeptName = eval(obj_BindDataset).GetColumn(ind, "sDepartName");
    sPart = eval(obj_BindDataset).GetColumn(ind, "sDepartCode");
    sPartName = eval(obj_BindDataset).GetColumn(ind, "sDepartName");
};
//사용안됨.
scwin.lfn_Btn_Search_OnClick = function(obj) {
    wconv.clear(DsWs_SearchWarning);
    SOBJ_Search.WSDL = gds.gWsdlBasis;
    var MethodObj = gfn_CreateMethodObj(SOBJ_Search, "com.inswave.admin.task.OrgTask", "selectOrgListByDepartName", "", "");
    gfn_SetParam(MethodObj, "sDepartName", Tab0_tab2_edt_sDepartName.getValue());
    gfn_CallService(SOBJ_Search, DOBJ_Search, MethodObj);
    //trace(replace(gfn_XmlEncoder(gDOBJ_getTeam.getValue()), "><", ">\n<"));
    if (DsWs_SearchWarning.getRowCount() != 0) {
        wprom.alert(DsWs_SearchWarning.getCellData(0, "msg"));
        return false;
    }
};

scwin.Tab0_tab2_Grd_List_OnCellClick = function( nRow, nCell) {
    /*	if(nCell == 0){
    		nAuthGroupID  		= Eval(obj.BindDataset).GetColumn(nRow,"nAuthGroupID");
    		sAuthGroupName		= Eval(obj.BindDataset).GetColumn(nRow,"sAuthGroupName");
    		sDescription		= Eval(obj.BindDataset).GetColumn(nRow,"sDescription");
    		sGroupType			= Eval(obj.BindDataset).GetColumn(nRow,"sGroupType");
    		sGroupTypeName		= Eval(obj.BindDataset).GetColumn(nRow,"sGroupTypeName");
    		sGroupDetType		= Eval(obj.BindDataset).GetColumn(nRow,"sGroupDetType");
    		sGroupDetTypeName	= Eval(obj.BindDataset).GetColumn(nRow,"sGroupDetTypeName");
    		sUserID				= Eval(obj.BindDataset).GetColumn(nRow,"sUserID");
    		sInputDate			= Eval(obj.BindDataset).GetColumn(nRow,"sInputDate");
    		sInputTime			= Eval(obj.BindDataset).GetColumn(nRow,"sInputTime");
    		
    		set_result_authgroup();
    	}*/
    if (nCell == 0) {
        Tab0_tab2_edt_sCenterCode.setValue( util.getGdsValue("gUserDepartCode") );
        Tab0_tab2_edt_sCenterName.setValue( util.getGdsValue("gUserDepartName") );
        Tab0_tab2_edt_sAuthGroupID.setValue( DsWs_GroupAuthList.getCellData(nRow, "nAuthGroupID") );
        Tab0_tab2_edt_sAuthGroupName.setValue( DsWs_GroupAuthList.getCellData(nRow, "sAuthGroupName") );

        // 등록탭으로 이동
        //gbTabCanMove = true;
        Tab0.setSelectedTabIndex( 1 );// = 1;
    }
};
//xxxxxxxxxxxxx
scwin.Tab0_tab2_Edt_sDepartName_OnKeyDown = function(e) {
    if (e.keyCode == 13) {
        scwin.lfn_Btn_Search_OnClick("");
    }
};
//
scwin.Tab0_tab2_Grd_List_OnCellDblClick = function(obj, nRow, nCell, nX, nY, nPivotIndex) {
    scwin.lfn_Btn_Action_OnClick("");
};

scwin.Tab0_tab1_grd_List0_OnCellDblClick = function(obj, nRow, nCell, nX, nY, nPivotIndex) {
    scwin.lfn_Btn_Action_OnClick("");
};

/////////////////////////////////////////////////////////////////////////////////////////////////////////////
// 탭 체인지
/////////////////////////////////////////////////////////////////////////////////////////////////////////////
scwin.Tab0_OnChanged = function(tabID,idx,userTabID) {
    if (Tab0.getSelectedTabIndex() == 0) {
        Tab0_tab1_edt_sCenterCode.setValue( util.getGdsValue("gUserDepartCode") );
        Tab0_tab1_edt_sCenterName.setValue( util.getGdsValue("gUserDepartName") );
        scwin.get_authgroup();
    } else {
        Tab0_tab2_edt_sCenterCode.setValue( util.getGdsValue("gUserDepartCode")) ;
        Tab0_tab2_edt_sCenterName.setValue( util.getGdsValue("gUserDepartName") );
        scwin.get_auth();
    }
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////
//버튼조회
/////////////////////////////////////////////////////////////////////////////////////////////////////////////
//비동기 호출 
scwin.btn_OnClick = function(e) {
	util.eventAsyncCall(this,scwin.btn_OnClick_sync,arguments);
};

scwin.btn_OnClick_sync = function(e) {
    if (Tab0.getSelectedTabIndex() == 0) {
        scwin.view_authgroup(); //Tab0.TabIndex = 0;		
    } else if (Tab0.getSelectedTabIndex() == 1) {
        scwin.view_auth(); //Tab0.TabIndex = 1;
    }
};
//전환
scwin.Tab0_tab1_btn_Pop_Search_OnClick = function(obj, psButton,pCode) {
    var promise = Promise.resolve();
    promise = promise.then(function(rtnVal) {
			var indata = {"psButton":psButton,"pCode":pCode};
			var popInfo = {
       			title : "부서목록",
    			width : 583,
				height : 535,
				"indata":indata
       		};
	    return wprom.popupOpen("/ui/cbso/CBSO032P.xml",popInfo);
    });
    promise = promise.then(function(result) {

        var rtnArry = result.split( "^" );
        if (Tab0.getSelectedTabIndex() == 0) {
            if (rtnArry[0] > 0) {
                Tab0_tab1_edt_sCenterCode.setValue( rtnArry[0] );
                Tab0_tab1_edt_sCenterName.setValue( rtnArry[1] );
            } else {
                Tab0_tab1_edt_sCenterCode.setValue("");
                Tab0_tab1_edt_sCenterName.setValue("");
            }
        } else if (Tab0.getSelectedTabIndex() == 1) {
            if (rtnArry[0] > 0) {
                Tab0_tab2_edt_sCenterCode.setValue( rtnArry[0]);
                Tab0_tab2_edt_sCenterName.setValue( rtnArry[1]);
            } else {
                Tab0_tab2_edt_sCenterCode.setValue("");
                Tab0_tab2_edt_sCenterName.setValue("");
            }
        }
    });
    
    return promise;
};

scwin.Tab0_tab2_btn_Pop_search1_OnClick = function(obj, agrs) {
    //alert("추후개발예정");
    //return;
    
    var promise = Promise.resolve();
    var args = {};
    args.sType="group";
    args.p_sCenterCode= util.getGdsValue("gDptOfficeCode");
    args.p_sCenterName= util.getGdsValue("gDptOfficeName");
    //if (wconv.length(wconv.trim(p_Args)) > 0) {
    //    args = p_Args;
   // }
    promise = promise.then(function(rtnVal) {
    	var popInfo = {
    		width : 736,
    		height : 344,
    		indata : args,
    		title : "권한그룹조회"
    	};
        //return wprom.popupOpen("PROJECT_PATH_TEMP/com_pop/9959_authGrupPop.xml", args);
        return wprom.popupOpen("/ui/cbso/CBSO054P.xml", popInfo);
    });
    promise = promise.then(function(rst) {
        /*wprom.popupOpen(가이드참조)*/
        if (wconv.length(rst) != 0) {
            var arrRst = rst.split( "^");
            Tab0_tab2_edt_sAuthGroupID.setValue(arrRst[0]);
            Tab0_tab2_edt_sAuthGroupName.setValue( arrRst[1] );
        }
        return;
    });
    return promise;
};
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//각 탭에서 관리부서,권한그룹 출력처리
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
scwin.edt_OnKeyDown = function(e) {
    var promise = Promise.resolve();
    var popupName = "";
    var args = "";
    var flags = "";
    if (e.keyCode == 13) {
        if (this.id == "Tab0_tab1_edt_sCenterCode") {
            //사용자권한 관리부서
            agrs = "";
            if (wconv.length(wconv.trim(Tab0_tab1_edt_sCenterCode.getValue())) == 7 || 
                agf_isNum(Tab0_tab1_edt_sCenterCode.getValue()) == false) {
                
                flags = scwin.agf_DeptCode(Tab0_tab1_edt_sCenterCode.getValue());
                if (flags != "list" && flags != "0") {
                    //조회가 1건인경우
                    var arrt = flags.split( "^" );
                    Tab0_tab1_edt_sCenterCode.setValue( arrt[0] );
                    Tab0_tab1_edt_sCenterName.setValue( arrt[1] );
                    return;
                } else if (flags == "list") {
                    //2건이상인 경우
                    //args = "psButton='' pCode='" + Tab0_tab1_edt_sCenterCode.getValue() + "'";
                    promise = promise.then(function(rtnVal) {
                    	//args = {"psButton":"","pCode":Tab0_tab1_edt_sCenterCode.getValue()};
                    	var psButton = "";
                    	var pCode = Tab0_tab1_edt_sCenterCode.getValue();
                        return scwin.Tab0_tab1_btn_Pop_Search_OnClick(Tab0_tab1_btn_Pop_Search, psButton,pCode);
                    });
                    promise = promise.then(function(rtnVal) {
                        return;
                    });
                } else if (flags == "0") {
                    //결과가 없는경우
                    Tab0_tab1_edt_sCenterName.setValue("");
                    return;
                }
            } else {
                Tab0_tab1_edt_sCenterName.setValue("");
            }
        } else if (this.id == "Tab0_tab2_edt_sCenterCode") {
            //사용자권한 관리부서
            agrs = "";
            if (wconv.length(wconv.trim(Tab0_tab2_edt_sCenterCode.getValue())) == 7 || 
                agf_isNum(Tab0_tab2_edt_sCenterCode.getValue()) == false) {
                flags = scwin.agf_DeptCode(Tab0_tab2_edt_sCenterCode.getValue());
                if (flags != "list" && flags != "0") {
                    //조회가 1건인경우
                    var arrt = flags.split( "^" );
                    Tab0_tab2_edt_sCenterCode.setValue( arrt[0] );
                    Tab0_tab2_edt_sCenterName.setValue( arrt[1] );
                    return;
                } else if (flags == "list") {
                    //2건이상인 경우
                    //args = "psButton='' pCode='" + Tab0_tab2_edt_sCenterCode.Text + "'";
                    var psButton = "";
                    var pCode = Tab0_tab2_edt_sCenterCode.getValue();
                    //Tab0_tab2_btn_Pop_Search_OnClick(Tab0_tab2.btn_Pop_Search, psButton,pCode);
                    return;
                } else if (flags == "0") {
                    //결과가 없는경우
                    Tab0_tab2_edt_sCenterName.setValue("");
                    return;
                }
            } else {
                Tab0_tab2_edt_sCenterName.setValue("");
            }
        } else if (this.id == "Tab0_tab2_edt_sAuthGroupID") {
            //사용자권한 권한그룹
            args = "";
            if (wconv.length(wconv.trim(Tab0_tab2_edt_sAuthGroupID.getValue())) > 4 || 
                agf_isNum(Tab0_tab2_edt_sAuthGroupID.getValue()) == false) {
                
                flags = scwin.getAutgGroup(Tab0_tab2_edt_sAuthGroupID.getValue());
                if (flags != "list" && flags != "0") {
                    //조회가 1건인경우
                    var arrt = flags.split( "^" );
                    Tab0_tab2_edt_sAuthGroupID.setValue( arrt[0] );
                    Tab0_tab2_edt_sAuthGroupName.setValue( arrt[1] );
                    return;
                } else if (flags == "list") {
                    //2건이상인 경우
                    //args = "sType=group";
                    //args += " sAuthGroupName='" + Tab0_tab2_edt_sAuthGroupID.Text + "'";
                    var sType = "group";
                    var sAuthGroupName= Tab0_tab2_edt_sAuthGroupID.getValue();
                    
                    //Tab0_tab2_btn_Pop_Search_OnClick(Tab0_tab2.btn_Pop_search1, sType,sAuthGroupName);
                    return;
                } else if (flags == "0") {
                    //결과가 없는경우
                    Tab0_tab2_edt_sAuthGroupName.setValue("");
                    return;
                }
            } else {
                Tab0_tab2_edt_sAuthGroupName.setValue("");
            }
        }
    }
    return promise;
};

// focus out
scwin.edt_OnKillFocus = function(e) {
    var promise = Promise.resolve();
    promise = promise.then(function(rtnVal) {
        return scwin.edt_OnKeyDown(e);
    });
    return promise;
};

//관리부서 처리
scwin.agf_DeptCode = function(param) {
    var rtn = "";
    var lsBaseDate = wconv.today();
    var lsLevel = "A";
    wconv.clear(DsWs_CodeSelect);
    /*
    SOBJ.WSDL = gds.gWsdlAccounting;
    DsWs_CodeSelect.XPath = "//-/vector/data/ADMAC01";
    var MethodObj = gfn_CreateMethodObj(SOBJ, "com.inswave.admin.task.AdminTask", "getNewDepartbyLevel", "9999", "1");
    gfn_SetParam(MethodObj, "sBaseDate", lsBaseDate); // 기준일자
    gfn_SetParam(MethodObj, "sLevel", lsLevel); // 부서레벨
    if (agf_isNum(param)) {
        gfn_SetParam(MethodObj, "sCenterCode", param); // 센타팀코드
    } else {
        gfn_SetParam(MethodObj, "sCenterName", param); // 부서명
    }
    // 조회실행
    gfn_CallService(SOBJ, DOBJ_ADCOM, MethodObj);
    */
	var MethodObj = new callService("com.inswave.admin.task.AdminTask", "getNewDepartbyLevel");
	MethodObj.setId("getNewDepartbyLevel");
	
    MethodObj.setParam( "sBaseDate", lsBaseDate); // 기준일자
    MethodObj.setParam( "sLevel", lsLevel); // 부서레벨
    if (agf_isNum(param)) {
        MethodObj.setParam( "sCenterCode", param); // 센타팀코드
    } else {
        MethodObj.setParam( "sCenterName", param); // 부서명
    }

	MethodObj.setUrl("/common/CBSO007MController.do");
	MethodObj.setXPath("//*/vector/data/ADMAC01");
	MethodObj.addXPath("//WARNING");
	MethodObj.sync();
	MethodObj.send();
	//util.interfaceKey(_tranSync.result.serviceDs);
	//DsWs_Team.setJSON (_tranSync.getDsJson("ADMAC03")); // dataset 데이터 
	util.jSonDsCreate(_tranSync.getDsJson("ADMAC01"), "DsWs_CodeSelect");
	util.setCompBindRefresh("DsWs_CodeSelect");
	util.setRowPosition(DsWs_CodeSelect, 0);
    
    if (DsWs_CodeSelect.getRowCount() == 1) {
        rtn = DsWs_CodeSelect.getCellData(0, "sCenterCode") + "^" + DsWs_CodeSelect.getCellData(0, "sCenterName");
    } else if (DsWs_CodeSelect.getRowCount() > 1) {
        rtn = "list";
    } else if (DsWs_CodeSelect.getRowCount() == 0) {
        rtn = "0";
    }
    return rtn;
};

//권한그룹처리
scwin.getAutgGroup = function(param) {
    var rtn = "";
    wconv.clear(DsWs_CodeSelect);
    /*
    SOBJ.WSDL = gds.gWsdlAccounting;
    DsWs_CodeSelect.XPath = "//-/vector/data/ADMAA09";
    var MethodObj = gfn_CreateMethodObj(SOBJ, "com.inswave.admin.task.AuthTask", "selectGroupAuth", "9999", "1");
    if (agf_isNum(param)) {
        gfn_SetParam(MethodObj, "nAuthGroupID", param); // 그룹권한코드
    } else {
        gfn_SetParam(MethodObj, "sAuthGroupName", param); // 그룹권한명
    }
    gfn_CallService(SOBJ, DOBJ_ADCOM, MethodObj);
    */
	var MethodObj = new callService("com.inswave.admin.task.AuthTask", "selectGroupAuth");
	MethodObj.setId("selectGroupAuth");

    if (agf_isNum(param)) {
        MethodObj.setParam( "nAuthGroupID", param); // 그룹권한코드
    } else {
        MethodObj.setParam( "sAuthGroupName", param); // 그룹권한명
    }

	MethodObj.setUrl("/common/CBSO007MController.do");
	MethodObj.setXPath("//*/vector/data/ADMAA09");
	MethodObj.addXPath("//WARNING");
	MethodObj.sync();
	MethodObj.send();
	//util.interfaceKey(_tranSync.result.serviceDs);
	//DsWs_Team.setJSON (_tranSync.getDsJson("ADMAC03")); // dataset 데이터 
	util.jSonDsCreate(_tranSync.getDsJson("ADMAA09"), "DsWs_CodeSelect");
	util.setCompBindRefresh("DsWs_CodeSelect");
	util.setRowPosition(DsWs_CodeSelect, 0);    
    //wconv.trace(replace(gfn_XmlEncoder(DOBJ_ADCOM.Contents), "><", ">\n<"));
    if (DsWs_CodeSelect.getRowCount() == 1) {
        rtn = DsWs_CodeSelect.getCellData(0, "nAuthGroupID") + "^" + DsWs_CodeSelect.getCellData(0, "sAuthGroupName");
    } else if (DsWs_CodeSelect.getRowCount() > 1) {
        rtn = "list";
    } else if (DsWs_CodeSelect.getRowCount() == 0) {
        rtn = "0";
    }
    return rtn;
};
//
//탭2 그리드 클릭
//
scwin.Tab0_tab2_Grid0_OnCellClick = function( nRow, nCell) {
    var promise = Promise.resolve();
    promise = promise.then(function(rtnVal) {
     	//"sAuthID=" + DsWs_UpperOrg.getCellData(nRow, "nAuthID") + " sApplySystem=A");
     	var indata = {"sAuthID" : DsWs_UpperOrg.getCellData(nRow, "nAuthID"),
     	                   "sApplySystem":"A"
     	                   };
     	var popInfo = {
     				width:680,
     				height:420,
     				indata :indata,
     				title : "메뉴조회"
     	};
     	
        return wprom.popupOpen("/ui/cbso/CBSO053P.xml",popInfo);
    });
    return promise;
};
]]></script>
    </head>
    <body>
        <xf:group class="cont_wrap" id="9959_main"
        	style="position:absolute; left:0px; top:33px; width:100%; height:610px;"
        	userData1="권한조회[9959_main]"
        	userData2=" OnLoadCompleted:scwin.OnLoadCompleted; ">
        	<DataObjects>
        		<DataObject></DataObject>
        		<DataObject></DataObject>
        		<DataObject></DataObject>
        		<DataObject></DataObject>
        		<DataObject></DataObject>
        	</DataObjects>
        	<ServiceObjects>
        		<ServiceObject></ServiceObject>
        		<ServiceObject></ServiceObject>
        		<ServiceObject></ServiceObject>
        	</ServiceObjects>
        	<w2:tabControl class="sty_tab"
        		ev:onchange="scwin.Tab0_OnChanged" id="Tab0"
        		style="position:absolute;left:0px;top:0px; width:100%; height:610px;"
        		tabIndex="1">
        		<w2:content alwaysDraw="true" id="Tab0_tab1"
        			style="position:absolute; UseDBuff:true;  InputPanel:FALSE;  EndLineColor:default;  border:Flat;height:100%;left:0px;top:24px;width: 100%;" frameMode="" scope="">
        			<xf:group arcsize="6" class="search_area"
        				id="Tab0_tab1_Shape0" style="top:15px;left:0px;width: 100%"
        				userData3="RoundRect">
        			</xf:group>
        			<xf:input class="sty_ipt_form"
        				id="Tab0_tab1_edt_sCenterDesc"
        				style="position:absolute; display:none;  border-style:solid;  height:20px; left:649px; top:-23px; width:81px;"
        				tabIndex="3">
        			</xf:input>
        			<w2:textbox class="sty_lb_Search"
        				id="Tab0_tab1_Static1" label="관리부서설명"
        				style="position:absolute; display:none;  VAlign:Middle;  text-align:right; height:20px; left:425px; top:-23px; width:76px;"
        				tagname="">
        			</w2:textbox>
        			<xf:input class="sty_ipt_form" disabled="true"
        				id="Tab0_tab1_edt_sCenterName"
        				style="position:absolute; border-style:solid;  height:20px;left:158px;top:24px; width:100px;"
        				tabIndex="4">
        			</xf:input>
        			<xf:input class="sty_ipt_form"
        				ev:onblur="scwin.edt_OnKillFocus"
        				id="Tab0_tab1_edt_sCenterCode"
        				style="position:absolute; ImeMode:none;  border-style:solid;  height:20px;left:73px;top:24px; width:60px;"
        				tabIndex="2" ev:onkeydown="scwin.edt_OnKeyDown">
        			</xf:input>
        			<w2:textbox class="sty_lb_Search"
        				id="Tab0_tab1_Static6" label="관리부서"
        				style="position:absolute; VAlign:Middle;  text-align:right; height:20px;left:5px;top:24px; width:56px;"
        				tagname="">
        			</w2:textbox>
        			<xf:select1 appearance="full" class="sty_ipt_form"
        				id="Tab0_tab1_rdo_sAuthView" rows="1" selectedIndex="1"
        				style="position:absolute; height:21px;left:519px;top:24px; width:110px;"
        				tabIndex="8" cols="">
        				<xf:choices>
        					<xf:item>
        						<xf:label><![CDATA[표시]]></xf:label>
        						<xf:value><![CDATA[1]]></xf:value>
        					</xf:item>
        					<xf:item>
        						<xf:label><![CDATA[숨김]]></xf:label>
        						<xf:value><![CDATA[2]]></xf:value>
        					</xf:item>
        				</xf:choices>
        				<Layout></Layout>
        				<Layout></Layout>
        			</xf:select1>
        			<w2:textbox class="sty_lb_Search"
        				id="Tab0_tab1_Static7" label="권한"
        				style="position:absolute; VAlign:Middle;  text-align:right; height:20px;left:472px;top:25px; width:32px;"
        				tagname="">
        			</w2:textbox>
        			<xf:trigger class="btn_Comm_Search"
        				ev:onclick="scwin.btn_OnClick" id="Tab0_tab1_btn_AuthGroup"
        				style="position:absolute;  height:20px;right:10px; width:54px;top:23px;"
        				tabIndex="9" type="anchor">
        				<xf:label><![CDATA[조회]]></xf:label>
        			</xf:trigger>
        			<xf:input class="sty_ipt_form" id="Tab0_tab1_Edit0"
        				style="position:absolute; border-style:solid;  height:20px;left:363px;top:24px; width:87px;"
        				tabIndex="10">
        			</xf:input>
        			<w2:textbox class="sty_lb_Search"
        				id="Tab0_tab1_Static0" label="권한그룹명"
        				style="position:absolute; VAlign:Middle;  text-align:right; height:20px;left:276px;top:24px; width:76px;"
        				tagname="">
        			</w2:textbox>
        			<xf:trigger class="detail_search"
        				ev:onclick="scwin.Tab0_tab1_btn_Pop_Search_OnClick"
        				id="Tab0_tab1_btn_Pop_Search"
        				style="position:absolute; Transparent:TRUE;  ImageID:btn_Search_Search;  height:20px;left:133px;top:24px; width:20px;"
        				tabIndex="12" type="anchor">
        			</xf:trigger>
        			<w2:gridView autoFit="" autoFitMinWidth=""
        				class="sty_Grid" dataList="DsWs_GroupAuthList"
        				ev:oncellclick="scwin.Tab0_tab2_Grd_List_OnCellClick"
        				focusMode="row" id="Tab0_tab1_Grd_List2" inputType="text"
        				readOnly="true"
        				style="position:absolute;  EndLineColor:default;  border:Flat;height:500px;left:0px;top:61px;width: 100%;"
        				tabIndex="13">
        				<w2:header>
        					<w2:row>
        						<w2:column dataType="text"
        							id="head_id_0" inputType="text" readOnly="true"
        							style="height:20px;" textAlign="center" userData1="0"
        							userData3="0" value="권한그룹 ID" width="141">
        						</w2:column>
        						<w2:column dataType="text"
        							id="head_id_1" inputType="text" readOnly="true"
        							style="height:20px;" textAlign="center" userData1="1"
        							userData3="0" value="권한그룹명" width="157">
        						</w2:column>
        						<w2:column dataType="text"
        							id="head_id_2" inputType="text" readOnly="true"
        							style="height:20px;" userData1="2" userData3="0"
        							value="관리부서" width="193" textAlign="center">
        						</w2:column>
        						<w2:column dataType="text"
        							id="head_id_3" inputType="text" readOnly="true"
        							style="height:20px;" textAlign="center" userData1="3"
        							userData3="0" value="그룹유형" width="131">
        						</w2:column>
        						<w2:column dataType="text"
        							id="head_id_4" inputType="text" readOnly="true"
        							style="height:20px;" textAlign="center" userData1="4"
        							userData3="0" value="권한설명" width="318">
        						</w2:column>
        						<w2:column dataType="text"
        							id="head_id_5" inputType="text" readOnly="true"
        							style="height:20px;" textAlign="center" userData1="5"
        							userData3="0" value="권한ID" width="96">
        						</w2:column>
        						<w2:column dataType="text"
        							id="head_id_6" inputType="text" readOnly="true"
        							style="height:20px;" textAlign="center" userData1="6"
        							userData3="0" value="권한명" width="262">
        						</w2:column>
        					</w2:row>
        				</w2:header>
        				<w2:gBody>
        					<w2:row>
        						<w2:column dataType="text"
        							id="nAuthGroupID" inputType="link" readOnly="true"
        							style="height:20px;" textAlign="center" userData1="0"
        							userData3="0" width="141">
        						</w2:column>
        						<w2:column dataType="text"
        							id="sAuthGroupName" inputType="text" readOnly="true"
        							textAlign="left" userData1="1" userData3="0" width="157"
        							style="height:20px;">
        						</w2:column>
        						<w2:column dataType="text"
        							id="sDepartName" inputType="text" readOnly="true"
        							textAlign="center" userData1="2" userData3="0"
        							width="193" style="height:20px;">
        						</w2:column>
        						<w2:column dataType="text"
        							id="sGroupTypeName" inputType="text" readOnly="true"
        							textAlign="center" userData1="3" userData3="0"
        							width="131" style="height:20px;">
        						</w2:column>
        						<w2:column dataType="text"
        							id="sDescription" inputType="text" readOnly="true"
        							textAlign="left" userData1="4" userData3="0" width="318"
        							style="height:20px;">
        						</w2:column>
        						<w2:column dataType="text" id="nAuthID"
        							inputType="text" readOnly="true" textAlign="center"
        							userData1="5" userData3="0" width="96"
        							style="height:20px;">
        						</w2:column>
        						<w2:column dataType="text"
        							id="sAuthName" inputType="text" readOnly="true"
        							textAlign="left" userData1="6" userData3="0" width="262"
        							style="height:20px;">
        						</w2:column>
        					</w2:row>
        				</w2:gBody>
        			</w2:gridView>
        		</w2:content>
        		<w2:content alwaysDraw="true" id="Tab0_tab2"
        			style="position:absolute; UseDBuff:true;  InputPanel:FALSE;  EndLineColor:default;  border:Flat;height:100%;left:0px;top:24px;width: 100%;" frameMode="" scope="">
        			<xf:group arcsize="6" class="search_area" id="Tab0_tab2_Shape0"
        				style="position:absolute; right:641px; bottom:59px; height:55px;left:0px;top:15px; width:100%;"
        				userData3="RoundRect">
        			</xf:group>
        			<w2:gridView autoFit="allColumn"
        				autoFitMinWidth="100" class="sty_Grid"
        				dataList="DsWs_UpperOrg"
        				ev:oncellclick="scwin.Tab0_tab2_Grid0_OnCellClick"
        				focusMode="row" id="Tab0_tab2_Grid0" inputType="text"
        				readOnly="true"
        				style="position:absolute;height:500px; left:0px; right:641px;top:73px; width:100%;"
        				tabIndex="1">
        				<w2:header>
        					<w2:row>
        						<w2:column dataType="text"
        							id="head_id_7" inputType="text" readOnly="true"
        							style="height:20px;" textAlign="center" userData1="0"
        							userData3="0" value="권한 ID" width="70">
        						</w2:column>
        						<w2:column dataType="text"
        							id="head_id_8" inputType="text" readOnly="true"
        							style="height:20px;" textAlign="center" userData1="1"
        							userData3="0" value="권한 명" width="112">
        						</w2:column>
        						<w2:column dataType="text"
        							id="head_id_9" inputType="text" readOnly="true"
        							style="height:20px;" textAlign="center" userData1="2"
        							userData3="0" value="권한구분" width="75">
        						</w2:column>
        						<w2:column dataType="text"
        							id="head_id_10" inputType="text" readOnly="true"
        							style="height:20px;" textAlign="center" userData1="3"
        							userData3="0" value="권한설명" width="295">
        						</w2:column>
        						<w2:column dataType="text"
        							id="head_id_11" inputType="text" readOnly="true"
        							style="height:20px;" textAlign="center" userData1="4"
        							userData3="0" value="관리부서" width="115">
        						</w2:column>
        					</w2:row>
        				</w2:header>
        				<w2:gBody>
        					<w2:row>
        						<w2:column dataType="text" id="nAuthID"
        							inputType="link" readOnly="true"
        							style="height:20px; cursor:hand; " textAlign="center"
        							userData1="0" userData3="0" width="70">
        						</w2:column>
        						<w2:column dataType="text"
        							id="sAuthName" inputType="text" readOnly="true"
        							style="height:20px;" textAlign="left" userData1="1"
        							userData3="0" width="112">
        						</w2:column>
        						<w2:column dataType="text"
        							id="sAuthType" inputType="select" readOnly="true"
        							style="height:20px;" textAlign="center" userData1="2"
        							userData3="0" width="75">
        							<w2:choices>
        								<w2:itemset
        									nodeset="data:Ds_AuthDiv">
        									<w2:value ref="CODE">
        									</w2:value>
        									<w2:label ref="TEXT">
        									</w2:label>
        								</w2:itemset>
        							</w2:choices>
        						</w2:column>
        						<w2:column dataType="text"
        							id="sDescription" inputType="text" readOnly="true"
        							style="height:20px;" textAlign="left" userData1="3"
        							userData3="0" width="295">
        						</w2:column>
        						<w2:column dataType="text"
        							id="sDepartName" inputType="text" readOnly="true"
        							style="height:20px;" textAlign="left" userData1="4"
        							userData3="0" width="115">
        						</w2:column>
        					</w2:row>
        				</w2:gBody>
        			</w2:gridView>
        			<xf:input class="sty_ipt_form"
        				ev:onblur="scwin.edt_OnKillFocus"
        				id="Tab0_tab2_edt_sCenterCode"
        				style="position:absolute; border-style:solid;  height:20px;left:73px;top:21px; width:90px;"
        				tabIndex="3" ev:onkeydown="scwin.edt_OnKeyDown">
        			</xf:input>
        			<xf:input class="sty_ipt_form" disabled="true"
        				id="Tab0_tab2_edt_sCenterName"
        				style="position:absolute; border-style:solid;  height:20px;left:186px;top:21px; width:104px;"
        				tabIndex="5">
        			</xf:input>
        			<xf:input class="sty_ipt_form" ev:onblur="" id="Tab0_tab2_edt_sAuthGroupID" style="position:absolute; ImeMode:none;  border-style:solid;  height:20px;left:481px;top:21px; width:65px;" tabIndex="15" ev:onkeydown="scwin.edt_OnKeyDown">
        			</xf:input><xf:input class="sty_ipt_form" disabled="true" id="Tab0_tab2_edt_sAuthGroupName" style="position:absolute; border-style:solid;  height:20px;left:573px;top:21px; width:118px;" tabIndex="16">
        			</xf:input><xf:input class="sty_ipt_form"
        				id="Tab0_tab2_edt_sCenterDesc"
        				style="position:absolute; border-style:solid;  height:20px;left:481px;top:45px; width:120px;"
        				tabIndex="4">
        			</xf:input>
        			<w2:textbox class="sty_lb_Search"
        				id="Tab0_tab2_Static6" label="관리부서"
        				style="position:absolute; VAlign:Middle;  text-align:right; height:20px;left:5px;top:21px; width:56px;"
        				tagname="">
        			</w2:textbox>
        			<w2:textbox class="sty_lb_Search"
        				id="Tab0_tab2_Static1" label="권한설명"
        				style="position:absolute; VAlign:Middle;  text-align:right; height:18px;left:417px;top:45px; width:51px;"
        				tagname="">
        			</w2:textbox>
        			<xf:trigger class="btn_Comm_Search"
        				ev:onclick="scwin.btn_OnClick" id="Tab0_tab2_btn_Auth"
        				style="position:absolute;  height:20px;right:10px; width:54px;top:23px;"
        				tabIndex="8" type="anchor">
        				<xf:label><![CDATA[조회]]></xf:label>
        			</xf:trigger>
        			<w2:textbox class="sty_lb_Search"
        				id="Tab0_tab2_Static0" label="권한명"
        				style="position:absolute; VAlign:Middle;  text-align:right; height:20px;left:19px;top:45px; width:40px;"
        				tagname="">
        			</w2:textbox>
        			<xf:input class="sty_ipt_form" id="Tab0_tab2_Edit0"
        				style="position:absolute; ImeMode:none;  border-style:solid;  height:20px;left:73px;top:45px; width:90px;"
        				tabIndex="9">
        			</xf:input>
        			<xf:trigger class="detail_search"
        				ev:onclick="scwin.Tab0_tab1_btn_Pop_Search_OnClick"
        				id="Tab0_tab2_btn_Pop_Search"
        				style="position:absolute; Transparent:TRUE;  ImageID:btn_Search_Search;  height:20px;left:162px;top:21px; width:20px;"
        				tabIndex="11" type="anchor">
        			</xf:trigger>
        			<w2:textbox class="sty_lb_Search"
        				id="Tab0_tab2_Static2" label="구분"
        				style="position:absolute; VAlign:Middle;  text-align:right; height:20px;left:215px;top:45px; width:30px;"
        				tagname="">
        			</w2:textbox>
        			<xf:select1 appearance="minimal"
        				class="sty_ipt_form" emptyItem="true" id="Tab0_tab2_Combo7"
        				style="position:absolute; INDEX:0;  border-style:solid;  height:20px;left:256px;top:44px; width:99px;"
        				tabIndex="13" visibleRowNum="10" textAlign="left" renderType="native">
        				<xf:choices>
        					<xf:itemset nodeset="data:Ds_AuthDiv">
        						<xf:label ref="TEXT"></xf:label>
        						<xf:value ref="CODE"></xf:value>
        					</xf:itemset>
        				</xf:choices>
        			</xf:select1>
        			
        			<xf:trigger class="detail_search"
        				ev:onclick="scwin.Tab0_tab2_btn_Pop_search1_OnClick"
        				id="Tab0_tab2_btn_Pop_search1"
        				style="position:absolute; Transparent:TRUE;  ImageID:btn_Search_Search;  height:20px;left:547px;top:21px; width:20px;"
        				tabIndex="17" type="anchor">
        			</xf:trigger>
        			
        			<w2:textbox class="sty_lb_Search"
        				id="Tab0_tab2_Static3" label="권한그룹명"
        				style="position:absolute; VAlign:Middle;  text-align:right; height:20px;left:400px;top:21px; width:69px;"
        				tagname="">
        			</w2:textbox>
        		</w2:content>
        		<w2:tabs disabled="false" id="tab0_tab1" label="권한그룹 조회"
        			style="">
        		</w2:tabs>
        		<w2:tabs disabled="false" id="tab0_tab2" label="개별권한 조회"
        			style="">
        		</w2:tabs>
        	</w2:tabControl>
        	
        </xf:group>
    <w2:wframe class="common_bu_area" id="" initScript="scwin.wfTitleFavInit();" src="/cm/common/wf_titleFav.xml" style="">
        	</w2:wframe></body>
</html>