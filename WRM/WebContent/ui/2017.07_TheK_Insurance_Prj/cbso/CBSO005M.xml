<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="/cm/css/all.css" type="text/css"?>
<?xml-stylesheet href="/cm/css/new.css" type="text/css"?>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare"
	xmlns:xf="http://www.w3.org/2002/xforms">
	<head>
		<w2:type>DEFAULT</w2:type>
		<w2:buildDate />
		<xf:model>
			<xf:instance>
				<data xmlns="" />
			</xf:instance>
			<w2:dataCollection baseNode="map">
				<w2:dataMap baseNode="map" id="dst_LginAuthInqrVo">
					<w2:keyInfo>
						<w2:key id="empNo" name="사번" dataType="text">
						</w2:key>
						<w2:key id="name" name="이름" dataType="text">
						</w2:key>
						<w2:key id="pstnDeptCd" name="소속부서코드"
							dataType="text">
						</w2:key>
						<w2:key id="bizAdmrYn" name="업무관리자"
							dataType="text">
						</w2:key>
						<w2:key id="geafAdmrYn" name="대면총무여부,지점장여부"
							dataType="text">
						</w2:key>
						<w2:key id="gaEducMngrAdmrYn" name="GA교육매니저여부"
							dataType="text">
						</w2:key>
						<w2:key id="agncyAdmrYn" name="대리점사용인관리자여부"
							dataType="text">
						</w2:key>
						<w2:key id="superAuthYn" name="super권한여부"
							dataType="text">
						</w2:key>
						<w2:key id="drctMangYn" name="직영여부"
							dataType="text">
						</w2:key>
						<w2:key id="crossYn" name="교차여부"
							dataType="text">
						</w2:key>
						<w2:key id="atchYn" name="전속여부"
							dataType="text">
						</w2:key>
						<w2:key id="gAYn" name="GA여부" dataType="text">
						</w2:key>
						<w2:key id="drctMangAdmrYn" name="직영관리자여부"
							dataType="text">
						</w2:key>
						<w2:key id="crossAdmrYn" name="교차관리자여부"
							dataType="text">
						</w2:key>
						<w2:key id="atchAdmrYn" name="전속관리자여부"
							dataType="text">
						</w2:key>
						<w2:key id="gAAdmrYn" name="GA관리자여부"
							dataType="text">
						</w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataMap baseNode="map" id="dst_NotcMattInfoVo">
					<w2:keyInfo>
						<w2:key id="noticMattId" name="공지사항id"
							dataType="text">
						</w2:key>
						<w2:key id="rgtrEmpNo" name="등록자사번"
							dataType="text">
						</w2:key>
						<w2:key id="rgtrEmpNm" name="등록자이름"
							dataType="text">
						</w2:key>
						<w2:key id="rgstDate" name="등록일자"
							dataType="text">
						</w2:key>
						<w2:key id="seqno" name="순번" dataType="text">
						</w2:key>
						<w2:key id="noticMattFlag" name="공지사항구분"
							dataType="text">
						</w2:key>
						<w2:key id="noticMattName" name="공지사항명"
							dataType="text">
						</w2:key>
						<w2:key id="noticMattCont" name="공지사항내용"
							dataType="text">
						</w2:key>
						<w2:key id="rgtrPstnCd" name="등록자소속코드"
							dataType="text">
						</w2:key>
						<w2:key id="apdxFileName" name="첨부파일명"
							dataType="text">
						</w2:key>
						<w2:key id="apdxFilePath" name="첨부파일경로"
							dataType="text">
						</w2:key>
						<w2:key id="inqrNum" name="조회수"
							dataType="text">
						</w2:key>
						<w2:key id="drctMangAuthYn" name="직영권한여부"
							dataType="text">
						</w2:key>
						<w2:key id="crossAuthYn" name="교차권한여부"
							dataType="text">
						</w2:key>
						<w2:key id="atchAuthYn" name="전속권한여부"
							dataType="text">
						</w2:key>
						<w2:key id="gAAuthYn" name="GA권한여부"
							dataType="text">
						</w2:key>
						<w2:key id="noticDate" name="게시일자"
							dataType="text">
						</w2:key>
						<w2:key id="noticEnddt" name="게시종료일자"
							dataType="text">
						</w2:key>
						<w2:key id="delYn" name="삭제여부"
							dataType="text">
						</w2:key>
						<w2:key id="inptDler" name="입력처리자"
							dataType="text">
						</w2:key>
						<w2:key id="inptDlerIP" name="입력처리자IP"
							dataType="text">
						</w2:key>
						<w2:key id="inptDate" name="입력일자"
							dataType="text">
						</w2:key>
						<w2:key id="inptHms" name="입력시간"
							dataType="text">
						</w2:key>
						<w2:key id="mdfcDler" name="수정처리자"
							dataType="text">
						</w2:key>
						<w2:key id="mdfcDlerIP" name="수정처리자IP"
							dataType="text">
						</w2:key>
						<w2:key id="mdfcDate" name="수정일자"
							dataType="text">
						</w2:key>
						<w2:key id="mdfcHms" name="수정시간"
							dataType="text">
						</w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataList id="dst_NotcMattInfoListVo" baseNode="list"
					saveRemovedData="true" repeatNode="map" attributeMap="">
					<w2:columnInfo>
						<w2:column id="noticMattId" name="공지사항id"
							dataType="text">
						</w2:column>
						<w2:column id="rgtrEmpNo" name="등록자사번"
							dataType="text">
						</w2:column>
						<w2:column id="rgtrEmpNm" name="등록자이름"
							dataType="text">
						</w2:column>
						<w2:column id="rgstDate" name="등록일자"
							dataType="text">
						</w2:column>
						<w2:column id="seqno" name="순번"
							dataType="text">
						</w2:column>
						<w2:column id="noticMattFlag" name="공지사항구분"
							dataType="text">
						</w2:column>
						<w2:column id="noticMattName" name="공지사항명"
							dataType="text">
						</w2:column>
						<w2:column id="noticMattCont" name="공지사항내용"
							dataType="text">
						</w2:column>
						<w2:column id="rgtrPstnCd" name="등록자소속코드"
							dataType="text">
						</w2:column>
						<w2:column id="apdxFileName" name="첨부파일명"
							dataType="text">
						</w2:column>
						<w2:column id="apdxFilePath" name="첨부파일경로"
							dataType="text">
						</w2:column>
						<w2:column id="inqrNum" name="조회수"
							dataType="text">
						</w2:column>
						<w2:column id="drctMangAuthYn" name="직영권한여부"
							dataType="text">
						</w2:column>
						<w2:column id="crossAuthYn" name="교차권한여부"
							dataType="text">
						</w2:column>
						<w2:column id="atchAuthYn" name="전속권한여부"
							dataType="text">
						</w2:column>
						<w2:column id="gAAuthYn" name="GA권한여부"
							dataType="text">
						</w2:column>
						<w2:column id="noticDate" name="게시일자"
							dataType="text">
						</w2:column>
						<w2:column id="noticEnddt" name="게시종료일자"
							dataType="text">
						</w2:column>
						<w2:column id="delYn" name="삭제여부"
							dataType="text">
						</w2:column>
						<w2:column id="inptDler" name="입력처리자"
							dataType="text">
						</w2:column>
						<w2:column id="inptDlerIP" name="입력처리자IP"
							dataType="text">
						</w2:column>
						<w2:column id="inptDate" name="입력일자"
							dataType="text">
						</w2:column>
						<w2:column id="inptHms" name="입력시간"
							dataType="text">
						</w2:column>
						<w2:column id="mdfcDler" name="수정처리자"
							dataType="text">
						</w2:column>
						<w2:column id="mdfcDlerIP" name="수정처리자IP"
							dataType="text">
						</w2:column>
						<w2:column id="mdfcDate" name="수정일자"
							dataType="text">
						</w2:column>
						<w2:column id="mdfcHms" name="수정시간"
							dataType="text">
						</w2:column>
						<w2:column id="seqNo" name="테이블시퀀스"
							dataType="text">
						</w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList id="dsl_noticMattFlag" baseNode="list"
					saveRemovedData="true" repeatNode="map">
					<w2:columnInfo>
						<w2:column id="CODE" name="CODE"
							dataType="text">
						</w2:column>
						<w2:column id="TEXT" name="TEXT"
							dataType="text">
						</w2:column>
					</w2:columnInfo>
					<w2:data use="true">
						<w2:row>
							<CODE><![CDATA[01]]></CODE>
							<TEXT><![CDATA[중요공지]]></TEXT>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[02]]></CODE>
							<TEXT><![CDATA[상품]]></TEXT>
						</w2:row>
						<w2:row>
							<CODE><![CDATA[03]]></CODE>
							<TEXT><![CDATA[인수]]></TEXT>
						</w2:row>
					</w2:data>
				</w2:dataList>
			</w2:dataCollection>
			<w2:workflowCollection>
			</w2:workflowCollection>
			
		</xf:model>
<script src="/cm/js/common.js"/>
<script src="/cm/js/val_lib.js"/>
<script src="/cm/js/util.js"/>
<script src="/cm/js/transSub.js"/>
<script src="/cm/js/callService.js"/>
<script src="/cm/js/gds.js"/>
<script src="/cm/js/wconv.js"/>
<script src="/cm/js/wprom.js"/>		
<script src="/cm/js/convertJs/Global_Script.js"/>
<script src="/cm/js/convertJs/comm_Webservice.js"/>
<script src="/cm/js/convertJs/NewGen_Script.js"/>
<script src="/cm/js/convertJs/LongTerm_Script.js"/>
		<script type="javascript"><![CDATA[
	var gsSysDate;			// global 현재일자
	var gUserID; 			// global 사용자 ID
	var gUserEmpName; 	    // global 부서명
			
	//**********************************************************
	// 초기화
	//**********************************************************
	scwin.init = function() {
	
		gsSysDate 		= WebSquare.date.getCurrentServerDate("yyyyMMdd"); 	// global 현재일자
		gUserID 		= util.getGdsValue("gUserID");    					// global 사용자 ID
		gUserEmpName 	= util.getGdsValue("gUserEmpName");    				// global 부서명
						
	    //----- 버튼 처리(입력, 수정, 삭제, 결재, 취소, 인쇄, 엑셀, 닫기)
		gfn_btnEnable(false, false, false, false, false, false, false, true);
	        	    
	    ic_dateFr.setValue(gsSysDate.substring(0, 6)+"01");
	    ic_dateTo.setValue(gsSysDate);	    	    
	    
	    //var promise = Promise.resolve();
	    //promise = promise.then(function(rtnVal) {
	     	// /common/CBSO0015.do 로그인자 권한조회	 
			scwin.getLginAuthInfo();	  			
	    //});	    
	    //return promise;	
	    	
	};

	//**********************************************************
	// 로그인자 권한조회 /common/CBSO005.do 로그인자 권한조회
	//**********************************************************
	scwin.getLginAuthInfo = function() {
		var promise = Promise.resolve();
		// 사번으로 로그인자 권한조회	
		//gUserID = "2080018";
		//gUserID = "C000148";
		dst_LginAuthInqrVo.set("empNo" , gUserID);
		
		var trans = new transSub();                  	// transaction 보낼 객체 생성
		trans.setId("retrieveLginIDAuthInqr");        	// transaction 보낼 SubmissionID
		trans.setUrl("/common/CBSO0015.do");   			// Controller 쪽으로 보낼 주소
		trans.setDs("dst_LginAuthInqrVo");					
		trans.targetDs("dst_LginAuthInqrVo");		
		trans.callBack("scwin.subCallBackfunction");  	// 받을 Dataset을 처리시 콜백함수
		trans.send();
		
	};
	
	//**********************************************************
	// 
	//**********************************************************
	scwin.subCallBackfunction = function(e){
		// e.subID : 서브미션 ID
		// e.flag  : s성공;
		// e.msg   : 트렌젝션 처리후 메세지
		// e."받을데이타셋"
		switch(e.subID){
			// 로그인ID권한조회
			case "retrieveLginIDAuthInqr":
				if(e.flag == "s") {
		
					dst_LginAuthInqrVo.setJSON(e.result);	
					
console.log("권한===================>\n"+
 "업무관리자             :"+dst_LginAuthInqrVo.get("bizAdmrYn")+"\n"
+"대면총무여부,지점장여부:"+dst_LginAuthInqrVo.get("geafAdmrYn")+"\n"
+"GA교육매니저여부       :"+dst_LginAuthInqrVo.get("gaEducMngrAdmrYn")+"\n"
+"대리점사용인관리자여부 :"+dst_LginAuthInqrVo.get("agncyAdmrYn")+"\n"
+"super권한여부          :"+dst_LginAuthInqrVo.get("superAuthYn")+"\n"
+"직영여부               :"+dst_LginAuthInqrVo.get("drctMangYn")+"\n"
+"교차여부               :"+dst_LginAuthInqrVo.get("crossYn")+"\n"
+"전속여부               :"+dst_LginAuthInqrVo.get("atchYn")+"\n"
+"GA여부                 :"+dst_LginAuthInqrVo.get("gAYn")+"\n"
+"직영관리자여부         :"+dst_LginAuthInqrVo.get("drctMangAdmrYn")+"\n"
+"교차관리자여부         :"+dst_LginAuthInqrVo.get("crossAdmrYn")+"\n"
+"전속관리자여부         :"+dst_LginAuthInqrVo.get("atchAdmrYn")+"\n"
+"GA관리자여부           :"+dst_LginAuthInqrVo.get("gAAdmrYn")+"\n"
);
					
					// 로그인자 권한이 하나도 없는 경우 조회 못하도록 조회버튼 비활성
			  		if(util.isNull(dst_LginAuthInqrVo.get("drctMangYn")) && 
			  		   util.isNull(dst_LginAuthInqrVo.get("crossYn")) && 
			  		   util.isNull(dst_LginAuthInqrVo.get("atchYn")) && 
			  		   util.isNull(dst_LginAuthInqrVo.get("gAYn")) && 
			  		   util.isNull(dst_LginAuthInqrVo.get("geafAdmrYn"))&&
			  		   util.isNull(dst_LginAuthInqrVo.get("superAuthYn"))&&
			  		   util.isNull(dst_LginAuthInqrVo.get("gaEducMngrAdmrYn"))&&
			  		   util.isNull(dst_LginAuthInqrVo.get("agncyAdmrYn"))&&
			  		   util.isNull(dst_LginAuthInqrVo.get("drctMangAdmrYn"))&&
			  		   util.isNull(dst_LginAuthInqrVo.get("crossAdmrYn"))&&
			  		   util.isNull(dst_LginAuthInqrVo.get("atchAdmrYn"))&&
			  		   util.isNull(dst_LginAuthInqrVo.get("gAAdmrYn"))
			  		   ){
			 			//btn_search.setDisabled(true);
						btn_rgstNotcMatt.visible(false);
						btn_rgstNotcMatt.setDisabled( true );
       					//wprom.alert("조회 권한이 없습니다.");        	
       					return;		
				 	}else{
				 	
						//장기업무부와 대면총무만 공지사항 등록 가능.
						if(dst_LginAuthInqrVo.get("bizAdmrYn") == "Y"
							|| dst_LginAuthInqrVo.get("geafAdmrYn") == "Y"
						){						
							btn_rgstNotcMatt.visible(true);
							btn_rgstNotcMatt.setDisabled( false );	
						}else{
							btn_rgstNotcMatt.visible(false);
							btn_rgstNotcMatt.setDisabled( true );
						}
						var promise = Promise.resolve();
						promise = promise.then(function(rtnVal) {
							// /common/CBSO0009.do //공지사항리스트조회
	   						scwin.btn_Search_onclick();	
						});
				 	}								
					
				}else {
					wprom.alert(e.msg);
				}															
			break;
			
			//공지사항조회
			case "retrieveNotcMattList":
				if(e.flag == "s") {
					dst_NotcMattInfoListVo.setJSON(e.result.notcMattInfoVo);
					
					if(dst_NotcMattInfoListVo.getRowCount()==0){
			        	wprom.alert("조회결과가 없습니다.");        	
			        	return;	
					}
					
					//wprom.alert("조회가 완료되었습니다.");
				}else {
					wprom.alert(e.msg);
				}															
			break;			
			
			//공지사항조회수수정
			case "modifyNotcMattDataInqrNum":
				if(e.flag == "s") {
					dst_NotcMattInfoVo.setJSON(e.result);
					
				}else {
					wprom.alert(e.msg);
				}															
			break;													
		}
	};
	
	
	//**********************************************************
	// 공지사항등록 조회
	//**********************************************************
	scwin.btn_Search_onclick = function() {

		// 로그인자 권한이 하나도 없는 경우 조회 못하도록 조회버튼 비활성
 		if(util.isNull(dst_LginAuthInqrVo.get("drctMangYn")) && 
 		   util.isNull(dst_LginAuthInqrVo.get("crossYn")) && 
 		   util.isNull(dst_LginAuthInqrVo.get("atchYn")) && 
 		   util.isNull(dst_LginAuthInqrVo.get("gAYn")) && 
 		   util.isNull(dst_LginAuthInqrVo.get("geafAdmrYn"))&&
 		   util.isNull(dst_LginAuthInqrVo.get("superAuthYn"))&&
 		   util.isNull(dst_LginAuthInqrVo.get("gaEducMngrAdmrYn"))&&
 		   util.isNull(dst_LginAuthInqrVo.get("agncyAdmrYn"))&&
 		   util.isNull(dst_LginAuthInqrVo.get("drctMangAdmrYn"))&&
 		   util.isNull(dst_LginAuthInqrVo.get("crossAdmrYn"))&&
 		   util.isNull(dst_LginAuthInqrVo.get("atchAdmrYn"))&&
 		   util.isNull(dst_LginAuthInqrVo.get("gAAdmrYn"))
 		   ){
			//btn_search.setDisabled(true);   			    
			btn_rgstNotcMatt.visible(false);
			btn_rgstNotcMatt.setDisabled( true );
			//wprom.alert("조회 권한이 없습니다.");
   			return;		
	 	}else{
			dst_NotcMattInfoListVo.removeAll();
			// 업무관리자는 모든 정보 조회, 취급자는 해당 조직에 등록된 자료만 조회
			// /common/CBSO0009.do //공지사항리스트조회
			scwin.getNotcMattList();		
	 	}
	
	};
	
	//**********************************************************
	// 공지사항리스트조회
	//**********************************************************
	scwin.getNotcMattList = function() {
	
		if(util.isNull(ic_dateFr.getValue())){			
        	wprom.alertF("조회 시작일자를 입력해 주세요.",{}, ic_dateFr);        	
        	return;		
		}		
		if(util.isNull(ic_dateTo.getValue())){			
        	wprom.alertF("조회 종료일자를 입력해 주세요.",{}, ic_dateTo);        	
        	return;		
		}	
		if(parseInt(ic_dateFr.getValue()-ic_dateTo.getValue())>0){
			wprom.alertF("조회시작일이 조회종료일보다 큽니다.",{},ic_dateFr);						
			return;
		}		
		if(WebSquare.date.dateDiff(ic_dateFr.getValue(),ic_dateTo.getValue())>31){
			wprom.alertF("최대 31일까지 조회 가능합니다.",{},ic_dateTo);
			return;
		}	
		
		// INPUT DS 세팅					
		dst_NotcMattInfoVo.set("rgtrEmpNo" , gUserID);//조회사원번호
		dst_NotcMattInfoVo.set("noticDate", ic_dateFr.getValue());	//게시일자
		dst_NotcMattInfoVo.set("noticEnddt", ic_dateTo.getValue());	//종료일자
		
		dst_NotcMattInfoVo.set("noticMattName","");
		dst_NotcMattInfoVo.set("noticMattCont","");
		dst_NotcMattInfoVo.set("noticMattFlag","");
		dst_NotcMattInfoVo.set("noticMattFlag", sel_noticMattFlag.getValue());//공지사항구분
		if(sel_searchFlag.getValue() == "N") {
			dst_NotcMattInfoVo.set("noticMattName", ib_searchWord.getValue());//공지사항명
		}else if(sel_searchFlag.getValue() == "C") {
			dst_NotcMattInfoVo.set("noticMattCont", ib_searchWord.getValue());//공지사항내용
		}	
		
		if(dst_LginAuthInqrVo.get("bizAdmrYn") == "Y"){
//			dst_NotcMattInfoVo.set("drctMangAuthYn", "Y");//직영권한
//			dst_NotcMattInfoVo.set("crossAuthYn", "Y");//교차권한
//			dst_NotcMattInfoVo.set("atchAuthYn", "Y");//전속권한
//			dst_NotcMattInfoVo.set("gAAuthYn", "Y");	//ga권한
			
			dst_NotcMattInfoVo.set("drctMangAuthYn", "");//직영권한
			dst_NotcMattInfoVo.set("crossAuthYn", "");//교차권한
			dst_NotcMattInfoVo.set("atchAuthYn", "");//전속권한
			dst_NotcMattInfoVo.set("gAAuthYn", "");	//ga권한
			
		}else{
			dst_NotcMattInfoVo.set("drctMangAuthYn", dst_LginAuthInqrVo.get("drctMangYn"));//직영권한
			dst_NotcMattInfoVo.set("crossAuthYn", dst_LginAuthInqrVo.get("crossYn"));//교차권한
			dst_NotcMattInfoVo.set("atchAuthYn", dst_LginAuthInqrVo.get("atchAuthYn"));//전속권한
			dst_NotcMattInfoVo.set("gAAuthYn", dst_LginAuthInqrVo.get("gAYn"));	//ga권한		
		}
				
		var trans = new transSub();                  	// transaction 보낼 객체 생성
		trans.setId("retrieveNotcMattList");        	// transaction 보낼 SubmissionID
		trans.setUrl("/common/CBSO0009.do");   			// Controller 쪽으로 보낼 주소
		trans.setDs("dst_NotcMattInfoVo");					
		trans.targetDs("dst_NotcMattInfoListVo");		
		trans.callBack("scwin.subCallBackfunction");  	// 받을 Dataset을 처리시 콜백함수
		trans.send();
		
	};
	
	//**********************************************************
	// 공지사항등록 버튼 클릭이벤트 
	//**********************************************************
	scwin.btn_rgstNotcMatt_onclick = function() {
		// 공지사항 등록[CBSO006P]팝업화면 오픈  	
		// 신규 자료등록을 위한 팝업오픈  
		scwin.openPopupCBSO006P("");
	};
	
	//**********************************************************
	// 공지사항등록[CBSO006P]팝업화면 오픈
	//**********************************************************	
	scwin.openPopupCBSO006P = function(sNoticMattId) {
 		var promise = Promise.resolve();	        
        promise = promise.then(function(rtnVal) {	
			var indata  = {"noticMattId" 	: sNoticMattId};
			var popInfo = {
			    "width"     : 740,
			    "height"    : 340,
			    "top"       : 100,
			    "left"      : 100,
			    "indata"    : indata,
			    //"callback"  : scwin.popupCallback,
			    "title"     : "공지사항 등록 및 조회"
			};
			return wprom.popupOpen("/ui/cbso/CBSO006P.xml", popInfo);
		});
		// 등록완료 되면 재조회 
		promise = promise.then(function(rtnVal) {	
			var rtnValue = wprom.getReturnData();
			if (rtnValue != "") {
				if(rtnValue == "I") {
					// /common/CBSO0009.do //공지사항리스트조회
   					scwin.btn_Search_onclick();	
	            }		            
			}
		});
	};
	
	//**********************************************************
	// 그리드 더블 클릭
	//**********************************************************
	scwin.grd_notcMattInfoList_oncelldblclick = function(row,col) {
		// 공지사항등록[CBSO006P]팝업화면 오픈  	
		var colId = grd_notcMattInfoList.getColumnID(col);
		
		//공지사항이름	
		if(colId == "noticMattName"){
			// 기존 자료조회를 위한 팝업오픈  
			if(row<0) {
				wprom.alertF("자료등록할 활동자료명을 클릭하세요", {}, grd_notcMattInfoList);	
				return;	
			}			
			var sNoticMattId = dst_NotcMattInfoListVo.getCellData(row, "noticMattId"); 
						
			var promise = Promise.resolve();
		    promise = promise.then(function(rtnVal) {
		    	scwin.openPopupCBSO006P(sNoticMattId);
				// 활동조회수 수정 
				//scwin.modNotcMattInqrNum(sNoticMattId);	
				
			});
			
		//공지사항첨부파일 클릭시	
		}else if(colId == "apdxFileName"){
			var apdxFileName = dst_NotcMattInfoListVo.getCellData(row, "apdxFileName"); 
			var apdxFilePath = dst_NotcMattInfoListVo.getCellData(row, "apdxFilePath");
			if(apdxFileName!=null && apdxFileName.trim()!= ""){
				util.fileDownload(apdxFilePath, apdxFileName);
			}			
		}
	};
	
	//**********************************************************
	// 공지사항 조회수수정
	//**********************************************************
	scwin.modNotcMattInqrNum = function(sNoticMattId) {
		// 영업활동자료Id   		
		dst_NotcMattInfoVo.set("noticMattId" , sNoticMattId);
			
		var trans = new transSub();                 // transaction 보낼 객체 생성
		trans.setId("modifyNotcMattDataInqrNum");     // transaction 보낼 SubmissionID
		trans.setUrl("/common/CBSO0014.do");   // Controller 쪽으로 보낼 주소
		trans.setDs("dst_NotcMattInfoVo");					
		trans.targetDs("dst_NotcMattInfoVo");		
		trans.callBack("scwin.subCallBackfunction");  // 받을 Dataset을 처리시 콜백함수
		trans.send();
	
	};
	
	//**********************************************************
	// 그리드 첨부파일 컬럼 customFormatter
	//**********************************************************
	scwin.setApdxFileInfo = function(data, formattedData, rowIndex, colIndex) {
		var sApdxFileName = dst_NotcMattInfoListVo.getCellData(rowIndex, "apdxFileName");
		
		// 첨부파일명이 존재하면 이미지 표시
		if(!util.isNull(sApdxFileName) && sApdxFileName.trim() != ""){
			formattedData = "<img src='/cm/images/contents/ico_top_save.png'>"
		}
		// 첨부파일명이 널이면 '-' 표시 
		else {
			formattedData = "-";
		}	
		return formattedData;	
	};
	
	//**********************************************************
	// 검색어 입력후 엔터키 치면 자동 조회
	//**********************************************************	
	scwin.ib_searchWord_onkeydown = function(e) {
		// 검색어 인풋박스 키다운이벤트시  조회버튼 클릭이벤트와 연결  
		if(e.keyCode == 13) {
			scwin.btn_Search_onclick();
		}	
	};
	]]></script>
	</head>
	<body>
		<xf:group class="contentWrap" id="" style="">
			<w2:wframe id="" style=""
				initScript="scwin.wfTitleFavInit();"
				src="/cm/common/wf_titleFav.xml" class="common_bu_area">
			</w2:wframe>

			<!-- group:s -->
			<xf:group id="" style="" class="section">
				<xf:group id="" style="" class="tbl_search">
					<xf:group id="" style="" adaptive=""
						class="w2tb tbl_sc" adaptiveThreshold="" tagname="table">
						<w2:attributes>
							<w2:summary></w2:summary>
						</w2:attributes>
						<xf:group tagname="colgroup">
							<xf:group style="width:60px;"
								tagname="col">
							</xf:group>
							<xf:group style="width:100px"
								tagname="col">
							</xf:group>
							<xf:group style="width:80px;"
								tagname="col">
							</xf:group>
							<xf:group style="width:230px"
								tagname="col">
							</xf:group>
							<xf:group style="width:80px;"
								tagname="col">
							</xf:group>
							<xf:group style="" tagname="col"></xf:group>
						</xf:group>
						<xf:group tagname="tr" style="">
							<xf:group style="" class="w2tb_th"
								tagname="th">
								공지구분
							</xf:group>
							<xf:group style="" class="w2tb_td"
								tagname="td">
								<xf:select1 allOption=""
									appearance="minimal" chooseOption="true" direction="auto"
									disabled="false" disabledClass="" displayMode="label"
									ev:onviewchange="" id="sel_noticMattFlag" optionOrder="" ref=""
									style="" submenuSize="" renderType="native"
									chooseOptionLabel="-전체-">
									<xf:choices>
										<xf:itemset
											nodeset="data:dsl_noticMattFlag">
											<xf:label ref="TEXT"></xf:label>
											<xf:value ref="CODE"></xf:value>
										</xf:itemset>
									</xf:choices>
								</xf:select1>
							</xf:group>
							<xf:group style="" class="w2tb_th"
								tagname="th">
								조회기간
							</xf:group>
							<xf:group style="" class="w2tb_td"
								tagname="td">
								<xf:group class="" style="">
									<w2:inputCalendar
										calendarValueType="yearMonthDate" focusOnDateSelect="false"
										footerDiv="false" id="ic_dateFr" renderDiv="true"
										renderType="component" rightAlign="false" style="width:100px"
										weekStartsOn="0">
									</w2:inputCalendar>
									<w2:textbox class="txt_bw" id=""
										label="~" tagname="span">
									</w2:textbox>
									<w2:inputCalendar
										calendarValueType="yearMonthDate" focusOnDateSelect="false"
										footerDiv="false" id="ic_dateTo" renderDiv="true"
										renderType="component" rightAlign="false" style="width:100px"
										weekStartsOn="0">
									</w2:inputCalendar>
								</xf:group>
							</xf:group>
							<xf:group style="" class="w2tb_th"
								tagname="th">
								조회구분
							</xf:group>
							<xf:group style="" class="w2tb_td"
								tagname="td">
								<xf:select1 allOption=""
									appearance="minimal" chooseOption="" direction="auto"
									disabled="false" disabledClass="" displayMode="label"
									ev:onviewchange="" id="sel_searchFlag" optionOrder="" ref=""
									style="width:80px" submenuSize="" renderType="native">
									<xf:choices>
										<xf:item>
											<xf:label><![CDATA[제목]]></xf:label>
											<xf:value><![CDATA[N]]></xf:value>
										</xf:item>
										<xf:item>
											<xf:label><![CDATA[내용]]></xf:label>
											<xf:value><![CDATA[C]]></xf:value>
										</xf:item>
									</xf:choices>
								</xf:select1>
								<xf:input id="ib_searchWord"
									style="width:250px" ev:onkeydown="scwin.ib_searchWord_onkeydown">
								</xf:input>
							</xf:group>
						</xf:group>
					</xf:group>
					<w2:anchor id="btn_Search" style=""
						ev:onclick="scwin.btn_Search_onclick" class="btn_sh"
						outerDiv="true" disabled="false">
						<xf:label><![CDATA[조회]]></xf:label>
					</w2:anchor>
				</xf:group>
			</xf:group>
			<!-- group:e -->

			<!-- group:s -->
			<xf:group id="" style="" class="section">
				<w2:gridView ignoreCellClick="false"
					ev:onrowindexchange="" autoFit="allColumn" rowStatusWidth="20"
					visibleRowNum="" class="cm_grid" wheelRows="" ev:onviewchange=""
					fixedColumnWithHidden="" dataList="dst_NotcMattInfoListVo" id="grd_notcMattInfoList"
					style="height:550px" scrollByColumn="false" useShiftKey="true"
					rowStatusVisible="" ev:onafteredit="" rowStatusHeaderValue="상태"
					ev:oncellclick="" rowNumVisible="true" rowNumWidth="30" ev:oncelldblclick="scwin.grd_notcMattInfoList_oncelldblclick" rowNumHeaderValue="No" readOnly="true">
					<w2:header id="header1" style="">
						<w2:row id="row2" style="">
							<w2:column id="column2" blockSelect="false"
								style="height:20px;" width="150" inputType="text" value="공지ID"
								displayMode="label" hidden="true">
							</w2:column>
							<w2:column id="column3" blockSelect="false"
								style="height:20px;" width="80" inputType="text" value="공지구분"
								displayMode="label">
							</w2:column>
							<w2:column id="column4" blockSelect="false"
								style="height:20px;" width="400" inputType="text" value="제목"
								displayMode="label">
							</w2:column>
							<w2:column id="column5" blockSelect="false"
								style="height:20px;" width="100" inputType="text" value="첨부파일"
								displayMode="label">
							</w2:column>
							<w2:column id="column6" blockSelect="false"
								style="height:20px;" width="80" inputType="text" value="등록자"
								displayMode="label">
							</w2:column>
							<w2:column id="column7" blockSelect="false"
								style="height:20px;" width="100" inputType="text" value="등록일"
								displayMode="label">
							</w2:column>
							<w2:column id="column8" blockSelect="false"
								style="height:20px;" width="40" inputType="text" value="조회수"
								displayMode="label">
							</w2:column>
						</w2:row>
					</w2:header>
					<w2:gBody id="gBody4" style="">
						<w2:row id="row5" style="">
							<w2:column id="noticMattId" blockSelect="false"
								style="" width="400" inputType="" displayMode="label">
							</w2:column>
							<w2:column id="noticMattFlag"
								blockSelect="false" style="" width="80" inputType="select"
								displayMode="label" allOption="" chooseOption="">
								<w2:choices>
									<w2:itemset
										nodeset="data:dsl_noticMattFlag">
										<w2:label ref="TEXT"></w2:label>
										<w2:value ref="CODE"></w2:value>
									</w2:itemset>
								</w2:choices>
							</w2:column>
							<w2:column id="noticMattName" blockSelect="false"
								style="" width="400" inputType="" displayMode="label" textAlign="left" escape="true">
							</w2:column>
							<w2:column id="apdxFileName"
								blockSelect="false" style="" width="100" inputType="text"
								displayMode="label"
								imageSrc="/cm/images/contents/ico_top_save.png"
								displayFormatter=""
								customFormatter="scwin.setApdxFileInfo">
							</w2:column>
							<w2:column id='rgtrEmpNm' blockSelect="false"
								style="" width="80" inputType="" displayMode="label">
							</w2:column>
							<w2:column id="rgstDate" blockSelect="false"
								style="" width="100" inputType="" displayMode="label" displayFormatter="" displayFormat="" dataType="date">
							</w2:column>
							<w2:column id="inqrNum" blockSelect="false"
								style="" width="80" inputType="" displayMode="label">
							</w2:column>
						</w2:row>
					</w2:gBody>
				</w2:gridView>
			</xf:group>
			<!-- group:e -->

			
			<xf:group class="section bottom_center" id="" style="">
				
				<xf:group class="fr" id="" style="">
				<w2:anchor id="btn_rgstNotcMatt" style="" ev:onclick="scwin.btn_rgstNotcMatt_onclick" class="btn_nml" outerDiv="true">
					<xf:label><![CDATA[공지사항 등록]]></xf:label>
				</w2:anchor></xf:group>
			</xf:group>
		</xf:group>
	</body>
</html>