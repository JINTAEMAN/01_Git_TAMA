<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="/cm/css/all.css" type="text/css"?>
<?xml-stylesheet href="/cm/css/convert.css" type="text/css"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
	<head>
    <!-- 
        ###################################################
         파일명 : CBSC116P.xml
         프로그램명 : 화재손해(건물) 특약상세입력
         설 명 :  화재손해(건물) 특약상세입력
         작성자 : 진태만
         작성일 : 2017.09.29
 
         수정일자            수정자                  수정내용
        ==================================================
        2017.09.29        진태만          최초작성
        ###################################################
     -->
	 <w2:type>DEFAULT</w2:type>
        <w2:buildDate/>
        <xf:model>
            <xf:instance>
                <data/>
            </xf:instance>
            <w2:dataCollection> 
          		<!-- 피보험 목적물 적용 정보 Ds  -->	
            	<w2:dataList id="Ds_Prprt_Appl" baseNode="list" saveRemovedData="true" repeatNode="map">
            		<w2:columnInfo>
            			<w2:column id="sPlanNo" name="설계번호" dataType="text"/>
						<w2:column id="sPoleTypeCd" name="기둥형태코드" dataType="text"/>
            			<w2:column id="sExtrnWlTypeCd" name="외벽형태코드" dataType="text"/>
            			<w2:column id="sRoofTypeCd" name="지붕형태코드" dataType="text"/>
            			<w2:column id="nInsrdObjctSeqno" name="name2" dataType="text"/>
            			<w2:column id="nCrChngNo" name="name3" dataType="text"/>
            			<w2:column id="sInsBntpCd" name="name4" dataType="text"/>
            			<w2:column id="sInsBntpCdMcls" name="name5" dataType="text"/>
            			<w2:column id="sInsBntpObjtFlagCd" name="name6" dataType="text"/>
            			<w2:column id="sRatoBntpCd" name="name7" dataType="text"/>
            			<w2:column id="sRatoBntpCdMcls" name="name8" dataType="text"/>
            			<w2:column id="sRatoBntpObjtFlagCd" name="name9" dataType="text"/>            			 
            			<w2:column id="sBuldgStrtGradCd" name="name13" dataType="text"/>
            			<w2:column id="sBuldgStrtGradCdNm" name="name14" dataType="text"/>
            			<w2:column id="nInsArea" name="name15" dataType="text"/>
            			<w2:column id="nBuldgGrodFlct" name="name16" dataType="text"/>
            			<w2:column id="nBuldgUndgFlct" name="name17" dataType="text"/>
            			<w2:column id="sObjctGrodUndgFlagCd" name="name18" dataType="text"/>
            			<w2:column id="nObjctRelvFlct" name="name19" dataType="text"/>
            			<w2:column id="sSpclBuldgFlagCd" name="name20" dataType="text"/>
            			<w2:column id="sSpclBuldgNo" name="name21" dataType="text"/>
            			<w2:column id="sSpclBuldgTypeCd" name="name22" dataType="text"/>
            			<w2:column id="sEmplSubCvrgeInsYn" name="name23" dataType="text"/>
            			<w2:column id="sEqmtOwnRprtnBntpCd" name="name24" dataType="text"/>
            			<w2:column id="sEqmtScal" name="name25" dataType="text"/>
            			<w2:column id="sSchlMngrRprtnBntpCd" name="name26" dataType="text"/>
            			<w2:column id="nStuNum" name="name27" dataType="text"/>
            			<w2:column id="sParkEqmtFlagCd" name="name28" dataType="text"/>
            			<w2:column id="nPrkLtArea" name="name29" dataType="text"/>
            			<w2:column id="nParkAvaCarNum" name="name30" dataType="text"/>
            			<w2:column id="nPrkLtMachNum" name="name31" dataType="text"/>
            			<w2:column id="sFoodRprtnBntpCd" name="name32" dataType="text"/>
            			<w2:column id="nBfyySaleAmt" name="name33" dataType="text"/>
            			<w2:column id="sGasRprtnBntpCd" name="name34" dataType="text"/>
            			<w2:column id="sGasRprtnAreaFlagCd" name="name35" dataType="text"/>
            			<w2:column id="sGasEqmtCpctFlagCd" name="name36" dataType="text"/>
            			<w2:column id="sCityGasUseFlagCd" name="name37" dataType="text"/>
            			<w2:column id="sGasEqmtUndgLctnYn" name="name38" dataType="text"/>
            			<w2:column id="sAgreRestTermCd" name="name39" dataType="text"/>
            			<w2:column id="sOwnrFlagCd" name="name40" dataType="text"/>
            			<w2:column id="sOwnrDscrNo" name="name41" dataType="text"/>
            			<w2:column id="sOwnrNm" name="name42" dataType="text"/>
            			<w2:column id="sCrtorReln" name="name43" dataType="text"/>
            			<w2:column id="sAccptPlac" name="name44" dataType="text"/>
            			<w2:column id="sPaymTermCd" name="name45" dataType="text"/>
            			<w2:column id="nRealPaymTerm" name="name46" dataType="text"/>
            			<w2:column id="sInsurTermCd" name="name47" dataType="text"/>
            			<w2:column id="nRealInsurTerm" name="name48" dataType="text"/>
            			<w2:column id="sInsrdObjctStatCd" name="name49" dataType="text"/>
            			<w2:column id="sInsurStrtdate" name="name50" dataType="text"/>
            			<w2:column id="sInsurEndDate" name="name51" dataType="text"/>
            			<w2:column id="sCnclExtnEndDate" name="name52" dataType="text"/>
            			<w2:column id="sApplPlanCd" name="name53" dataType="text"/>
            			<w2:column id="sApplPlanName" name="name54" dataType="text"/>
            			<w2:column id="sInptDler" name="name55" dataType="text"/>
            			<w2:column id="sInptDlerIP" name="name56" dataType="text"/>
            			<w2:column id="sInptDate" name="name57" dataType="text"/>
            			<w2:column id="sInptHms" name="name58" dataType="text"/>
            			<w2:column id="sMdfcDler" name="name59" dataType="text"/>
            			<w2:column id="sMdfcDlerIP" name="name60" dataType="text"/>
            			<w2:column id="sMdfcDate" name="name61" dataType="text"/>
            			<w2:column id="sMdfcHms" name="name62" dataType="text"/>
            			<w2:column id="nGrntPrem" name="name63" dataType="text"/>
            			<w2:column id="sel1" name="name64" dataType="text"/>
            		</w2:columnInfo>
            	</w2:dataList>
				
				<!-- 피보험 목적물 정보 Ds  -->	
            	<w2:dataList id="Ds_Prprt" baseNode="list" saveRemovedData="true" repeatNode="map">
            		<w2:columnInfo>
            			<w2:column id="sPlanNo" name="name1" dataType="text"/>
            			<w2:column id="nInsrdObjctSeqno" name="name2" dataType="text"/>
            			<w2:column id="nCrChngNo" name="name3" dataType="text"/>
            			<w2:column id="sInsBntpCd" name="name4" dataType="text"/>
            			<w2:column id="sInsBntpCdMcls" name="name5" dataType="text"/>
            			<w2:column id="sInsBntpObjtFlagCd" name="name6" dataType="text"/>
            			<w2:column id="sRatoBntpCd" name="name7" dataType="text"/>
            			<w2:column id="sRatoBntpCdMcls" name="name8" dataType="text"/>
            			<w2:column id="sRatoBntpObjtFlagCd" name="name9" dataType="text"/>
            			<w2:column id="sPoleTypeCd" name="name10" dataType="text"/>
            			<w2:column id="sExtrnWlTypeCd" name="name11" dataType="text"/>
            			<w2:column id="sRoofTypeCd" name="name12" dataType="text"/>
            			<w2:column id="sBuldgStrtGradCd" name="name13" dataType="text"/>
            			<w2:column id="sBuldgStrtGradCdNm" name="name14" dataType="text"/>
            			<w2:column id="nInsArea" name="name15" dataType="text"/>
            			<w2:column id="nBuldgGrodFlct" name="name16" dataType="text"/>
            			<w2:column id="nBuldgUndgFlct" name="name17" dataType="text"/>
            			<w2:column id="sObjctGrodUndgFlagCd" name="name18" dataType="text"/>
            			<w2:column id="nObjctRelvFlct" name="name19" dataType="text"/>
            			<w2:column id="sSpclBuldgFlagCd" name="name20" dataType="text"/>
            			<w2:column id="sSpclBuldgNo" name="name21" dataType="text"/>
            			<w2:column id="sSpclBuldgTypeCd" name="name22" dataType="text"/>
            			<w2:column id="sEmplSubCvrgeInsYn" name="name23" dataType="text"/>
            			<w2:column id="sEqmtOwnRprtnBntpCd" name="name24" dataType="text"/>
            			<w2:column id="sEqmtScal" name="name25" dataType="text"/>
            			<w2:column id="sSchlMngrRprtnBntpCd" name="name26" dataType="text"/>
            			<w2:column id="nStuNum" name="name27" dataType="text"/>
            			<w2:column id="sParkEqmtFlagCd" name="name28" dataType="text"/>
            			<w2:column id="nPrkLtArea" name="name29" dataType="text"/>
            			<w2:column id="nParkAvaCarNum" name="name30" dataType="text"/>
            			<w2:column id="nPrkLtMachNum" name="name31" dataType="text"/>
            			<w2:column id="sFoodRprtnBntpCd" name="name32" dataType="text"/>
            			<w2:column id="nBfyySaleAmt" name="name33" dataType="text"/>
            			<w2:column id="sGasRprtnBntpCd" name="name34" dataType="text"/>
            			<w2:column id="sGasRprtnAreaFlagCd" name="name35" dataType="text"/>
            			<w2:column id="sGasEqmtCpctFlagCd" name="name36" dataType="text"/>
            			<w2:column id="sCityGasUseFlagCd" name="name37" dataType="text"/>
            			<w2:column id="sGasEqmtUndgLctnYn" name="name38" dataType="text"/>
            			<w2:column id="sAgreRestTermCd" name="name39" dataType="text"/>
            			<w2:column id="sOwnrFlagCd" name="name40" dataType="text"/>
            			<w2:column id="sOwnrDscrNo" name="name41" dataType="text"/>
            			<w2:column id="sOwnrNm" name="name42" dataType="text"/>
            			<w2:column id="sCrtorReln" name="name43" dataType="text"/>
            			<w2:column id="sAccptPlac" name="name44" dataType="text"/>
            			<w2:column id="sPaymTermCd" name="name45" dataType="text"/>
            			<w2:column id="nRealPaymTerm" name="name46" dataType="text"/>
            			<w2:column id="sInsurTermCd" name="name47" dataType="text"/>
            			<w2:column id="nRealInsurTerm" name="name48" dataType="text"/>
            			<w2:column id="sInsrdObjctStatCd" name="name49" dataType="text"/>
            			<w2:column id="sInsurStrtdate" name="name50" dataType="text"/>
            			<w2:column id="sInsurEndDate" name="name51" dataType="text"/>
            			<w2:column id="sCnclExtnEndDate" name="name52" dataType="text"/>
            			<w2:column id="sApplPlanCd" name="name53" dataType="text"/>
            			<w2:column id="sApplPlanName" name="name54" dataType="text"/>
            			<w2:column id="sInptDler" name="name55" dataType="text"/>
            			<w2:column id="sInptDlerIP" name="name56" dataType="text"/>
            			<w2:column id="sInptDate" name="name57" dataType="text"/>
            			<w2:column id="sInptHms" name="name58" dataType="text"/>
            			<w2:column id="sMdfcDler" name="name59" dataType="text"/>
            			<w2:column id="sMdfcDlerIP" name="name60" dataType="text"/>
            			<w2:column id="sMdfcDate" name="name61" dataType="text"/>
            			<w2:column id="sMdfcHms" name="name62" dataType="text"/>
            			<w2:column id="nGrntPrem" name="name63" dataType="text"/>
            			<w2:column id="sel1" name="name64" dataType="text"/>
            		</w2:columnInfo>
            	</w2:dataList>
            	
   				<!-- 건물구조급수코드 Ds -->
            	<w2:dataList id="Ds_BuldgStrtGradCd" baseNode="list" saveRemovedData="true" repeatNode="map">
            		<w2:columnInfo>
            			<w2:column id="sCd" name="" dataType="text"></w2:column>
            			<w2:column id="sCdType" name="" dataType="text"/>
            			<w2:column id="sCdTypeName" name="" dataType="text"/>
            			<w2:column id="sHnglCdName" name="" dataType="text"/>
            			<w2:column id="sEngCdName" name="" dataType="text"/>
            		</w2:columnInfo>
            	</w2:dataList>
            	
				<!-- 목적물지상지하구분코드 Ds -->
            	<w2:dataList id="Ds_ObjctGrodUndgFlagCd"  baseNode="list" saveRemovedData="true" repeatNode="map">
            		<w2:columnInfo>
            			<w2:column id="sCd" name="" dataType="text"></w2:column>
            			<w2:column id="sCdType" name="" dataType="text"/>
            			<w2:column id="sCdTypeName" name="" dataType="text"/>
            			<w2:column id="sHnglCdName" name="" dataType="text"/>
            			<w2:column id="sEngCdName" name="" dataType="text"/>
            		</w2:columnInfo>
            	</w2:dataList>
            	
            	<!-- 기둥형태 Ds -->
            	<w2:dataList id="Ds_PoleTypeCd" baseNode="list" saveRemovedData="true" repeatNode="map">
            		<w2:columnInfo>
            			<w2:column id="sCd" name="" dataType="text"></w2:column>
            			<w2:column id="sCdType" name="" dataType="text"/>
            			<w2:column id="sCdTypeName" name="" dataType="text"/>
            			<w2:column id="sHnglCdName" name="" dataType="text"/>
            			<w2:column id="sEngCdName" name="" dataType="text"/>
            		</w2:columnInfo>
            	</w2:dataList>

            	<!-- 외벽형태 Ds -->
            	<w2:dataList baseNode="list" id="Ds_ExtrnWlTypeCd" saveRemovedData="true" repeatNode="map">
            		<w2:columnInfo>
            			<w2:column id="sCd" name="" dataType="text"></w2:column>
            			<w2:column id="sCdType" name="" dataType="text"/>
            			<w2:column id="sCdTypeName" name="" dataType="text"/>
            			<w2:column id="sHnglCdName" name="" dataType="text"/>
            			<w2:column id="sEngCdName" name="" dataType="text"/>
            		</w2:columnInfo>
            	</w2:dataList>

            	<!-- 지붕형태코드 Ds -->
            	<w2:dataList baseNode="list" id="Ds_RoofTypeCd" saveRemovedData="true" repeatNode="map">
            		<w2:columnInfo>
            			<w2:column id="sCd" name="" dataType="text"></w2:column>
            			<w2:column id="sCdType" name="" dataType="text"/>
            			<w2:column id="sCdTypeName" name="" dataType="text"/>
            			<w2:column id="sHnglCdName" name="" dataType="text"/>
            			<w2:column id="sEngCdName" name="" dataType="text"/>
            		</w2:columnInfo>
            	</w2:dataList>            	 
 
            	<w2:dataList baseNode="list" id="DsWs_BuldgStrtGradCd" repeatNode="map" userData2="//*/hashtable/data/vector/data" />
            	<w2:dataList baseNode="list" id="DsWs_ObjctGrodUndgFlagCd" repeatNode="map" userData2="//*/hashtable/data/vector/data" />
            	<w2:dataList baseNode="list" id="DsWs_PoleTypeCd" repeatNode="map" userData2="//*/hashtable/data/vector/data" />
            	<w2:dataList baseNode="list" id="DsWs_ExtrnWlTypeCd" repeatNode="map" userData2="//*/hashtable/data/vector/data" />
            	<w2:dataList baseNode="list" id="DsWs_RoofTypeCd" repeatNode="map" userData2="//*/hashtable/data/vector/data" />
            	 
            </w2:dataCollection>
            <w2:workflowCollection/>
        </xf:model>
        
		<!--// js Script include //--> 
		<script src="/cm/js/convertJs/Global_Script.js"/>
		<script src="/cm/js/convertJs/comm_Webservice.js"/> 
	 	<script src="/cm/js/convertJs/LongTerm_Script.js"/>
 
        <script><![CDATA[
		
 /****************************************************************************
 * 프로그램번호   : B630_Pop
 * 프로그램명     : 화재손해(건물) 특약상세입력
 * 파일명         : B630_Pop.xml
 * 프로그램 내용  : 화재손해(건물) 특약상세입력
 * 관련 프로그램  : 
 * 작성자         : coolys
 * 작성일         : 2013-05-29lfn_setBuldgStrtName
 * 저작권         : Copyright ⓒ 2004. the K 손해보험㈜. All Right Reserved.
 * 변경내역       : 
 ****************************************************************************/

var applyEnable = "N";  // 설계상태(인수완료)-적용버튼(비활성화)   
var parent_Ds_Prprt = "";		// 부모창 목적물 정보 Ds Set  

//---------------------------------------------------------------------------
// function 명 : FORM_OnLoadCompleted(obj)
// 내용        : FORM OnLoad
//---------------------------------------------------------------------------
scwin.init = function() { 
	console.log("[/CBSC116P.xml] [init()] ==> [폼 로딩] [TEST_01]" );
	
	var pro = Promise.resolve();
	window.top.util.winTopShowModalChk = "T";
	util.winTopShowModal();

	pro = pro.then(function(rv) {
		return util.winTopShowModalPromise();
	});

	pro = pro.then(function(rv) {
		// init 부분 함수 입력하는곳  // =================================================>
		
		var indata = $w.getParameter("param");  
		var inJSON = JSON.parse(indata); 	// 부모창에서 받아온 값( 예) inJSON.sMyPlan)
	 
		if (!util.isNull(inJSON.applyEnable)) 	applyEnable = inJSON.applyEnable;	 // 설계상태(인수완료)-적용버튼(비활성화)   
		
		var pObj = wprom.getParamObject();  
		parent_Ds_Prprt = pObj.Ds_Prprt;	// 부모창 목적물 정보 Ds Set 
	   
	    if (applyEnable == "Y")  btn_apply.setDisabled(false);
	 	//console.log("[/CBSC116P.xml] [init()] ==> [폼 로딩] ==> [적용버튼(비활성화)]"+ applyEnable );    	
	 
	     // 공통코드 조회
	   	scwin.lfn_getCommonCodes();
	            
	    // DataSet 초기화
	    scwin.lfn_initDataset(); 
	      
	     // 건물구조명 설정
	 	scwin.lfn_setBuldgStrtName(); 
 		
		return ;		// init 함수를 종료하고자 할때 사용	// =================================================> 
	});

	pro = pro.then(function(rv) {
		util.winTopHideModal();
	});
 	 
	return pro; 
	//console.log("[/CBSC116P.xml] [init()] ==> [폼 로딩]] [TEST_end]" );
};

//---------------------------------------------------------------------------
// function 명 : lfn_getCommonCodes
// 내용        : 공통코드 조회 
//---------------------------------------------------------------------------
scwin.lfn_getCommonCodes = function() {
	//console.log("[/CBSC116P.xml] [lfn_getCommonCodes()] ==> [공통코드 조회_01] [TEST_01]" );

    wconv.clear(DsWs_BuldgStrtGradCd); // 건물구조급수코드
    wconv.clear(DsWs_ObjctGrodUndgFlagCd); // 목적물지상지하구분코드
    wconv.clear(DsWs_PoleTypeCd); // 기둥형태
    wconv.clear(DsWs_ExtrnWlTypeCd); // 외벽형태
    wconv.clear(DsWs_RoofTypeCd); // 지붕형태
 
	var dataSets = "DsWs_BuldgStrtGradCd DsWs_ObjctGrodUndgFlagCd DsWs_PoleTypeCd DsWs_ExtrnWlTypeCd DsWs_RoofTypeCd";   
	var columns = "S03 ObjctGrodUndgFlagCd PoleTypeCd ExtrnWlTypeCd RoofTypeCd";   
    var objects = "";
    var titleTypes =  "N N N N N"; 		// A:전체, S:선택, N:안넣기  
    
    gfn_getCommonCodes(dataSets, columns, objects, titleTypes);
    //console.log("[/CBSC116P.xml] [lfn_getCommonCodes()] ==> [DsWs_PoleTypeCd_갯수]"+ DsWs_PoleTypeCd.getRowCount() +"[DsWs_PoleTypeCd]"+ WebSquare.xml.serialize(DsWs_PoleTypeCd.getAllXML()) ); 
    //console.log("[/CBSC068M.xml] [lfn_getCommonCodes()] ==> [공통코드 조회] [TEST_end]" );  
};

//---------------------------------------------------------------------------
// function 명 : getComCodeS
// 내용        : 공통코드 조회2
//---------------------------------------------------------------------------
scwin.getComCodeS = function() { 
	//console.log("[/CBSC068M.xml] [getComCodeS()] ==> [공통코드 조회_02] [TEST_01]" );
	
 	wconv.clear(DsWs_BuldgStrtGradCd); // 건물구조급수코드
    wconv.clear(DsWs_ObjctGrodUndgFlagCd); // 목적물지상지하구분코드
  
	var dataSets = "DsWs_BuldgStrtGradCd DsWs_ObjctGrodUndgFlagCd";   
	var columns = "S03 ObjctGrodUndgFlagCd";   
    var objects = "";
    var titleTypes =  "N N"; 		// A:전체, S:선택, N:안넣기  
    
    gfn_getCommonCodes(dataSets, columns, objects, titleTypes);
	//console.log("[/CBSC116P.xml] [getComCodeS()] ==> [DsWs_BuldgStrtGradCd, 갯수]"+ DsWs_BuldgStrtGradCd.getRowCount() +"[DsWs_BuldgStrtGradCd]"+ WebSquare.xml.serialize(DsWs_BuldgStrtGradCd.getAllXML()) ); 
 
    //console.log("[/CBSC068M.xml] [getComCodeS()] ==> [공통코드 조회] [TEST_end]" );  
};

 //---------------------------------------------------------------------------
// function 명 : lfn_initDataset
// 내용        : DataSet 초기화
//---------------------------------------------------------------------------
 scwin.lfn_initDataset = function() { 
 	//console.log("[/CBSC116P.xml] [lfn_initDataset()] ==> [DataSet 초기화] [TEST_01]" ); 
  
	wconv.copy(Ds_Prprt_Appl, parent_Ds_Prprt);	 // 피보험목적물 Dataset Copy(Ds_Prprt_Appl 데이타 생성됨) 
   
	scwin.getComCodeS();		 // 공통코드 조회  
 
	wconv.copy(Ds_BuldgStrtGradCd, DsWs_BuldgStrtGradCd);	    // 건물구조급수코드 Dataset Copy(Ds_Prprt_Appl 데이타 생성됨) 
 	wconv.copy(Ds_ObjctGrodUndgFlagCd, DsWs_ObjctGrodUndgFlagCd);	  // 목적물지상지하구분코드  Dataset Copy(Ds_ObjctGrodUndgFlagCd 데이타 생성됨) 
 	wconv.copy(Ds_PoleTypeCd, DsWs_PoleTypeCd);	    // 기둥형태  Dataset Copy(Ds_PoleTypeCd 데이타 생성됨)       
    wconv.copy(Ds_ExtrnWlTypeCd, DsWs_ExtrnWlTypeCd);	  // 외벽형태 Dataset Copy(Ds_ExtrnWlTypeCd 데이타 생성됨)     
    wconv.copy(Ds_RoofTypeCd, DsWs_RoofTypeCd); 	 // 지붕형태 Dataset Copy(Ds_RoofTypeCd 데이타 생성됨) 
 
	//cmb_BuldgStrtGradCd.setValue(Ds_Prprt_Appl.getCellData(0, "sBuldgStrtGradCd"));		// 건물구조 급수(comb)
	//cmb_ObjctGrodUndgFlagCd.setValue(Ds_Prprt_Appl.getCellData(0, "sObjctGrodUndgFlagCd"));		// 목적물 층수(comb)
	//console.log("[/CBSC116P.xml] [lfn_getCommonCodes()] ==> [Ds_Prprt_Appl, 갯수]"+ Ds_Prprt_Appl.getRowCount() +"[Ds_Prprt_Appl]"+ WebSquare.xml.serialize(Ds_Prprt_Appl.getAllXML()) );
	//console.log("[/CBSC116P.xml] [lfn_initDataset()] ==> [건물구조 급수(sBuldgStrtGradCd)]"+ Ds_Prprt_Appl.getCellData(0, "sBuldgStrtGradCd") );
   
	util.setRowPosition(Ds_Prprt_Appl, Ds_Prprt_Appl.getRowPosition());	// datalist 포지션 변경(gridView 자동 연동)
 
 	Ds_Prprt_Appl.setRowPosition(0);	 // Row 위치 0번째로 지정
  
	//console.log("[/CBSC116P.xml] [lfn_initDataset()] ==> [TEST_end]" );
};

//---------------------------------------------------------------------------
// function 명 : btn_Close_OnClick(obj)
// 내용        : 닫기 OnClick
//---------------------------------------------------------------------------
scwin.btn_Close_OnClick = function(obj) {
    wprom.close("");
};

//---------------------------------------------------------------------------
// function 명 : btn_apply_OnClick(obj)
// 내용        : 적용 OnClick
//---------------------------------------------------------------------------
scwin.btn_apply_OnClick = function(obj) {
	//console.log("[/CBSC116P.xml] [btn_apply_OnClick()] ==> [적용] [TEST_01]" );
 
    if (Ds_Prprt_Appl.getRowCount() < 1) {
        wprom.alert("목적물이 입력되지 않았습니다!");
        return;
    }   
    if (wconv.trim(edt_BuldgStrt.getValue()) == null || wconv.trim(edt_BuldgStrt.getValue()) == "") {
        wprom.alert("건물구조를 입력하세요!");
        return;
    }
    if (wconv.trim(cmb_BuldgStrtGradCd.getValue()) == null || wconv.trim(cmb_BuldgStrtGradCd.getValue()) == "") {   
        wprom.alert("건물구조 급수를 입력하세요!");
        return;
    }
    if (wconv.trim(mke_InsArea.getValue()) == null || wconv.trim(mke_InsArea.getValue()) == "") {
        wprom.alert("가입면적을 입력하세요!");
        mke_InsArea.focus();
        return;
    }
    if (wconv.trim(mke_BuldgGrodFlct.getValue()) == null || wconv.trim(mke_BuldgGrodFlct.getValue()) == "") {
        wprom.alert("지상층수를 입력하세요!");
        mke_BuldgGrodFlct.focus();
        return;
    }
    if (wconv.trim(mke_BuldgUndgFlct.getValue()) == null || wconv.trim(mke_BuldgUndgFlct.getValue()) == "") {
        wprom.alert("지하층수를 입력하세요!");
        mke_BuldgUndgFlct.focus();
        return;
    }
    if (wconv.trim(cmb_ObjctGrodUndgFlagCd.getValue()) == null || wconv.trim(cmb_ObjctGrodUndgFlagCd.getValue()) == "") {  
        wprom.alert("목적물지상지하구분을 선택하세요!");
        cmb_ObjctGrodUndgFlagCd.focus();
        return;
    }
    if (wconv.trim(mke_ObjctRelvFlct.getValue()) == null || wconv.trim(mke_ObjctRelvFlct.getValue()) == "") {
        wprom.alert("목적물층수를 입력하세요!");
        mke_ObjctRelvFlct.focus();
        return;
    }
	
    // 음수(-)값 체크
    if (eval(mke_InsArea.getValue()) <= 0) {
        wprom.alert("가입면적에 0이하의 값을 입력할 수 없습니다!");
        mke_InsArea.focus();
        return;
    }
    if (eval(mke_BuldgGrodFlct.getValue()) <= 0) {
        wprom.alert("지상층수에 0이하의 값을 입력할 수 없습니다!");
        mke_BuldgGrodFlct.focus();
        return;
    }
    if (eval(mke_BuldgUndgFlct.getValue()) <= 0) {
        wprom.alert("지하층수에 0이하의 값을 입력할 수 없습니다!");
        mke_BuldgUndgFlct.focus();
        return;
    }
    if (eval(mke_ObjctRelvFlct.getValue()) <= 0) {
        wprom.alert("목적물층수에 0이하의 값을 입력할 수 없습니다!");
        mke_ObjctRelvFlct.focus();
        return;
    }

    // 목적물층수 체크
    if (wconv.trim(cmb_ObjctGrodUndgFlagCd.getValue()) == "1") {
        if (eval(mke_ObjctRelvFlct.getValue()) > eval(mke_BuldgGrodFlct.getValue())) {
            wprom.alert("목적물층수(지상)가 잘못입력되었습니다!");
            mke_ObjctRelvFlct.focus();
            return;
        }
    } else if (wconv.trim(cmb_ObjctGrodUndgFlagCd.getValue()) == "2") {
    	//console.log("[/CBSC116P.xml] [btn_apply_OnClick()] ==> [적용] [mke_ObjctRelvFlct.getValue()]"+ mke_ObjctRelvFlct.getValue() +"[mke_BuldgUndgFlct.getValue()]"+ mke_BuldgUndgFlct.getValue() );
    	
        if (eval(mke_ObjctRelvFlct.getValue()) > eval(mke_BuldgUndgFlct.getValue())) {
            wprom.alert("목적물층수(지하)가 잘못입력되었습니다!");
            mke_ObjctRelvFlct.focus();
            return;
        }
    }
  
    wconv.copy(parent_Ds_Prprt, Ds_Prprt_Appl);	  // 보험 목적물 적용 정보 Ds(Ds_Prprt_Appl)을 parent_Ds_Prprt에 복사  
    parent_Ds_Prprt.setRowPosition(Ds_Prprt_Appl.getRowPosition());	 // Row 위치 Ds_Prprt_Appl.getRowPosition() 번째로 지정 
    //console.log("[/CBSC116P.xml] [btn_apply_OnClick()] ==> [적용] [Ds_Prprt_Appl.getRowPosition]"+ Ds_Prprt_Appl.getRowPosition() +"[parent_Ds_Prprt.getRowPosition]"+ parent_Ds_Prprt.getRowPosition() );
    //console.log("[/CBSC116P.xml] [btn_apply_OnClick()] ==> [적용] [parent_Ds_Prprt, 조회수]"+ parent_Ds_Prprt.getRowCount() +"[parent_Ds_Prprt]"+ WebSquare.xml.serialize(parent_Ds_Prprt.getAllXML()) );
	
    wprom.close("");	 // 창닫기
};

//---------------------------------------------------------------------------
// function 명 : btn_SizeCalc_OnClick(obj)
// 내용        : 평형계산 버튼 OnClick
//---------------------------------------------------------------------------
scwin.btn_SizeCalc_OnClick = function(obj) { 
    scwin.lfn_dialogB660_Pop();
};

//---------------------------------------------------------------------------
// function 명 : btn_BuldgStrt_OnClick(obj)
// 내용        : 건물구조 버튼 팝업 OnClick
//--------------------------------------------------------------------------- 
scwin.btn_BuldgStrt_OnClick = function(e) {
	//console.log("[/CBSC116P.xml] [btn_BuldgStrt_OnClick()] ==> [건물구조 팝업] [TEST_01]" );
	
	 scwin.lfn_dialogB640_Pop(); 
};

//---------------------------------------------------------------------------
// function 명 : lfn_dialogB640_Pop
// 내용        : 구조급수 Popup
//---------------------------------------------------------------------------
scwin.lfn_dialogB640_Pop = function() {
	//console.log("[/CBSC116P.xml] [lfn_dialogB640_Pop()] ==> [구조급수 Popup] [TEST_01]" );
	
	var promise = Promise.resolve();   // Promise 설정
			
    promise = promise.then(function(rtnVal) { 
     	 //팝업창으로 보낼 자료(Parameter)
		var indata  = {
				"PoleTypeCd" : Ds_Prprt_Appl.getCellData(Ds_Prprt_Appl.getRowPosition(), "sPoleTypeCd")	//기둥형태코드
				, "ExtrnWlTypeCd" : Ds_Prprt_Appl.getCellData(Ds_Prprt_Appl.getRowPosition(), "sExtrnWlTypeCd")		// 외벽형태코드  
				, "RoofTypeCd" : Ds_Prprt_Appl.getCellData(Ds_Prprt_Appl.getRowPosition(), "sRoofTypeCd")	// 지붕형태코드   
			}; 
		//console.log("[/CBSC116P.xml] [lfn_dialogB640_Pop()] ==> [구조급수 Popup_1] [Ds_Prprt_Appl.rowposition]"+ Ds_Prprt_Appl.getRowPosition() +"[Ds_Prprt_Appl.sPoleTypeCd]"+ Ds_Prprt_Appl.getCellData(Ds_Prprt_Appl.getRowPosition(), "sPoleTypeCd") );
  
		var popInfo = {
		 	"width"     : 896,      	// 수정(width, height): 2017.11.04, by 진태만   --> 736, 560 
			"height"    : 623,
			"top"       : 0,
			"left"      : 0,
			"indata"    : indata,		 //indata
			"callback"  : "",
			"title"     : "건물구조급수[B640_Pop]"
		};
		return wprom.popupOpen("/ui/cbsc/CBSC024P.xml", popInfo);		// 건물구조급수[B640_Pop]  팝업 처리
    });	 // end of promise()
    
    promise = promise.then(function(rst) { 
 		//console.log("[/CBSC116P.xml] [lfn_dialogB640_Pop()] ==> [구조급수 Popup] [TEST_07] [rst]"+ rst );
    	
        if (wconv.length(rst) != 0) {  
	 		// 구조급수,기둥형태,외벽형태,지붕형태 설정
	        if (rst != null && rst != "" && rst != 0) { 
	        	Ds_Prprt_Appl.setRowPosition(Ds_Prprt_Appl.getRowPosition());	 // Row 위치 0번째로 지정
	        	
	            Ds_Prprt_Appl.setCellData(Ds_Prprt_Appl.getRowPosition(), "sBuldgStrtGradCd", rst[0]); // 건물급수코드
	            Ds_Prprt_Appl.setCellData(Ds_Prprt_Appl.getRowPosition(), "sPoleTypeCd", rst[2]); // 기둥형태코드
	            Ds_Prprt_Appl.setCellData(Ds_Prprt_Appl.getRowPosition(), "sExtrnWlTypeCd", rst[4]); // 외벽형태코드
	            Ds_Prprt_Appl.setCellData(Ds_Prprt_Appl.getRowPosition(), "sRoofTypeCd", rst[6]); // 지붕형태코드 
	       		//console.log("[/CBSC116P.xml] [lfn_dialogB640_Pop()] ==> [구조급수 Popup] [TEST_06] [Ds_Prprt_Appl.sBuldgStrtGradCd]"+ Ds_Prprt_Appl.getCellData(Ds_Prprt_Appl.getRowPosition(), "sBuldgStrtGradCd") );
	             
	           cmb_BuldgStrtGradCd.setValue(Ds_Prprt_Appl.getCellData(Ds_Prprt_Appl.getRowPosition(), "sBuldgStrtGradCd"));		// 건물구조 급수(comb)
	     	}
	
	        // 건물구조명 설정
	        scwin.lfn_setBuldgStrtName();         
        }
    });	 // end of promise() 
};

//---------------------------------------------------------------------------
// function 명 : lfn_dialogB660_Pop
// 내용        : 평형계산 Popup
//---------------------------------------------------------------------------
scwin.lfn_dialogB660_Pop = function() {
	//console.log("[/CBSC116P.xml] [lfn_dialogB660_Pop()] ==> [평형계산 Popup] [TEST_01]" );
		
	var promise = Promise.resolve();   // Promise 설정
			
    promise = promise.then(function(rtnVal) { 
     	 //팝업창으로 보낼 자료(Parameter)
		var indata  = {};
	
		var popInfo = {
		 	"width"     : 440,      	// 수정(width, height): 2017.11.04, by 진태만   --> 390, 50 
			"height"    : 80,
			"top"       : 0,
			"left"      : 0,
			"indata"    : indata,		 //indata
			"callback"  : "",
			"title"     : "평형계산[B660_Pop]"
		};
		return wprom.popupOpen("/ui/cbsc/CBSC127P.xml", popInfo);		// 평형계산[B660_Pop]  팝업 처리
    });	 // end of promise()
    
    promise = promise.then(function(rst) { 
 		//console.log("[/CBSC116P.xml] [lfn_dialogB660_Pop()] ==> [평형계산 Popup] [TEST_07] [rst]"+ rst );
    	
        if (wconv.length(rst) != 0) {  
	 		// 구조급수,기둥형태,외벽형태,지붕형태 설정
	        if (rst != null && rst != "" && rst != 0) {
	            Ds_Prprt_Appl.setCellData(Ds_Prprt_Appl.getRowPosition(), "nInsArea", rst[0]);
	        } 
        }
    });	 // end of promise() 
};
 
//---------------------------------------------------------------------------
// function 명 : lfn_setBuldgStrtName
// 내용        : 건물구조명 설정
//---------------------------------------------------------------------------
scwin.lfn_setBuldgStrtName = function() {
	//console.log("[/CBSC116P.xml] [lfn_setBuldgStrtName()] ==> [건물구조명 설정] [TEST_01]" ); 
	
	Ds_Prprt_Appl.setRowPosition(0);
	//console.log("[/CBSC116P.xml] [lfn_initDataset()] ==> [Ds_Prprt_Appl_갯수]"+ Ds_Prprt_Appl.getRowPosition() +"[Ds_Prprt_Appl]"+ WebSquare.xml.serialize(Ds_Prprt_Appl.getAllXML()) ); 
	
    var nPoleTypeCdIdx = wconv.findRow(Ds_PoleTypeCd, "sCd", Ds_Prprt_Appl.getCellData(Ds_Prprt_Appl.getRowPosition(), "sPoleTypeCd"));		//기둥형태코드
    var nExtrnWlTypeCdIdx = wconv.findRow(Ds_ExtrnWlTypeCd, "sCd", Ds_Prprt_Appl.getCellData(Ds_Prprt_Appl.getRowPosition(), "sExtrnWlTypeCd"));	// 외벽형태코드  
   	var nRoofTypeCdIdx = wconv.findRow(Ds_RoofTypeCd, "sCd", Ds_Prprt_Appl.getCellData(Ds_Prprt_Appl.getRowPosition(), "sRoofTypeCd"));	// 지붕형태코드   
 
    if (nPoleTypeCdIdx < 0 || nExtrnWlTypeCdIdx < 0 || nRoofTypeCdIdx < 0)
        return;
	//console.log("[/CBSC116P.xml] [lfn_setBuldgStrtName()] ==> [건물구조명 설정] [TEST_05]" );
       	 
    edt_BuldgStrt.setValue(Ds_PoleTypeCd.getCellData(nPoleTypeCdIdx, "sHnglCdName") 
    	+ " / " + Ds_ExtrnWlTypeCd.getCellData(nExtrnWlTypeCdIdx, "sHnglCdName") 
    	+ " / " + Ds_RoofTypeCd.getCellData(nRoofTypeCdIdx, "sHnglCdName"));	// 건물구조명
	//console.log("[/CBSC116P.xml] [lfn_setBuldgStrtName()] ==> [건물구조명 설정] [edt_BuldgStrt.getValue() ]"+ edt_BuldgStrt.getValue() );
}; 
]]></script>
    </head>
    <body>
        <xf:group class="cont_wrap layer" id="B630_Pop"
            style="position:absolute; WorkArea:true;  Ver:1.0;  PidAttrib:7;/*  height:245px;*/ left:0px; top:0px;/* width:416px;"
            userData1="특약상세입력[B630_Pop]" userData2=" OnLoadCompleted:scwin.B630_OnLoadCompleted; ">
            <DataObjects>
                <DataObject/>
            </DataObjects>
            <ServiceObjects>
                <ServiceObject/>
            </ServiceObjects>
            <xf:group arcsize="8" class="sty_area_form" id="Shape0"
                style="position:absolute;height:26px;width:439px;bottom:58px;left:0px;right:410px;top:30px;" userData3="Rectangle"/>
            <xf:group arcsize="8" class="sty_area_form" id="Shape2"
                style="position:absolute;height:126px;width:439px;bottom:95px;left:0px;right:410px;top:67px;" userData3="Rectangle">
                <xf:group class="form_w_line" id="" style="top:24px;" />
        		<xf:group class="form_w_line" id="" style="top:49px;" />
        		<xf:group class="form_w_line" id="" style="top:74px;" />
        		<xf:group class="form_w_line" id="" style="top:99px;" />
            </xf:group>
            <w2:textbox id="Static5" label="특약상세입력" style="position:absolute; VAlign:Middle;  height:20px; left:0px; top:0px; " tagname="" class="sub_pop_title01">
</w2:textbox>
            
            <w2:textbox class="sty_lb_Detail" id="Static1" label=" 화재손해(건물), 화재손해(가재도구)"
                style="position:absolute;
 WordWrap:TRUE;
  VAlign:Middle;
  background-color:user22;
  height:20px;
left:126px;
top:33px;
 width:297px;
" tagname=""/>
            <xf:trigger class="detail_search" ev:onclick="scwin.btn_BuldgStrt_OnClick" id="btn_BuldgStrt"
                style="position:absolute; ImageID:btn_Input_Search;  height:18px;left:403px;top:70px; width:18px;" tabIndex="2" type="anchor"/>
            <xf:trigger class="btn_Calculate" ev:onclick="scwin.btn_SizeCalc_OnClick" id="btn_SizeCalc"
                style="position:absolute; Transparent:TRUE;  ImageID:btn_Calculate;  height:18px;left:403px;top:170px; width:18px;" tabIndex="9" type="anchor"/>
            <xf:select1 appearance="minimal" class="sty_ipt_form" emptyItem="true" id="cmb_ObjctGrodUndgFlagCd"
                ref="data:Ds_Prprt_Appl.sObjctGrodUndgFlagCd"
                style="position:absolute; INDEX:1;  border-style:solid;  height:20px;left:126px;top:145px; width:128px;" tabIndex="6" renderType="native">
                <xf:choices>
                    <xf:itemset nodeset="data:Ds_ObjctGrodUndgFlagCd">
                        <xf:label ref="sHnglCdName"/>
                        <xf:value ref="sCd"/>
                    </xf:itemset>
                </xf:choices>
            </xf:select1>
            <w2:textbox class="sty_lb_Basic" id="Static17" label="건물구조"
                style="position:absolute;height:24px;width:104px;left:0px;VAlign:Middle;top:67px;" tagname=""/>
            <w2:textbox class="sty_lb_Basic" id="Static15" label="건물구조 급수"
                style="position:absolute;height:24px;width:104px;left:0px;VAlign:Middle;top:92px;" tagname=""/>
            <w2:textbox class="sty_lb_Basic" id="Static16" label="가입면적(㎡)"
                style="position:absolute;height:24px;width:104px;left:0px;VAlign:Middle;top:167px;" tagname=""/>
            <xf:input class="sty_ipt_form" dataType="number" displayFormat="#######.###" id="mke_InsArea" maxlength="10"
                ref="data:Ds_Prprt_Appl.nInsArea"
                style="position:absolute; text-align:right;    border-style:solid;  height:20px;left:126px;top:170px; width:275px;" tabIndex="8"/>
            <w2:textbox class="sty_lb_Basic" id="Static18" label="층수(지상)"
                style="position:absolute;height:24px;width:104px;left:0px;VAlign:Middle;top:117px;" tagname=""/>
            <xf:input class="sty_ipt_form" dataType="number" displayFormat="#####" id="mke_BuldgGrodFlct" maxlength="5"
                ref="data:Ds_Prprt_Appl.nBuldgGrodFlct"
                style="position:absolute; text-align:right;    border-style:solid;  height:20px;left:126px;top:120px; width:95px;" tabIndex="4"/>
            <w2:textbox class="sty_lb_Basic" id="Static19" label="층수(지하)"
                style="position:absolute; VAlign:Middle;  height:24px;left:237px;top:117px;" tagname=""/>
            <xf:input class="sty_ipt_form" dataType="number" displayFormat="#####" id="mke_BuldgUndgFlct" maxlength="5"
                ref="data:Ds_Prprt_Appl.nBuldgUndgFlct"
                style="position:absolute; text-align:right;    border-style:solid;  height:20px;left:345px;top:120px; width:81px;" tabIndex="5"/>
            <w2:textbox class="sty_lb_Basic" id="Static20" label="목적물층수"
                style="position:absolute;height:24px;width:104px;left:0px;VAlign:Middle;top:142px;" tagname=""/>
            <xf:input class="sty_ipt_form" dataType="number" displayFormat="#####" id="mke_ObjctRelvFlct" maxlength="5"
                ref="data:Ds_Prprt_Appl.nObjctRelvFlct"
                style="position:absolute; text-align:right;    border-style:solid;  height:20px;left:261px;top:145px; width:151px;" tabIndex="7"/>
            <w2:textbox id="Static21" label="층" style="position:absolute; VAlign:Middle;  height:20px;left:416px;top:146px; width:13px;" tagname=""/>
            <xf:trigger class="popup_top_btn" disabled="true" ev:onclick="scwin.btn_apply_OnClick" id="btn_apply"
                style="position:absolute;ImageID:btn_Input_02;height:20px;width:25px;left:339px;top:0px;" tabIndex="10" type="anchor">
                <xf:label><![CDATA[적용]]></xf:label>
            </xf:trigger>
            <xf:trigger class="popup_top_btn" ev:onclick="scwin.btn_Close_OnClick" id="btn_Close"
                style="position:absolute;ImageID:btn_Comm_Close;height:20px;width:25px;left:390px;top:0px;" tabIndex="11" type="anchor">
                <xf:label><![CDATA[닫기]]></xf:label>
            </xf:trigger>
            <w2:textbox class="sty_lb_Basic" id="Static2" label="특약명"
                style="position:absolute;height:24px;width:104px;left:0px;VAlign:Middle;top:30px;" tagname=""/>
            <xf:input class="sty_ipt_form" disabled="true" id="edt_BuldgStrt" readOnly="TRUE"
                style="position:absolute;   border-style:solid;  text-align:CENTER;  height:20px;left:126px;top:70px; width:275px;" tabIndex="1" ref=""/>
            <xf:select1 appearance="minimal" class="sty_ipt_form" disabled="true" emptyItem="true" id="cmb_BuldgStrtGradCd"
                ref=""
                style="position:absolute; Value:01;  INDEX:1;  border-style:solid;  height:20px;left:126px;top:95px; width:298px;" tabIndex="3" renderType="native">
                <xf:choices>
                    <xf:itemset nodeset="data:Ds_BuldgStrtGradCd">
                        <xf:label ref="sHnglCdName"/>
                        <xf:value ref="sCd"/>
                    </xf:itemset>
                </xf:choices>
            </xf:select1>
            <xf:trigger disabled="true" id="Button0"
                style="position:absolute; border-color:user22;  background-color:user22;  height:20px;left:405px;top:95px; width:17px;" tabIndex="13" type="anchor"/>
        </xf:group>
    </body>
</html>
