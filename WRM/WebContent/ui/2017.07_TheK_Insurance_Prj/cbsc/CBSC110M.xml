<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="/cm/css/all.css" type="text/css"?>
<?xml-stylesheet href="/cm/css/convert.css" type="text/css"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head>
        <w2:type>DEFAULT</w2:type>
        <w2:buildDate/>
        <xf:model>
            <xf:instance>
                <data/>
            </xf:instance>
            <w2:dataCollection>
            	<w2:dataList baseNode="list" id="Ds_WorkFlag"
            		repeatNode="map">
            		<w2:columnInfo>
            			<w2:column dataType="text" id="sHnglCdName"
            				name="sHnglCdName" />
            			<w2:column dataType="text" id="sCd" name="sCd" />
            		</w2:columnInfo>
            		<w2:data use="true">
            			<w2:row>
            				<sCd />
            				<sHnglCdName><![CDATA[- 전체 -]]></sHnglCdName>
            			</w2:row>
            			<w2:row>
            				<sCd><![CDATA[01]]></sCd>
            				<sHnglCdName><![CDATA[청약]]></sHnglCdName>
            			</w2:row>
            		</w2:data>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="Ds_search"
            		repeatNode="map">
            		<w2:columnInfo>
            			<w2:column dataType="text" id="sHnglCdName"
            				name="sHnglCdName" />
            			<w2:column dataType="text" id="sCd" name="sCd" />
            		</w2:columnInfo>
            		<w2:data use="true">
            			<w2:row>
            				<sCd />
            				<sHnglCdName><![CDATA[- 전체 -]]></sHnglCdName>
            			</w2:row>
            			<w2:row>
            				<sCd><![CDATA[sPlanNo]]></sCd>
            				<sHnglCdName><![CDATA[청약번호]]></sHnglCdName>
            			</w2:row>
            			<w2:row>
            				<sCd><![CDATA[sDmdr]]></sCd>
            				<sHnglCdName><![CDATA[요청자코드]]></sHnglCdName>
            			</w2:row>
            			<w2:row>
            				<sCd><![CDATA[sKeyDoer]]></sCd>
            				<sHnglCdName><![CDATA[취급자코드]]></sHnglCdName>
            			</w2:row>
            			<w2:row>
            				<sCd><![CDATA[sKeyDoerUser]]></sCd>
            				<sHnglCdName><![CDATA[사용인코드]]></sHnglCdName>
            			</w2:row>
            			<w2:row>
            				<sCd><![CDATA[sKeyDept]]></sCd>
            				<sHnglCdName><![CDATA[조직코드]]></sHnglCdName>
            			</w2:row>
            		</w2:data>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="Ds_LinkList"
            		repeatNode="map" />
            	<w2:dataList baseNode="list" id="ds_code"
            		repeatNode="map" />
            	<w2:dataList baseNode="list" id="Ds_searchTerm"
            		repeatNode="map">
            		<w2:columnInfo>
            			<w2:column dataType="text" id="sHnglCdName"
            				name="sHnglCdName" />
            			<w2:column dataType="text" id="sCd" name="sCd" />
            		</w2:columnInfo>
            		<w2:data use="true">
            			<w2:row>
            				<sCd><![CDATA[sKeyPlanDate]]></sCd>
            				<sHnglCdName><![CDATA[청약일]]></sHnglCdName>
            			</w2:row>
            			<w2:row>
            				<sCd><![CDATA[sKeyReqtDate]]></sCd>
            				<sHnglCdName><![CDATA[요청일]]></sHnglCdName>
            			</w2:row>
            			<w2:row>
            				<sCd><![CDATA[sKeyUndrDate]]></sCd>
            				<sHnglCdName><![CDATA[심사일]]></sHnglCdName>
            			</w2:row>
            		</w2:data>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="Ds_Team"
            		repeatNode="map" />
            	<w2:dataList baseNode="list" id="Ds_JobCode"
            		repeatNode="map" />
            	<w2:dataList baseNode="list" id="DsWs_Team"
            		repeatNode="map" userData2="//*/ADMAC03" />
            	<w2:dataList baseNode="list" id="DsWs_LTIDB56"
            		repeatNode="map"
            		userData2="//hashtable/data[@hashkey='vLTIDB56']/vector/data/LTIDB05"
            		ev:oncelldatachange="scwin.lfn_LTIDB03_OnColumnChanged">
            		<w2:columnInfo>
            			<w2:column id="chk" name="chk"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sSat" name="sSat"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sPlanNo" name="sPlanNo"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sInrpsName" name="sInrpsName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sSsrtDate" name="sSsrtDate"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sRqstDateHms" name="sRqstDateHms"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sGdName" name="sGdName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sFinalImagJugmStatName"
            				name="sFinalImagJugmStatName" dataType="text">
            			</w2:column>
            			<w2:column id="nProgDgre" name="nProgDgre"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sDmdrName" name="sDmdrName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sJudgName" name="sJudgName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sCnfmDateHms" name="sCnfmDateHms"
            				dataType="text">
            			</w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="DsWs_ImagJugmReslt"
            		repeatNode="map" />
            	<w2:dataList baseNode="list" id="DsWs_Warning"
            		repeatNode="map" userData2="//*/WARNING">
            		<w2:columnInfo>
            			<w2:column id="msg" name="name1"
            				dataType="text">
            			</w2:column>
            			<w2:column id="level" name="name2"
            				dataType="text">
            			</w2:column>
            			<w2:column id="detail" name="name3"
            				dataType="text">
            			</w2:column>
            			<w2:column id="timestamp" name="name4"
            				dataType="text">
            			</w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="DsWs_LTIDB05"
            		repeatNode="map"
            		userData2="//hashtable/data[@hashkey='vLTIDB05']/vector/data/LTIDB05">
            		<w2:columnInfo>
            			<w2:column id="chk2" name="chk2"
            				dataType="text">
            			</w2:column>
            			<w2:column id="nProgDgre" name="nProgDgre"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sImagJugmResltName" name="sImagJugmResltName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sDmdrName" name="sDmdrName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sJudgName" name="sJudgName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sRqstDate" name="sRqstDate"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sCnfmDate" name="sCnfmDate"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sJugmCont" name="sJugmCont"
            				dataType="text">
            			</w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="DsWs_Auth"
            		repeatNode="map" />
            	<w2:dataList baseNode="list" id="DsWs_ImagKindCd_srch"
            		repeatNode="map" />
            	<w2:dataList baseNode="list" id="DsWs_LTIDB56Cnt"
            		repeatNode="map"
            		userData2="//hashtable/data[@hashkey='lTIDB56ListDocCnt']/LTIDB05CNT" />
            	<w2:dataList baseNode="list" id="DsWs_JobCode"
            		repeatNode="map" userData2="//*/ADMAB01" />
            	<w2:dataList id="WARNING" baseNode="list"
            		saveRemovedData="true" repeatNode="map">
            		<w2:columnInfo>
            			<w2:column id="msg" name="name1"
            				dataType="text">
            			</w2:column>
            			<w2:column id="level" name="name2"
            				dataType="text">
            			</w2:column>
            			<w2:column id="detail" name="name3"
            				dataType="text">
            			</w2:column>
            			<w2:column id="timestamp" name="name4"
            				dataType="text">
            			</w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            </w2:dataCollection>
            <w2:workflowCollection/>
        </xf:model>
            <script src="/cm/js/convertJs/Global_Script.js" />
	<script src="/cm/js/convertJs/LongTerm_Script.js" />
	<script src="/cm/js/convertJs/comm_Webservice.js" />   
	<script src="/cm/js/convertJs/Marine_Script.js" />           
	<script src="/cm/js/convertJs/NewGen_Script.js" />           
	<script src="/cm/js/convertJs/CCC_Script.js" />		
	<script src="/cm/js/convertJs/GrdPassword_Script.js"/>
        <script><![CDATA[
//O310.xml에서 호출 (callee ID):  0120,B520_Pop,B340_Pop01,R960_Pop
var pageSize = "10";
var pageCount = "10";
var sPlanNo = "";
var sOnlySrarch = "";//조회만 가능하게 처리
var sToday = "";
var chld_open_flag = false;


//---------------------------------------------------------------------------
// function 명 : B520_OnLoadCompleted
// 내용        :  화면로드시 처리
//---------------------------------------------------------------------------
scwin.init = function() {
	var pro = Promise.resolve();
		window.top.util.winTopShowModalChk = "T";
		util.winTopShowModal();
	pro = pro.then(function(rv) {
    	return util.winTopShowModalPromise();
	}); 
	pro = pro.then(function(rv) {
     //init 부분 함수 입력하는곳
    //----- 버튼 처리(조회, 입력, 수정, 삭제, 결제, 취소, 인쇄, 엑셀, 닫기)
    	gfn_btnEnable(false, false, false, false, false, false, false, true);
    //공통코드호출
    gfn_getCommonCodes("DsWs_ImagJugmReslt", "ImagJugmReslt", "cmb_ImagJugmReslt", "A");	
    
    //링크된 정보가 넘어올경우 처리
    if (gds.gDs_LinkArg.getRowCount() > 0) {
        edt_deptCd.setValue(gds.gDs_LinkArg.getCellData(0, "edt_deptCd"));
        edt_deptName.setValue(gds.gDs_LinkArg.getCellData(0, "edt_deptName"));
        //cal_standStrtdate.Value = gDs_LinkArg.GetColumn(0,"cal_standStrtdate");
        //cal_standEndDate.Value = gDs_LinkArg.GetColumn(0,"cal_standEndDate");
        sPlanNo = gds.gDs_LinkArg.getCellData(0, "sPlanNo");
        sOnlySrarch = gds.gDs_LinkArg.getCellData(0, "sOnlySrarch");
        cmb_searchCd.setValue("sPlanNo");
        edt_searchName.setValue(sPlanNo);
        gds.gDs_LinkArg.removeAll();
        scwin.lfn_Search();
    } else {
        // 현재시간 setting
//        global_http.Sync = true;
        gfn_getServerTime();
        sToday = wconv.substr(gds.gDs_ServerTime.getCellData(0, "sToday"), 0, 8);
//        global_http.Sync = false;
        cal_standStrtdate.setValue(wconv.addDateSimple(sToday, -7));
        cal_standEndDate.setValue(sToday);
    }
    wconv.clear(Ds_JobCode);    
    var pageSize="";
    var pageNo="";
//    SOBJ_JobCode.WSDL = gds.gWsdlBasis; // 서비스 Obj WSDC 설정
//    var MethodObj = gfn_CreateMethodObj(SOBJ_JobCode, "com.inswave.longterm.dpt.com.task.FAF000Task", "getEmpName", "", "");
//    gfn_SetParam(MethodObj, "sEmpNo", gds.gUserID); //조직구조
//    gfn_CallService(SOBJ_JobCode, DOBJ_JobCode, MethodObj);

	var MethodObj = new callService("com.inswave.longterm.dpt.com.task.FAF000Task", "getEmpName", pageSize, pageNo);
	MethodObj.setId("getEmpName");
	MethodObj.setParam("sEmpNo", util.getGdsValue("gUserID")); //조직구조
	MethodObj.setUrl("/contract/CBSC110MController.do");//배포후변경할것(controller위치와 이름)
	MethodObj.setXPath("//*/ADMAB01");//(dsWS의 XPath)
	MethodObj.sync();
	MethodObj.send();
	util.jSonDsCreate(_tranSync.getDsJson("ADMAB01"), "DsWs_JobCode");
//    wconv.copy(Ds_JobCode, "DsWs_JobCode");
	util.copyM(Ds_JobCode, DsWs_JobCode.getAllJSON());
	util.setCompBindRefresh(Ds_JobCode.getID());
    util.setRowPosition(Ds_JobCode, 0);	
	
    var sJobCode = DsWs_JobCode.getCellData(0, "sJobCode");    
    wconv.clear(Ds_Team);
    
//    SOBJ_TEAM.WSDL = gds.gWsdlBasis; // 서비스 Obj WSDC 설정
//    var MethodObj = gfn_CreateMethodObj(SOBJ_TEAM, "com.inswave.longterm.com.com.task.AXR930Task", "getAgentList", "", "");
//    gfn_SetParam(MethodObj, "sAgentCode", gds.gUserID); //조직구조
//    gfn_CallService(SOBJ_TEAM, DOBJ_TEAM, MethodObj);

    var MethodObj = new callService("com.inswave.longterm.com.com.task.AXR930Task", "getAgentList", pageSize, pageNo);
	MethodObj.setId("getAgentList");
	MethodObj.setParam("sAgentCode", util.getGdsValue("gUserID")); //조직구조
	MethodObj.setUrl("/contract/CBSC110MController.do");//배포후변경할것(controller위치와 이름)
	MethodObj.setXPath("//*/ADMAC03");//(dsWS의 XPath)
	MethodObj.sync();
	MethodObj.send();
    util.jSonDsCreate(_tranSync.getDsJson("ADMAC03"), "DsWs_Team");    
//    wconv.copy(Ds_Team, "DsWs_Team");
	util.copyM(Ds_Team, DsWs_Team.getAllJSON());
	util.setCompBindRefresh(Ds_Team.getID());
    util.setRowPosition(Ds_Team, 0);   
    var sTeamCd = DsWs_Team.getCellData(0, "sTeamCode");

    //권한 체크  장기보험 업무팀권한 22030   장기보험 인수권한 22040
    if (nfn_checkAuthByID("DsWs_Auth", util.getGdsValue("gUserID"), "22030")) {} else if (nfn_checkAuthByID("DsWs_Auth", util.getGdsValue("gUserID"), "34030") && (sJobcode == "200205")) {} else if (nfn_checkAuthByID("DsWs_Auth", util.getGdsValue("gUserID"), "22040")) {} else {
        if (util.getGdsValue("gUserDuty") == "66" || util.getGdsValue("gUserDuty") == "64") {
            cmb_searchCd.setValue("sKeyDept");
            scwin.cmb_searchCd_OnClick();
            cmb_searchCd.setDisabled(true);
        } else if (((util.getGdsValue("gUserDuty") == "30" || util.getGdsValue("gUserDuty") == "33" || util.getGdsValue("gUserDuty") == "35")) == false) {
            cmb_searchCd.setValue("sDmdr");
            cmb_searchCd.setDisabled(true);
            edt_searchName.setValue(util.getGdsValue("gUserID"));
            edt_searchName.setDisabled(true);
        }
    }
    
        return ;		// init 함수를 종료하고자 할때 사용
		// return Promise.reject("오류관련처리"); 
	});
	pro = pro.then(function(rv) {
		util.winTopHideModal();
	});	
	pro = pro.catch(function(rj) {
		util.winTopHideModal();
		//alert(rj); //Promise reject 시 처리 "오류관련처리" 값출력
	});	 
	return pro; 
};

//---------------------------------------------------------------------------
// function 명 : lfn_Search)
// 내용        : 조회버튼 클릭시 처리
//---------------------------------------------------------------------------
scwin.lfn_Search_Async = function() { 
    util.eventAsyncCall(this, scwin.lfn_Search, arguments);
};
scwin.lfn_Search = function() {
    wconv.clear(DsWs_LTIDB56);
    wconv.clear(DsWs_LTIDB05);
    wconv.clear(DsWs_LTIDB56Cnt);
    scwin.lfn_SearchData(1);    
    if (DsWs_LTIDB56.getRowCount() > 0) {
        gfn_MakePagingData(Ds_Page, DsWs_LTIDB56Cnt.getCellData(0, "nCount"), pageSize, pageCount);
        Cmb_Page.setValue("1");
    }
};

//---------------------------------------------------------------------------
// function 명 : lfn_Search
// 내용        : 조회
//---------------------------------------------------------------------------
scwin.lfn_SearchData = function(pageNo) {

    if (!mfn_IsEmpty(cal_standStrtdate.getValue()) && !mfn_IsEmpty(cal_standEndDate.getValue())) {
        //시작종료체크
        if (wconv.toNumber(cal_standStrtdate.getValue()) > wconv.toNumber(cal_standEndDate.getValue())) {
            wprom.alert("조회기간시작일자가 종료일자보다 큽니다");
            cal_standStrtdate.focus();
            return false;
        }
    } else {
        if (mfn_IsEmpty(cal_standStrtdate.getValue()) && !mfn_IsEmpty(cal_standEndDate.getValue())) {
            wprom.alert("조회기간시작일자를 선택하세요");
            cal_standStrtdate.focus();
            return false;
        } else if (!mfn_IsEmpty(cal_standStrtdate.getValue()) && mfn_IsEmpty(cal_standEndDate.getValue())) {
            wprom.alert("조회기간종료일자를 선택하세요");
            cal_standEndDate.focus();
            return false;
        }
    }
    if (gfn_betweenDays(cal_standStrtdate.getValue(), cal_standEndDate.getValue()) > 7) {
        wprom.alert("조회기준일을 7일이내로 지정하셔야 합니다");
        return false;        
    }
    //조회기준
    if (!mfn_IsEmpty(cmb_searchCd.getValue())) {
        if (mfn_IsEmpty(edt_searchName.getValue()) && mfn_IsEmpty(edt_deptName.getValue())) {
            wprom.alert("조회기준을 입력하세요");
            edt_searchName.focus();
            return false;
        }
    }
    
//    SOBJ.WSDL = gds.gWsdlBasis; //기본 웹서비스
//    DsWs_Warning.DataObject = "DOBJ";
//    DsWs_LTIDB05.DataObject = "DOBJ";
//    DsWs_LTIDB05.XPath = "//hashtable/data[@hashkey='vLTIDB05']/vector/data/LTIDB05";
//    var MethodObj = gfn_CreateMethodObj(SOBJ, "com.inswave.longterm.uwt.uwm.task.OBO310Task", "getScanJugm", pageSize, pageNo);

	var MethodObj = new callService("com.inswave.longterm.uwt.uwm.task.OBO310Task", "getScanJugm", pageSize, pageNo);
	MethodObj.setId("getScanJugm");
	//대리점인지 여부(30:대리점,33:사용인,35:TM사용인)
    if (util.getGdsValue("gUserDuty") == "30" || util.getGdsValue("gUserDuty") == "33" || util.getGdsValue("gUserDuty") == "35" || util.getGdsValue("gUserDuty") == "48" || util.getGdsValue("gUserDuty") == "49" || util.getGdsValue("gUserDuty") == "50" || util.getGdsValue("gUserDuty") == "62" || util.getGdsValue("gUserDuty") == "65" || util.getGdsValue("gUserDuty") == "66") {
        //대리점 관리자
        if (nfn_checkAuthByID("ds_code", util.getGdsValue("gUserID"), "21013")) {} else if (nfn_checkAuthByID("ds_code", util.getGdsValue("gUserID"), "34024")) {
//            gfn_SetParam(MethodObj, "sKeyDoer", "");
			MethodObj.setParam("sKeyDoer", "");
        } else if (nfn_checkAuthByID("ds_code", util.getGdsValue("gUserID"), "34011")) {
//            gfn_SetParam(MethodObj, "sKeyDoer", gds.gDoer);
			MethodObj.setParam("sKeyDoer", util.getGdsValue("gDoer"));
        } else if (nfn_checkAuthByID("ds_code", util.getGdsValue("gUserID"), "34030") && (sJobCode == "200205")) {} else if (nfn_checkAuthByID("ds_code", util.getGdsValue("gUserID"), "34030")) {
//            gfn_SetParam(MethodObj, "sKeyDoer", gds.gDoer);
			MethodObj.setParam("sKeyDoer", util.getGdsValue("gDoer"));
        } else {
//            gfn_SetParam(MethodObj, "sKeyDoerUser", gds.gDoerUser);
			MethodObj.setParam("sKeyDoerUser", util.getGdsValue("gDoerUser"));
        }
    }
//    gfn_SetParam(MethodObj, "sDeptCd", edt_deptCd.getValue()); //조직구조
//    gfn_SetParam(MethodObj, "sLevel", edt_level.getValue()); //조직레벨
//    gfn_SetParam(MethodObj, "standStrtdate", cal_standStrtdate.getValue()); //조회기간시작일
//    gfn_SetParam(MethodObj, "standEndDate", cal_standEndDate.getValue()); //조회기간종료일
//    gfn_SetParam(MethodObj, "sSearchCd", cmb_searchCd.getValue()); //조회기준코드
//    gfn_SetParam(MethodObj, "sSearchTermCd", cmb_searchTermCd.getValue()); //조회기간코드
//    gfn_SetParam(MethodObj, "sSearchName", edt_searchName.getValue()); //조회기준코드명
//    gfn_SetParam(MethodObj, "sWorkCd", cmb_workFlag.getValue()); //업무구분
//    gfn_SetParam(MethodObj, "sImagJugmReslt", cmb_ImagJugmReslt.getValue()); //심사상태
    	
    	MethodObj.setParam("sDeptCd", edt_deptCd.getValue()); //조직구조
    	MethodObj.setParam("sLevel", edt_level.getValue()); //조직레벨
    	MethodObj.setParam("standStrtdate", cal_standStrtdate.getValue()); //조회기간시작일-
    	MethodObj.setParam("standEndDate", cal_standEndDate.getValue()); //조회기간종료일-
    	MethodObj.setParam("sSearchCd", cmb_searchCd.getValue()); //조회기준코드
    	MethodObj.setParam("sSearchTermCd", cmb_searchTermCd.getValue()); //조회기간코드-
    	MethodObj.setParam("sSearchName", edt_searchName.getValue()); //조회기준코드명
    	MethodObj.setParam("sWorkCd", cmb_workFlag.getValue()); //업무구분
    	MethodObj.setParam("sImagJugmReslt", cmb_ImagJugmReslt.getValue()); //심사상태

    
    if (wconv.length(sPlanNo) > 0){
//        gfn_SetParam(MethodObj, "sPlanNo", sPlanNo); //설계번호
		MethodObj.setParam("sPlanNo", sPlanNo); //설계번호
		}
    sPlanNo = "";
//    gfn_CallService(SOBJ, DOBJ, MethodObj);
		    
    MethodObj.setUrl("/contract/CBSC110MController.do");//배포후변경할것(controller위치와 이름)
	MethodObj.setXPath("//hashtable/data[@hashkey='vLTIDB56']/vector/data/LTIDB05");//(dsWS의 XPath)
	MethodObj.addXPath("//hashtable/data[@hashkey='lTIDB56ListDocCnt']/LTIDB05CNT");
	MethodObj.addXPath("//*/WARNING");
	MethodObj.sync();
	MethodObj.send();
	util.jSonDsCreate(_tranSync.getDsJson("LTIDB05"), "DsWs_LTIDB56");
	util.jSonDsCreate(_tranSync.getDsJson("LTIDB05CNT"), "DsWs_LTIDB56Cnt");
	util.setCompBindRefresh(DsWs_LTIDB56Cnt.getID());//바인딩을 해줌
	util.setCompBindRefresh(DsWs_LTIDB56.getID());//바인딩을 해줌
	util.setRowPosition(DsWs_LTIDB56, 0);	

	util.jSonDsCreate(_tranSync.getDsJson("WARNING"), "DsWs_Warning");
    if (DsWs_Warning.getRowCount() != 0) {
        wprom.alert(DsWs_Warning.getCellData(0, "msg"));
        return;
    } else {
        if (DsWs_LTIDB56.getRowCount() == 0) {
            wprom.alert("조회된 건수가 없습니다.");
        } else {
            //조회만 가능하게 처리
            if (wconv.length(sOnlySrarch) > 0) {
                btn_B520.setDisabled(true);
            }
        }
//        eval(DsWs_LTIDB56_ID).OnColumnChanged = "lfn_LTIDB03_OnColumnChanged";
			scwin.lfn_LTIDB03_OnColumnChanged();
    }
};

scwin.daysub = function(value){
	if(value != 0){ 
	value = wconv.mid(value, 0, 4)+"-"+wconv.mid(value, 4, 2)+"-"+wconv.mid(value, 6, 2)+" "+wconv.mid(value, 8, 2)
	+":"+wconv.mid(value, 10, 2);
	}else{}
	return value;
		
//		return wconv.substr(value,0,6)+"-"+wconv.substr(value,6,1)+"******";
	
};

scwin.gfn_changeMask = function(value){
	value = gfn_changeMask(value, 4);
	return value;
};
//---------------------------------------------------------------------------
// function 명 : lfn_SearchDept_OnClick
// 내용        :  조직찾기 POPUP
//---------------------------------------------------------------------------
scwin.lfn_SearchDept_OnClick = function(obj) {
    var promise = Promise.resolve();
    wconv.clear(Ds_Team);
    var pageSize="";
    var pageNo="";
    
//    SOBJ_TEAM.WSDL = gds.gWsdlBasis; // 서비스 Obj WSDC 설정
//    var MethodObj = gfn_CreateMethodObj(SOBJ_TEAM, "com.inswave.longterm.com.com.task.AXR930Task", "getAgentList", "", "");
//    gfn_SetParam(MethodObj, "sAgentCode", gds.gUserID); //조직구조
//    gfn_CallService(SOBJ_TEAM, DOBJ_TEAM, MethodObj);

    var MethodObj = new callService("com.inswave.longterm.com.com.task.AXR930Task", "getAgentList", pageSize, pageNo);
	MethodObj.setId("getAgentList");
	MethodObj.setParam("sAgentCode", util.getGdsValue("gUserID")); //조직구조
	MethodObj.setUrl("/contract/CBSC110MController.do");//배포후변경할것(controller위치와 이름)
	MethodObj.setXPath("//*/ADMAC03");//(dsWS의 XPath)
	MethodObj.sync();
	MethodObj.send();
    
	util.copyM(Ds_Team, DsWs_Team.getAllJSON());
	util.setCompBindRefresh(Ds_Team.getID());
    util.setRowPosition(Ds_Team, 0);  
//    wconv.copy(Ds_Team, "DsWs_Team");
    
    
    promise = promise.then(function(rtnVal) {
//        return wprom.promise.popupOpen("PROJECT_PATH_TEMP/com_pop/0120.xml", "", 594, 321);    
        	var popInfo = {
				"width"     : 750,
				"height"    : 500
			};			
			return wprom.popupOpen("/ui/cbso/CBSO020P.xml", popInfo);
    });
    promise = promise.then(function(result) {
        /*wprom.popupOpen(가이드참조)*/
        if (wconv.length(result) != 0) {
            var arrRst = wconv.split(result, "^", true);
            if (wconv.toNumber(arrRst[2]) <= 2) {
                wprom.alert("조직은 팀/센터이후부터 선택하세요");
            } else if (util.getGdsValue("gUserDuty") == "66" && (Ds_Team.getCellData(0, "sTeamCode") == arrRst[0])) {
                edt_deptCd.setValue(arrRst[0]);
                edt_deptName.setValue(arrRst[3]);
                edt_level.setValue(arrRst[2]);
            } else if (util.getGdsValue("gUserDuty") == "66" && (Ds_Team.getCellData(0, "sTeamCode") != arrRst[0])) {
                wprom.alert("대면총무인 경우, 본인 소속 지점을 선택해주세요.");
                edt_deptCd.setValue("");
                edt_deptName.setValue("");
                edt_level.setValue("");
            } else if (util.getGdsValue("gUserDuty") == "64" && (Ds_Team.getCellData(0, "sTeamCode") != arrRst[0])) {
                wprom.alert("지점장인 경우, 본인 소속 지점을 선택해주세요.");
                edt_deptCd.setValue("");
                edt_deptName.setValue("");
                edt_level.setValue("");
            } else {
                edt_deptCd.setValue(arrRst[0]);
                edt_deptName.setValue(arrRst[3]);
                edt_level.setValue(arrRst[2]);
            } 
        }
    });
    return promise;
};

//---------------------------------------------------------------------------
// function 명 : lfn_LTIDB03_OnColumnChanged
// 내용        :  그리드 클릭시 처리
//---------------------------------------------------------------------------
var checkFlag = "";

scwin.lfn_LTIDB03_OnColumnChanged = function(rowIndex, colID){
	checkFlag = false;
	var row = rowIndex;
    switch (colID) {
        case "chk":
        DsWs_LTIDB56.setCellData(row, "chk", "1");
        
            //현재 선택된 체크박스를 제외한 체크박스는 값을 0으로 바꾼다.
            for (var i = 0; i < DsWs_LTIDB56.getRowCount(); i++) {
                if (i != row && DsWs_LTIDB56.getCellData(i, "chk") == "1" && !checkFlag) {
                    //trace(nRow+"==4=="+checkFlag);
                    checkFlag = true;
                    DsWs_LTIDB56.setCellData(i, "chk", "0");
                    break;
                }
            }
            
            //해당 심사의 내역을 조회한다.
            if (DsWs_LTIDB56.getCellData(row, "chk") == "1" && !checkFlag) {
                scwin.lfn_ImgJugm(row);
            } else {
                if (!checkFlag) {                    
                    checkFlag = true;
                    DsWs_LTIDB56.setCellData(row, "chk", "1");
                } else {
                    checkFlag = false;
                }
            }
            break;
        default:
            break;
    }
};

//---------------------------------------------------------------------------
// function 명 : lfn_lTIDB03_OnClick
// 내용        :  그리드 클릭시 처리
//---------------------------------------------------------------------------
scwin.lfn_lTIDB03_OnClick = function(row, col) {
	
    switch (col) {
    	case 0:
    	var colID = "chk";	
    		scwin.lfn_LTIDB03_OnColumnChanged(row, colID);
    		
    	break;
        case 2:
            //var result = Dialog("ssr_pln::B010.xml", , 800, 550, "TaskBar=true Resize=true");	
            var strCode = "";
            var sScrnId = "";
            var sBunsMetdDocuClsfCd = DsWs_LTIDB56.getCellData(row, "sBunsMetdDocuClsfCd");
            //사업방법서 구분
            var sBunsMetdClsfCd = DsWs_LTIDB56.getCellData(row, "sBunsMetdClsfCd");
            //화재저축 구분
            //단체일경우
            var oDsJson=[{"PrigId":"CBSC110M"
			                		, "sInsuredNo": DsWs_LTIDB56.getCellData(row, "sPlanNo")		// 청약번호
			                		, "sKey": DsWs_LTIDB56.getCellData(row, "sPlanNo") 				// 청약번호
			                		, "sScrnId" : sScrnId }];  		// 필드 Json에 담기(gDs_LinkArg 함수 사용)		 
	       	gds.gDs_LinkArg.setJSON(oDsJson);
	       	
            if (DsWs_LTIDB56.getCellData(row, "sPsnGroupFlgcd") == "21") {
                 gfn_OpenLinkPage("CBSC042M"); //개인일경우
            } else {
                if (sBunsMetdDocuClsfCd == "3" || sBunsMetdClsfCd == "1") {
                     gfn_OpenLinkPage("CBSC094M");
                } else if (sBunsMetdDocuClsfCd == "7") {
                    //장기보험고도화-연금청약화면 이동
                     gfn_OpenLinkPage("CBSC075M");
                } else {
                  	gfn_OpenLinkPage("CBSC015M");
                }
            }
            scwin.lfn_cmb_linkMenu(strCode, sScrnId, row);
            break;
        case 3:
        	return true;
            //var result = Dialog("psv_ens::D020.xml", , 800, 550, "TaskBar=true Resize=true");	
            gfn_OpenLinkPage("CBSC028M");
            break;
        default:        
            break;
    }
};

//---------------------------------------------------------------------------
// function 명 : lfn_mkCheckBox
// 내용        : 리스트선택 시 체크박스에 체크
//---------------------------------------------------------------------------
scwin.lfn_mkCheckBox = function(currow) {
    if (DsWs_LTIDB05.getRowPosition() == currow) {
        return "1";
    } else {
        return "0";
    }
};

scwin.lfn_lTIDB05_OnClick = function(row, col) {

	var LTIDB05Count = DsWs_LTIDB05.getRowCount();
		 DsWs_LTIDB05.setCellData(row, "chk2", "1");
    if (col == 0) {
        for (var i = 0; i < LTIDB05Count; i++) {
            if (LTIDB05Count > 0) {
                if (row != i && DsWs_LTIDB05.getCellData(i, "chk2") == "1") {
                    DsWs_LTIDB05.setCellData(i, "chk2", 0);
                } else {
                    continue;
                }
            }
        }
    } 
//    else {}
};

//---------------------------------------------------------------------------
// function 명 : lfn_ImgJugm
// 내용        :  이미지심사내역 조회
//---------------------------------------------------------------------------
scwin.lfn_ImgJugm = function(row) {
    wconv.clear(DsWs_LTIDB05);
//    SOBJ.WSDL = gds.gWsdlBasis; //기본 웹서비스
    var pageSize="";
    var pageNo="";    
//    var MethodObj = gfn_CreateMethodObj(SOBJ, "com.inswave.longterm.ssr.sst.task.DBB520Task", "getImgJugm", "", "");
//    gfn_SetParam(MethodObj, "sPlanNo", DsWs_LTIDB56.getCellData(nRow, "sPlanNo")); //계약번호
//    gfn_SetParam(MethodObj, "sImagClsfCd", DsWs_LTIDB56.getCellData(nRow, "sImagClsfCd")); //이미지분류코드
//    DsWs_Warning.DataObject = "DOBJ_Req";
//    DsWs_LTIDB05.DataObject = "DOBJ_Req";
//    DsWs_LTIDB05.XPath = "//*/LTIDB05";
//    gfn_CallService(SOBJ, DOBJ_Req, MethodObj); 
    
    var MethodObj = new callService("com.inswave.longterm.ssr.sst.task.DBB520Task", "getImgJugm", pageSize, pageNo);
	MethodObj.setId("getImgJugm");
	MethodObj.setParam("sPlanNo", DsWs_LTIDB56.getCellData(row, "sPlanNo")); //계약번호
	MethodObj.setParam("sImagClsfCd", DsWs_LTIDB56.getCellData(row, "sImagClsfCd")); //이미지분류코드
	
	MethodObj.setUrl("/contract/CBSC110MController.do");//배포후변경할것(controller위치와 이름)
	MethodObj.setXPath("//*/LTIDB05");//(dsWS의 XPath)
	MethodObj.addXPath("//*/WARNING");
	MethodObj.sync();
	MethodObj.send();
	
	util.jSonDsCreate(_tranSync.getDsJson("LTIDB05"), "DsWs_LTIDB05");
	util.setCompBindRefresh("DsWs_LTIDB05");//바인딩을 해줌
	util.setRowPosition(DsWs_LTIDB05, 0);	
    
    util.jSonDsCreate(_tranSync.getDsJson("WARNING"), "DsWs_Warning");
    if (DsWs_Warning.getRowCount() != 0) {
        wprom.alert(DsWs_Warning.getCellData(0, "msg"));
        return;
    } else {
        if (DsWs_LTIDB05.getRowCount() == 0) {
            wprom.alert("조회된 건수가 없습니다.");
        }
    }
};

scwin.lfn_B520_OnClick = function(row) {
    var promise = Promise.resolve();
    if (wconv.length(DsWs_LTIDB05.getCellData(wconv.findRow(DsWs_LTIDB05, "chk2", "1"), "sPlanNo")) == 0) {
        wprom.alert("체크된 심사건이 없습니다.");
        return false;
    }
    //권한 체크  장기보험 업무팀권한 22030   장기보험 인수권한 22040
    //이부분도 주석처리함...나중에 풀기.
    /*if(nfn_checkAuthByID(SOBJ, DOBJ_Auth, "DsWs_Auth", gUserID, "22030")){
	}else if(nfn_checkAuthByID(SOBJ, DOBJ_Auth, "DsWs_Auth", gUserID, "22040")){
	}else{
		alert("심사자만 처리할수 있습니다.");
		return false;
	}*/
    /*	if(DsWs_LTIDB56.getColumn(DsWs_LTIDB56.FindRow("chk","1"), "sImagJugmReslt") != "01"){
    		alert("요청상태만 심사처리할수 있습니다.");
    		return false;
    	}	   */
    var arg = {};
    arg.sPlanNo = DsWs_LTIDB05.getCellData(wconv.findRow(DsWs_LTIDB05, "chk2", "1"), "sPlanNo"); //설계번호
    arg.sImagClsfCd = DsWs_LTIDB05.getCellData(wconv.findRow(DsWs_LTIDB05, "chk2", "1"), "sImagClsfCd"); //설계번호
    arg.nProgDgre = DsWs_LTIDB05.getCellData(wconv.findRow(DsWs_LTIDB05, "chk2", "1"), "nProgDgre");
    
//    var arg = "sPlanNo=" + wconv.quote(DsWs_LTIDB05.getCellData(wconv.findRow(DsWs_LTIDB05, "chk2", "1"), "sPlanNo")); //설계번호
//    arg += " sImagClsfCd=" + wconv.quote(DsWs_LTIDB05.getCellData(wconv.findRow(DsWs_LTIDB05, "chk2", "1"), "sImagClsfCd")); //이미지분류코드
//    arg += " nProgDgre=" + wconv.quote(DsWs_LTIDB05.getCellData(wconv.findRow(DsWs_LTIDB05, "chk2", "1"), "nProgDgre"));
    promise = promise.then(function(rtnVal) {
        //최종차수
//        return wprom.promise.popupOpen("PROJECT_PATH_TEMP/ssr_sst/CBSC107P.xml", arg, 300, 100, "TaskBar=true Resize=true");
			var popInfo = {
				"width"     : 650,
				"height"    : 175,				
				"indata" : arg				
			};			
			return wprom.popupOpen("/ui/cbsc/CBSC107P.xml", popInfo);
    });
    promise = promise.then(function(result) {
        /*wprom.popupOpen(가이드참조)*/
        if (wconv.length(result) != 0) {}
    });
    return promise;
};

//---------------------------------------------------------------------------
// function 명 : lfn_img_OnClick
// 내용        :  이미지 확인
//---------------------------------------------------------------------------
scwin.lfn_img_OnClick = function() {

    if (wconv.length(DsWs_LTIDB56.getCellData(wconv.findRow(DsWs_LTIDB56, "chk", "1"), "sPlanNo")) == 0) {
        wprom.alert("체크된 심사건이 없습니다.");
        return false;
    }
  
    var arg = "ContractNo=" + DsWs_LTIDB56.getCellData(wconv.findRow(DsWs_LTIDB56, "chk", "1"), "sPlanNo") + "&"; //계약번호
    arg += "Doctype=" + DsWs_LTIDB56.getCellData(wconv.findRow(DsWs_LTIDB56, "chk", "1"), "sImagClsfCd") + "&";
    arg += "hidJob_gubun=4" + "&";
    arg += "UsrId=" + util.getGdsValue("gUserID");
    
    var port = "";
    //운영환경일 때 Y  아니면 N 
    if (util.getGdsValue("gProdYN") == "Y") {
        port = "9000";
    } else {
        port = "8089";
    }
    /* 	var arg = "ContractNo=M10078000005"+"&";//계약번호
    	arg += "Doctype=JCA10001"+"&";
    	arg += "hidJob_gubun=4"+"&";
    	arg += "UsrId=5100018";   */
    //ExecBrowser("http://10.1.1.58:"+port+"/imgsys/jsp/index.jsp?"+arg);
    ExecBrowser(util.getGdsValue("gImgUrl") + "?" + arg);
};

scwin.grd_scanList_OnCellClick = function(row, col) {
    var promise = Promise.resolve();
    var arg = {};
//    arg = "sImagClsfCd=" + DsWs_LTIDB05.getCellData(row, "sImagClsfCd");
//    arg += " sPlanNo=" + DsWs_LTIDB05.getCellData(row, "sPlanNo");
//    arg += " nProgDgre=" + DsWs_LTIDB05.getCellData(row, "nProgDgre");
    
    arg.sPlanNo= DsWs_LTIDB05.getCellData(row, "sPlanNo");
    arg.sImagClsfCd= DsWs_LTIDB05.getCellData(row, "sImagClsfCd");		
    arg.nProgDgre= DsWs_LTIDB05.getCellData(row, "nProgDgre");
    
    promise = promise.then(function(rtnVal) {
    	var popInfo = {
				"width"     : 497,
				"height"    : 400,  		
				"indata" : arg
			};			
			return wprom.popupOpen("/ui/cbso/CBSC083P.xml", popInfo);    
       // return wprom.promise.popupOpen("PROJECT_PATH_TEMP/ssr_sst/CBSC083P.xml", arg, -1, -1); /*wprom.popupOpen(가이드참조)*/
    });
    return promise;
};


scwin.btn_Image_OnClick = function() {
    var row;
    var sPlanNo;
    nRow = DsWs_LTIDB56.getRowPosition();    
    sPlanNo = DsWs_LTIDB56.getCellData(row, "sPlanNo");
    var url;
    //운영환경일 때 Y  아니면 N 
    if (util.getGdsValue("gProdYN") == "Y") {
        url = "http://10.1.1.58:9000/imgsys/jsp/index.jsp?";
    } else {
        url = "http://10.1.1.131:8090/imgsys/jsp/index.jsp?";
    }
    var arg = "UsrId=" + util.getGdsValue("gUserID") + "&";
    arg += "hidJob_gubun=4" + "&";
    arg += "ContractNo=" + sPlanNo; //설계번호
    
    //계약 : http://10.1.1.131:8090/imgsys/jsp/index.jsp?UsrId=5140023&hidJob_gubun=4&ContractNo=M20120102092
    //      UsrId : 사용자ID
    //      hidJob_gubun : 업무구분
    //      ContractNo : 청약번호
    
    ExecBrowser(url + arg);
};

//**************************************************************************************************
// 조회구분 선택에 따른 컴포넌트 활성화 처리
//**************************************************************************************************
scwin.cmb_searchCd_OnClick = function(obj, strPreText, strPostText) {
    if (cmb_searchCd.getValue() == "sPlanNo") {
        edt_searchName.show();
        edt_searchValue.hide();
        edt_deptName.hide();
        btn_Doer.hide();
        btn_grup.hide();
        edt_searchName.setValue("");
        edt_searchValue.setValue("");
        edt_deptName.setValue("");
    } else if (cmb_searchCd.getValue() == "sDmdr" || cmb_searchCd.getValue() == "sKeyDoer" || cmb_searchCd.getValue() == "sKeyDoerUser") {
        edt_searchName.show();
        edt_searchValue.show();
        edt_deptName.hide();
        btn_Doer.show();
        btn_grup.hide();
        edt_searchName.setValue("");
        edt_searchValue.setValue("");
        edt_deptName.setValue("");
    } else if (cmb_searchCd.getValue() == "sKeyDept") {
        edt_searchName.hide();
        edt_searchValue.hide();
        edt_deptName.show();
        btn_Doer.hide();
        btn_grup.show();
        edt_searchName.setValue("");
        edt_searchValue.setValue("");
        edt_deptName.setValue("");
    } else {
    	edt_deptName.hide();
        edt_searchName.show();
        edt_searchValue.hide();
        btn_Doer.hide();
        btn_grup.hide();
        edt_searchName.setValue("");
        edt_searchValue.setValue("");
        edt_deptName.setValue("");
    }
};

//**************************************************************************************************
// 취급자,사용인 조회
//**************************************************************************************************
scwin.lfn_SearchDoer_OnClick = function(obj) {
    var promise = Promise.resolve();
    if (cmb_searchCd.getValue() == "sDmdr" || cmb_searchCd.getValue() == "sKeyDoer" || cmb_searchCd.getValue() == "sKeyDoerUser") {
        var indata  = { };				
        promise = promise.then(function(rtnVal) {			
			var popInfo = {
				"width"     : 657,
				"height"    : 437,  
				"indata"    : indata				
			};			
			return wprom.popupOpen("/ui/cbso/CBSO015P.xml", popInfo);        
//            return wprom.promise.popupOpen("PROJECT_PATH_TEMP/popup/CBSO015P.xml", "", 640, 336);
        });
        promise = promise.then(function(rst) {
            /*wprom.popupOpen(가이드참조)*/
            if (wconv.length(rst) != 0) {
                var arrRst = wconv.split(rst, "^");
                edt_searchName.setValue(arrRst[0]);
                edt_searchValue.setValue(arrRst[1]);
            }
        });
    }
    return promise;
};

//**************************************************************************************************
// 페이징 처리 - 첫 페이지
//**************************************************************************************************
scwin.Btn_PreV_OnClick = function(e) {
    var ftVal = wconv.toNumber(Ds_Page.getCellData(Ds_Page.getRowCount(), "FILTERCD")) - 1;
    if (wconv.toNumber(maxFilterVal) < wconv.toNumber(ftVal))
        return;
    else if (wconv.toNumber(ftVal) < 1)
        return;
    wconv.filter(Ds_Page, "FILTERCD=='" + ftVal + "'", true);
    Cmb_Page.setValue(Ds_Page.getCellData(0, "CODE"));
    scwin.lfn_SearchData(1);
};

//**************************************************************************************************
// 페이징 처리 - 이전 페이지
//**************************************************************************************************
scwin.Btn_Pre_OnClick = function(e) {
    var Idx = Cmb_Page.getValue();
    if (wconv.toNumber(Idx) - 1 < 1) {
        wprom.alert("조회의 처음입니다.");
        return;
    }
    scwin.lfn_SearchData(wconv.toString(wconv.toNumber(Idx) - 1));
    if (Ds_Page.getCellData(Ds_Page.firstrow, "CODE") == Idx) {
        wconv.filter(Ds_Page, "FILTERCD=='" + wconv.toString(wconv.toNumber(Ds_Page.getCellData(0, "FILTERCD")) - 1) + "'", true);
        Cmb_Page.setValue(Ds_Page.getCellData(Ds_Page.getRowCount(), "CODE"));
        /*수작업 변환 가이드 (getTotalRow)
            필터 적용이 되어있는 row의 건수는 getRowCount API를 사용합니다.*/
    } else
        Cmb_Page.setValue(wconv.toNumber(Idx) - 1);
};

//**************************************************************************************************
// 페이징 처리 - 다음 페이지
//**************************************************************************************************
scwin.Btn_Next_OnClick = function(e) {
    var Idx = Cmb_Page.getValue();
    if (wconv.toNumber(maxPage) < wconv.toNumber(Idx) + 1) {
        wprom.alert("더이상 자료가 존재하지 않습니다");
        return;
    }
    scwin.lfn_SearchData(wconv.toString(wconv.toNumber(Idx) + 1));
    if (Ds_Page.getCellData(Ds_Page.getRowCount(), "CODE") == Idx
        /*수작업 변환 가이드 (getTotalRow)
            필터 적용이 되어있는 row의 건수는 getRowCount API를 사용합니다.*/
    ) {
        wconv.filter(Ds_Page, "FILTERCD=='" + wconv.toString(wconv.toNumber(Ds_Page.getCellData(Ds_Page.getRowCount(), "FILTERCD")) + 1) + "'", true);
    }
    Cmb_Page.setValue(wconv.toNumber(Idx) + 1);
};

//**************************************************************************************************
// 페이징 처리 - 다음 페이지 리스트
//**************************************************************************************************
scwin.Btn_NextV_OnClick = function(e) {
    var ftVal = wconv.toNumber(Ds_Page.getCellData(Ds_Page.getRowCount, "FILTERCD")) + 1;
    if (wconv.toNumber(maxFilterVal) <= wconv.toNumber(ftVal)) {
        wprom.alert("더이상 자료가 존재하지 않습니다");
        return;
    }
    wconv.filter(Ds_Page, "FILTERCD=='" + ftVal + "'", true);
    Cmb_Page.setValue(Ds_Page.getCellData(0, "CODE"));
    scwin.lfn_SearchData(Cmb_Page.getValue());
};
//**************************************************************************************************
// 페이지 처리
//**************************************************************************************************
scwin.Cmb_Page_OnChanged = function(info) {
    scwin.lfn_SearchData(info.newValue);
};
//---------------------------------------------------------------------------
// function 명 : lfn_cmb_linkMenu_OnChanged
// 내용        :  그리드 클릭시 처리
//---------------------------------------------------------------------------
scwin.lfn_cmb_linkMenu = function(strCode, sScrnId, row) {
return true;
    gds.gDs_LinkArg.removeAll();
    var insRow = util.insertRow(gds.gDs_LinkArg);
    /*수작업 변환 개발자 가이드(테스트 중)
    dataList에 row를 추가하고 setCellData를 하는 경우 첫 번째 인자를 insRow로 변경해주세요.*/
    util.insertColumn(gds.gDs_LinkArg, [["sInsuredNo", "sInsuredNo", "text"]]);
    util.insertColumn(gds.gDs_LinkArg, [["sScrnId", "sScrnId", "text"]]);
    util.insertColumn(gds.gDs_LinkArg, [["sCrNo", "sCrNo", "text"]]);
    gds.gDs_LinkArg.setCellData(0, "sInsuredNo", DsWs_LTIDB56.getCellData(insRow, "sPlanNo"));
    gds.gDs_LinkArg.setCellData(0, "sCrNo", DsWs_LTIDB56.getCellData(insRow, "sCrNo"));
    gds.gDs_LinkArg.setCellData(0, "sScrnId", sScrnId);
    //trace("gDs_LinkArg=="+gDs_LinkArg.SaveXML());	
    gfn_OpenLinkPage(strCode);
};
]]></script>
    </head>
    <body>
    	<xf:group class="cont_wrap" id="O310"
    		style="position:absolute; WorkArea:true;  Ver:1.0;  PidAttrib:7;  /*height:612px;*/ left:0px; top:0px;/* width:820px;"
    		userData1="청약 이미지 심사 New"
    		userData2=" OnLoadCompleted:scwin.O310_OnLoadCompleted; ">
    		<DataObjects>
    			<DataObject />
    			<DataObject />
    			<DataObject />
    			<DataObject />
    			<DataObject />
    			<DataObject />
    			<DataObject />
    		</DataObjects>
    		<ServiceObjects>
    			<ServiceObject />
    			<ServiceObject />
    			<ServiceObject />
    			<ServiceObject />
    		</ServiceObjects>
    		<xf:group arcsize="6" class="search_area" id="Shape0"
    			style="position:absolute; right:0px; bottom:80px; height:52px; left:0px; top:28px;"
    			userData3="RoundRect">
    			<w2:anchor class="btn_search" disabled=""
    				ev:onclick="scwin.lfn_Search_Async" id="search" outerDiv="false"
    				style="top:29px;margin-top:-10px;" tabIndex="7">
    				<xf:label><![CDATA[조회]]></xf:label>
    			</w2:anchor>
    		</xf:group>
    		<xf:switch id="switch_175" style=" ">
    			<xf:case id="Default_176" style=" ">
    				<w2:gridView class="sty_Grid"
    					dataList="DsWs_LTIDB56"
    					ev:oncellclick="scwin.lfn_lTIDB03_OnClick" focusMode="row"
    					id="grd_LTIDB56" inputType="text" readOnly="false"
    					style="position:absolute; UseDBuff:true;  InputPanel:FALSE;  EndLineColor:default;  border:Flat;  AutoFitEndLine:Hide;height:294px; left:0px; top:115px;"
    					tabIndex="1" arrowMove="" autoFit="allColumn"
    					autoFitMinWidth="100" ignoreCellClick="false"
    					ignoreToggleOnDisabled="false" scrollByColumn="false"
    					scrollByColumnAdaptive="false" showSortableUseFilter="false"
    					summaryAuto="false" summaryOnlyAuto="false" fixedColumn="">
    					<w2:header>
    						<w2:row>
    							<w2:column dataType="text"
    								id="head_id_1588" inputType="text" readOnly="true"
    								style="height:20px;" userData1="0" userData3="0" width="30" />
    							<w2:column dataType="text"
    								id="head_id_1589" inputType="text" readOnly="true"
    								style="height:20px;" userData1="1" userData3="0" value="구분"
    								width="40" />
    							<w2:column dataType="text"
    								id="head_id_1590" inputType="text" readOnly="true"
    								style="height:20px;" userData1="2" userData3="0"
    								value="청약번호" width="110" />
    							<w2:column dataType="text"
    								id="head_id_1591" inputType="text" readOnly="true"
    								style="height:20px;" userData1="3" userData3="0"
    								value="피보험자" width="54" />
    							<w2:column dataType="text"
    								id="head_id_1592" inputType="text" readOnly="true"
    								style="height:20px;" userData1="4" userData3="0" value="청약일"
    								width="80" />
    							<w2:column dataType="text"
    								id="head_id_1593" inputType="text" readOnly="true"
    								style="height:20px;" userData1="5" userData3="0"
    								value="요청일시" width="120" />
    							<w2:column dataType="text"
    								id="head_id_1594" inputType="text" readOnly="true"
    								style="height:20px;" userData1="6" userData3="0" value="상품명"
    								width="170" />
    							<w2:column dataType="text"
    								id="head_id_1595" inputType="text" readOnly="true"
    								style="height:20px;" userData1="7" userData3="0"
    								value="심사상태" width="58" />
    							<w2:column dataType="text"
    								id="head_id_1596" inputType="text" readOnly="true"
    								style="height:20px;" userData1="8" userData3="0" value="차수"
    								width="35" />
    							<w2:column dataType="text"
    								id="head_id_1597" inputType="text" readOnly="true"
    								style="height:20px;" userData1="9" userData3="0" value="요청자"
    								width="50" />
    							<w2:column width="100" inputType="text"
    								style="height:20px;" id="column5" blockSelect="false"
    								displayMode="label" value="취급자소속">
    							</w2:column>
    							<w2:column width="70" inputType="text"
    								style="height:20px;" id="column3" blockSelect="false"
    								displayMode="label" value="취급자">
    							</w2:column>
    							<w2:column width="100" inputType="text"
    								style="height:20px;" id="column1" blockSelect="false"
    								displayMode="label" value="취급자명">
    							</w2:column>
    							<w2:column dataType="text"
    								id="head_id_1598" inputType="text" readOnly="true"
    								style="height:20px;" userData1="10" userData3="0"
    								value="심사자" width="55" />
    							<w2:column dataType="text"
    								id="head_id_1599" inputType="text" readOnly="true"
    								style="height:20px;" userData1="11" userData3="0"
    								value="심사일시" width="99" />
    						</w2:row>
    					</w2:header>
    					<w2:gBody>
    						<w2:row>
    							<w2:column id="chk" inputType="checkbox"
    								style="height:20px;" userData1="0" userData3="0" width="16"
    								falseValue="0" trueValue="1" defaultValue="0"
    								blockSelect="false" readOnly="false" displayMode="label">
    							</w2:column>
    							<w2:column dataType="text" id="sSat"
    								inputType="text" readOnly="true" textAlign="center"
    								userData1="1" userData3="0" width="40" />
    							<w2:column dataType="text"
    								displayFormat="#-####-#######" id="sPlanNo" inputType="link"
    								readOnly="true" textAlign="center" userData1="2"
    								userData3="0" width="95" />
    							<w2:column dataType="text"
    								id="sInrpsName" readOnly="true" textAlign="center"
    								userData1="3" userData3="0" width="54" inputType="text"
    								displayFormatter="scwin.gfn_changeMask" />
    							<w2:column dataType="date"
    								id="sSsrtDate" inputType="text" readOnly="true"
    								textAlign="center" userData1="4" userData3="0" width="67" />
    							<w2:column dataType="text"
    								id="sRqstDateHms" inputType="text" readOnly="true"
    								textAlign="center" userData1="5" userData3="0" width="103"
    								displayFormatter="scwin.daysub" />
    							<w2:column dataType="text" id="sGdName"
    								inputType="text" readOnly="true" textAlign="left"
    								userData1="6" userData3="0" width="167" />
    							<w2:column dataType="text"
    								id="sFinalImagJugmStatName" inputType="text" readOnly="true"
    								textAlign="center" userData1="7" userData3="0" width="58" />
    							<w2:column dataType="text"
    								id="nProgDgre" inputType="text" readOnly="true"
    								textAlign="center" userData1="8" userData3="0" width="30" />
    							<w2:column dataType="text"
    								id="sDmdrName" inputType="text" readOnly="true"
    								textAlign="center" userData1="9" userData3="0" width="50" />
    							<w2:column width="100" inputType="text"
    								style="height:20px" id="sDoerCentrName" blockSelect="false"
    								displayMode="label">
    							</w2:column>
    							<w2:column width="70" inputType="text"
    								style="height:20px" id="sDoer" blockSelect="false"
    								displayMode="label">
    							</w2:column>
    							<w2:column width="100" inputType="text"
    								style="height:20px" id="sDoerName" blockSelect="false"
    								displayMode="label">
    							</w2:column>
    							<w2:column dataType="text"
    								id="sJudgName" inputType="text" readOnly="true"
    								textAlign="center" userData1="10" userData3="0" width="55" />
    							<w2:column dataType="text"
    								id="sCnfmDateHms" inputType="text" readOnly="true"
    								textAlign="center" userData1="11" userData3="0" width="99"
    								displayFormatter="scwin.daysub" />
    						</w2:row>
    					</w2:gBody>
    				</w2:gridView>
    			</xf:case>
    		</xf:switch>
    		<w2:textbox class="sty_lb_Search" id="Static6" label="조회기준"
    			style="position:absolute; VAlign:Middle;  text-align:right; height:20px; left:9px; top:33px; width:68px;"
    			tagname="" />
    		<xf:input class="sty_ipt_search" id="edt_searchName"
    			style="position:absolute; border-style:solid;  height:20px;left:199px;top:32px; width:104px;"
    			tabIndex="7" />
    		<w2:textbox id="Static2" label="~"
    			style="position:absolute;height:20px;text-align:right;width:20px;left:681px;VAlign:Middle;top:56px;"
    			tagname="" />
    		<w2:inputCalendar class="sty_ipt_search"
    			id="cal_standEndDate"
    			style="position:absolute;height:20px;SundayTextColor:red;width:98px;border-style:solid;SaturdayTextColor:blue;left:707px;top:56px;"
    			tabIndex="10" validCheck="true" />
    		<w2:textbox class="sty_lb_Search" id="Static7"
    			label="조회기간구분"
    			style="position:absolute; VAlign:Middle;  text-align:right; height:20px;left:386px;top:57px; width:77px;"
    			tagname="" />
    		<w2:inputCalendar class="sty_ipt_search"
    			id="cal_standStrtdate"
    			style="position:absolute;height:20px;SundayTextColor:red;width:100px;border-style:solid;SaturdayTextColor:blue;left:586px;top:56px;"
    			tabIndex="12" validCheck="true" />
    		<xf:select1 appearance="minimal" class="sty_ipt_search"
    			emptyItem="true" ev:onchange="scwin.cmb_searchCd_OnClick"
    			id="cmb_searchCd"
    			style="position:absolute; ImeMode:none;  INDEX:0;  border-style:solid;  height:20px;left:93px;top:32px; width:100px;text-align: center;"
    			tabIndex="13" renderType="native">
    			<xf:choices>
    				<xf:itemset nodeset="data:Ds_search">
    					<xf:label ref="sHnglCdName" />
    					<xf:value ref="sCd" />
    				</xf:itemset>
    			</xf:choices>
    		</xf:select1>
    		<w2:textbox class="sty_lb_Search" id="Static4" label="업무구분"
    			style="position:absolute; VAlign:Middle;  text-align:right; height:20px;left:13px;top:57px; width:64px;"
    			tagname="" />
    		<xf:select1 appearance="minimal" class="sty_ipt_search"
    			emptyItem="true" id="cmb_ImagJugmReslt"
    			style="position:absolute; border-style:solid;  height:20px;left:221px;top:56px; width:80px;"
    			tabIndex="15" renderType="native">
    			<xf:choices>
    				<xf:itemset nodeset="data:DsWs_ImagJugmReslt">
    					<xf:label ref="sHnglCdName" />
    					<xf:value ref="sCd" />
    				</xf:itemset>
    			</xf:choices>
    		</xf:select1>
    		<w2:textbox class="sty_lb_Search" id="Static5" label="심사상태"
    			style="position:absolute; VAlign:Middle;  text-align:right;height:20px;left:153px;top:57px;width:53px;"
    			tagname="" />
    		<xf:switch id="switch_176" style=" ">
    			<xf:case id="Default_177" style=" ">
    				<w2:gridView class="sty_Grid"
    					dataList="DsWs_LTIDB05"
    					ev:oncellclick="scwin.lfn_lTIDB05_OnClick" focusMode="row"
    					id="grd_LTIDB05" inputType="text" readOnly=""
    					style="position:absolute; UseDBuff:true;  InputPanel:FALSE;  EndLineColor:default;  border:Flat;  AutoFitEndLine:Hide;height:142px; left:0px;top:417px;"
    					tabIndex="19" autoFitMinWidth="100" autoFit="allColumn">
    					<w2:header>
    						<w2:row>
    							<w2:column dataType="text"
    								id="head_id_1600" inputType="text" readOnly="true"
    								style="height:20px;" userData1="0" userData3="0" value="심사"
    								width="30" />
    							<w2:column dataType="text"
    								id="head_id_1601" inputType="text" readOnly="true"
    								style="height:20px;" userData1="1" userData3="0" value="차수"
    								width="35" />
    							<w2:column dataType="text"
    								id="head_id_1602" inputType="text" readOnly="true"
    								style="height:20px;" userData1="2" userData3="0"
    								value="심사상태" width="78" />
    							<w2:column dataType="text"
    								id="head_id_1603" inputType="text" readOnly="true"
    								style="height:20px;" userData1="3" userData3="0" value="요청자"
    								width="65" />
    							<w2:column dataType="text"
    								id="head_id_1604" inputType="text" readOnly="true"
    								style="height:20px;" userData1="4" userData3="0" value="심사자"
    								width="73" />
    							<w2:column dataType="text"
    								id="head_id_1605" inputType="text" readOnly="true"
    								style="height:20px;" userData1="5" userData3="0" value="요청일"
    								width="71" />
    							<w2:column dataType="text"
    								id="head_id_1606" inputType="text" readOnly="true"
    								style="height:20px;" userData1="6" userData3="0" value="심사일"
    								width="71" />
    							<w2:column dataType="text"
    								id="head_id_1607" inputType="text" readOnly="true"
    								style="height:20px;" userData1="7" userData3="0"
    								value="심사내용" width="377" />
    						</w2:row>
    					</w2:header>
    					<w2:gBody>
    						<w2:row>
    							<w2:column id="chk2"
    								inputType="checkbox" style="height:20px;" userData1="0"
    								userData3="0" width="29" trueValue="1" falseValue="0"
    								defaultValue="0" readOnly="false" blockSelect="false"/>
    							<w2:column dataType="text"
    								id="nProgDgre" inputType="text" readOnly="true"
    								textAlign="center" userData1="1" userData3="0" width="35" />
    							<w2:column dataType="text"
    								id="sImagJugmResltName" inputType="text" readOnly="true"
    								textAlign="center" userData1="2" userData3="0" width="78" />
    							<w2:column dataType="text"
    								id="sDmdrName" inputType="text" readOnly="true"
    								textAlign="center" userData1="3" userData3="0" width="65" />
    							<w2:column dataType="text"
    								id="sJudgName" inputType="text" readOnly="true"
    								textAlign="center" userData1="4" userData3="0" width="73" />
    							<w2:column dataType="date"
    								id="sRqstDate" inputType="text" readOnly="true"
    								textAlign="center" userData1="5" userData3="0" width="71" />
    							<w2:column dataType="text"
    								displayFormat="####-##-##" id="sCnfmDate" inputType="text"
    								readOnly="false" textAlign="center" userData1="6"
    								userData3="0" width="71" />
    							<w2:column dataType="text"
    								id="sJugmCont" inputType="text" readOnly="true"
    								textAlign="left" userData1="7" userData3="0" width="377" />
    						</w2:row>
    					</w2:gBody>
    				</w2:gridView>
    			</xf:case>
    		</xf:switch>
    		<xf:select1 appearance="minimal" class="sty_ipt_search"
    			emptyItem="true" id="cmb_workFlag"
    			style="position:absolute; INDEX:0;  border-style:solid;height:20px;left:93px;top:56px;width:68px;"
    			tabIndex="20" renderType="native" allOption="" chooseOption="">
    			<xf:choices>
    				<xf:itemset nodeset="data:Ds_WorkFlag">
    					<xf:label ref="sHnglCdName" />
    					<xf:value ref="sCd" />
    				</xf:itemset>
    			</xf:choices>
    		</xf:select1>
    		<xf:input class="sty_ipt_search" id="edt_level"
    			maxlength="7"
    			style="position:absolute; display:none;  ImeMode:none;  border-style:solid;  height:20px; left:463px; top:32px; width:9px;"
    			tabIndex="24" />
    		<xf:input class="sty_ipt_search" id="edt_deptCd"
    			maxlength="7"
    			style="position:absolute; display:none;  ImeMode:none;  border-style:solid;  height:20px; left:455px; top:32px; width:6px;"
    			tabIndex="23" />
    		<xf:trigger class="detail_search"
    			ev:onclick="scwin.lfn_SearchDept_OnClick" id="btn_grup"
    			style="position:absolute;  Transparent:TRUE;  ImageID:btn_Search_Search;  height:20px;left:448px;top:33px; width:20px; display: none;"
    			tabIndex="22" type="anchor"/>
    		<xf:input class="sty_ipt_search" disabled="true"
    			id="edt_deptName" maxlength="7"
    			style="position:absolute;Transparent:TRUE;  ImageID:btn_Search_Search;height:20px;left:198px;top:33px;width:246px;display: none;"
    			tabIndex="21" />
    		<xf:input class="sty_ipt_search" dataType="text"
    			id="medt_searchName" maxlength="12"
    			style="position:absolute; display:none;  border-style:solid;  height:20px; left:832px; top:80px; width:96px;"
    			tabIndex="25" />
    		<xf:trigger class="detail_bu02"
    			ev:onclick="scwin.lfn_B520_OnClick" id="btn_B520"
    			style="position:absolute; Transparent:TRUE;  ImageID:btn_Input_05;  height:20px;right:0;top:564px; width:60px;"
    			tabIndex="26" type="anchor">
    			<xf:label><![CDATA[이미지심사]]></xf:label>
    		</xf:trigger>
    		<xf:trigger class="detail_bu02"
    			ev:onclick="scwin.btn_Image_OnClick" id="btn_Image"
    			style="position:absolute; ImageID:btn_Input_06;  height:20px;right:94px;top:564px; width:80px;"
    			tabIndex="27" type="anchor" disabled="true">
    			<xf:label><![CDATA[이미지 시스템]]></xf:label>
    		</xf:trigger>
    		<w2:wframe id="div1" scope="false"
    			src="/cm/common/Main_btn_GridControl.xml"
    			style="position:absolute; height:20px; right:38px;top:83px; width:219px;" />
    		<xf:trigger class="detail_search"
    			ev:onclick="scwin.lfn_SearchDoer_OnClick" id="btn_Doer"
    			style="position:absolute;  Transparent:TRUE;  ImageID:btn_Search_Search;  height:20px;left:308px;top:33px; width:20px; display: none"
    			tabIndex="29" type="anchor"/>
    		<xf:input class="sty_ipt_search" disabled="true"
    			id="edt_searchValue" maxByteLength="7"
    			style="position:absolute;  ImeMode:native;  border-style:solid;  height:20px;left:337px;top:33px; width:119px;display: none;"
    			tabIndex="30" />
    		<xf:select1 appearance="minimal" class="sty_ipt_search"
    			emptyItem="true" id="cmb_searchTermCd"
    			style="position:absolute;INDEX:0;height:20px;width:100px;border-style:solid;ImeMode:none;left:479px;top:56px;"
    			tabIndex="31" renderType="native">
    			<xf:choices>
    				<xf:itemset nodeset="data:Ds_searchTerm">
    					<xf:label ref="sHnglCdName" />
    					<xf:value ref="sCd" />
    				</xf:itemset>
    			</xf:choices>
    		</xf:select1>
    	</xf:group>
    	<w2:wframe id="" initScript="scwin.wfTitleFavInit();"
    		src="/cm/common/wf_titleFav.xml" style="margin-right: 15px;">
    	</w2:wframe>
    </body>
</html>
