<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="/cm/css/all.css" type="text/css"?>
<?xml-stylesheet href="/cm/css/convert.css" type="text/css"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head>
    <!-- 
        ###################################################
         파일명 : CBSC115M.xml
         프로그램명 : 통합계약조회
         설 명 :  통합계약조회 화면
         작성자 : 이경일
         작성일 : 2017.09.11
 
         수정일자            수정자                  수정내용
        ==================================================
        2017.09.11        이경일          최초작성
        ###################################################
     -->
        <w2:type>DEFAULT</w2:type>
        <w2:buildDate></w2:buildDate>
        <xf:model>
            <xf:instance>
                <data></data>
            </xf:instance>
            <w2:dataCollection>
                <w2:dataList baseNode="list" id="Ds_LinkList" repeatNode="map"></w2:dataList>
                <w2:dataList baseNode="list" id="Ds_LTIEA00"
                	repeatNode="map">
                	<w2:columnInfo>
                		<w2:column id="nFinalPaymSeq" name="name1"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCrtorSendAdrs2" name="name2"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sAdrs2" name="name3"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCrtorSendAdrs1" name="name4"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sAdrs1" name="name5"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCrtorInrpsFlag" name="name6"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCrStatCdName" name="name7"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCrtorAdrs1" name="name8"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCrtorAdrs2" name="name9"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCrtorName" name="name10"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInrpsName" name="name11"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInsurFlag" name="name12"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInrpsSendType" name="name13"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInrpsCdDp" name="name14"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sLastEndorseDate" name="name15"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCrtorCd" name="name16"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInrpsCd" name="name17"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInrpsSendAdrs1" name="name18"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInrpsSendAdrs2" name="name19"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCrNo" name="name20"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCrtorSendType" name="name21"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sPolicyDate" name="name22"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInputDate" name="name23"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sGdCdName" name="name24"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sPaymCtDp" name="name25"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sSendTypeNm" name="name26"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInrpsAdrsType" name="name27"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sPayrNo" name="name28"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sTodt" name="name29"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCrtorCdDp" name="name30"
                			dataType="text">
                		</w2:column>
                		<w2:column id="nInsrdNum" name="name31"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sScanObjtYn" name="name32"
                			dataType="text">
                		</w2:column>
                		<w2:column id="nLastEndorseNo" name="name33"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sAccid" name="name34"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInrpsAdrs1" name="name35"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInrpsAdrs2" name="name36"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInsurTerm" name="name37"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sPlateNo" name="name38"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sFmdt" name="name39"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sSendType" name="name40"
                			dataType="text">
                		</w2:column>
                		<w2:column id="nMaxEndorseNo" name="name41"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sRenwlYn" name="name42"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCrtorAdrsType" name="name43"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sFinalPaymMthy" name="name44"
                			dataType="text">
                		</w2:column>
                		<w2:column id="nInrpsSeqno" name="name45"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sMonitoringYN" name="name46"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCmMetdName" name="name47"
                			dataType="text">
                		</w2:column>
                	</w2:columnInfo>
                </w2:dataList>
                <w2:dataList baseNode="list" id="Ds_CrChng" repeatNode="map">
                    <w2:columnInfo>
                        <w2:column dataType="text" id="sIndex" name="sIndex"></w2:column>
                        <w2:column dataType="text" id="sValue" name="sValue"></w2:column>
                    </w2:columnInfo>
                    <w2:data use="true">
                        <w2:row>
                            <sIndex></sIndex>
                            <sValue><![CDATA[전체]]></sValue>
                        </w2:row>
                        <w2:row>
                            <sIndex><![CDATA[1]]></sIndex>
                            <sValue><![CDATA[유효]]></sValue>
                        </w2:row>
                    </w2:data>
                </w2:dataList>
                <w2:dataList baseNode="list" id="Ds_StdCd" repeatNode="map">
                    <w2:columnInfo>
                        <w2:column dataType="text" id="sIndex" name="sIndex"></w2:column>
                        <w2:column dataType="text" id="sValue" name="sValue"></w2:column>
                    </w2:columnInfo>
                    <w2:data use="true">
                        <w2:row>
                            <sIndex><![CDATA[1]]></sIndex>
                            <sValue><![CDATA[보험계약자명]]></sValue>
                        </w2:row>
                        <w2:row>
                            <sIndex><![CDATA[2]]></sIndex>
                            <sValue><![CDATA[보험계약자코드]]></sValue>
                        </w2:row>
                        <w2:row>
                            <sIndex><![CDATA[3]]></sIndex>
                            <sValue><![CDATA[피보험자명]]></sValue>
                        </w2:row>
                        <w2:row>
                            <sIndex><![CDATA[4]]></sIndex>
                            <sValue><![CDATA[피보험자코드]]></sValue>
                        </w2:row>
                        <w2:row>
                            <sIndex><![CDATA[5]]></sIndex>
                            <sValue><![CDATA[계약번호]]></sValue>
                        </w2:row>
                        <w2:row>
                            <sIndex><![CDATA[7]]></sIndex>
                            <sValue><![CDATA[납부자번호]]></sValue>
                        </w2:row>
                    </w2:data>
                </w2:dataList>
                <w2:dataList baseNode="list" id="ds_code" repeatNode="map"></w2:dataList>
                <w2:dataList baseNode="list" id="DsWs_Warning"
                	keyNode="//*/WARNING" repeatNode="map">
                	<w2:columnInfo>
                		<w2:column id="msg" name="name1"
                			dataType="text">
                		</w2:column>
                		<w2:column id="level" name="name2"
                			dataType="text">
                		</w2:column>
                		<w2:column id="detail" name="name3"
                			dataType="text">
                		</w2:column>
                		<w2:column id="timestamp" name="name4"
                			dataType="text">
                		</w2:column>
                	</w2:columnInfo>
                </w2:dataList>
                <w2:dataList baseNode="list" id="DsWs_LTIEA00"
                	keyNode="//*/hashtable/data/vector/data/LTIEA00"
                	repeatNode="map">
                	<w2:columnInfo>
                		<w2:column id="nFinalPaymSeq" name="name1"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCrtorSendAdrs2" name="name2"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sAdrs2" name="name3"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCrtorSendAdrs1" name="name4"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sAdrs1" name="name5"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCrtorInrpsFlag" name="name6"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCrStatCdName" name="name7"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCrtorAdrs1" name="name8"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCrtorAdrs2" name="name9"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCrtorName" name="name10"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInrpsName" name="name11"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInsurFlag" name="name12"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInrpsSendType" name="name13"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInrpsCdDp" name="name14"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sLastEndorseDate" name="name15"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCrtorCd" name="name16"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInrpsCd" name="name17"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInrpsSendAdrs1" name="name18"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInrpsSendAdrs2" name="name19"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCrNo" name="name20"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCrtorSendType" name="name21"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sPolicyDate" name="name22"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInputDate" name="name23"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sGdCdName" name="name24"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sPaymCtDp" name="name25"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sSendTypeNm" name="name26"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInrpsAdrsType" name="name27"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sPayrNo" name="name28"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sTodt" name="name29"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCrtorCdDp" name="name30"
                			dataType="text">
                		</w2:column>
                		<w2:column id="nInsrdNum" name="name31"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sScanObjtYn" name="name32"
                			dataType="text">
                		</w2:column>
                		<w2:column id="nLastEndorseNo" name="name33"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sAccid" name="name34"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInrpsAdrs1" name="name35"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInrpsAdrs2" name="name36"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sInsurTerm" name="name37"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sPlateNo" name="name38"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sFmdt" name="name39"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sSendType" name="name40"
                			dataType="text">
                		</w2:column>
                		<w2:column id="nMaxEndorseNo" name="name41"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sRenwlYn" name="name42"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCrtorAdrsType" name="name43"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sFinalPaymMthy" name="name44"
                			dataType="text">
                		</w2:column>
                		<w2:column id="nInrpsSeqno" name="name45"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sMonitoringYN" name="name46"
                			dataType="text">
                		</w2:column>
                		<w2:column id="sCmMetdName" name="name47"
                			dataType="text">
                		</w2:column>
                	</w2:columnInfo>
                </w2:dataList>
                <w2:dataList baseNode="list" id="DsWs_chekCrInqrAuth"
                	keyNode="//*/AXR931" repeatNode="map">
                	<w2:columnInfo>
                		<w2:column id="sAcesCntrYn" name="name1"
                			dataType="text">
                		</w2:column>
                	</w2:columnInfo>
                </w2:dataList>
            </w2:dataCollection>
            <w2:workflowCollection></w2:workflowCollection>
        </xf:model>
		<script src="/cm/js/convertJs/Global_Script.js"/>
		<script src="/cm/js/convertJs/comm_Webservice.js"/>
		<script src="/cm/js/convertJs/NewGen_Script.js"/>
		<script src="/cm/js/convertJs/LongTerm_Script.js"/>
        <script><![CDATA[
/*■■■■■■■■■■■■■■■■■■■■■스크립트 변환 결과■■■■■■■■■■■■■■■■■■■■■
※본 주석은 수작업 변환 참고용입니다. ★개발완료 후에는 필히 삭제해주세요.★
변환시간:  Fri Sep 01 2017 14:10:35 GMT+0900 (대한민국 표준시)
파일ID:  D170.xml

아래의 작업을 먼저 해주세요.


1. scwin.init() 함수에 아래의 글로벌 데이터리스트를 선언합니다.
gds.gDs_ServerTime();,
gds.gDs_LinkArg();

2. 공통.JS 파일을 include해주세요.
</xf:model>
 ***include 위치(하단에 주석처리 되어 있습니다.)***
<script><![CDATA[

예시)
</xf:model>
<script src="/cm/js/convertJs/예시입니다.js"/>
<script src="/cm/js/convertJs/예시입니다.js"/>
<script src="/cm/js/convertJs/예시입니다.js"/>
<script><![CDATA[

3. 표준에 어긋난 코딩인 경우 ✖ 으로 return 되어 있습니다. 검색으로 ✖이 나온다면 ASIS 소스를 확인해주세요.
ex) ASIS if(a = 1 and b = 2) {} ------> TOBE if (✖ = 2) {}

4. dialog함수로 팝업을 호출 할 경우에는 실제 파일이 있는 경로로 변경해주세요
ex) 현재 PROJECT_PATH_TEMP입니다. 

-호출구조-

호출구조는 모든 화면이 아닌 변환대상화면을 기준으로 분석하였습니다.
선언하지 않은 변수를 사용중이라면 caller 에서 넘겼을 가능성이 높습니다.
파일 ID는 소스의 form ID로 가정했습니다. 아래의 결과는 따로 확인해주세요.
D170.xml에서 호출 (callee ID):  
D170.xml을 호출   (caller ID):  
■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■*/
/****************************************************************************
 * 프로그램번호   : D170
 * 프로그램명     : 통합계약조회
 * 파일명         : D170.xml
 * 프로그램 내용  : 통합계약조회
 * 관련 프로그램  : 
 * 작성자         : 이정수
 * 작성일         : 2011-04-13
 * 저작권         : Copyright ⓒ 2004. the K 손해보험㈜. All Right Reserved...
 * 변경내역       : 
 ****************************************************************************/
// <script src="/cm/js/common.js"/>
// <script src="/cm/js/val_lib.js"/>
// <script src="/cm/js/util.js"/>
// <script src="/cm/js/transSub.js"/>
// <script src="/cm/js/callService.js"/>
// <script src="/cm/js/gds.js"/>
// <script src="/cm/js/convertJs/conv.js"/>
// <script src="/cm/js/convertJs/Global_Script.js"/>
// <script src="/cm/js/convertJs/comm_Webservice.js"/>
// <script src="/cm/js/convertJs/NewGen_Script.js"/>
// <script src="/cm/js/convertJs/LongTerm_Script.js"/>

var pageSize = "10";
var pageCount = "10";
var sCrNo = "";
var sysDate = "";

//MaskEdit 정규식 입력
var msk_SchVal_Event;

//---------------------------------------------------------------------------
// function 명 : lfn_OnLoadCompleted
// 내용        : 폼로드할때 처리할 내용 
//---------------------------------------------------------------------------
scwin.init = function() {
    /** 링크 콤보 데이터를 가저온다. 
        반드시 링크 데이터셋 ID = Ds_LinkList, 링크콤보 ID = cmb_linkMenu !!!!!
        링크 버튼 ID = btn_linkMenu !!!!!*/
    //gfn_GetLinkList("D170");

    //----- 버튼 처리(조회, 입력, 수정, 삭제, 결재, 취소, 인쇄, 엑셀, 닫기)
    gfn_btnEnable(false, false, false, false, false, false, false, true);
    
    //Mask Edit 정규식 입력
	//"######-#ZZZZZZ" , "A-####-#######"
	var maskRegExp = [/^[0-9\s]{7}[A-Z0-9\s]{6}$/, /^[A-Z\s]{1}[0-9\s]{11}$/];
	var maxLength  = [13, 12];
	var chkIndex   = 0;
	msk_SchVal_Event = new wMaskEditObj(msk_SchVal, maskRegExp, maxLength, chkIndex);

	cmb_SearchStd.setSelectedIndex(1);
	cmb_sVaildState.setSelectedIndex(1);

    //대리점인지
    /*
    //scwin_lfn_Bgcolor_Chg 에서 처리 됨
    if (util.getGdsValue("gUserDuty") == "30" || util.getGdsValue("gUserDuty") == "33" || util.getGdsValue("gUserDuty") == "35" || util.getGdsValue("gUserDuty") == "50") {
        grd_LTIEA00.SetCellProp("body", 2, "mask", "");
        grd_LTIEA00.SetCellProp("body", 7, "mask", "");
        grd_LTIEA00.SetCellProp("body", 2, "Expr", "lfn_InrpsCd_display(sInrpsCdDp)");
        grd_LTIEA00.SetCellProp("body", 7, "Expr", "lfn_InrpsCd_display(sCrtorCdDp)");
    }
    */

    //대리점 사용인(33,35), DP(48), 재정전문위원(50) 경우는 고객명 조회가 안되도록 수정
    if (util.getGdsValue("gUserDuty") == "33" || util.getGdsValue("gUserDuty") == "35" || util.getGdsValue("gUserDuty") == "48" || util.getGdsValue("gUserDuty") == "50" || util.getGdsValue("gUserDuty") == "62" || util.getGdsValue("gUserDuty") == "65") {
		util.removeRow(Ds_StdCd, wconv.findRow(Ds_StdCd, "sIndex", "1")); //보험계약자명
	    util.removeRow(Ds_StdCd, wconv.findRow(Ds_StdCd, "sIndex", "3")); //피보험자명
    }

    gfn_getServerTime();
    sysDate = gds.gDs_ServerTime.getCellData(0, "sToday"); // 서버시간
    var nowYM = wconv.substr(sysDate, 0, 8);
    var nowYMD = wconv.addDateSimple(nowYM, -7);

    scwin.lfn_SchChange({"oldValue" : "", "newValue" : ""});

    if (util.getGdsValue("gCustNo") != "") {
        cmb_SearchStd.setValue("2");
        scwin.lfn_SchChange({"oldValue" : "", "newValue" : ""});
        msk_SchVal.setValue(util.getGdsValue("gCustNo"));
        scwin.lfn_Search();
    }
};

scwin.setPolicyNo = function(policyNo) {
	/*
    gds.gDs_LinkArg.removeAll();
    var insRow = util.insertRow(gds.gDs_LinkArg, 0);
    util.insertColumn(gds.gDs_LinkArg, [
        [
            "sCrNo",
            "sCrNo",
            "text"
        ]
    ]);
    util.insertColumn(gds.gDs_LinkArg, [
        [
            "sScrnId",
            "sScrnId",
            "text"
        ]
    ]);
    gds.gDs_LinkArg.setCellData(0, "sCrNo", policyNo);
    */
};

//---------------------------------------------------------------------------
// function 명 : lfn_cmb_linkMenu_OnChanged
// 내용        : 링크페이지 선택시 Event처리
//---------------------------------------------------------------------------
scwin.lfn_cmb_linkMenu_OnChanged = function(obj, strCode, strText, nOldIndex, nNewIndex) {
    //gfn_OpenLinkPage(strCode);
};

//---------------------------------------------------------------------------
// function 명 : chkEssnInpt
// 내용        : 필수입력 check
//---------------------------------------------------------------------------
scwin.chkEssnInpt = function() {
    return true;
};

//---------------------------------------------------------------------------
// function 명 : lfn_SchChange
// 내용        : 조회기준 콤보박스 변경이벤트 
//---------------------------------------------------------------------------
scwin.lfn_SchChange = function(info) {
    if (info.oldValue != info.newValue) {
        Ds_LTIEA00.removeAll();
    }
    switch (cmb_SearchStd.getValue()) {
    
    	/*********************
		* 1 보험계약자명
		* 2 보험계약자코드
		* 3 피보험자명
		* 4 피보험자코드
		* 5 계약번호
		**********************/
    
        case "1":
            msk_SchVal.hide();
            edt_SchVal.show();
            msk_SchVal.setValue("");
            edt_SchVal.setValue("");
            //msk_SchVal.setDisplayFormat("@@@@@@@@@@");
            msk_SchVal.setDisplayFormat("##########");
            msk_SchVal.Width = "90";
            edt_SchVal.focus();
            break;
        case "2":
            msk_SchVal.show();
            edt_SchVal.hide();
            msk_SchVal.setValue("");
            msk_SchVal_Event.setIndex(0)
            //msk_SchVal.setDisplayFormat("######-#ZZZZZZ");
            msk_SchVal.setDisplayFormat("######-#######");
            msk_SchVal.Width = "90";
            msk_SchVal.focus();
            break;
        case "3":
            msk_SchVal.hide();
            edt_SchVal.show();
            msk_SchVal.setValue("");
            edt_SchVal.setValue("");
            //msk_SchVal.setDisplayFormat("@@@@@@@@@@");
            msk_SchVal.setDisplayFormat("##########");
            msk_SchVal.Width = "90";
            edt_SchVal.focus();
            break;
        case "4":
            msk_SchVal.show();
            edt_SchVal.hide();
            edt_SchVal.setValue("");
            msk_SchVal_Event.setIndex(0)
            //msk_SchVal.setDisplayFormat("######-#ZZZZZZ");
            msk_SchVal.setDisplayFormat("######-#######");
            msk_SchVal.Width = "90";
            msk_SchVal.focus();
            break;
        case "5":
            msk_SchVal.show();
            edt_SchVal.hide();
            msk_SchVal.setValue("");
            msk_SchVal.show();
            msk_SchVal_Event.setIndex(1)
            //msk_SchVal.setDisplayFormat("A-####-#######");
            msk_SchVal.setDisplayFormat("#-####-#######");
            msk_SchVal.Width = "90";
            msk_SchVal.focus();
            break;
        case "7":
            msk_SchVal.hide();
            edt_SchVal.show();
            msk_SchVal.setValue("");
            edt_SchVal.setValue("");
            //msk_SchVal.setDisplayFormat("@@@@@@@@@@");
            msk_SchVal.setDisplayFormat("##########");
            msk_SchVal.Width = "90";
            edt_SchVal.focus();
            break;
        default:
            break;
    }
};

//---------------------------------------------------------------------------
// function 명 : lfn_Search
// 내용        : 조회버튼 클릭 Event처리 ( 장기계약변경설계건 조회 )
//---------------------------------------------------------------------------
//scwin.lfn_Search_Async = function() {
	//util.eventAsyncCall(this, scwin.lfn_Search, arguments);
//	scwin.lfn_Search();
//}
scwin.lfn_Search = function() {
	Ds_LTIEA00.removeAll();
	DsWs_LTIEA00.removeAll();
	DsWs_Warning.removeAll();

	var transObj = new callService("com.inswave.longterm.psv.ens.task.EAD170Task", "getTotCrList", "", "");
	transObj.setUrl("/contract/CBSC115MController.do");
	transObj.setId("interfaceSample");

	var sSchVal = "";
    var objSchVal;
    if (wconv.isShow(msk_SchVal)) {
        sSchVal = msk_SchVal.getValue();
        objSchVal = msk_SchVal;
    } else {
        sSchVal = edt_SchVal.getValue();
        objSchVal = edt_SchVal;
    }
	if (wconv.length(sSchVal) <= 0) {
        objSchVal.focus();
        wprom.alertF(Ds_StdCd.getCellData(cmb_SearchStd.getSelectedIndex(), "sValue") + " 이(가) 입력되지 않았습니다.", {}, objSchVal);
        return false;
    }
    if (wconv.length(sSchVal) < 2 && wconv.isShow(edt_SchVal)) {
        objSchVal.focus();
        wprom.alertF(Ds_StdCd.getCellData(cmb_SearchStd.getSelectedIndex(), "sValue") + " 은(는) 2자 이상 입력해야 합니다.", {}, objSchVal);
        return false;
    }

	transObj.setParam("sVaildState"       , cmb_sVaildState.getValue()); // 
	transObj.setParam("sInqrFlagCd"       , cmb_SearchStd.getValue());   // 조회기준 구분값 ( 1 ~ 7 )
	transObj.setParam("sInqrFlagValue"    , objSchVal.getValue());       // 
	transObj.setParam("sOneday"           , "Y");                        // 

	transObj.setXPath("//*/hashtable/data/vector/data/LTIEA00");
	transObj.addXPath("//*/WARNING");  
	transObj.callBack("scwin.subCallBackfunction");
	//transObj.sync();
	transObj.send();
	//util.interfaceKey(_tranSync.result.serviceDs);

	//DsWs_LTIEA00.setJSON(_tranSync.getDsJson("LTIEA00"));
	//DsWs_Warning.setJSON(_tranSync.getDsJson("WARNING"));

	//if (wconv.length(DsWs_Warning.getCellData(0, "msg")) > 0) {
    //    wprom.alert(DsWs_Warning.getCellData(0, "msg"));
    //} else {
    //    Ds_LTIEA00.setJSON(DsWs_LTIEA00.getAllJSON());
        //Ds_LTIEA00.sort("sPolicyDate", False);
    //    Ds_LTIEA00.sort("sPolicyDate", 1);
    //   stc_totalCnt.setValue("전체건수 : " + Ds_LTIEA00.getTotalRow() + " 건");
    //}

    //고객정보 조회 이력쌓기
    gfn_LogCreditInfoVt(Ds_LTIEA00, "", "S", "sInrpsCdDp");
    gfn_LogCreditInfoVt(Ds_LTIEA00, "", "S", "sCrtorCdDp");
};

scwin.subCallBackfunction = function(rtnMap) {

	if (rtnMap.subID == "interfaceSample") {

		DsWs_LTIEA00.setJSON(_tranSync.getDsJsonAsync(rtnMap, "LTIEA00"));
		DsWs_Warning.setJSON(_tranSync.getDsJsonAsync(rtnMap, "WARNING"));
	
		if (wconv.length(DsWs_Warning.getCellData(0, "msg")) > 0) {
	        wprom.alert(DsWs_Warning.getCellData(0, "msg"));
	    } else {
	        Ds_LTIEA00.setJSON(DsWs_LTIEA00.getAllJSON());
	        //Ds_LTIEA00.sort("sPolicyDate", False);
	        Ds_LTIEA00.sort("sPolicyDate", 1);
	        stc_totalCnt.setValue("전체건수 : " + Ds_LTIEA00.getTotalRow() + " 건");
	    }

	}
};

//---------------------------------------------------------------------------
// function 명 : lfn_CopyGridCell
// 내용        : Grid Copy ( 그리드 내용 Copy )
//---------------------------------------------------------------------------
scwin.lfn_CopyGridCell = function(obj, nChar, bShift, bCtrl, bAlt, nLLParam, nHLParam) {
	//nfn_CopyGridCell(grd_LTIEA00, nChar, bShift, bCtrl, bAlt, nLLParam, nHLParam);
};

//---------------------------------------------------------------------------
// function 명 : lfn_GrdList_OnCellClick
// 내용        : Cell 클릭시
//---------------------------------------------------------------------------
scwin.lfn_GrdList_OnCellClick = function(nRow, nCol) {
	if (nRow < 0) return;
    if (grd_LTIEA00.getColumnID(nCol) == "sCrNo") {
        //계약번호
        scwin.lfn_CrNo_OnCellClick(nRow, nCol);
    } else if (nCell == 2 || nCell == 8) {}
};

//---------------------------------------------------------------------------
// function 명 : lfn_CrNo_OnCellClick
// 내용        : 계약번호 클릭시 
//---------------------------------------------------------------------------
scwin.lfn_CrNo_OnCellClick = function(nRow, nCol) {

	if (grd_LTIEA00.getColumnID(nCol) != "sCrNo") {
		return;
	}

    var sCrNo = grd_LTIEA00.getCellData(nRow, nCol);
    var sTeamCd = wconv.substr(sCrNo, 0, 1);

    //장기
    if (sTeamCd == "L") {
        //2015.01.23 (N1501-00121)
        if (gfn_chekAcesCntrAuth("DsWs_chekCrInqrAuth", "2", sCrNo) == false) {
            wprom.alert("접근 권한이 없습니다.");
            return;
        }

        //END (N1501-00121)
        if (
              ((util.getGdsValue("gUserDuty") == "30" || util.getGdsValue("gUserDuty") == "33" || util.getGdsValue("gUserDuty") == "35" || util.getGdsValue("gUserDuty") == "48" || util.getGdsValue("gUserDuty") == "62" || util.getGdsValue("gUserDuty") == "65")) &&
        	   (gfn_chekCrInqrAuth("DsWs_chekCrInqrAuth", "2", sCrNo) == false)
        	  ) {
            wprom.alert("해당 계약의 조회 권한이 없습니다.");
            return;
        }
    }

    //자동차
    if (sTeamCd == "C") {
        if (gfn_chekAcesCntrAuth_Car("DsWs_chekCrInqrAuth", "20019", sCrNo) == false) {
            wprom.alert("접근 권한이 없습니다.");
            return;
        }
    }
    
    //if (parent.Id == "global") {
    //    UserNotify(0, sTeamCd + "^" + sCrNo);
    //} else {
        if (sTeamCd == "L") {
            scwin.lfn_longtermCr(sCrNo);
        } else {
            wprom.alert("장기보험시스템 내에서는 장기보험 계약만 상세조회 가능합니다.");
        }
    //}
};

//---------------------------------------------------------------------------
// function 명 : lfn_longtermCr
// 내용        : Cell 클릭시 장기계약 상세조회
//---------------------------------------------------------------------------
scwin.lfn_longtermCr = function(sCrNo) {
	var oDsJson=[
		{"sCrNo"   : sCrNo},
		{"sScrnId" : "D010"}
	];            
	window.top.util.jSonDsCreate(oDsJson, "gDs_LinkArg");            
	gfn_OpenLinkPage("CBSC028M");
};

//scwin.lfn_SchVal_OnKeyDown_Async = function(e) {
//	if (e.keyCode == 13) {
//		util.eventAsyncCall(this, scwin.lfn_SchVal_OnKeyDown, arguments);
//	}
//}
scwin.lfn_SchVal_OnKeyDown = function(e) {
    if (e.keyCode == 13) {
        //grd_LTIEA00.focus();
        scwin.lfn_Search();
    }
};

//scwin.lfn_SchVal_OnChanged = function(obj, strText) {
    //wconv.clear(Ds_LTIEA00);
    //Ds_LTIEA00.removeAll();
    //stc_totalCnt.setValue("전체건수 : ");
//};

//---------------------------------------------------------------------------
// function 명 : lfn_InrpsCd_display
// 내용        : 주민번호 "*"처리
//---------------------------------------------------------------------------
scwin.lfn_InrpsCd_display = function(sInrpsCd) {
	var rtnValue = "";
    //대리점인지
    if (util.getGdsValue("gUserDuty") == "30" || util.getGdsValue("gUserDuty") == "33" || util.getGdsValue("gUserDuty") == "35" || util.getGdsValue("gUserDuty") == "50") {
        var smask = "######-#******";
        if (wconv.length(sInrpsCd) == 10) {
            smask = "###-##-*****";
        }
        rtnValue = gfn_convert_mask(wconv.replace(sInrpsCd, "-", ""), smask);
    } else {
        rtnValue = sInrpsCd;
    }
    
    return gfn_changeMask(rtnValue, 1)
};

scwin.lfn_Name_display = function(inV) {
    return gfn_changeMask(inV, 4);
};

scwin_lfn_Bgcolor_Chg = function(data, formattedData, rowIndex, colIndex) {
	//decode(sInsurFlag,'자동차','lightblue','일반','user39','wheat')
	if (Ds_LTIEA00.getCellData(rowIndex, "sInsurFlag") == "자동차") {
		grd_LTIEA00.setCellBackgroundColor( rowIndex , colIndex , "lightblue" );
	} else if (Ds_LTIEA00.getCellData(rowIndex, "sInsurFlag") == "일반") {
		grd_LTIEA00.setCellBackgroundColor( rowIndex , colIndex , "#F3E5E5" );
	} else {
		grd_LTIEA00.setCellBackgroundColor( rowIndex , colIndex , "wheat" );
	}
	if (grd_LTIEA00.getColumnID(colIndex) == "sCrNo") {
		grd_LTIEA00.setCellStyle(rowIndex, colIndex, "text-decoration", "underline");
		grd_LTIEA00.setCellStyle(rowIndex, colIndex, "font-weight", "bold");
	}
	return formattedData;
};
]]></script>
    </head>
    <body>
    	<xf:group class="cont_wrap" id="D170" style="position:absolute;height:478px;left:-px;top:71px;" userData1="통합계약조회" userData2=" OnLoadCompleted:scwin.lfn_OnLoadCompleted; ">
    		<DataObjects>
    			<DataObject></DataObject>
    			<DataObject></DataObject>
    			<DataObject></DataObject>
    		</DataObjects>
    		<ServiceObjects>
    			<ServiceObject></ServiceObject>
    			<ServiceObject></ServiceObject>
    			<ServiceObject></ServiceObject>
    		</ServiceObjects>
    		<xf:group arcsize="6" class="search_area" id="Shape9" style="top:-38px;left:0px;" userData3="RoundRect">
    			<w2:anchor class="btn_search" disabled="" id="btn_search" outerDiv="false" style="" tabIndex="7" ev:onclick="scwin.lfn_Search">
    				<xf:label><![CDATA[조회]]></xf:label>
    			</w2:anchor>
    		</xf:group>
    		<w2:textbox class="sty_lb_Search" id="Static1" label="계약상태" style="position:absolute; VAlign:Middle;  text-align:right; height:20px;left:361px;top:-30px; width:60px;" tagname=""></w2:textbox>
    		<xf:input class="sty_ipt_form" ev:onblur="" ev:onchange="scwin.lfn_SchVal_OnChanged" id="edt_SchVal" maxlength="20"
    			style="position:absolute; ImeMode:keep,native;  border-style:solid;  height:20px;left:216px;top:-30px; width:110px;" tabIndex="14" ev:onkeydown="scwin.lfn_SchVal_OnKeyDown">
    		</xf:input>
    		<xf:group arcsize="8" class="" id="Shape5" style="position:absolute;bottom:515px;height:451px;left:0px;top:0px; width:100%;" userData3="RoundRect">
    			<w2:gridView ignoreCellClick="false" id="grd_LTIEA00"
    				dataList="Ds_LTIEA00" summaryAuto="false"
    				ignoreToggleOnDisabled="false"
    				style="width:927px;height:561px;left:0px;top:34px;width:100.0%;"
    				useShiftKey="true" scrollByColumn="false"
    				fixedColumnWithHidden="true" scrollByColumnAdaptive="false"
    				autoFit="allColumn" autoFitMinWidth="100" class="sty_Grid"
    				evenRowBackgroundColor="" rowMouseOver="" rowMouseOverColor=""
    				selectedCellColor=""
    				ev:oncellclick="scwin.lfn_CrNo_OnCellClick">
    				<w2:header id="header2" style="">
    					<w2:row id="row4" style="">
    						<w2:column blockSelect="false" id="column64"
    							style="height:23px;" inputType="text" width="70"
    							displayMode="label" value="보험종목" rowSpan="2">
    						</w2:column>
    						<w2:column blockSelect="false" id="column62"
    							style="height:23px;" inputType="text" width="150"
    							displayMode="label" value="상품명">
    						</w2:column>
    						<w2:column blockSelect="false" id="column60"
    							style="height:23px;" inputType="text" width="100"
    							displayMode="label" value="피보험자 코드">
    						</w2:column>
    						<w2:column blockSelect="false" id="column58"
    							style="height:23px;" inputType="text" width="100"
    							displayMode="label" value="피보험자명">
    						</w2:column>
    						<w2:column blockSelect="false" id="column56"
    							style="height:23px;" inputType="text" width="200"
    							displayMode="label" value="보험기간">
    						</w2:column>
    						<w2:column blockSelect="false" id="column54"
    							style="height:23px;" inputType="text" width="100"
    							displayMode="label" value="계약체결일">
    						</w2:column>
    						<w2:column blockSelect="false" id="column52"
    							style="height:23px;" inputType="text" width="150"
    							displayMode="label" value="납부자번호">
    						</w2:column>
    					</w2:row>
    					<w2:row id="row6" style="">
    						<w2:column blockSelect="false" id="column77"
    							style="height:20px;" width="150" inputType="text"
    							displayMode="label" value="계약번호">
    						</w2:column>
    						<w2:column blockSelect="false" id="column76"
    							style="height:20px;" width="100" inputType="text"
    							displayMode="label" value="계약자코드">
    						</w2:column>
    						<w2:column blockSelect="false" id="column75"
    							style="height:20px;" width="100" inputType="text"
    							displayMode="label" value="계약자명">
    						</w2:column>
    						<w2:column blockSelect="false" id="column74"
    							style="height:20px;" width="200" inputType="text"
    							displayMode="label" value="납입횟수">
    						</w2:column>
    						<w2:column blockSelect="false" id="column73"
    							style="height:20px;" width="100" inputType="text"
    							displayMode="label" value="계약상태">
    						</w2:column>
    						<w2:column blockSelect="false" id="column72"
    							style="height:23px;" width="150" inputType="text"
    							displayMode="label">
    						</w2:column>
    					</w2:row>
    				</w2:header>
    				<w2:gBody id="gBody2" style="">
    					<w2:row id="row5" style="">
    						<w2:column blockSelect="false"
    							id="sInsurFlag" style="height:20px" inputType="text"
    							width="70" displayMode="label" rowSpan="2"
    							customFormatter="scwin_lfn_Bgcolor_Chg" readOnly="true">
    						</w2:column>
    						<w2:column blockSelect="false"
    							id="sGdCdName" style="height:20px" inputType="text"
    							width="150" displayMode="label"
    							customFormatter="scwin_lfn_Bgcolor_Chg" textAlign="left"
    							readOnly="true">
    						</w2:column>
    						<w2:column blockSelect="false" id="sInrpsCd"
    							style="height:20px" inputType="text" width="100"
    							displayMode="label"
    							displayFormatter="scwin.lfn_InrpsCd_display"
    							customFormatter="scwin_lfn_Bgcolor_Chg" textAlign="left"
    							readOnly="true">
    						</w2:column>
    						<w2:column blockSelect="false"
    							id="sInrpsName" style="height:20px" inputType="text"
    							width="100" displayMode="label"
    							customFormatter="scwin_lfn_Bgcolor_Chg"
    							displayFormatter="scwin.lfn_Name_display" textAlign="left"
    							readOnly="true">
    						</w2:column>
    						<w2:column blockSelect="false"
    							id="sInsurTerm" style="height:20px" inputType="text"
    							width="200" displayMode="label"
    							customFormatter="scwin_lfn_Bgcolor_Chg" textAlign="left"
    							readOnly="true">
    						</w2:column>
    						<w2:column blockSelect="false"
    							id="sPolicyDate" style="height:20px" inputType="text"
    							width="100" displayMode="label"
    							customFormatter="scwin_lfn_Bgcolor_Chg" dataType="date"
    							displayFormat="yyyy-MM-dd" textAlign="left"
    							readOnly="true">
    						</w2:column>
    						<w2:column blockSelect="false" id="sPayrNo"
    							style="height:20px" inputType="text" width="150"
    							displayMode="label" customFormatter="scwin_lfn_Bgcolor_Chg"
    							textAlign="left" readOnly="true">
    						</w2:column>
    					</w2:row>
    					<w2:row id="row7" style="">
    						<w2:column blockSelect="false" id="sCrNo"
    							style="height:20px" inputType="link" width="150"
    							displayMode="label" customFormatter="scwin_lfn_Bgcolor_Chg"
    							textAlign="left" displayFormat="#-####-#######"
    							readOnly="true">
    						</w2:column>
    						<w2:column blockSelect="false" id="sCrtorCd"
    							style="height:20px" inputType="text" width="100"
    							displayMode="label"
    							displayFormatter="scwin.lfn_InrpsCd_display"
    							customFormatter="scwin_lfn_Bgcolor_Chg" textAlign="left"
    							readOnly="true">
    						</w2:column>
    						<w2:column blockSelect="false"
    							id="sCrtorName" style="height:20px" inputType="text"
    							width="100" displayMode="label"
    							customFormatter="scwin_lfn_Bgcolor_Chg"
    							displayFormatter="scwin.lfn_Name_display" textAlign="left"
    							readOnly="true">
    						</w2:column>
    						<w2:column blockSelect="false"
    							id="sPaymCtDp" style="height:20px" inputType="text"
    							width="200" displayMode="label"
    							customFormatter="scwin_lfn_Bgcolor_Chg" textAlign="left"
    							readOnly="true">
    						</w2:column>
    						<w2:column blockSelect="false"
    							id="sCrStatCdName" style="height:20px" inputType="text"
    							width="100" displayMode="label"
    							customFormatter="scwin_lfn_Bgcolor_Chg" textAlign="left"
    							readOnly="true">
    						</w2:column>
    						<w2:column blockSelect="false"
    							id="temp_id_764" style="height:20px" width="150"
    							inputType="text" displayMode="label"
    							customFormatter="scwin_lfn_Bgcolor_Chg" textAlign="left"
    							readOnly="true">
    						</w2:column>
    					</w2:row>
    				</w2:gBody>
    			</w2:gridView>
    		</xf:group>
    		<xf:select1 appearance="minimal" class="sty_ipt_search" emptyItem="true" ev:onchange="" id="cmb_SearchStd"
    			style="position:absolute; INDEX:1;  border-style:solid;  height:20px;left:85px;top:-30px; width:124px;" tabIndex="3" renderType="native" ev:onviewchange="scwin.lfn_SchChange">
    			<xf:choices>
    				<xf:itemset nodeset="data:Ds_StdCd">
    					<xf:label ref="sValue"></xf:label>
    					<xf:value ref="sIndex"></xf:value>
    				</xf:itemset>
    			</xf:choices>
    		</xf:select1>
    		<xf:switch id="switch_95" style=" ">
    			<xf:case id="Default_96" style=" "></xf:case>
    		</xf:switch>
    		<xf:input class="sty_ipt_search" dataType="text" displayFormat="######-#ZZZZZZ" ev:onblur="" ev:onchange="scwin.lfn_SchVal_OnChanged" id="msk_SchVal"
    			style="position:absolute; InputPanel:FALSE;  border-style:solid;  height:20px;left:216px;top:-30px; width:91px;" tabIndex="10" ev:onkeydown="scwin.lfn_SchVal_OnKeyDown">
    		</xf:input>
    		<w2:textbox class="sty_lb_Search" id="Static0" label="조회조건" style="position:absolute; VAlign:Middle;  text-align:right; height:20px;left:0px;top:-30px; width:68px;" tagname=""></w2:textbox>
    		<xf:select1 appearance="minimal" class="sty_ipt_search" emptyItem="true" ev:onchange="scwin.lfn_SchVal_OnChanged" id="cmb_sVaildState"
    			style="position:absolute; INDEX:1;  border-style:solid;  height:20px;left:439px;top:-30px; width:100px;" tabIndex="12" renderType="native">
    			<xf:choices>
    				<xf:itemset nodeset="data:Ds_CrChng">
    					<xf:label ref="sValue"></xf:label>
    					<xf:value ref="sIndex"></xf:value>
    				</xf:itemset>
    			</xf:choices>
    		</xf:select1>
    		<w2:textbox id="stc_totalCnt" label="전체건수 : " style="position:absolute; VAlign:Middle;  height:20px;left:0px;top:8px; width:157px;" tagname=""></w2:textbox>
    	</xf:group>
    	<w2:wframe class="common_bu_area" id="" src="/cm/common/wf_titleFav.xml" style="" initScript="scwin.wfTitleFavInit();"></w2:wframe>
    </body>
</html>