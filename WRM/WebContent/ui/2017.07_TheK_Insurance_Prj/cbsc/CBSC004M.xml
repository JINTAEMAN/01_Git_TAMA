<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="/cm/css/all.css" type="text/css"?>
<?xml-stylesheet href="/cm/css/new.css" type="text/css"?>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare"
	xmlns:xf="http://www.w3.org/2002/xforms">
	<head>
		<w2:type>DEFAULT</w2:type>
		<w2:buildDate />
		<xf:model ev:submit="scwin.submission1_submit">
			<xf:instance>
				<data xmlns="" />
			</xf:instance>
			<w2:dataCollection baseNode="map">
				<w2:dataMap baseNode="map" id="FaqMngmVo">
					<w2:keyInfo>
						<w2:key id="faqId" name="FAQ ID"
							dataType="number">
						</w2:key>
						<w2:key id="faqBizFlagCd" name="FAQ업무분류코드"
							dataType="text">
						</w2:key>
						<w2:key id="faqBizDtclCd" name="FAQ업무세분류코드"
							dataType="text">
						</w2:key>
						<w2:key id="qustCont" name="질문내용"
							dataType="text">
						</w2:key>
						<w2:key id="replCont" name="답변내용"
							dataType="text">
						</w2:key>
						<w2:key id="faqKeyWord" name="FAQ키워드"
							dataType="text">
						</w2:key>
						<w2:key id="apdxFilePath" name="첨부파일경로"
							dataType="text">
						</w2:key>
						<w2:key id="apdxFileName" name="첨부파일명"
							dataType="text">
						</w2:key>
						<w2:key id="useYn" name="사용여부"
							dataType="text">
						</w2:key>
						<w2:key id="inptDler" name="입력처리자"
							dataType="text">
						</w2:key>
						<w2:key id="inptDlerIP" name="입력처리자IP"
							dataType="text">
						</w2:key>
						<w2:key id="inptDate" name="입력일자"
							dataType="text">
						</w2:key>
						<w2:key id="inptHms" name="입력시간"
							dataType="text">
						</w2:key>
						<w2:key id="mdfcDler" name="수정처리자"
							dataType="text">
						</w2:key>
						<w2:key id="mdfcDlerIP" name="수정처리자IP"
							dataType="text">
						</w2:key>
						<w2:key id="mdfcDate" name="수정일자"
							dataType="text">
						</w2:key>
						<w2:key id="mdfcHms" name="수정시간"
							dataType="text">
						</w2:key>
						<w2:key id="inptDlerName" name="입력처리자명"
							dataType="text">
						</w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataList id="FaqListVo" baseNode="list"
					saveRemovedData="true" repeatNode="map">
					<w2:columnInfo>
						<w2:column id="faqId" name="FAQ ID"
							dataType="number">
						</w2:column>
						<w2:column id="faqBizFlagCd" name="FAQ업무분류코드"
							dataType="text">
						</w2:column>
						<w2:column id="faqBizDtclCd" name="FAQ업무세분류코드"
							dataType="text">
						</w2:column>
						<w2:column id="qustCont" name="질문내용"
							dataType="text">
						</w2:column>
						<w2:column id="replCont" name="답변내용"
							dataType="text">
						</w2:column>
						<w2:column id="faqKeyWord" name="FAQ키워드"
							dataType="text">
						</w2:column>
						<w2:column id="apdxFilePath" name="첨부파일경로"
							dataType="text">
						</w2:column>
						<w2:column id="apdxFileName" name="첨부파일명"
							dataType="text">
						</w2:column>
						<w2:column id="useYn" name="사용여부"
							dataType="text">
						</w2:column>
						<w2:column id="inptDler" name="입력처리자"
							dataType="text">
						</w2:column>
						<w2:column id="inptDlerIP" name="입력처리자IP"
							dataType="text">
						</w2:column>
						<w2:column id="inptDate" name="입력일자"
							dataType="text">
						</w2:column>
						<w2:column id="inptHms" name="입력시간"
							dataType="text">
						</w2:column>
						<w2:column id="mdfcDler" name="수정처리자"
							dataType="text">
						</w2:column>
						<w2:column id="mdfcDlerIP" name="수정처리자IP"
							dataType="text">
						</w2:column>
						<w2:column id="mdfcDate" name="수정일자"
							dataType="text">
						</w2:column>
						<w2:column id="mdfcHms" name="수정시간"
							dataType="text">
						</w2:column>
						<w2:column id="inptDlerName" name="입력처리자명"
							dataType="text">
						</w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList id="DsWs_FaqBizFlagCd" baseNode="list"
					saveRemovedData="true" repeatNode="map">
				</w2:dataList>
				<w2:dataList id="DsWs_FaqBizDtclCd" baseNode="list"
					saveRemovedData="true" repeatNode="map">
				</w2:dataList>
			</w2:dataCollection>
			<w2:workflowCollection></w2:workflowCollection>

			<xf:submission id="submission1"
				ref='data:json,{"id":"ds_commonCode","key":"inputVo"}'
				target='data:json,[{"id":"ds_commonCodeList","key":"commonCodeVoList"},"testMap"]'
				action="/common/CBSO0017.do" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace=""
				errorHandler="" customHandler="" mode="asynchronous" processMsg=""
				ev:submit="" ev:submitdone=""
				ev:submiterror="">
			</xf:submission>
		</xf:model>

		<script src="/cm/js/convertJs/Global_Script.js"/>
		<script src="/cm/js/convertJs/LongTerm_Script.js"/>
		
		<script type="javascript"><![CDATA[
var handlerID = "";
var Auth = "";
			
	scwin.init = function() {
		handlerID = util.getGdsValue("gUserID");

		gfn_btnEnable(false, false, false, false, false, false, false, true);		
		gfn_getCommonCodes("DsWs_FaqBizFlagCd DsWs_FaqBizDtclCd", "FaqBizFlagCd FaqBizDtclCd", "id_faqBizFlagCd id_faqBizDtclCd", "A A");
		
		id_useYn.setValue("Y");
		//권한체크-22040:장기보험인수
		Auth = nfn_checkAuthByID("Ds_id", handlerID, "22040");
		if (Auth) {
			id_registFaq.setStyle("display", "");
			id_th_useYn.setStyle("display", "");
			id_td_useYn.setStyle("display", "");
		}
		
		if (gds.gDs_LinkArg.getRowCount() != 0) {
			var sGdCd = gds.gDs_LinkArg.getCellData(0, "sGdCd") //상품코드
			gds.gDs_LinkArg.removeAll();  //초기화
			
			id_faqKeyWord.setValue(sGdCd);
			scwin.btn_Search_onclick();
		}
	};
	
	scwin.btn_Search_onclick = function() {
		id_faq.removeAll();
		
		FaqMngmVo.set("faqBizFlagCd", id_faqBizFlagCd.getValue());
		FaqMngmVo.set("faqBizDtclCd", id_faqBizDtclCd.getValue());
		FaqMngmVo.set("faqKeyWord", id_faqKeyWord.getValue());
		FaqMngmVo.set("useYn", id_useYn.getValue());
		
		var trans = new transSub();						// transaction 보낼 객체 생성
		trans.setId("retrieveFaqList");					// transaction 보낼 SubmissionID
		trans.setUrl("/contract/longterm/CBSC0003.do");		// Controller 쪽으로 보낼 주소
		trans.setDs("FaqMngmVo");
		trans.targetDs("FaqListVo");
		trans.callBack("scwin.subCallBack");	// 받을 Dataset을 처리시 콜백함수
		trans.send();
	};
	
	scwin.subCallBack = function(e) {
		switch(e.subID){
			case "retrieveFaqList":
				FaqListVo.setJSON(e.result.listfaqMngmVo);
				
				var insertIndex = 0;
				var childObj;

				for (var i=0;i<FaqListVo.getRowCount();i++) {
					insertIndex = id_faq.insertChild();
					
					childObj = id_faq.getChild(insertIndex, 'id_qustCont');
					childObj.setValue(FaqListVo.getCellData(i, "qustCont"));
					childObj.setUserData("rownum", i);
					
					childObj = id_faq.getChild(insertIndex, 'id_replCont');
					childObj.setValue(FaqListVo.getCellData(i, "replCont"));
					childObj.setUserData("faqId", FaqListVo.getCellData(i, "faqId"));
					
					childObj = id_faq.getChild(insertIndex, 'id_apdxFileName');
					if (wconv.isNull(wconv.trim(FaqListVo.getCellData(i, "apdxFileName")))) {
						childObj.setStyle("visibility","hidden");
					} else {
						childObj.setUserData("apdxFileName", FaqListVo.getCellData(i, "apdxFileName"));
						childObj.setUserData("apdxFilePath", FaqListVo.getCellData(i, "apdxFilePath"));
					}
				}
		}
	};
	
	scwin.id_registFaq_onclick = function(faqId) {
		var pro = Promise.resolve();

		pro = pro.then(function(rv) {
			var indata  = {"faqId" : faqId
						   };
			var popInfo = {
				"width"     : 680,
				"height"    : 310,  
				"indata"    : indata,
				"title"     : "FAQ관리",
				"callback"  : scwin.popupCallback
			};

			return wprom.popupOpen("/ui/cbsc/CBSC005P.xml", popInfo);
		});

		pro = pro.then(function(rv) {

		});
	};
	
	scwin.id_qustCont_onclick = function() {
		var curIndex = this.getGeneratedIndex();
		var childobj = id_faq.getChild(curIndex, 'id_qustCont');
		var rownum = childobj.getUserData("rownum");
		
		$('.titlelistbox').eq(rownum).toggleClass('act');
	};
	
	scwin.id_replCont_ondblclick = function(e) {
		if (Auth) {
			var curIndex = this.getGeneratedIndex();
			var childobj = id_faq.getChild(curIndex, 'id_replCont');
			var faqId = childobj.getUserData("faqId");
			scwin.id_registFaq_onclick(faqId);
		}
	};
	
	scwin.id_apdxFileName_onclick = function() {
		var curIndex = this.getGeneratedIndex();
		var childobj = id_faq.getChild(curIndex, 'id_apdxFileName');
		var apdxFileName = childobj.getUserData("apdxFileName");
		var apdxFilePath = childobj.getUserData("apdxFilePath");
		
		util.fileDownload(apdxFilePath, apdxFileName);
	};
	]]></script>
	</head>
	<body>
		<xf:group class="contentWrap" id="" style="">
			<w2:wframe id="" style=""
				initScript="scwin.wfTitleFavInit();"
				src="/cm/common/wf_titleFav.xml">
			</w2:wframe>

			<!-- group:s -->
			<xf:group id="" style="" class="section">
				<xf:group id="" style="" class="tbl_search">
					<xf:group id="" style="" adaptive=""
						class="w2tb tbl_sc" adaptiveThreshold="" tagname="table">
						<w2:attributes>
							<w2:summary></w2:summary>
						</w2:attributes>
						<xf:group tagname="colgroup">
							<xf:group style="width:80px;"
								tagname="col">
							</xf:group>
							<xf:group style="width:150px;"
								tagname="col">
							</xf:group>
							<xf:group style="width:90px;"
								tagname="col">
							</xf:group>
							<xf:group style="width:150px;"
								tagname="col">
							</xf:group>
							<xf:group style="width:80px;"
								tagname="col">
							</xf:group>
							<xf:group style="width:150px;"
								tagname="col">
							</xf:group>
							<xf:group style="width:80px;"
								tagname="col">
							</xf:group>
							<xf:group style="" tagname="col"></xf:group>
						</xf:group>
						<xf:group tagname="tr" style="">
							<xf:group style="" class="w2tb_th"
								tagname="th">
								업무구분
							</xf:group>
							<xf:group style="" class="w2tb_td"
								tagname="td">
								<xf:select1 allOption=""
									appearance="minimal" chooseOption="" direction="auto"
									disabled="" disabledClass="" displayMode="label"
									ev:onviewchange="" id="id_faqBizFlagCd" optionOrder="" ref=""
									renderType="native" style="" submenuSize="">
									<xf:choices></xf:choices>
								</xf:select1>
							</xf:group>
							<xf:group class="w2tb_th" tagname="th">
								업무세분류
								<w2:attributes></w2:attributes>
							</xf:group>
							<xf:group class="w2tb_td" tagname="td">
								<w2:attributes></w2:attributes>
								<xf:select1 allOption=""
									appearance="minimal" chooseOption="" direction="auto"
									disabled="" disabledClass="" displayMode="label"
									ev:onviewchange="" id="id_faqBizDtclCd" optionOrder="" ref=""
									renderType="native" style="" submenuSize="">
									<xf:choices></xf:choices>
								</xf:select1>
							</xf:group>
							<xf:group class="w2tb_th" tagname="th">
								키워드
								<w2:attributes></w2:attributes>
							</xf:group>
							<xf:group class="w2tb_td" tagname="td">
								<w2:attributes></w2:attributes>
								<xf:input id="id_faqKeyWord"
									style="width:150px;">
								</xf:input>
							</xf:group>
							<xf:group class="w2tb_th" tagname="th" id="id_th_useYn" style="display: none;">
								사용여부
								<w2:attributes></w2:attributes>
							</xf:group>
							<xf:group class="w2tb_td" tagname="td" id="id_td_useYn" style="display: none;">
								<w2:attributes></w2:attributes>
								<xf:select1 allOption=""
									appearance="minimal" chooseOption="" direction="auto"
									disabled="" disabledClass="" displayMode="label"
									ev:onviewchange="" id="id_useYn" optionOrder="" ref=""
									renderType="native" style="width : 100px;" submenuSize="">
									<xf:choices>
										<xf:item>
											<xf:label><![CDATA[전체]]></xf:label>
											<xf:value><![CDATA[]]></xf:value>
										</xf:item>
										<xf:item>
											<xf:label><![CDATA[사용]]></xf:label>
											<xf:value><![CDATA[Y]]></xf:value>
										</xf:item>
										<xf:item>
											<xf:label><![CDATA[미사용]]></xf:label>
											<xf:value><![CDATA[N]]></xf:value>
										</xf:item>
									</xf:choices>
								</xf:select1>
							</xf:group>
						</xf:group>
					</xf:group>
					<w2:anchor id="btn_Search" style=""
						ev:onclick="scwin.btn_Search_onclick" class="btn_sh"
						outerDiv="true" disabled="">
						<xf:label><![CDATA[조회]]></xf:label>
					</w2:anchor>
				</xf:group>
			</xf:group>
			<!-- group:e -->

			<!-- group:s -->
			<xf:group id="" style="" class="section">
				<xf:group id="" style="" class="defaultbox">
					<xf:group id="" style="" class="fr">
						<w2:anchor id="id_registFaq"
							ev:onclick="scwin.id_registFaq_onclick" class="btn_nml"
							outerDiv="true" style="display: none;">
							<xf:label><![CDATA[작성]]></xf:label>
						</w2:anchor>
					</xf:group>
				</xf:group>

				<xf:group>
					<w2:generator id="id_faq"
						style="position: relative;">
						<xf:group class="titlelistbox" id="" style="">
							<xf:group class="titlelist_tit" id=""
								style="">
								<w2:anchor class="btn_titlelist "
									ev:onclick="scwin.id_qustCont_onclick"
									id="id_qustCont" outerDiv="false" style="">
									<xf:label><![CDATA[질문내용]]></xf:label>
								</w2:anchor>
							</xf:group>
							<xf:group class="contlistbox">
								<w2:textbox class="" id="id_replCont"
									label="답변내용" ref="" ev:ondblclick="scwin.id_replCont_ondblclick">
								</w2:textbox>
								<xf:group class="tar">
									<w2:anchor class="btn_nml"
										ev:onclick="scwin.id_apdxFileName_onclick" id="id_apdxFileName" outerDiv="true">
										<xf:label><![CDATA[파일 다운로드]]></xf:label>
									</w2:anchor>
								</xf:group>
							</xf:group>
						</xf:group>
					</w2:generator>

				</xf:group>

			</xf:group>
			<!-- group:e -->

		</xf:group>
	</body>
</html>