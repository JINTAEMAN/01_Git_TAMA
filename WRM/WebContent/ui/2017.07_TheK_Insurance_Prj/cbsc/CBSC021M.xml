<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="/cm/css/all.css" type="text/css"?>
<?xml-stylesheet href="/cm/css/convert.css" type="text/css"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head>
        <w2:type>DEFAULT</w2:type>
        <w2:buildDate/>
        <xf:model>
            <xf:instance>
                <data/>
            </xf:instance>
            <w2:dataCollection>
                <w2:dataList baseNode="list" id="Ds_InsurCrList" repeatNode="map"/>
                <w2:dataList baseNode="list" id="ds_combo" repeatNode="map">
                    <w2:columnInfo>
                        <w2:column dataType="text" id="id_nm" name="id_nm"/>
                        <w2:column dataType="text" id="id_cd" name="id_cd"/>
                        <w2:column dataType="text" id="id_gubun" name="id_gubun"/>
                    </w2:columnInfo>
                    <w2:data use="true">
                        <w2:row>
                            <id_cd><![CDATA[0]]></id_cd>
                            <id_gubun><![CDATA[0]]></id_gubun>
                            <id_nm><![CDATA[전체]]></id_nm>
                        </w2:row>
                        <w2:row>
                            <id_cd><![CDATA[1]]></id_cd>
                            <id_gubun><![CDATA[1]]></id_gubun>
                            <id_nm><![CDATA[계약번호]]></id_nm>
                        </w2:row>
                        <w2:row>
                            <id_cd><![CDATA[2]]></id_cd>
                            <id_gubun><![CDATA[2]]></id_gubun>
                            <id_nm><![CDATA[계약자명]]></id_nm>
                        </w2:row>
                    </w2:data>
                </w2:dataList>
                <w2:dataList baseNode="list" id="Ds_InsurCrList1" repeatNode="map"/>
                <w2:dataList baseNode="list" id="Ds_InsurCrListExl" repeatNode="map"/>
                <w2:dataList baseNode="list" id="Dataset0" repeatNode="map"/>
                <w2:dataList baseNode="list" id="DsWs_InsurCrList" repeatNode="map" userData2="//*/hashtable/data/vector/data/LTIEZ90"/>
                <w2:dataList baseNode="list" id="DsWs_DataWarning" repeatNode="map" userData2="//*/WARNING"/>
                <w2:dataList baseNode="list" id="DsWs_Warning" repeatNode="map" userData2="//*/WARNING"/>
                <w2:dataList baseNode="list" id="DsWs_InsurCrList_Cnt" repeatNode="map" userData2="//*/hashtable/data/LTIEZ90Count"/>
                <w2:dataList baseNode="list" id="Detail_Warning" repeatNode="map" userData2="//*/WARNING"/>
                <w2:dataList baseNode="list" id="DsWs_InsurCrList1" repeatNode="map" userData2="//*/hashtable/data/vector/data/LTIEZ90Detail"/>
                <w2:dataList baseNode="list" id="DsWs_InsurCrListExl" repeatNode="map" userData2="//*/hashtable/data/vector/data/LTIEZ90"/>
            </w2:dataCollection>
            <w2:workflowCollection/>
        </xf:model>
 <script src="/cm/js/convertJs/Global_Script.js"/>
 <script src="/cm/js/convertJs/comm_Webservice.js"/>
 <script src="/cm/js/convertJs/LongTerm_Script.js"/>
 <script src="/cm/js/convertJs/NewGen_Script.js"/>
 <script src="/cm/js/convertJs/GrdPassword_Script.js"/>
        <script><![CDATA[
/****************************************************************************
 * 프로그램번호   : D800
 * 프로그램명     : 갱신특약정보 조회
 * 파일명         : D800.xml
 * 프로그램 내용  : 갱신특약정보 조회
 * 관련 프로그램  : 
 * 작성자         : 정한진
 * 작성일         : 2015-06-22
 * 저작권         : Copyright ⓒ 2004. the K 손해보험㈜. All Right Reserved.
 * 변경내역       : 
 ****************************************************************************/
var pageSize = "13";
var pageCount = "10";// 날짜 변수
var sysDate = "";
var sDate = "";
var sTime = "";
//---------------------------------------------------------------------------
// function 명 : lfn_OnLoadCompleted
// 내용        : 폼로드할때 처리할 내용 
//---------------------------------------------------------------------------
scwin.init = function() { 
    //-----서버 시간 받기
    //transaction("getServerTime", "NewGen::getServerTime.jsp", "", "gDs_ServerTime=output", "", "tr_callback");
	Grid0.hide();
    //----- 버튼 처리(조회, 입력, 수정, 삭제, 결재, 취소, 인쇄, 엑셀, 닫기)
    gfn_btnEnable( false, false, false, false, false, false, true, true);

    // 서버시간 조회
    gfn_getServerTime();
    sysDate = gds.gDs_ServerTime.getCellData(0, "sToday"); // 서버시간	
    sDate = wconv.mid(sysDate, 0, 8);
    scwin.tr_callback( "getServerTime",0,"0");
    
    medt_Str.hide();
    edt_Str.hide();
};

scwin.tr_callback = function(ServiceId, errorCd, errorMsg) {
    if (ServiceId == "getServerTime") {
        if (errorCd != 0) {
            wprom.alert("errorCd:::[" + errorCd + "] errorMsg:::[" + errorMsg + "]");
        } else {
            gsSysDate = gds.gDs_ServerTime.getCellData(0, "sToday").substr(0, 8);
            Cal_SelDate.setValue( wconv.substr(gsSysDate, 0, 6)); //초기화
        }
    }
};

//---------------------------------------------------------------------------
// function 명 : btn_Pop_Search_OnClick
// 내용        : btn 날짜 선택 클릭시[▼] 
//---------------------------------------------------------------------------
scwin.btn_Pop_Search_OnClick = function(e) {

		var prom = Promise.resolve();
		prom = prom.then(function() {
			var indata  = {};				
			var popInfo = {
				"width"     : 219,
				"height"    : 228,  
				"left"        : 95+140,
				"top"        : 29+140,
				"indata"    : indata,
				"title"     : "년월선택",
				"callback"  : ""
			};			
			return wprom.popupOpen("/ui/cbso/CBSO008P.xml", popInfo);
		});
		prom = prom.then(function(ret) {
			 Cal_SelDate.setValue(ret);
		});
		return prom;
    //nX = ClientToScreenX(obj, 0) - 57;
    //nY = ClientToScreenY(obj, 0);
    //var ret;
    //if (nX < 0) {
    //    nX = 0;
    // }
//    ret = PopDiv_Calendar.TrackPopup(nX, nY, obj.Width, obj.Height);
//    ret = replace(ret, "-", ""); // 2015-03 에서 '-' 제거
//    if (wconv.length(ret) == 6) {
//         ex) [201503] 길이가 6이면
//        Cal_SelDate.setValue(ret);
//    }
	
};

//---------------------------------------------------------------------------
// function 명 : chkEssnInpt
// 내용        : 필수입력 check
//---------------------------------------------------------------------------
scwin.chkEssnInpt = function() {
    if (cmb_Gubun.getValue() == "1") {
        if (medt_Str.getValue() == "") {
            wprom.alert(cmb_Gubun.getValue() + "를 입력하세요.");
            medt_Str.focus();
            return false;
        } else {
            var sMskValLen = wconv.length(medt_Str.getValue());
            if (cmb_Gubun.getValue() == "1") {
                if (sMskValLen < 12) {
                    wprom.alert(cmb_Gubun.getValue() + " 코드값은 12자리가 되어야 합니다.");
                    medt_Str.focus();
                    return false;
                }
            }
        }
    } else {
        if (edt_Str.getValue() == "") {
            wprom.alert(cmb_Gubun.getValue() + "를 입력하세요.");
            edt_Str.focus();
            return false;
        } else {
            var sEdtValLen = wconv.length(edt_Str.getValue());
            if (cmb_Gubun.getValue() == "2") {
                if (sEdtValLen < 2) {
                    wprom.alert(cmb_Gubun.getValue() + " 계약자명은 2자 이상이어야 합니다.");
                    edt_Str.focus();
                    return false;
                }
            }
        }
    }
    wconv.clear(Ds_InsurCrList);
    return true;
};

//---------------------------------------------------------------------------
// function 명 : lfn_SchChange
// 내용        : 콤보박스 변경시 입력창 변경 이벤트
//---------------------------------------------------------------------------
scwin.lfn_SchChange = function(){//obj, strCode, strText, nOldIndex, nNewIndex) {
    wconv.clear(Ds_InsurCrList);
    wconv.clear(DsWs_InsurCrList);
    wconv.clear(Ds_InsurCrList1);
    //Ds_InsurCrList1.removeAll();
    switch (cmb_Gubun.getValue()) {
        case "0":
            medt_Str.hide();
            edt_Str.hide();
            break;
        case "1":
            medt_Str.setValue("");
            medt_Str.show();
            edt_Str.hide();
            medt_Str.setDisplayFormat("#-####-#######");
            break;
        case "2":
            medt_Str.setValue("");
            medt_Str.hide();
            edt_Str.setValue("");
            edt_Str.show();
            //edt_Str.ImeMode = "native";
            break;
        default:
            medt_Str.hide();
            edt_Str.hide();
            break;
    }
};

//---------------------------------------------------------------------------
// function 명 : lfn_Search
// 내용        : 조회버튼 클릭 Event처리 
//---------------------------------------------------------------------------
//비동기호출 
scwin.lfn_Search_sync = function() {
	util.eventAsyncCall(this, scwin.lfn_Search, arguments);
};

scwin.lfn_Search = function() {
    wconv.clear(DsWs_InsurCrList);
    wconv.clear(Ds_InsurCrList);
    
    if (cmb_Gubun.getValue() != "0") {
        if (scwin.chkEssnInpt() == false) {
            return;
        }
    }
    scwin.lfn_SearchData(1);
    if (DsWs_InsurCrList.getRowCount() > 0) {
        gfn_MakePagingData(Ds_Page, DsWs_InsurCrList_Cnt.getCellData(0, "nCount"), pageSize, pageCount);
        Cmb_Page.setValue("1");
        edt_count.setValue(DsWs_InsurCrList_Cnt.getCellData(0, "nCount"));
    }
};

//---------------------------------------------------------------------------
// function 명 : lfn_SearchData
// 내용        : (특약갱신조회) 조회버튼 클릭 Event처리
//---------------------------------------------------------------------------
scwin.lfn_SearchData = function(PageNo) {
    wconv.clear(Ds_InsurCrList);
    wconv.clear(DsWs_InsurCrList);
    /*
    SOBJ_DataSearch.WSDL = gds.gWsdlBasis;
    var MethodObj = gfn_CreateMethodObj(SOBJ_DataSearch, "com.inswave.longterm.psv.ens.task.EAD510Task", "InquiryList", PageSize, PageNo);
    gfn_SetParam(MethodObj, "sSearchFlag", cmb_Gubun.getValue()); // 조회구분 
    gfn_SetParam(MethodObj, "SelDate", Cal_SelDate.getValue()); // 파라미터 SelDate		
    if (cmb_Gubun.getValue() == "2") {
        gfn_SetParam(MethodObj, "sSearchFlagVal", edt_Str.getValue()); // 구분값에 따른 입력값.
    } else {
        gfn_SetParam(MethodObj, "sSearchFlagVal", medt_Str.getValue()); // 구분값에 따른 입력값.
    }
    gfn_CallService(SOBJ_DataSearch, DOBJ_DataSearch, MethodObj);
    */
	var MethodObj = new callService("com.inswave.longterm.psv.ens.task.EAD510Task", "InquiryList", pageSize, PageNo);
	MethodObj.setId("InquiryList");
	//MethodObj.setParam("sAgentCode", gUserID);
    MethodObj.setParam( "sSearchFlag", cmb_Gubun.getValue()); // 조회구분 
    MethodObj.setParam( "SelDate", Cal_SelDate.getValue()); // 파라미터 SelDate		
    if (cmb_Gubun.getValue() == "2") {
        MethodObj.setParam( "sSearchFlagVal", edt_Str.getValue()); // 구분값에 따른 입력값.
    } else {
        MethodObj.setParam( "sSearchFlagVal", medt_Str.getValue()); // 구분값에 따른 입력값.
    }
	MethodObj.setUrl("/contract/CBSC021MController.do");

	MethodObj.setXPath("//*/hashtable/data/vector/data/LTIEZ90");
	MethodObj.addXPath("//*/hashtable/data/LTIEZ90Count");	
	MethodObj.addXPath("//WARNING");
	MethodObj.sync();
	MethodObj.send();
	//util.interfaceKey(_tranSync.result.serviceDs);
	//DsWs_Team.setJSON (_tranSync.getDsJson("ADMAC03")); // dataset 데이터 
	util.jSonDsCreate(_tranSync.getDsJson("LTIEZ90"), "DsWs_InsurCrList");
	util.jSonDsCreate(_tranSync.getDsJson("LTIEZ90"), "Ds_InsurCrList");
	util.jSonDsCreate(_tranSync.getDsJson("LTIEZ90Count"), "DsWs_InsurCrList_Cnt");	
	util.jSonDsCreate(_tranSync.getDsJson("WARNING"), "DsWs_Warning");
	util.setCompBindRefresh("Ds_InsurCrList");
	util.setRowPosition(Ds_InsurCrList, 0);
    
    if (wconv.length(DsWs_Warning.getCellData(0, "msg")) > 0) {
        wprom.alert(DsWs_Warning.getCellData(0, "msg"));
    } else {
        if (DsWs_InsurCrList.getRowCount() == 0) {
            wconv.clear(Ds_InsurCrList1);
            Ds_InsurCrList1.removeAll();
            wprom.alert("특약갱신조회 건이 없습니다.");
        } else {
            //wconv.copy(Ds_InsurCrList, "DsWs_InsurCrList");
        }
    }
};

//---------------------------------------------------------------------------
// function 명 : grd_LTIEZ90_OnCellClick
// 내용        : 셀 클릭했을 때 
//---------------------------------------------------------------------------
scwin.grd_LTIEZ90_OnCellClick = function( nRow, nCell) { 
    wconv.clear(Ds_InsurCrList1);
    wconv.clear(DsWs_InsurCrList1);
    /*
    SOBJ_Get.WSDL = gds.gWsdlBasis;
    var MethodObj = gfn_CreateMethodObj(SOBJ_Get, "com.inswave.longterm.psv.ens.task.EAD510Task", "InquiryDetailList", "", "");
    gfn_SetParam(MethodObj, "sCrNo", Ds_InsurCrList.getCellData(nRow, "sCrNo"));
    gfn_SetParam(MethodObj, "SelDate", Cal_SelDate.getValue()); // 파라미터 SelDate
    gfn_CallService(SOBJ_Get, DOBJ_Get, MethodObj);
    */
	var MethodObj = new callService("com.inswave.longterm.psv.ens.task.EAD510Task", "InquiryDetailList", "", "");
	MethodObj.setId("InquiryDetailList");
	//MethodObj.setParam("sAgentCode", gUserID);
    MethodObj.setParam( "sCrNo", Ds_InsurCrList.getCellData(nRow, "sCrNo"));
    MethodObj.setParam( "SelDate", Cal_SelDate.getValue()); // 파라미터 SelDate
	
	MethodObj.setUrl("/contract/CBSC021MController.do");
	MethodObj.setXPath("//*/hashtable/data/vector/data/LTIEZ90Detail");
	MethodObj.addXPath("//WARNING");
	MethodObj.sync();
	MethodObj.send();
	//util.interfaceKey(_tranSync.result.serviceDs);
	//DsWs_Team.setJSON (_tranSync.getDsJson("ADMAC03")); // dataset 데이터 
	util.jSonDsCreate(_tranSync.getDsJson("LTIEZ90Detail"), "DsWs_InsurCrList1");
	util.jSonDsCreate(_tranSync.getDsJson("LTIEZ90Detail"), "Ds_InsurCrList1");
	util.jSonDsCreate(_tranSync.getDsJson("WARNING"), "Detail_Warning");
	util.setCompBindRefresh("Ds_InsurCrList1");
	util.setRowPosition(Ds_InsurCrList1, 0);
    
    if (wconv.length(Detail_Warning.getCellData(0, "msg")) > 0) {
        wprom.alert(Detail_Warning.getCellData(0, "msg"));
    } else {
        if (DsWs_InsurCrList1.getRowCount() == 0) {
            wprom.alert("특약사항 건이 없습니다.");
        } else {
            //wconv.copy(Ds_InsurCrList1, "DsWs_InsurCrList1");
        }
    }
};

scwin.grd_LTIEZ90s_OnCellClick = function( nRow, nCell) {
    var sCrNo = DsWs_InsurCrList1.getCellData(nRow, "sCrNo");
    var nInrpsSeqno = DsWs_InsurCrList1.getCellData(nRow, "nInrpsSeqno");
    //var arg = "sCrNo=" + wconv.quote(sCrNo) + " nInrpsSeqno=" + wconv.quote(nInrpsSeqno);
    //wconv.trace(arg);
	var indata	=	{
			"sCrNo" 				: sCrNo,
		   	"nInrpsSeqno" 	: nInrpsSeqno
	};				
	var popInfo = {
		"width"     : 860,
		"height"    : 350,  
		"indata"    : indata,
		"title"     : "갱신특약정보",
		"callback"  : ""
	};	    
    wprom.popupOpen("/ui/cbsc/CBSC022P.xml", popInfo);
};

//**************************************************************************************************
// 페이지 처리 - 페이지 콤보 박스
//**************************************************************************************************
scwin.Cmb_Page_OnChanged = function(info) {
    //scwin.lfn_Search(info.newValue);
    scwin.lfn_SearchData(info.newValue);
};

//**************************************************************************************************
// 페이징 처리 - 이전 페이지 리스트
//**************************************************************************************************
scwin.Btn_PreV_OnClick = function(e) {
    var ftVal = wconv.toNumber(Ds_Page.getCellData(Ds_Page.getRowPosition(), "FILTERCD")) - 1;
    if (wconv.toNumber(maxFilterVal) < wconv.toNumber(ftVal)) {
        wprom.alert("조회의 처음입니다.");
        return;
    } else if (wconv.toNumber(ftVal) < 1) {
        wprom.alert("조회의 처음입니다.");
        return;
    }
    wconv.filter(Ds_Page, "FILTERCD=='" + ftVal + "'",true);
    Cmb_Page.setValue(Ds_Page.getCellData(0, "CODE"));
    scwin.lfn_SearchData(Cmb_Page.getValue());
};

//**************************************************************************************************
// 페이징 처리 - 이전 페이지
//**************************************************************************************************
scwin.Btn_Pre_OnClick = function(e) {
    var Idx = Cmb_Page.getValue();
    if (wconv.toNumber(Idx) - 1 < 1) {
        wprom.alert("조회의 처음입니다.");
        return;
    }
    scwin.lfn_SearchData(wconv.toString(wconv.toNumber(Idx) - 1));
    if (Ds_Page.getCellData(0, "CODE") == Idx) {
        wconv.filter(Ds_Page, "FILTERCD=='" + wconv.toString(wconv.toNumber(Ds_Page.getCellData(0, "FILTERCD")) - 1) + "'",true);
        Cmb_Page.setValue(Ds_Page.getCellData(Ds_Page.getTotalRow(), "CODE"));
        /*수작업 변환 가이드 (getTotalRow)
            필터 적용이 되어있는 row의 건수는 getRowCount API를 사용합니다.*/
    } else
        Cmb_Page.setValue(wconv.toNumber(Idx) - 1);
};

//**************************************************************************************************
// 페이징 처리 - 다음 페이지
//**************************************************************************************************
scwin.Btn_Next_OnClick = function(e) {
    var Idx = Cmb_Page.getValue();
    if (wconv.toNumber(maxPage) < wconv.toNumber(Idx) + 1) {
        wprom.alert("더이상 자료가 존재하지 않습니다");
        return;
    }
    scwin.lfn_SearchData(wconv.toString(wconv.toNumber(Idx) + 1));
    if (Ds_Page.getCellData(Ds_Page.getTotalRow(), "CODE") == Idx  ) {
        wconv.filter(Ds_Page, "FILTERCD=='" + wconv.toString(wconv.toNumber(Ds_Page.getCellData(Ds_Page.getTotalRow(), "FILTERCD")) + 1
        ) + "'",true);
    }
    Cmb_Page.setValue(wconv.toNumber(Idx) + 1);
};

//**************************************************************************************************
// 페이징 처리 - 다음 페이지 리스트
//**************************************************************************************************
scwin.Btn_NextV_OnClick = function(e) {
    var ftVal = wconv.toNumber(Ds_Page.getCellData(Ds_Page.getRowPosition(), "FILTERCD")) + 1;
    if (wconv.toNumber(maxFilterVal) < wconv.toNumber(ftVal)) {
        wprom.alert("더이상 자료가 존재하지 않습니다");
        return;
    }
    wconv.filter(Ds_Page, "FILTERCD=='" + ftVal + "'",true);
    Cmb_Page.setValue(Ds_Page.getCellData(0, "CODE"));
    scwin.lfn_SearchData(Cmb_Page.getValue());
};

scwin.Cal_SelDate_OnKeyDown = function(e) {
    gsSysDate = gds.gDs_ServerTime.getCellData(0, "sToday").substr(0, 8);
    var cmp;
    cmp = wconv.substr(Cal_SelDate.getValue(), 4, 2); // ex) 2015[03] 월정보만 가져옴
    if (e.keyCode == 13) {
        // ENTER키 누를 때
        if (cmp >= 13) {
            // 13월 이상이면
            wprom.alert("유효한 값이 아닙니다.");
        } else {
            scwin.lfn_SearchData("1"); // 아니면 검색
        }
    }
};

scwin.medt_Str_OnKeyDown = function(e) {
    //13자리이면 조회처리
    if (e.keyCode == 13) {
        scwin.lfn_Search();
    }
};

scwin.Cal_SelDate_OnChanged = function(obj, strText) {
    wconv.clear(Ds_InsurCrList);
    wconv.clear(DsWs_InsurCrList);
    wconv.clear(Ds_InsurCrList1);
    //Ds_InsurCrList1.removeAll();
};

//**************************************************************************
// 공통 엑셀 버튼
//**************************************************************************
scwin.cm_btnExDown = function() {
    scwin.ExcelData();
};

//**************************************************************************************************
// 엑셀출력
//**************************************************************************************************
scwin.ExcelData = function() {
    //var sResult;
    //sResult = FileDialog0.Open();
    //if (sResult) {
        wconv.clear(DsWs_Warning);
        
        //DsWs_LoanList.Clear();
        wconv.clear(Ds_InsurCrListExl);
        wconv.clear(DsWs_InsurCrListExl);
        var npageSize = DsWs_InsurCrList_Cnt.getCellData(0, "nCount");
        //wconv.trace(npageSize);
        /*
        SOBJ_DataSearch1.WSDL = gds.gWsdlBasis;
        var MethodObj = gfn_CreateMethodObj(SOBJ_DataSearch1, "com.inswave.longterm.psv.ens.task.EAD510Task", "InquiryList", npageSize, "");
        gfn_SetParam(MethodObj, "sSearchFlag", cmb_Gubun.getValue()); // 조회구분 
        gfn_SetParam(MethodObj, "SelDate", Cal_SelDate.getValue()); // 파라미터 SelDate		
        if (cmb_Gubun.getValue() == "2") {
            gfn_SetParam(MethodObj, "sSearchFlagVal", edt_Str.getValue()); // 구분값에 따른 입력값.
        } else {
            gfn_SetParam(MethodObj, "sSearchFlagVal", medt_Str.getValue()); // 구분값에 따른 입력값.
        }
        gfn_CallService(SOBJ_DataSearch1, DOBJ_DataSearch1, MethodObj);
        */
		var MethodObj = new callService("com.inswave.longterm.psv.ens.task.EAD510Task", "InquiryList", npageSize, "");
		MethodObj.setId("InquiryList");
		//MethodObj.setParam("sAgentCode", gUserID);
        MethodObj.setParam( "sSearchFlag", cmb_Gubun.getValue()); // 조회구분 
        MethodObj.setParam( "SelDate", Cal_SelDate.getValue()); // 파라미터 SelDate		
        if (cmb_Gubun.getValue() == "2") {
            MethodObj.setParam( "sSearchFlagVal", edt_Str.getValue()); // 구분값에 따른 입력값.
        } else {
            MethodObj.setParam( "sSearchFlagVal", medt_Str.getValue()); // 구분값에 따른 입력값.
        }

		MethodObj.setUrl("/contract/CBSC021MController.do");
		MethodObj.setXPath("//*/hashtable/data/vector/data/LTIEZ90");
		MethodObj.addXPath("//WARNING");
		MethodObj.sync();
		MethodObj.send();
		//util.interfaceKey(_tranSync.result.serviceDs);
		//DsWs_Team.setJSON (_tranSync.getDsJson("ADMAC03")); // dataset 데이터 
		util.jSonDsCreate(_tranSync.getDsJson("LTIEZ90"), "DsWs_InsurCrListExl");
		util.jSonDsCreate(_tranSync.getDsJson("LTIEZ90"), "Ds_InsurCrListExl");
		util.jSonDsCreate(_tranSync.getDsJson("WARNING"), "DsWs_Warning");
		util.setCompBindRefresh("Ds_InsurCrListExl");
		util.setRowPosition(Ds_InsurCrListExl, 0);
        
        if (wconv.length(DsWs_Warning.getCellData(0, "msg")) > 0) {
            wprom.alert(DsWs_Warning.getCellData(0, "msg"));
        } else {
            //wconv.copy(Ds_InsurCrListExl, "DsWs_InsurCrListExl");
        }
    
    //Grid0.SaveExcel(FileDialog0.FilePath + "\\" + FileDialog0.FileName, "갱신안내문대상조회");
   	var option={};
	option.fileName= "갱신안내문대상조회.xlsx";
	var infoArr = {};
	common.downLoadExcel("Grid0",option,infoArr);	
	Grid0.hide();
};
]]></script>
    </head>
    <body>
    	<xf:group class="cont_wrap" id="D800"
    		style="position:absolute;WorkArea:true;  height:570px;left:0px;top:33px; width:100%;"
    		userData1="갱신안내문대상조회"
    		userData2=" OnLoadCompleted:scwin.D800_OnLoadCompleted; ">
    		<DataObjects>
    			<DataObject />
    			<DataObject />
    			<DataObject />
    			<DataObject />
    		</DataObjects>
    		<ServiceObjects>
    			<ServiceObject />
    			<ServiceObject />
    			<ServiceObject />
    			<ServiceObject />
    			<ServiceObject />
    			<ServiceObject />
    		</ServiceObjects>
    		<xf:group arcsize="6" class="search_area" id="Shape9"
    			style="top:px;left:0px;" userData3="RoundRect">
    			<w2:anchor class="btn_search" disabled="" id=""
    				outerDiv="false" style="" tabIndex="7" ev:onclick="scwin.lfn_Search_sync">
    				<xf:label><![CDATA[조회]]></xf:label>
    			</w2:anchor>
    		</xf:group>
    		<xf:group arcsize="8" class="" id="Shape1"
    			style="position:absolute;  bottom:565px; height:160px; left:0px; top:405px; width:100%;"
    			userData3="RoundRect">
    		</xf:group>
    		<w2:textbox class="sty_lb_Search" id="Static63" label="조회년월"
    			style="position:absolute; VAlign:Middle;  text-align:right; height:20px;left:12px;top:10px; width:68px;"
    			tagname="" />
    		<xf:input class="sty_ipt_form" dataType="text"
    			displayFormat="####-##" ev:onblur="scwin.Cal_SelDate_OnKeyDown"
    			ev:onchange="scwin.Cal_SelDate_OnChanged" id="Cal_SelDate"
    			style="position:absolute;border-style:solid;height:20px;left:95px;top:9px;width:105px;text-align: center;"
    			tabIndex="6" />
    		<xf:trigger ev:onclick="scwin.btn_Pop_Search_OnClick"
    			id="Button0"
    			style="position:absolute; height:20px;left:204px;top:10px;width: 18px;"
    			tabIndex="7" class="add_calendar_bu" type="anchor">
    			<xf:label><![CDATA[]]></xf:label>
    		</xf:trigger>
    		<PopupDiv />
    		<w2:textbox class="sty_lb_Search" id="Static0" label="조회조건"
    			style="position:absolute; VAlign:Middle;  text-align:right; height:20px;left:277px;top:10px; width:58px;"
    			tagname="" />
    		<xf:select1 appearance="minimal" class="sty_ipt_search"
    			emptyItem="true" ev:onchange="scwin.lfn_SchChange" id="cmb_Gubun"
    			style="position:absolute; ImeMode:none;  INDEX:0;  border-style:solid;  height:20px;left:351px;top:9px; width:100px;"
    			tabIndex="9" renderType="native">
    			<xf:choices>
    				<xf:itemset nodeset="data:ds_combo">
    					<xf:label ref="id_nm" />
    					<xf:value ref="id_cd" />
    				</xf:itemset>
    			</xf:choices>
    		</xf:select1>
    		<xf:input dataType="text" displayFormat="#-####-#######"
    			ev:onblur="scwin.medt_Str_OnKeyDown" id="medt_Str"
    			placeholder="_-____-_______"
    			style="position:absolute; border-color:user33;  border-style:solid;  height:20px;left:457px;top:9px; width:103px;"
    			tabIndex="11" />
    		<xf:input ev:onblur="scwin.medt_Str_OnKeyDown" id="edt_Str"
    			maxlength="16"
    			style="position:absolute; border-color:user33;  border-style:solid;  height:20px;left:457px;top:9px; width:103px;"
    			tabIndex="12" />
    		<w2:wframe id="div1" scope="false"
    			src="/cm/common/Main_btn_GridControl.xml"
    			style="position:absolute; height:20px;right:60px;top:44px; width:219px;" />
    		<xf:switch id="switch_101" style=" ">
    			<xf:case id="Default_102" style=" ">
    				<w2:gridView autoFit="allColumn"
    					autoFitMinWidth="100" class="sty_Grid"
    					dataList="Ds_InsurCrList"
    					ev:oncellclick="scwin.grd_LTIEZ90_OnCellClick" focusMode="row"
    					id="grd_LTIEZ90" inputType="text" readOnly="true"
    					style="position:absolute; UseDBuff:true;  InputPanel:FALSE;  EndLineColor:default;  border:Flat;  AutoFitEndLine:Hide;height:364px; left:0px; right:812px;top:77px;width:100.0%;"
    					tabIndex="14">
    					<w2:header>
    						<w2:row>
    							<w2:column dataType="text"
    								id="head_id_821" inputType="text" readOnly="true"
    								rowSpan="2" style="height:20px;" userData1="0" userData3="0"
    								value="계약번호" width="110" />
    							<w2:column dataType="text"
    								id="head_id_822" inputType="text" readOnly="true"
    								rowSpan="2" style="height:20px;" userData1="1" userData3="0"
    								value="계약자명" width="63" />
    							<w2:column dataType="text"
    								id="head_id_823" inputType="text" readOnly="true"
    								rowSpan="2" style="height:20px;" userData1="2" userData3="0"
    								value="계약시작일자" width="76" />
    							<w2:column dataType="text"
    								id="head_id_824" inputType="text" readOnly="true"
    								rowSpan="2" style="height:20px;" userData1="3" userData3="0"
    								value="계약종료일자" width="76" />
    							<w2:column dataType="text"
    								id="head_id_825" inputType="text" readOnly="true"
    								rowSpan="2" style="height:20px;" userData1="4" userData3="0"
    								value="갱신일자" width="76" />
    							<w2:column colSpan="3" dataType="text"
    								id="head_id_826" inputType="text" readOnly="true"
    								style="height:20px;" userData1="5" userData3="0"
    								value="갱신 전" width="68" />
    							<w2:column colSpan="3" dataType="text"
    								id="head_id_830" inputType="text" readOnly="true"
    								style="height:20px;" userData1="8" userData3="0"
    								value="갱신 후" width="204" />
    						</w2:row>
    						<w2:row>
    							<w2:column dataType="text"
    								id="head_id_827" inputType="text" readOnly="true"
    								style="height:20px;" userData1="5" userData3="1"
    								value="보장보험료" width="68" />
    							<w2:column dataType="text"
    								id="head_id_828" inputType="text" readOnly="true"
    								style="height:20px;" userData1="6" userData3="1"
    								value="적립보험료" width="68" />
    							<w2:column dataType="text"
    								id="head_id_829" inputType="text" readOnly="true"
    								style="height:20px;" userData1="7" userData3="1"
    								value="영업보험료" width="68" />
    							<w2:column dataType="text"
    								id="head_id_831" inputType="text" readOnly="true"
    								style="height:20px;" userData1="8" userData3="1"
    								value="보장보험료" width="68" />
    							<w2:column dataType="text"
    								id="head_id_832" inputType="text" readOnly="true"
    								style="height:20px;" userData1="9" userData3="1"
    								value="적립보험료" width="68" />
    							<w2:column dataType="text"
    								id="head_id_833" inputType="text" readOnly="true"
    								style="height:20px;" userData1="10" userData3="1"
    								value="영업보험료" width="68" />
    						</w2:row>
    					</w2:header>
    					<w2:gBody>
    						<w2:row>
    							<w2:column dataType="text"
    								displayFormat="#-####-#######" id="sCrNo" inputType="link"
    								readOnly="true" style="height:20px; cursor:hand; "
    								textAlign="center" userData1="0" userData3="0" width="110" />
    							<w2:column dataType="text"
    								id="sCrtorName" inputType="text" readOnly="true"
    								textAlign="center" userData1="1" userData3="0" width="63"
    								style="height:20px;" />
    							<w2:column dataType="date"
    								id="sInsurStrtdate" inputType="text" readOnly="true"
    								textAlign="center" userData1="2" userData3="0" width="76"
    								style="height:20px;" />
    							<w2:column dataType="date"
    								id="sInsurEndDate" inputType="text" readOnly="true"
    								textAlign="center" userData1="3" userData3="0" width="76"
    								style="height:20px;" />
    							<w2:column dataType="date"
    								id="sRenwlDate" inputType="text" readOnly="true"
    								textAlign="center" userData1="4" userData3="0" width="76"
    								style="height:20px;" />
    							<w2:column dataType="number"
    								displayFormat="#,###" id="nRenwlBfGrntPrem" inputType="text"
    								readOnly="true" textAlign="right" userData1="5"
    								userData3="0" width="68" style="height:20px;" />
    							<w2:column dataType="number"
    								displayFormat="#,###" id="nRenwlBfAccuPrem" inputType="text"
    								readOnly="true" userData1="6" userData3="0" width="68"
    								textAlign="right" style="height:20px;" />
    							<w2:column dataType="number"
    								displayFormat="#,###" id="nRenwlBfBussPrem" inputType="text"
    								readOnly="true" userData1="7" userData3="0" width="68"
    								textAlign="right" style="height:20px;" />
    							<w2:column dataType="number"
    								displayFormat="#,###" id="nRenwlAfGrntPrem" inputType="text"
    								readOnly="true" userData1="8" userData3="0" width="68"
    								textAlign="right" style="height:20px;" />
    							<w2:column dataType="number"
    								displayFormat="#,###" id="nRenwlAfAccuPrem" inputType="text"
    								readOnly="true" userData1="9" userData3="0" width="68"
    								textAlign="right" style="height:20px;" />
    							<w2:column dataType="number"
    								displayFormat="#,###" id="nRenwlAfBussPrem" inputType="text"
    								readOnly="true" userData1="10" userData3="0" width="68"
    								textAlign="right" style="height:20px;" />
    						</w2:row>
    					</w2:gBody>
    				</w2:gridView>
    			</xf:case>
    		</xf:switch>
    		<xf:switch id="switch_102" style=" ">
    			<xf:case id="Default_103" style=" ">
    				<w2:gridView autoFit="allColumn"
    					autoFitMinWidth="100" class="sty_Grid"
    					dataList="Ds_InsurCrList1"
    					ev:oncellclick="scwin.grd_LTIEZ90s_OnCellClick" focusMode="row"
    					id="grd_LTIEZ90s" inputType="text" readOnly="true"
    					style="position:absolute; UseDBuff:true;  InputPanel:FALSE;  EndLineColor:default;  border:Flat;  AutoFitEndLine:Hide;  height:150px; left:0px; right:812px;top:445px; width:100%;"
    					tabIndex="17">
    					<w2:header>
    						<w2:row>
    							<w2:column dataType="text"
    								id="head_id_834" inputType="text" readOnly="true"
    								rowSpan="2" style="height:20px;" userData1="0" userData3="0"
    								value="계약번호" width="110" />
    							<w2:column dataType="text"
    								id="head_id_835" inputType="text" readOnly="true"
    								rowSpan="2" style="height:20px;" userData1="1" userData3="0"
    								value="피보험자명" width="63" />
    							<w2:column colSpan="3" dataType="text"
    								id="head_id_836" inputType="text" readOnly="true"
    								style="height:20px;" userData1="2" userData3="0"
    								value="갱신 전" width="204" />
    							<w2:column colSpan="3" dataType="text"
    								id="head_id_840" inputType="text" readOnly="true"
    								style="height:20px;" userData1="5" userData3="0"
    								value="갱신 후" width="68" />
    						</w2:row>
    						<w2:row>
    							<w2:column dataType="text"
    								id="head_id_837" inputType="text" readOnly="true"
    								style="height:20px;" userData1="2" userData3="1"
    								value="보장보험료" width="68" />
    							<w2:column dataType="text"
    								id="head_id_838" inputType="text" readOnly="true"
    								style="height:20px;" userData1="3" userData3="1"
    								value="적립보험료" width="68" />
    							<w2:column dataType="text"
    								id="head_id_839" inputType="text" readOnly="true"
    								style="height:20px;" userData1="4" userData3="1"
    								value="영업보험료" width="68" />
    							<w2:column dataType="text"
    								id="head_id_841" inputType="text" readOnly="true"
    								style="height:20px;" userData1="5" userData3="1"
    								value="보장보험료" width="68" />
    							<w2:column dataType="text"
    								id="head_id_842" inputType="text" readOnly="true"
    								style="height:20px;" userData1="6" userData3="1"
    								value="적립보험료" width="68" />
    							<w2:column dataType="text"
    								id="head_id_843" inputType="text" readOnly="true"
    								style="height:20px;" userData1="7" userData3="1"
    								value="영업보험료" width="68" />
    						</w2:row>
    					</w2:header>
    					<w2:gBody>
    						<w2:row>
    							<w2:column dataType="text"
    								displayFormat="#-####-#######" id="sCrNo" inputType="link"
    								readOnly="true" style="height:20px; cursor:hand; ;"
    								textAlign="center" userData1="0" userData3="0" width="110" />
    							<w2:column dataType="text"
    								id="sInrpsName" inputType="text" readOnly="true"
    								style="height:20px;" textAlign="center" userData1="1"
    								userData3="0" width="63" />
    							<w2:column dataType="number"
    								displayFormat="#,###" id="nRenwlBfGrntPrem" inputType="text"
    								readOnly="true" style="height:20px;" textAlign="right"
    								userData1="2" userData3="0" width="68" />
    							<w2:column dataType="number"
    								displayFormat="#,###" id="nRenwlBfAccuPrem" inputType="text"
    								readOnly="true" style="height:20px;" userData1="3"
    								userData3="0" width="68" textAlign="right" />
    							<w2:column dataType="number"
    								displayFormat="#,###" id="nRenwlBfBussPrem" inputType="text"
    								readOnly="true" style="height:20px;" userData1="4"
    								userData3="0" width="68" textAlign="right" />
    							<w2:column dataType="number"
    								displayFormat="#,###" id="nRenwlAfGrntPrem" inputType="text"
    								readOnly="true" style="height:20px;" userData1="5"
    								userData3="0" width="68" textAlign="right" />
    							<w2:column dataType="number"
    								displayFormat="#,###" id="nRenwlAfAccuPrem" inputType="text"
    								readOnly="true" style="height:20px;" userData1="6"
    								userData3="0" width="68" textAlign="right" />
    							<w2:column dataType="number"
    								displayFormat="#,###" id="nRenwlAfBussPrem" inputType="text"
    								readOnly="true" style="height:20px;" userData1="7"
    								userData3="0" width="68" textAlign="right" />
    						</w2:row>
    					</w2:gBody>
    				</w2:gridView>
    			</xf:case>
    		</xf:switch>
    		<xf:switch id="switch_103" style=" ">
    			<xf:case id="Default_104" style=" "></xf:case>
    		</xf:switch>
    		<xf:input id="edt_count" readOnly="TRUE"
    			style="position:absolute; text-align:CENTER;  height:20px;right:313px;top:51px; width:20px;"
    			tabIndex="21" />
    		<w2:textbox id="Static4" label="건"
    			style="position:absolute; height:16px;right:290px;top:53px; width:19px;"
    			tagname="" />
    		<w2:textbox id="Static1" label="총"
    			style="position:absolute; height:16px;right:333px;top:53px; width:19px;"
    			tagname="" />


    	</xf:group>
    	<w2:wframe class="common_bu_area" id=""
    		src="/cm/common/wf_titleFav.xml" style="" initScript="scwin.wfTitleFavInit();">
    	</w2:wframe>
    	<w2:gridView ev:oncellclick="scwin.grd_LTIEZ90_OnCellClick"
    		focusMode="row" dataList="Ds_InsurCrListExl" inputType="text"
    		readOnly="true"
    		style="position:absolute; UseDBuff:true;  InputPanel:FALSE;  EndLineColor:default;  border:Flat;  AutoFitEndLine:Hide;  height:192px; left:0px; right:818px;top:646px;width:-1.8970704E8%;"
    		tabIndex="18" autoFit="allColumn" id="Grid0" class="sty_Grid"
    		autoFitMinWidth="100">
    		<w2:header>
    			<w2:row>
    				<w2:column rowSpan="2" dataType="text" width="110"
    					userData3="0" inputType="text" readOnly="true"
    					style="height:20px;" id="head_id_844" userData1="0"
    					value="계약번호">
    				</w2:column>
    				<w2:column rowSpan="2" dataType="text" width="63"
    					userData3="0" inputType="text" readOnly="true"
    					style="height:20px;" id="head_id_845" userData1="1"
    					value="계약자명">
    				</w2:column>
    				<w2:column rowSpan="2" dataType="text" width="76"
    					userData3="0" inputType="text" readOnly="true"
    					style="height:20px;" id="head_id_846" userData1="2"
    					value="계약시작일자">
    				</w2:column>
    				<w2:column rowSpan="2" dataType="text" width="76"
    					userData3="0" inputType="text" readOnly="true"
    					style="height:20px;" id="head_id_847" userData1="3"
    					value="계약종료일자">
    				</w2:column>
    				<w2:column rowSpan="2" dataType="text" width="76"
    					userData3="0" inputType="text" readOnly="true"
    					style="height:20px;" id="head_id_848" userData1="4"
    					value="갱신일자">
    				</w2:column>
    				<w2:column colSpan="3" dataType="text" width="204"
    					userData3="0" inputType="text" readOnly="true"
    					style="height:20px;" id="head_id_849" userData1="5"
    					value="갱신 전">
    				</w2:column>
    				<w2:column colSpan="3" dataType="text" width="138"
    					userData3="0" inputType="text" readOnly="true"
    					style="height:21px;" id="head_id_853" userData1="8"
    					value="갱신 후" rowSpan="">
    				</w2:column>
    				<w2:column rowSpan="2" dataType="text" width="68"
    					userData3="0" inputType="text" readOnly="true"
    					style="height:20px;" id="head_id_857" userData1="11"
    					value="이체방법">
    				</w2:column>
    				<w2:column rowSpan="2" dataType="text" width="68"
    					userData3="0" inputType="text" readOnly="true"
    					style="height:20px;" id="head_id_858" userData1="12"
    					value="이체일자">
    				</w2:column>
    			</w2:row>
    			<w2:row>
    				<w2:column dataType="text" width="68" userData3="1"
    					inputType="text" readOnly="true" style="height:20px;"
    					id="head_id_850" userData1="5" value="보장보험료">
    				</w2:column>
    				<w2:column dataType="text" width="68" userData3="1"
    					inputType="text" readOnly="true" style="height:20px;"
    					id="head_id_851" userData1="6" value="적립보험료">
    				</w2:column>
    				<w2:column dataType="text" width="68" userData3="1"
    					inputType="text" readOnly="true" style="height:20px;"
    					id="head_id_852" userData1="7" value="영업보험료">
    				</w2:column>
    				<w2:column dataType="text" width="68" userData3="1"
    					inputType="text" readOnly="true" style="height:20px;"
    					id="head_id_854" userData1="8" value="보장보험료">
    				</w2:column>
    				<w2:column dataType="text" width="68" userData3="1"
    					inputType="text" readOnly="true" style="height:20px;"
    					id="head_id_855" userData1="9" value="적립보험료">
    				</w2:column>
    				<w2:column dataType="text" width="68" userData3="1"
    					inputType="text" readOnly="true" style="height:20px;"
    					id="head_id_856" userData1="10" value="영업보험료">
    				</w2:column>
    			</w2:row>
    		</w2:header>
    		<w2:gBody>
    			<w2:row>
    				<w2:column textAlign="center" dataType="text"
    					width="110" displayFormat="#-####-#######" userData3="0"
    					inputType="link" readOnly="true"
    					style="height:27px; cursor:hand; " id="sCrNo" userData1="0">
    				</w2:column>
    				<w2:column textAlign="center" dataType="text"
    					width="63" userData3="0" inputType="text" readOnly="true"
    					id="sCrtorName" userData1="1">
    				</w2:column>
    				<w2:column textAlign="center" dataType="date"
    					width="76" userData3="0" inputType="text" readOnly="true"
    					id="sInsurStrtdate" userData1="2">
    				</w2:column>
    				<w2:column textAlign="center" dataType="date"
    					width="76" userData3="0" inputType="text" readOnly="true"
    					id="sInsurEndDate" userData1="3">
    				</w2:column>
    				<w2:column textAlign="center" dataType="date"
    					width="76" userData3="0" inputType="text" readOnly="true"
    					id="sRenwlDate" userData1="4">
    				</w2:column>
    				<w2:column textAlign="right" dataType="number"
    					width="68" displayFormat="#,###" userData3="0" inputType="text"
    					readOnly="true" id="nRenwlBfGrntPrem" userData1="5">
    				</w2:column>
    				<w2:column dataType="number" width="68"
    					displayFormat="#,###" userData3="0" inputType="text"
    					readOnly="true" id="nRenwlBfAccuPrem" userData1="6">
    				</w2:column>
    				<w2:column dataType="number" width="68"
    					displayFormat="#,###" userData3="0" inputType="text"
    					readOnly="true" id="nRenwlBfBussPrem" userData1="7">
    				</w2:column>
    				<w2:column dataType="number" width="68"
    					displayFormat="#,###" userData3="0" inputType="text"
    					readOnly="true" id="nRenwlAfGrntPrem" userData1="8">
    				</w2:column>
    				<w2:column dataType="number" width="68"
    					displayFormat="#,###" userData3="0" inputType="text"
    					readOnly="true" id="nRenwlAfAccuPrem" userData1="9">
    				</w2:column>
    				<w2:column dataType="number" width="68"
    					displayFormat="#,###" userData3="0" inputType="text"
    					readOnly="true" id="nRenwlAfBussPrem" userData1="10">
    				</w2:column>
    				<w2:column textAlign="center" dataType="text"
    					width="68" userData3="0" inputType="text" readOnly="true"
    					id="sCmMetdNm" userData1="11">
    				</w2:column>
    				<w2:column textAlign="center" dataType="text"
    					width="68" userData3="0" inputType="text" readOnly="true"
    					id="sTrnfAsmtDate" userData1="12">
    				</w2:column>
    			</w2:row>
    		</w2:gBody>
    	</w2:gridView>
    </body>
</html>
