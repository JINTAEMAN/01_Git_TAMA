<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="/cm/css/all.css" type="text/css"?>
<?xml-stylesheet href="/cm/css/convert.css" type="text/css"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head>
        <w2:type>DEFAULT</w2:type>
        <w2:buildDate/>
        <xf:model>
            <xf:instance>
                <data/>
            </xf:instance>
            <w2:dataCollection>
                <w2:dataList baseNode="list" id="Ds_Result" repeatNode="map"/>
                <w2:dataList baseNode="list" id="Ds_DgnsObjt" repeatNode="map">
                    <w2:columnInfo>
                        <w2:column dataType="text" id="nInrpsSeqno" name="nInrpsSeqno"/>
                    </w2:columnInfo>
                </w2:dataList>
                <w2:dataList baseNode="list" id="Ds_LTIDA20" repeatNode="map" userData2="//hashtable/data[@hashkey='lTIDA20Doc']/LTIDA20"/>
                <w2:dataList baseNode="list" id="DsWs_ConuResltCd" repeatNode="map" userData2="//hashtable/data[@hashkey='com_ConuResltCd']/vector/data/com_ConuResltCd"/>
                <w2:dataList baseNode="list" id="DsWs_LTIDA20" repeatNode="map" userData2="//hashtable/data[@hashkey='lTIDA20Doc']/vector/data/LTIDA20"/>
                <w2:dataList baseNode="list" id="DsWs_ADMAC03" repeatNode="map" userData2="//hashtable/data[@hashkey='aDMAC03Doc']/ADMAC03"/>
                <w2:dataList baseNode="list" id="DsWs_Login" repeatNode="map" userData2="//*/PWD"/>
                <w2:dataList baseNode="list" id="DsWs_Warning" repeatNode="map" userData2="//*/WARNING"/>
                <w2:dataList baseNode="list" id="DsWs_SqrtList" repeatNode="map" userData2="//hashtable/data[@hashkey='lTIDA00ListDoc']/vector/data/LTIDA00"/>
                <w2:dataList baseNode="list" id="ds_code" repeatNode="map"/>
            </w2:dataCollection>
            <w2:workflowCollection/>
        </xf:model>
 <script src="/cm/js/convertJs/Global_Script.js"/>
 <script src="/cm/js/convertJs/comm_Webservice.js"/>
 <script src="/cm/js/convertJs/LongTerm_Script.js"/>
 <script src="/cm/js/convertJs/Marine_Script.js"/>        
 <script><![CDATA[
/****************************************************************************
 * 프로그램번호   : B175_Pop
 * 프로그램명     : QA심의결재
 * 파일명         : B175_Pop.xml
 * 프로그램 내용  : QA심의결재
 * 관련 프로그램  : 
 * 작성자         : 이은연
 * 작성일         : 2014-01-06
 * 저작권         : Copyright ⓒ 2004. the K 손해보험㈜. All Right Reserved.
 * 변경내역       : 
 ****************************************************************************/

//요청(10),승인(20) Flag
var rqstFlag;
var rqstFlagName;
var sOnlySrarch;
var nCrChngNoPop = 0;
var flag_login = false;
var nCrChngNo;
var sToday;
var sJugmAuthCdFlag = "1";
var fv_args;

scwin.init = function() {

	var indata = $w.getParameter("param");//
	try {
		fv_args = JSON.parse(indata);
	} catch(e) {}

    // 현재시간 setting
    //global.http.Sync = true;
    //getServerTime();
    //sToday = substr(gDs_ServerTime.GetColumn(0, "sToday"),0,8);
    //global.http.Sync = false;	
    gfn_getServerTime();
    sToday = wconv.substr(gDs_ServerTime.getCellData(0,"sToday"), 0, 8);
    //sToday = wconv.subStr(gfn_GetSysTime(), 0, 8);
console.log(sToday);
    //sPlanNo = "M20140000033";
    //medt_PlanNo.Value = fv_args.sPlanNo;
    rqstFlag = fv_args.rqstFlag;
    sOnlySrarch = fv_args.sOnlySrarch;
    nCrChngNo = fv_args.nCrChngNo;
    
    if (nCrChngNo.length > 0)
        nCrChngNoPop = nCrChngNo;
    //	if(Length(gUserID) == 0) gUserID = "5100022";	
    //	if(Length(gDoer) == 0) gDoer = "5100022";
    //	if(Length(gDoerUser) == 0) gDoerUser = "5100022";
    scwin.lfn_search();
};

scwin.lfn_search = function() {
    if (mfn_IsEmpty(fv_args.sPlanNo)) {
        wprom.alert("가입설계번호를 입력해주세요");
        return;
    }


    //데이터셋 초기화
    wconv.clear(DsWs_LTIDA20);
    /*
    SOBJ_reqMain.WSDL = gds.gWsdlBasis; //기본 웹서비스
    DsWs_Warning.DataObject = "DOBJ_reqMain";
    var MethodObj = gfn_CreateMethodObj(SOBJ_reqMain, "com.inswave.longterm.ssr.sst.task.DBB170Task", "selectQAHistList", "", "");
    gfn_SetParam(MethodObj, "sPlanNo", medt_PlanNo.Value); //가입설계번호
    gfn_SetParam(MethodObj, "nCrChngNo", nCrChngNoPop); //변경일련번호
    var result = gfn_CallService(SOBJ_reqMain, DOBJ_reqMain, MethodObj);
	*/
	var MethodObj = new callService("com.inswave.longterm.ssr.sst.task.DBB170Task", "selectQAHistList");
	MethodObj.setId("selectQAHistList");
	MethodObj.setParam("sPlanNo", "");//medt_PlanNo.Value); //가입설계번호
	MethodObj.setParam("nCrChngNo", nCrChngNoPop); //변경일련번호
	
	MethodObj.setUrl("/contract/CBSC153PController.do");
	MethodObj.setXPath("//hashtable/data[@hashkey='lTIDA20Doc']/vector/data/LTIDA20");
	MethodObj.addXPath("//WARNING");
	MethodObj.sync();
	MethodObj.send();
	//util.interfaceKey(_tranSync.result.serviceDs);
	//DsWs_Team.setJSON (_tranSync.getDsJson("ADMAC03")); // dataset 데이터 
	util.jSonDsCreate(_tranSync.getDsJson("LTIDA20"), "DsWs_LTIDA20");
	util.jSonDsCreate(_tranSync.getDsJson("WARNING"), "DsWs_Warning");
	util.setCompBindRefresh("DsWs_LTIDA20");
	util.setRowPosition(DsWs_LTIDA20, 0);
	
    //trace("\n value ==> "+ replace(gfn_XmlEncoder(DOBJ_reqMain.Value), "><", ">\n<"));
    // 오류처리
    if (DsWs_Warning.getRowCount() != 0) {
        wprom.alert(DsWs_Warning.getCellData(0, "msg"));
        return;
    } else {
        wconv.filter(DsWs_ConuResltCd, "ToNumber(sCd) < 10",true);
        wconv.copy(Ds_LTIDA20, DsWs_LTIDA20);
    }
};

//---------------------------------------------------------------------------
// function 명 : lfn_OnClose
// 내용        : 화면종료
//---------------------------------------------------------------------------
scwin.lfn_OnClose = function() {
    wprom.close();
};
]]></script>
    </head>
    <body>
        <xf:group class="cont_wrap layer" id="B176_Pop"
            style="position:absolute; WorkArea:true;  Ver:1.0;  PidAttrib:7; left:8px; top:8px;"
            userData1="QA이력 리스트" userData2=" OnLoadCompleted:scwin.lfn_Init; ">
            <DataObjects>
                <DataObject/>
                <DataObject/>
                <DataObject/>
                <DataObject/>
                <DataObject/>
            </DataObjects>
            <ServiceObjects>
                <ServiceObject/>
                <ServiceObject/>
                <ServiceObject/>
                <ServiceObject/>
                <ServiceObject/>
            </ServiceObjects>
            <w2:textbox id="Static5" label="QA이력조회" style="position:absolute; VAlign:Middle;  height:20px; left:0px; top:0px;" tagname="" class="sub_pop_title01" />
            
            <xf:trigger class="popup_top_btn" ev:onclick="scwin.lfn_OnClose" id="btn_close"
                style="position:absolute; ImageID:btn_Comm_Close;  height:20px;left:636px;top:0px; width:25px;" tabIndex="6" type="anchor">
                <xf:label><![CDATA[닫기]]></xf:label>
            </xf:trigger>
            <xf:switch id="switch_140" style=" ">
                <xf:case id="Default_141" style=" ">
                    <w2:gridView autoFit="allColumn" autoFitMinWidth="100" class="sty_Grid" dataList="DsWs_LTIDA20" focusMode="row"
                        id="grd_List" inputType="text" readOnly="true"
                        style="position:absolute; UseDBuff:true;  InputPanel:FALSE;  EndLineColor:default;  border:Flat;  height:192px; left:0px; right:693px; top:30px; width:685px;" tabIndex="7">
                        <w2:header>
                            <w2:row>
                                <w2:column dataType="text" id="head_id_1173" inputType="text" readOnly="true" style="height:30px;"
                                    userData1="0" userData3="0" value="청약번호" width="77"/>
                                <w2:column dataType="text" id="head_id_1174" inputType="text" readOnly="true" style="height:30px;"
                                    userData1="1" userData3="0" value="순번" width="30"/>
                                <w2:column dataType="text" id="head_id_1175" inputType="text" readOnly="true" style="height:30px;"
                                    userData1="2" userData3="0" value="요청내용" width="89"/>
                                <w2:column dataType="text" id="head_id_1176" inputType="text" readOnly="true" style="height:30px;"
                                    userData1="3" userData3="0" value="승인내용" width="123"/>
                                <w2:column dataType="text" id="head_id_1177" inputType="text" readOnly="true" style="height:30px;"
                                    userData1="4" userData3="0" value="승인결과" width="64"/>
                                <w2:column dataType="text" id="head_id_1178" inputType="text" readOnly="true" style="height:30px;"
                                    userData1="5" userData3="0" value="반려사유" width="64"/>
                                <w2:column dataType="text" id="head_id_1179" inputType="text" readOnly="true" style="height:30px;"
                                    userData1="6" userData3="0" value="반려내용" width="82"/>
                                <w2:column dataType="text" id="head_id_1180" inputType="text" readOnly="true" style="height:30px;"
                                    userData1="7" userData3="0" value="승인일자" width="64"/>
                            </w2:row>
                        </w2:header>
                        <w2:gBody>
                            <w2:row>
                                <w2:column dataType="text" id="sPlanNo" inputType="text" readOnly="true" style="height:27px;"
                                    textAlign="center" userData1="0" userData3="0" width="77"/>
                                <w2:column dataType="text" id="nSeqno" inputType="text" readOnly="true" style="" textAlign="center"
                                    userData1="1" userData3="0" width="30"/>
                                <w2:column dataType="text" id="sRqstCten" inputType="text" readOnly="true" style="" textAlign="left"
                                    userData1="2" userData3="0" width="89"/>
                                <w2:column dataType="text" id="sAppmnCten" inputType="text" readOnly="true" style="" textAlign="left"
                                    userData1="3" userData3="0" width="123"/>
                                <w2:column dataType="text" id="sConuResltName" inputType="text" readOnly="true" style="" textAlign="center"
                                    userData1="4" userData3="0" width="64"/>
                                <w2:column dataType="text" id="sRetrnResnName" inputType="link" readOnly="true" style="" textAlign="center"
                                    userData1="5" userData3="0" width="64"/>
                                <w2:column dataType="text" id="sRetrnResn" inputType="text" readOnly="true" style="" textAlign="left"
                                    userData1="6" userData3="0" width="82"/>
                                <w2:column dataType="text" displayFormat="####-##-##" id="sAprvlDate" inputType="text" readOnly="true"
                                    style="" textAlign="center" userData1="7" userData3="0" width="64"/>
                            </w2:row>
                        </w2:gBody>
                    </w2:gridView>
                </xf:case>
            </xf:switch>
        </xf:group>
    </body>
</html>
