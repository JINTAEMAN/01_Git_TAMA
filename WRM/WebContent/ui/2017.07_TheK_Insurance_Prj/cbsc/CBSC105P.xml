<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="/cm/css/all.css" type="text/css"?>
<?xml-stylesheet href="/cm/css/convert.css" type="text/css"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head>
        <w2:type>DEFAULT</w2:type>
        <w2:buildDate/>
        <xf:model>
            <xf:instance>
                <data/>
            </xf:instance>
            <w2:dataCollection>
            	<w2:dataList baseNode="list" id="Ds_LTIDA13"
            		repeatNode="map" />
            	<w2:dataList baseNode="list"
            		ev:oncelldatachange="scwin.Ds_LTIDA13tmp_OnColumnChanged"
            		id="Ds_LTIDA13tmp" repeatNode="map" />
            	<w2:dataList baseNode="list" id="Ds_LTIDA13Ins"
            		repeatNode="map" />
            	<w2:dataList baseNode="list" id="DsWs_LTIDA29"
            		repeatNode="map" userData2="//*/hashtable/data/LTIDA29">
            		<w2:columnInfo>
            			<w2:column id="col1" name="name1"
            				dataType="text">
            			</w2:column>
            		</w2:columnInfo>
            		<w2:data use="true">
            			<w2:row></w2:row>
            		</w2:data>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="DsWs_LTIDA29Dtl"
            		repeatNode="map"
            		userData2="//*/hashtable/data/vector/data/LTIDA29DTL" />
            	<w2:dataList baseNode="list" id="DsWs_Warning"
            		repeatNode="map" userData2="//*/WARNING" />
            	<w2:dataList baseNode="list" id="DsWs_CrtorRelnCd"
            		repeatNode="map" />
            	<w2:dataList baseNode="list" id="DsWs_SsrtFlgcd"
            		repeatNode="map" />
            	<w2:dataList baseNode="list" id="DsWs_DgnsKindCd"
            		repeatNode="map" />
            	<w2:dataList baseNode="list" id="DsWs_DgnsFlagCd"
            		repeatNode="map" />
            	<w2:dataList baseNode="list" id="DsWs_HospCd"
            		repeatNode="map" />
            	<w2:dataList id="WARNING" baseNode="list"
            		saveRemovedData="true" repeatNode="map">
            		<w2:columnInfo>
            			<w2:column id="msg" name="name1"
            				dataType="text">
            			</w2:column>
            			<w2:column id="level" name="name2"
            				dataType="text">
            			</w2:column>
            			<w2:column id="detail" name="name3"
            				dataType="text">
            			</w2:column>
            			<w2:column id="timestamp" name="name4"
            				dataType="text">
            			</w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            </w2:dataCollection>
            <w2:workflowCollection/>
        </xf:model>
            <script src="/cm/js/convertJs/Global_Script.js" />
	<script src="/cm/js/convertJs/LongTerm_Script.js" />
	<script src="/cm/js/convertJs/comm_Webservice.js" />   
	<script src="/cm/js/convertJs/Marine_Script.js" />   
        <script><![CDATA[
//B240_Pop.xml을 호출   (caller ID):  O010
var DgnsGubun;
var sToday;
var sInrpsName;

var sPlanNo;
var sInrpsCd;
var fv_args;
var pageSize;
var pageNo;
//---------------------------------------------------------------------------
// function 명 : B160_OnLoadCompleted()
// 내용        : 화면오픈시 처리
//---------------------------------------------------------------------------
scwin.init = function() {
	var pro = Promise.resolve();
		window.top.util.winTopShowModalChk = "T";
		util.winTopShowModal();
	pro = pro.then(function(rv) {
    	return util.winTopShowModalPromise();
	}); 
	pro = pro.then(function(rv) {
     //init 부분 함수 입력하는곳
	wprom.setPopupInit(785,520, "진단상세결과");
	var indata = $w.getParameter("param");
	try {
		fv_args = JSON.parse(indata);
		sPlanNo = fv_args.sPlanNo;
		sInrpsCd = fv_args.sInrpsCd;
		sInrpsName = fv_args.sInrpsName;						
	} catch(e) {
	};
	
    sToday = wconv.substr(gfn_GetSysTime(), 0, 8);
    medt_PlanNo.setValue(sPlanNo);
    edt_InrpsName.setValue(sInrpsName);

    //공통코드호출(CrStatCd)
    gfn_getCommonCodes("DsWs_CrtorRelnCd DsWs_SsrtFlgcd DsWs_DgnsKindCd DsWs_DgnsFlagCd DsWs_HospCd", "CrtorRelnCd  SsrtFlgcd DgnsKindCd DgnsFlagCd HospCd", "", "A N N");
    if (!mfn_IsEmpty(medt_PlanNo.getValue())) {
        scwin.lfn_Search_Async();
    }
        return ;		// init 함수를 종료하고자 할때 사용
		// return Promise.reject("오류관련처리"); 
	});
	pro = pro.then(function(rv) {
		util.winTopHideModal();
	});	
	pro = pro.catch(function(rj) {
		util.winTopHideModal();
		//alert(rj); //Promise reject 시 처리 "오류관련처리" 값출력
	});	 
	return pro;
};

//---------------------------------------------------------------------------
// function 명 : lfn_search()
// 내용        : 진단대상건조회
//---------------------------------------------------------------------------
scwin.lfn_Search_Async = function() {
	util.eventAsyncCall(this, scwin.lfn_search, arguments);
};

scwin.lfn_search = function(e) {
    //데이터셋 초기화
    wconv.clear(DsWs_LTIDA29);
    wconv.clear(DsWs_LTIDA29Dtl);
    
//    SOBJ_Search.WSDL = gds.gWsdlBasis; //기본 웹서비스
//    var MethodObj = gfn_CreateMethodObj(SOBJ_Search, "com.inswave.longterm.ssr.sst.task.DBB300Task", "selectDgnsReslt", "", "");
//    if (mfn_IsEmpty(sPlanNo)) {
//        wprom.alert("청약번호를 입력하세요");
//        break;
//    }
//    gfn_SetParam(MethodObj, "sPlanNo", sPlanNo);
//    gfn_SetParam(MethodObj, "sInrpsCd", sInrpsCd);
//    var result = gfn_CallService(SOBJ_Search, DOBJ_Search, MethodObj);
    
    var MethodObj = new callService("com.inswave.longterm.ssr.sst.task.DBB300Task", "selectDgnsReslt", pageSize, pageNo);
	MethodObj.setId("selectDgnsReslt");
	 if (mfn_IsEmpty(sPlanNo)) {
        wprom.alert("청약번호를 입력하세요");
        return false;
    }
	MethodObj.setParam("sPlanNo", sPlanNo);
	MethodObj.setParam("sInrpsCd", sInrpsCd);	
	MethodObj.setUrl("/contract/CBSC105PController.do");//배포후변경할것(controller위치와 이름)
	MethodObj.setXPath("//*/hashtable/data/LTIDA29");//(dsWS의 XPath)
	MethodObj.addXPath("//*/hashtable/data/vector/data/LTIDA29DTL");//(dsWS의 XPath)
	MethodObj.addXPath("//*/WARNING"); 
	MethodObj.sync();
	MethodObj.send();

	util.jSonDsCreate(_tranSync.getDsJson("LTIDA29"), "DsWs_LTIDA29");
	util.jSonDsCreate(_tranSync.getDsJson("LTIDA29DTL"), "DsWs_LTIDA29Dtl");
	util.jSonDsCreate(_tranSync.getDsJson("WARNING"), "DsWs_Warning");
	util.setCompBindRefresh("DsWs_LTIDA29");
	util.setCompBindRefresh("DsWs_LTIDA29Dtl");
	util.setRowPosition(DsWs_LTIDA29, 0);	
	util.setRowPosition(DsWs_LTIDA29Dtl, 0);	
    
    
    if (DsWs_Warning.getRowCount() != 0) {
        wprom.alert(DsWs_Warning.getCellData(0, "msg"));
        return;
    } else {
        if (DsWs_LTIDA29.getRowCount() == 0) {
            wprom.alert("진단대상건이 없습니다.");
        } else {}
    }
};

//---------------------------------------------------------------------------
// function 명 : lfn_Close()
// 내용        : 종료처리
//---------------------------------------------------------------------------
scwin.lfn_OnClose = function() {
    wprom.close();
};
]]></script>
<style>
.sty_Grid .gridHeaderTableDefault td{border:1px solid #c8cad0;}
</style>
    </head>
    <body>
        <xf:group class="cont_wrap layer" id="B300_Pop"
            style="position:absolute; WorkArea:true;  Ver:1.0;  PidAttrib:7; /* height:480px;*/ left:0px; top:0px;/* width:720px;"
            userData1="진단상세결과[B240_Pop]" userData2=" OnLoadCompleted:scwin.B300_Pop_OnLoadCompleted; ">
            <DataObjects>
                <DataObject/>
                <DataObject/>
                <DataObject/>
                <DataObject/>
            </DataObjects>
            <ServiceObjects>
                <ServiceObject/>
                <ServiceObject/>
                <ServiceObject/>
                <ServiceObject/>
            </ServiceObjects>
            <w2:textbox id="Static10" label="진단결과" style="position:absolute; VAlign:Middle;  height:24px; left:0px; top:0px; " tagname="" class="sub_pop_title01">
</w2:textbox>
            
            <xf:group arcsize="6" class="search_area" id="Shape3"
                style="position:absolute; right:712px; bottom:58px; height:30px; left:0px; top:28px; width:750px;" userData3="RoundRect"/>
            <w2:textbox class="sty_lb_Search" id="Static11" label="청약번호 |"
                style="position:absolute; VAlign:Middle;  text-align:right; height:20px;left:10px;top:33px; width:68px;" tagname=""/>
            <xf:input class="sty_ipt_search" dataType="text" disabled="true" displayFormat="#-####-#######" id="medt_PlanNo"
                style="position:absolute; border-style:solid;  height:20px;left:94px;top:33px; width:99px;" tabIndex="6"/>
            <xf:trigger class="popup_top_btn" ev:onclick="lfn_Search_Async" id="btn_search"
                style="position:absolute;ImageID:btn_Comm_Search;height:20px;width:25px;left:649px;top:0px;" tabIndex="8" type="anchor">
                <xf:label><![CDATA[조회]]></xf:label>
            </xf:trigger>
            <xf:trigger class="popup_top_btn" ev:onclick="scwin.lfn_OnClose" id="btn_Close"
                style="position:absolute;ImageID:btn_Comm_Close;height:20px;width:25px;left:701px;top:0px;" tabIndex="7" type="anchor">
                <xf:label><![CDATA[닫기]]></xf:label>
            </xf:trigger>
            <xf:switch id="switch_153" style=" ">
                <xf:case id="Default_154" style=" ">
                    <w2:gridView class="sty_Grid"
                    	dataList="DsWs_LTIDA29" focusMode="row"
                    	id="gidInfo" inputType="text" readOnly="true"
                    	style="position:absolute; UseDBuff:true;  InputPanel:FALSE;  FixedColSizing:TRUE;  FillAreaType:All;  FillArea:TRUE;  EndLineColor:default;  border:Flat;  AutoFitEndLine:Hide;  height:80px; left:0px; right:708px; top:88px; width:750px;"
                    	tabIndex="9" autoFit="allColumn">
                    	<w2:header>
                    		<w2:row>
                    			<w2:column style=" display:none; "
                    				width="64" id="col0" />
                    			<w2:column style=" display:none; "
                    				width="58" id="col1" />
                    			<w2:column style=" display:none; "
                    				width="67" id="col2" />
                    			<w2:column style=" display:none; "
                    				width="58" id="col3" />
                    			<w2:column style=" display:none; "
                    				width="50" id="col4" />
                    			<w2:column style=" display:none; "
                    				width="50" id="col5" />
                    			<w2:column style=" display:none; "
                    				width="50" id="col6" />
                    			<w2:column style=" display:none; "
                    				width="50" id="col7" />
                    			<w2:column style=" display:none; "
                    				width="50" id="col8" />
                    			<w2:column style=" display:none; "
                    				width="50" id="col9" />
                    			<w2:column style=" display:none; "
                    				width="50" id="col10" />
                    			<w2:column style=" display:none; "
                    				width="58" id="col11" />
                    			<w2:column style=" display:none; "
                    				width="59" id="col12" />
                    		</w2:row>
                    	</w2:header>
                    	<w2:gBody>
                    		<w2:row>
                    			<w2:column dataType="text"
                    				id="temp_id_1330" inputType="text"
                    				readOnly="true" textAlign="center" userData1="0"
                    				userData3="0" value="신장/체중" width="146" />
                    			<w2:column dataType="text" id="sHW"
                    				inputType="text" readOnly="true"
                    				textAlign="center" userData1="1" userData3="0"
                    				width="58" />
                    			<w2:column dataType="text"
                    				id="temp_id_1331" inputType="text"
                    				readOnly="true"
                    				style="height:27px; celltype:head; "
                    				textAlign="center" userData1="2" userData3="0"
                    				value="맥박/맥압" width="149" />
                    			<w2:column dataType="text" id="sPulse"
                    				inputType="text" readOnly="true"
                    				textAlign="center" userData1="3" userData3="0"
                    				width="58" />
                    			<w2:column dataType="text"
                    				id="temp_id_1332" inputType="text"
                    				readOnly="true" rowSpan="3"
                    				style="height:44px; celltype:head; ;"
                    				textAlign="center" userData1="4" userData3="0"
                    				value="혈압" width="50" />
                    			<w2:column dataType="text"
                    				id="temp_id_1333" inputType="text"
                    				readOnly="true"
                    				style="height:27px; celltype:head; border-left:1px solid #c8cad0 !important;"
                    				textAlign="center" userData1="5" userData3="0"
                    				value="1차 좌" width="50" />
                    			<w2:column dataType="text" id="sLtBP1"
                    				inputType="text" readOnly="true"
                    				textAlign="center" userData1="6" userData3="0"
                    				width="50" />
                    			<w2:column dataType="text"
                    				id="temp_id_1334" inputType="text"
                    				readOnly="true"
                    				style="height:27px; celltype:head; "
                    				textAlign="center" userData1="7" userData3="0"
                    				value="2차 좌" width="50" />
                    			<w2:column dataType="text" id="sLtBP2"
                    				inputType="text" readOnly="true"
                    				textAlign="center" userData1="8" userData3="0"
                    				width="50" />
                    			<w2:column dataType="text"
                    				id="temp_id_1335" inputType="text"
                    				readOnly="true"
                    				style="height:27px; celltype:head; "
                    				textAlign="center" userData1="9" userData3="0"
                    				value="3차 좌" width="50" />
                    			<w2:column dataType="text" id="sLtBP3"
                    				inputType="text" readOnly="true"
                    				textAlign="center" userData1="10" userData3="0"
                    				width="50" />
                    			<w2:column dataType="text"
                    				id="temp_id_1336" inputType="text"
                    				readOnly="true"
                    				style="height:27px; celltype:head; "
                    				textAlign="center" userData1="11" userData3="0"
                    				value="절대혈압" width="58" />
                    			<w2:column dataType="text"
                    				id="temp_id_1337" inputType="text"
                    				readOnly="true" textAlign="center"
                    				userData1="12" userData3="0" width="59" />
                    		</w2:row>
                    		<w2:row />
                    		<w2:row id="row1" style="">
                    			<w2:column blockSelect="false"
                    				id="column25" style="height:20px" width="146"
                    				inputType="text" displayMode="label"
                    				value="BMI">
                    			</w2:column>
                    			<w2:column blockSelect="false" id="sBMI"
                    				style="height:20px" width="58" inputType="text"
                    				displayMode="label">
                    			</w2:column>
                    			<w2:column blockSelect="false"
                    				id="column23" style="height:20px" width="149"
                    				inputType="text" displayMode="label"
                    				value="가슴둘레">
                    			</w2:column>
                    			<w2:column blockSelect="false"
                    				id="scBust" style="height:20px" width="58"
                    				inputType="text" displayMode="label">
                    			</w2:column>
                    			<w2:column blockSelect="false"
                    				id="column20" style="height:20px" width="50"
                    				inputType="text" displayMode="label"
                    				value="1차 우">
                    			</w2:column>
                    			<w2:column blockSelect="false"
                    				id="sRtBP1" style="height:20px" width="50"
                    				inputType="text" displayMode="label">
                    			</w2:column>
                    			<w2:column blockSelect="false"
                    				id="column18" style="height:20px" width="50"
                    				inputType="text" displayMode="label"
                    				value="2차 우">
                    			</w2:column>
                    			<w2:column blockSelect="false"
                    				id="sRtBP2" style="height:20px" width="50"
                    				inputType="text" displayMode="label">
                    			</w2:column>
                    			<w2:column blockSelect="false"
                    				id="column16" style="height:20px" width="50"
                    				inputType="text" displayMode="label"
                    				value="3차 우">
                    			</w2:column>
                    			<w2:column blockSelect="false"
                    				id="sRtBP3" style="height:20px" width="50"
                    				inputType="text" displayMode="label">
                    			</w2:column>
                    			<w2:column blockSelect="false"
                    				id="column14" style="height:20px" width="58"
                    				inputType="text" displayMode="label"
                    				value="허리둘레">
                    			</w2:column>
                    			<w2:column blockSelect="false"
                    				id="scWaist" style="height:20px" width="59"
                    				inputType="text" displayMode="label">
                    			</w2:column>
                    		</w2:row>
                    	</w2:gBody>
                    </w2:gridView>
                </xf:case>
            </xf:switch>
            <xf:switch id="switch_154" style=" ">
                <xf:case id="Default_155" style=" ">
                    <w2:gridView class="sty_Grid" dataList="DsWs_LTIDA29Dtl" focusMode="row" id="grdList" inputType="text" readOnly="true"
                        style="position:absolute; UseDBuff:true;  InputPanel:FALSE;  FixedColSizing:TRUE;  EndLineColor:default;  border:Flat;  AutoFitEndLine:Hide;  AutoEnter:TRUE;  height:293px; left:0px; right:708px; top:169px; width:750px;" tabIndex="11" autoFit="allColumn">
                        <w2:header>
                            <w2:row>
                                <w2:column dataType="text" id="head_id_1344" inputType="text" readOnly="true" style="height:20px;"
                                    userData1="0" userData3="0" value="검사명" width="182"/>
                                <w2:column dataType="text" id="head_id_1345" inputType="text" readOnly="true" style="height:20px;"
                                    userData1="1" userData3="0" value="검사결과" width="70"/>
                                <w2:column dataType="text" id="head_id_1346" inputType="text" readOnly="true" style="height:20px;"
                                    userData1="2" userData3="0" value="참고치" width="87"/>
                                <w2:column dataType="text" id="head_id_1347" inputType="text" readOnly="true" style="height:20px;"
                                    userData1="3" userData3="0" value="단위" width="59"/>
                                <w2:column dataType="text" id="head_id_1348" inputType="text" readOnly="true" style="height:20px;"
                                    userData1="4" userData3="0" value="비정상여부" width="73"/>
                                <w2:column dataType="text" id="head_id_1349" inputType="text" readOnly="true" style="height:20px;"
                                    userData1="5" userData3="0" value="관련질환" width="236"/>
                            </w2:row>
                            <w2:row/>
                        </w2:header>
                        <w2:gBody>
                            <w2:row>
                                <w2:column dataType="text" id="sInsItemName" inputType="text" readOnly="true"
                                    style="height:24px;combodisplaynltext:true;" textAlign="center" userData1="0" userData3="0" width="182"/>
                                <w2:column dataType="text" id="sInsReslt" inputType="text" readOnly="true" style="height:24px;" textAlign="center"
                                    userData1="1" userData3="0" width="70"/>
                                <w2:column dataType="text" id="sScale" inputType="text" readOnly="true" style="height:24px;" textAlign="center"
                                    userData1="2" userData3="0" width="87"/>
                                <w2:column dataType="text" id="sUnit" inputType="text" readOnly="true" style="height:24px;" textAlign="center"
                                    userData1="3" userData3="0" width="59"/>
                                <w2:column dataType="text" id="sUnuslYn" inputType="text" readOnly="true" style="height:24px;" textAlign="center"
                                    userData1="4" userData3="0" width="73"/>
                                <w2:column dataType="text" id="sRefMatt" inputType="text" readOnly="true" style="height:24px;" textAlign="center"
                                    userData1="5" userData3="0" width="236"/>
                            </w2:row>
                        </w2:gBody>
                    </w2:gridView>
                </xf:case>
            </xf:switch>
            <w2:textbox id="Static12" label="검진정보" style="position:absolute;height:20px;width:112px;left:0px;VAlign:Middle;top:67px;" tagname="" class="sub_pop_title02"/>
            <w2:textbox id="Static0" label="검진정보" style="position:absolute;height:20px;width:112px;left:0px;VAlign:Middle;top:147px;" tagname="" class="sub_pop_title02"/>
            <xf:input class="sty_ipt_form" disabled="true" id="edt_InrpsName"
                style="position:absolute; border-style:solid;  height:20px;left:294px;top:33px; width:78px;" tabIndex="16"/>
            <w2:textbox class="sty_lb_Search" id="Static1" label="검진자명 |"
                style="position:absolute; VAlign:Middle;  text-align:right; height:20px; left:207px; top:33px; width:68px;" tagname=""/>
        </xf:group>
    </body>
</html>
