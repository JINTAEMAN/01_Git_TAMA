<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="/cm/css/all.css" type="text/css"?>
<?xml-stylesheet href="/cm/css/convert.css" type="text/css"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
      <head>
		<!-- 
	       ###################################################
	        파일명 : CBSC014M.xml
	        프로그램명 : 개인청약사항조회
	        설 명 :  개인청약사항을 조회하는 화면
	        작성자 : 진태만
	        작성일 : 2017.09.27
	
	        수정일자            수정자                  수정내용
	       ==================================================
	       2017.09.27      		진태만      				최초작성 
	       ###################################################
	    -->
		<w2:type>DEFAULT</w2:type>
        <w2:buildDate></w2:buildDate>
        <xf:model>
            <xf:instance>
                <data></data>
            </xf:instance>
           		<w2:dataCollection>
            		<w2:dataList id="Ds_PlanList" baseNode="list" saveRemovedData="true" repeatNode="map">
	            		<w2:columnInfo>
	            			<w2:column id="sHsecFlagCd" name="name1" dataType="text"/>
	            			<w2:column id="sInptDate" name="name2" dataType="text"/>
	            			<w2:column id="sBsmnRgstNo" name="name3" dataType="text"/>
	            			<w2:column id="sGnrzCd" name="name4" dataType="text"/>
	            			<w2:column id="sCrNoSeq" name="name5" dataType="text"/>
	            			<w2:column id="sCrStatFlgcd" name="name6" dataType="text"/>
	            			<w2:column id="sInsurStrtdate" name="name7" dataType="text"/>
	            			<w2:column id="sDoerName" name="name8" dataType="text"/>
	            			<w2:column id="sDoer" name="name9" dataType="text"/>
	            			<w2:column id="sTaxPrfrYn" name="name10" dataType="text"/>
	            			<w2:column id="sPsnGroupFlgcdName" name="name11" dataType="text"/>
	            			<w2:column id="nMaxPrem" name="name12" dataType="text"/>
	            			<w2:column id="sSaleChnl" name="name13" dataType="text"/>
	            			<w2:column id="nObjtNum" name="name14" dataType="text"/>
	            			<w2:column id="sCrStatCd" name="name15" dataType="text"/>
	            			<w2:column id="sApplPlanCd" name="name16" dataType="text"/>
	            			<w2:column id="sDgnsObjtYnName" name="name17" dataType="text"/>
	            			<w2:column id="sFrstDoerPartCd" name="name18" dataType="text"/>
	            			<w2:column id="sSrdoIssuDate" name="청약일" dataType="text"/>
							<w2:column id="sApplyPrtDate" name="발행일" dataType="text"/>
	            			<w2:column id="sPlanProgRankCdName" name="name20" dataType="text"/>
	            			<w2:column id="sAsmtAgntCntad" name="name21" dataType="text"/>
	            			<w2:column id="sCpayDate" name="name22" dataType="text"/>
	            			<w2:column id="nDefrYct" name="name23" dataType="text"/>
	            			<w2:column id="sScanObjtYn" name="name24" dataType="text"/>
	            			<w2:column id="sDoerUserName" name="name25" dataType="text"/>
	            			<w2:column id="nGrntPrem" name="name26" dataType="text"/>
	            			<w2:column id="sItemCd" name="name27" dataType="text"/>
	            			<w2:column id="nCstChngSeqno" name="name28" dataType="text"/>
	            			<w2:column id="sPaymTermCd" name="name29" dataType="text"/>
	            			<w2:column id="nPaymAge" name="name30" dataType="text"/>
	            			<w2:column id="nInrpsSeqno" name="name31" dataType="text"/>
	            			<w2:column id="sAsmtAgntFlagCd" name="name32" dataType="text"/>
	            			<w2:column id="sInsurCrLoanYn" name="name33" dataType="text"/>
	            			<w2:column id="sCmprCrNotcSsrt" name="name34" dataType="text"/>
	            			<w2:column id="sCrtorSexFlag" name="name35" dataType="text"/>
	            			<w2:column id="sMdfcHms" name="name36" dataType="text"/>
	            			<w2:column id="sEndPftbpCd" name="name37" dataType="text"/>
	            			<w2:column id="nAnntPymCt" name="name38" dataType="text"/>
	            			<w2:column id="sAddrFlgcd" name="name39" dataType="text"/>
	            			<w2:column id="sBunsMetdDocuClsfCd" name="name40" dataType="text"/>
	            			<w2:column id="nCrtorAge" name="name41" dataType="text"/>
	            			<w2:column id="sCrtorName" name="name42" dataType="text"/>
	            			<w2:column id="sPaymCyclCd" name="name43" dataType="text"/>
	            			<w2:column id="sMNumCrInsAgreYn" name="name44" dataType="text"/>
	            			<w2:column id="sPsnInfoOferAgreYn" name="name45" dataType="text"/>
	            			<w2:column id="sApplPlanName" name="name46" dataType="text"/>
	            			<w2:column id="sJobCd" name="name47" dataType="text"/>
	            			<w2:column id="nRealInsurTerm" name="name48" dataType="text"/>
	            			<w2:column id="nEndRtnrt" name="name49" dataType="text"/>
	            			<w2:column id="sInrpsCd" name="name50" dataType="text"/>
	            			<w2:column id="sAsmtAgntCd" name="name51" dataType="text"/>
	            			<w2:column id="sMailRvadAddrFlagCd" name="name52" dataType="text"/>
	            			<w2:column id="sPaymExptDate" name="name53" dataType="text"/>
	            			<w2:column id="sCnclExtnEndDate" name="name54" dataType="text"/>
	            			<w2:column id="sFrstDoerUser" name="name55" dataType="text"/>
	            			<w2:column id="sEndPftbpCntad" name="name56" dataType="text"/>
	            			<w2:column id="sDgnsResltRgstYn" name="name57" dataType="text"/>
	            			<w2:column id="sPftbpInrpsRelnCd" name="name58" dataType="text"/>
	            			<w2:column id="nTelnoChngSeq" name="name59" dataType="text"/>
	            			<w2:column id="sEndPftbpName" name="name60" dataType="text"/>
	            			<w2:column id="nRealPaymTerm" name="name61" dataType="text"/>
	            			<w2:column id="sGdCd" name="name62" dataType="text"/>
	            			<w2:column id="sAnntPymCyclCd" name="name63" dataType="text"/>
	            			<w2:column id="nGroupInsPsct" name="name64" dataType="text"/>
	            			<w2:column id="sGroupCrAdmNo" name="name65" dataType="text"/>
	            			<w2:column id="sInptHms" name="name66" dataType="text"/>
	            			<w2:column id="nBussPrem" name="name67" dataType="text"/>
	            			<w2:column id="sCrtorRelnCd" name="name68" dataType="text"/>
	            			<w2:column id="sDoerUser" name="name69" dataType="text"/>
	            			<w2:column id="nEndAge" name="name70" dataType="text"/>
	            			<w2:column id="sInrpsStatCd" name="name71" dataType="text"/>
	            			<w2:column id="sCrNoType" name="name72" dataType="text"/>
	            			<w2:column id="sInrpsSexFlag" name="name73" dataType="text"/>
	            			<w2:column id="sInrpsFlagCd" name="name74" dataType="text"/>
	            			<w2:column id="sHndwritJugmYn" name="name75" dataType="text"/>
	            			<w2:column id="sMdfcDler" name="name76" dataType="text"/>
	            			<w2:column id="nMailRvadChngSeq" name="name77" dataType="text"/>
	            			<w2:column id="sCrtorCd" name="name78" dataType="text"/>
	            			<w2:column id="nCrChngNo" name="name79" dataType="text"/>
	            			<w2:column id="sFrstDoerHdqtCd" name="name80" dataType="text"/>
	            			<w2:column id="sCrtorFlgcd" name="name81" dataType="text"/>
	            			<w2:column id="sFrstDoer" name="name82" dataType="text"/>
	            			<w2:column id="sEnntmPftbpFlagCd" name="name83" dataType="text"/>
	            			<w2:column id="sGdCdName" name="name84" dataType="text"/>
	            			<w2:column id="sDvdnFlagCd" name="name85" dataType="text"/>
	            			<w2:column id="nAddrChngSeq" name="name86" dataType="text"/>
	            			<w2:column id="nDcPrem" name="name87" dataType="text"/>
	            			<w2:column id="sDrveFlagCd" name="name88" dataType="text"/>
	            			<w2:column id="sLapsDate" name="name89" dataType="text"/>
	            			<w2:column id="sFrstDoerTeamCd" name="name90" dataType="text"/>
	            			<w2:column id="sAnntPymTermCd" name="name91" dataType="text"/>
	            			<w2:column id="sInsurEndDate" name="name92" dataType="text"/>
	            			<w2:column id="sCmMetd" name="name93" dataType="text"/>
	            			<w2:column id="sPpayAvaYn" name="name94" dataType="text"/>
	            			<w2:column id="nInrpsPsct" name="name95" dataType="text"/>
	            			<w2:column id="sInptDlerIP" name="name96" dataType="text"/>
	            			<w2:column id="sPftbpTelno" name="name97" dataType="text"/>
	            			<w2:column id="sCstFlgcd" name="name98" dataType="text"/>
	            			<w2:column id="nExptEndRetrnAmt" name="name99" dataType="text"/>
	            			<w2:column id="nAccuPrem" name="name100" dataType="text"/>
	            			<w2:column id="sPlanNo" name="name101" dataType="text"/>
	            			<w2:column id="sConuResltCd" name="name102" dataType="text"/>
	            			<w2:column id="sCmprCrNotcCncl" name="name103" dataType="text"/>
	            			<w2:column id="sPftbpName" name="name104" dataType="text"/>
	            			<w2:column id="sFinalPaymMthy" name="name105" dataType="text"/>
	            			<w2:column id="sImagJugmResltNm" name="name106" dataType="text"/>
	            			<w2:column id="sCedeStndYm" name="name107" dataType="text"/>
	            			<w2:column id="sApplDclrRato" name="name108" dataType="text"/>
	            			<w2:column id="nFinalPaymSeq" name="name109" dataType="text"/>
	            			<w2:column id="nTotPaymPrem" name="name110" dataType="text"/>
	            			<w2:column id="sFinalReviDate" name="name111" dataType="text"/>
	            			<w2:column id="sAsmtAgntRelnCd" name="name112" dataType="text"/>
	            			<w2:column id="sAnntOpnAgeCd" name="name113" dataType="text"/>
	            			<w2:column id="nMinPrem" name="name114" dataType="text"/>
	            			<w2:column id="sInsType" name="name115" dataType="text"/>
	            			<w2:column id="sInrpsName" name="name116" dataType="text"/>
	            			<w2:column id="sPlanProgTbNo" name="name117" dataType="text"/>
	            			<w2:column id="nExptEndRtnrt" name="name118" dataType="text"/>
	            			<w2:column id="sMdfcDlerIP" name="name119" dataType="text"/>
	            			<w2:column id="sFinalRecpDate" name="name120" dataType="text"/>
	            			<w2:column id="sPftbpFlagCd" name="name121" dataType="text"/>
	            			<w2:column id="sJugmGradCd" name="name122" dataType="text"/>
	            			<w2:column id="sCrtorCstId" name="name123" dataType="text"/>
	            			<w2:column id="sFrstDoerGroupCd" name="name124" dataType="text"/>
	            			<w2:column id="sCrNo" name="name125" dataType="text"/>
	            			<w2:column id="nJobChngSeqno" name="name126" dataType="text"/>
	            			<w2:column id="sBunsMetdClsfCd" name="name127" dataType="text"/>
	            			<w2:column id="sPsnGroupFlgcd" name="name128" dataType="text"/>
	            			<w2:column id="sMdfcDate" name="name129" dataType="text"/>
	            			<w2:column id="sEndPftbpRelnCd" name="name130" dataType="text"/>
	            			<w2:column id="sPftbpCd" name="name131" dataType="text"/>
	            			<w2:column id="sPlanProgRankCd" name="name132" dataType="text"/>
	            			<w2:column id="sJobGradCd" name="name133" dataType="text"/>
	            			<w2:column id="sInrpsCstId" name="name134" dataType="text"/>
	            			<w2:column id="nApplPrem" name="name135" dataType="text"/>
	            			<w2:column id="sInsTypeName" name="name136" dataType="text"/>
	            			<w2:column id="sDgnsObjtYn" name="name137" dataType="text"/>
	            			<w2:column id="sFrstDoerCentrCd" name="name138" dataType="text"/>
	            			<w2:column id="nInrpsAge" name="name139" dataType="text"/>
	            			<w2:column id="sSsrtDate" name="name140" dataType="text"/>
	            			<w2:column id="sJugmAuthCd" name="name141" dataType="text"/>
	            			<w2:column id="sPectSaleYn" name="name142" dataType="text"/>
	            			<w2:column id="sInsurTermCd" name="name143" dataType="text"/>
	            			<w2:column id="sAsmtAgntName" name="name144" dataType="text"/>
	            			<w2:column id="sFrstDoerDeptOffcCd" name="name145" dataType="text"/>
	            			<w2:column id="sInptDler" name="name146" dataType="text"/>
	            		</w2:columnInfo>
	            	</w2:dataList>       	

            	<w2:dataList id="Ds_JobCode" baseNode="list"
            		saveRemovedData="true" repeatNode="map">
            		<w2:columnInfo>
            			<w2:column id="sResignDate" name="name1"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sRecmdEmpNo" name="name2"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sFrLangPsblYn" name="name3"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sAdrs3" name="name4"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sAdrs2" name="name5"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sAdrs1" name="name6"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sStartID" name="name7"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sConfirmPass" name="name8"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sBirthDate" name="name9"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sOfficeTel2" name="name10"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sResignDateInputDate"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sOfficeTel3" name="name12"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sEmpNo" name="name13"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sOfficeTel1" name="name14"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sSalesChannel" name="name15"
            				dataType="text">
            			</w2:column>
            			<w2:column id="beforeEJBCall" name="name16"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sResignDateInputTime"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sUserID" name="name18"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sMajor" name="name19"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sLockYN" name="name20"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sPosition" name="name21"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sReligion" name="name22"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sMobilePW" name="name23"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sBirthDateType" name="name24"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sHelpAgnt" name="name25"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sMarryYN" name="name26"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sFaxNum" name="name27"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sCompNm" name="name28"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sSchool" name="name29"
            				dataType="text">
            			</w2:column>
            			<w2:column id="nTryCnt" name="name30"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sEmail" name="name31"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sManageEmpNo" name="name32"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sIPAddress" name="name33"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sInnerPhone" name="name34"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sEmpName" name="name35"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sJobCode" name="name36"
            				dataType="text">
            			</w2:column>
            			<w2:column id="nMobileTryCnt" name="name37"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sLicenseYN" name="name38"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sJoiningDate" name="name39"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sSpeciality" name="name40"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sPwd" name="name41"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sZip2" name="name42"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sHrmPosition" name="name43"
            				dataType="text">
            			</w2:column>
            			<w2:column id="result" name="name44"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sStatType" name="name45"
            				dataType="text">
            			</w2:column>
            			<w2:column id="afterEJBCall" name="name46"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sFax2" name="name47"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sDuty" name="name48"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sFax3" name="name49"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sAdrsAdd" name="name50"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sZip1" name="name51"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sResignType" name="name52"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sFax1" name="name53"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sRegistrationNo" name="name54"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sChargeBiz" name="name55"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sStartName" name="name56"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sJobGroup" name="name57"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sStandDate" name="name58"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sHomeTel2" name="name59"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sHomeTel1" name="name60"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sJobCodeName" name="name61"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sOddNumber" name="name62"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sTrainingDate" name="name63"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sHomeTel3" name="name64"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sInputDate" name="name65"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sApprovalPwdType" name="name66"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sEnterDate" name="name67"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sScholarship" name="name68"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sCellPhone3" name="name69"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sCellPhone1" name="name70"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sCellPhone2" name="name71"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sDepartCode" name="name72"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sSubChannel" name="name73"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sGraduteDate" name="name74"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sApprovalPwd" name="name75"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sInputUser" name="name76"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sWorkTypeCode" name="name77"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sMobileLockYN" name="name78"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sHrmDuty" name="name79"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sApplyDate" name="name80"
            				dataType="text">
            			</w2:column>
            		</w2:columnInfo>
            	</w2:dataList>

            	<w2:dataList baseNode="list" id="Ds_TMAuth"
            		repeatNode="map">
            		<w2:columnInfo>
            			<w2:column id="afterEJBCall" name="name1"
            				dataType="text">
            			</w2:column>
            			<w2:column id="beforeEJBCall" name="name2"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sAuthFlag" name="name3"
            				dataType="text">
            			</w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataList id="Ds_Team" baseNode="list"
            		saveRemovedData="true" repeatNode="map">
            		<w2:columnInfo>
            			<w2:column id="sHeadCenterName" name="name1"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sHeadCenterCode" name="name2"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sTeamCode" name="name3"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sGroupName" name="name4"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sDptOfficeCode" name="name5"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sPartCode" name="name6"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sTeamName" name="name7"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sCenterCode" name="name8"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sCenterName" name="name9"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sAgentName" name="name10"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sPartName" name="name11"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sDptOfficeName" name="name12"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sInputTime" name="name13"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sGroupCode" name="name14"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sAgentCode" name="name15"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sInputDate" name="name16"
            				dataType="text">
            			</w2:column>
            		</w2:columnInfo>
            	</w2:dataList>

            	<w2:dataList baseNode="list" id="Ds_PlanProg"
            		repeatNode="map">
            		<w2:columnInfo>
            			<w2:column dataType="text" id="id_nm"
            				name="id_nm">
            			</w2:column>
            			<w2:column dataType="text" id="id_cd"
            				name="id_cd">
            			</w2:column>
            		</w2:columnInfo>
            		<w2:data use="true">
            			<w2:row>
            				<id_cd></id_cd>
            				<id_nm><![CDATA[전체]]></id_nm>
            			</w2:row>
            			<w2:row>
            				<id_cd><![CDATA[10]]></id_cd>
            				<id_nm><![CDATA[계약기본]]></id_nm>
            			</w2:row>
            			<w2:row>
            				<id_cd><![CDATA[20]]></id_cd>
            				<id_nm><![CDATA[보험료산출]]></id_nm>
            			</w2:row>
            			<w2:row>
            				<id_cd><![CDATA[50]]></id_cd>
            				<id_nm><![CDATA[청약사항입력]]></id_nm>
            			</w2:row>
            			<w2:row>
            				<id_cd><![CDATA[60]]></id_cd>
            				<id_nm><![CDATA[계약요약]]></id_nm>
            			</w2:row>
            			<w2:row>
            				<id_cd><![CDATA[70]]></id_cd>
            				<id_nm><![CDATA[입금안내]]></id_nm>
            			</w2:row>
            		</w2:data>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="Ds_searchInput"
            		repeatNode="map">
            		<w2:columnInfo>
            			<w2:column dataType="text" id="sInsurStrtdate"
            				name="sInsurStrtdate">
            			</w2:column>
            			<w2:column dataType="text" id="sInsurEndDate"
            				name="sInsurEndDate">
            			</w2:column>
            			<w2:column dataType="text" id="sPlanProgRankCd"
            				name="sPlanProgRankCd">
            			</w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="ds_combo"
            		repeatNode="map">
            		<w2:columnInfo>
            			<w2:column dataType="text" id="id_nm"
            				name="id_nm">
            			</w2:column>
            			<w2:column dataType="text" id="id_cd"
            				name="id_cd">
            			</w2:column>
            		</w2:columnInfo>
            		<w2:data use="true">
            			<w2:row>
            				<id_cd><![CDATA[1]]></id_cd>
            				<id_nm><![CDATA[피보험자코드]]></id_nm>
            			</w2:row>
            			<w2:row>
            				<id_cd><![CDATA[2]]></id_cd>
            				<id_nm><![CDATA[피보험자명]]></id_nm>
            			</w2:row>
            			<w2:row>
            				<id_cd><![CDATA[3]]></id_cd>
            				<id_nm><![CDATA[계약자코드]]></id_nm>
            			</w2:row>
            			<w2:row>
            				<id_cd><![CDATA[5]]></id_cd>
            				<id_nm><![CDATA[계약자명]]></id_nm>
            			</w2:row>
            			<w2:row>
            				<id_cd><![CDATA[6]]></id_cd>
            				<id_nm><![CDATA[청약번호]]></id_nm>
            			</w2:row>
            			<w2:row>
            				<id_cd><![CDATA[7]]></id_cd>
            				<id_nm><![CDATA[취급자코드]]></id_nm>
            			</w2:row>
            			<w2:row>
            				<id_cd><![CDATA[9]]></id_cd>
            				<id_nm><![CDATA[사용인코드]]></id_nm>
            			</w2:row>
            			<w2:row>
            				<id_cd><![CDATA[10]]></id_cd>
            				<id_nm><![CDATA[조직코드]]></id_nm>
            			</w2:row>
            		</w2:data>
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="Ds_LinkList"
            		repeatNode="map">
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="ds_code"
            		repeatNode="map">
            	</w2:dataList>
            	 
				<!-- 엑셀 다운로드 정보 Ds(Ds_PlanListExl) -->
				<w2:dataList baseNode="list" id="Ds_PlanListExl" repeatNode="map">
            		<w2:columnInfo>
            			<w2:column id="No" name="name1" dataType="text">
            			</w2:column>
            			<w2:column id="sGdCdName" name="name2" dataType="text">
            			</w2:column>
            			<w2:column id="sPlanNo" name="name3" dataType="text">
            			</w2:column>
            			<w2:column id="sCrNo" name="name4" dataType="text">
            			</w2:column>
            			<w2:column id="sInrpsName" name="name5" dataType="text">
            			</w2:column>
            			<w2:column id="sInrpsCd" name="name6" dataType="text">
            			</w2:column>
            			<w2:column id="sCrtorName" name="name7" dataType="text">
            			</w2:column>
            			<w2:column id="sCrtorCd" name="name8" dataType="text">
            			</w2:column>
            			<w2:column id="temp_id_1056" name="name9" dataType="text">
            			</w2:column>
            			<w2:column id="sSsrtDate" name="name10" dataType="text">
            			</w2:column>
            			<w2:column id="sInsurStrtdate" name="name11" dataType="text">
            			</w2:column>
            			<w2:column id="sInsTypeName" name="name12" dataType="text">
            			</w2:column>
            			<w2:column id="nApplPrem" name="name13" dataType="text">
            			</w2:column>
            			<w2:column id="sDoerName" name="name14" dataType="text">
            			</w2:column>
            			<w2:column id="sDoer" name="name15" dataType="text">
            			</w2:column>
            			<w2:column id="sDoerUserName" name="name16" dataType="text">
            			</w2:column>
            			<w2:column id="sDoerUser" name="name17" dataType="text">
            			</w2:column>
            			<w2:column id="sPlanProgRankCdName" name="name18" dataType="text">
            			</w2:column>
            			<w2:column id="sImagJugmResltNm" name="name19" dataType="text">
            			</w2:column>
            		</w2:columnInfo>
            	</w2:dataList> 				
				
				<!-- 엑셀 실제 다운로드 정보 Ds(Ds_PlanListExl2) -->
				<w2:dataList baseNode="list" id="Ds_PlanListExl2" repeatNode="map">
            		<w2:columnInfo>
            			<w2:column id="No" name="name1" dataType="text">
            			</w2:column>
            			<w2:column id="sGdCdName" name="name2" dataType="text">
            			</w2:column>
            			<w2:column id="sPlanNo" name="name3" dataType="text">
            			</w2:column>
            			<w2:column id="sCrNo" name="name4" dataType="text">
            			</w2:column>
            			<w2:column id="sInrpsName" name="name5" dataType="text">
            			</w2:column>
            			<w2:column id="sInrpsCd" name="name6" dataType="text">
            			</w2:column>
            			<w2:column id="sCrtorName" name="name7" dataType="text">
            			</w2:column>
            			<w2:column id="sCrtorCd" name="name8" dataType="text">
            			</w2:column>
            			<w2:column id="temp_id_1056" name="name9" dataType="text">
            			</w2:column>
            			<w2:column id="sSsrtDate" name="name10" dataType="text">
            			</w2:column>
            			<w2:column id="sInsurStrtdate" name="name11" dataType="text">
            			</w2:column>
            			<w2:column id="sInsTypeName" name="name12" dataType="text">
            			</w2:column>
            			<w2:column id="nApplPrem" name="name13" dataType="text">
            			</w2:column>
            			<w2:column id="sDoerName" name="name14" dataType="text">
            			</w2:column>
            			<w2:column id="sDoer" name="name15" dataType="text">
            			</w2:column>
            			<w2:column id="sDoerUserName" name="name16" dataType="text">
            			</w2:column>
            			<w2:column id="sDoerUser" name="name17" dataType="text">
            			</w2:column>
            			<w2:column id="sPlanProgRankCdName" name="name18" dataType="text">
            			</w2:column>
            			<w2:column id="sImagJugmResltNm" name="name19" dataType="text">
            			</w2:column>
            		</w2:columnInfo>
            	</w2:dataList> 
            	
            	<w2:dataList baseNode="list" id="Ds_TEAM"
            		repeatNode="map">
            	</w2:dataList>
       
            	<w2:dataList baseNode="list" id="DsWs_PlanList"
            		keyNode="//hashtable/data[@hashkey='lTIDA00ListDoc']/vector/data/LTIDA00"
            		repeatNode="map">
            		
            		<w2:columnInfo>
            			<w2:column id="No" name="No" dataType="text"></w2:column>
            			<w2:column id="sGdCdName" name="sGdCdName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sInrpsCd" name="sInrpsCd"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sCrtorCd" name="sCrtorCd"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sInsureTerm" name="sInsureTerm"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sSsrtDate" name="sSsrtDate"
            				dataType="text">
            			</w2:column>
            			<w2:column id="nApplPrem" name="nApplPrem"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sDoer" name="sDoer"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sDoerUser" name="sDoerUser"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sPlanProgRankCdName"
            				name="sPlanProgRankCdName" dataType="text">
            			</w2:column>
            			<w2:column id="sPlanNo" name="sPlanNo"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sInrpsName" name="sInrpsName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sCrtorName" name="sCrtorName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sCrNo" name="sCrNo"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sInsurStrtdate"
            				name="sInsurStrtdate" dataType="text">
            			</w2:column>
            			<w2:column id="sInsTypeName" name="sInsTypeName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sDoerName" name="sDoerName"
            				dataType="text">
            			</w2:column>
            			<w2:column id="sDoerUserName"
            				name="sDoerUserName" dataType="text">
            			</w2:column>
            			<w2:column id="sImagJugmResltNm"
            				name="sImagJugmResltNm" dataType="text">
            			</w2:column>
            		</w2:columnInfo>
            	</w2:dataList>

            	<!-- Warning DS(추가) -->
            	<w2:dataList baseNode="list" id="Ds_Warning"
            		keyNode="//*/WARNING" repeatNode="map">
            		<w2:columnInfo> 
            			<w2:column id="msg" name="name1"
            				dataType="text">
            			</w2:column>
            			<w2:column id="level" name="name1"
            				dataType="text">
            			</w2:column>
            			<w2:column id="detail" name="name1"
            				dataType="text">
            			</w2:column>
            			<w2:column id="timestamp" name="name1"
            				dataType="text">
            			</w2:column>
            		</w2:columnInfo>
            	</w2:dataList>

            	<w2:dataList baseNode="list" id="DsWs_PlanListCnt"
            		keyNode="//hashtable/data[@hashkey='lTIDA00ListDocCnt']/LTIDA00CNT"
            		repeatNode="map">
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="DsWs_AXR930"
            		keyNode="//hashtable/data[@hashkey='aDMAC03Doc']/ADMAC03"
            		repeatNode="map">
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="DsWs_Warning"
            		keyNode="//*/WARNING" repeatNode="map">
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="DsWs_chekCrInqrAuth"
            		keyNode="//*/AXR931" repeatNode="map">
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="DsWs_PlanListExl"
            		keyNode="//hashtable/data[@hashkey='lTIDA00ListDoc']/vector/data/LTIDA00"
            		repeatNode="map">
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="DsWs_PlanListCntExl"
            		keyNode="//hashtable/data[@hashkey='lTIDA00ListDocCnt']/LTIDA00CNT"
            		repeatNode="map">
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="DsWs_TEAM"
            		keyNode="//*/ADMAC03" repeatNode="map">
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="DsWs_JobCode"
            		keyNode="//*/ADMAB01" repeatNode="map">
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="DsWs_TMAuth"
            		keyNode="//*/GAG021" repeatNode="map">
            	</w2:dataList>
            	<w2:dataList baseNode="list" id="DsWs_Doer"
            		repeatNode="map">
            	</w2:dataList>            	 
            	<w2:dataList id="Ds_PlanListCnt" baseNode="list"
            		saveRemovedData="true" repeatNode="map">
            		<w2:columnInfo>
            			<w2:column id="result" name="name1"
            				dataType="text">
            			</w2:column>
            			<w2:column id="nCount" name="name2"
            				dataType="text">
            			</w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	
            	<w2:dataList id="Ds_PlanListCntExl"  baseNode="list"
            		saveRemovedData="true" repeatNode="map">
            		<w2:columnInfo>
            			<w2:column id="result" name="name1"
            				dataType="text">
            			</w2:column>
            			<w2:column id="nCount" name="name2"
            				dataType="text">
            			</w2:column>
            		</w2:columnInfo>
            	</w2:dataList>
            	
            </w2:dataCollection>
            <w2:workflowCollection></w2:workflowCollection>
        </xf:model>
		
		<!--// js Script include //--> 
		<script src="/cm/js/convertJs/Global_Script.js"/>
		<script src="/cm/js/convertJs/NewGen_Script.js"/>
        <script src="/cm/js/convertJs/Accounting_Script.js"/> 
		<script src="/cm/js/convertJs/LongTerm_Script.js"/> 
        <script src="/cm/js/convertJs/Marine_Script.js"/> 
		 <script src="/cm/js/convertJs/CCC_Script.js"/> 
		 
         <script><![CDATA[

//	###################################################
//	파일명 : CBSC014M.xml
//	프로그램명 : 개인청약사항조회
//	설 명 :  개인청약사항을 조회하는 화면
//	작성자 : 진태만
//	작성일 : 2017.09.27
//
//	수정일자            수정자                  수정내용
//	==================================================
//	2017.09.27      		진태만      				최초작성 
//	###################################################

var pageSize = "10";		//  페이지수(총 조회 수)
var pageCount = "10";		//  보여지는 페이지수[총 8 Page]
var sToday = ""; 
var bAuthFlag = false;	//전역변수
var slevel = "";
var medt_Str_Event;	// medt_Str(InputBox) MaskEdit 정규식 입력

//---------------------------------------------------------------------------
// function 명 : init()
// 내용        : 화면 오픈시 처리
//--------------------------------------------------------------------------- 
scwin.init = function() {
	console.log("[/CBSC014M.xml] [init()] ==> [폼 로딩] [TEST_01]" );
	
	// medt_Str(InputBox) MaskEdit 정규식 입력  
	var maskRegExp = [/^[0-9\s]{7}[A-Z0-9\s]{6}$/			// 01. 피보험자코드 이면[숫자 7, (대문자,  숫자 6),  합이 13자만 입력 가능] 	--> medt_Str_Event.setIndex(0);
								, /^[0-9\s]{7}[A-Z0-9\s]{6}$/			// 02. 계약자코드 이면[숫자 7, (대문자,  숫자 6),  합이 13자만 입력 가능] 	--> medt_Str_Event.setIndex(1);
								, /^[A-Z\s]{1}[0-9\s]{11}$/				// 03. 청약번호 이면[대문자 1, 숫자 11  합이 12자만 입력 가능]  	--> medt_Str_Event.setIndex(2);
								, /^[A-Z0-9\s]{7}$/							// 04. 취급자코드 이면[대문자, 숫자 합이 7자만 입력 가능]  	--> medt_Str_Event.setIndex(3);
								, /^[A-Z0-9\s]{7}$/							// 05. 사용인코드 이면[대문자, 숫자 합이 7자만 입력 가능]  	--> medt_Str_Event.setIndex(4);
								, /^[A-Z0-9\s]{7}$/							// 06. 조직코드 이면[대문자, 숫자 합이 7자만 입력 가능]  	--> medt_Str_Event.setIndex(5);
							  //,/^[ㄱ-ㅎㅣ가-힣*\s]{8}$/  				// 07. 피보험자명, 계약자명[한글 8자, * 만 입력 가능]	--> medt_Str_Event.setIndex(6);
							]; 			// 07. 청약번호 이면 : 12자리
	var maxLength  = [13, 13, 12, 7, 7, 7];
	var chkIndex   = 0;
	medt_Str_Event = new wMaskEditObj(medt_Str, maskRegExp, maxLength, chkIndex);
 
	//대리점인지 여부(30:대리점,33:사용인,35:TM사용인) 
    if (util.getGdsValue("gUserDuty") == "30" || util.getGdsValue("gUserDuty") == "33" || util.getGdsValue("gUserDuty") == "35") {
		sAgncYn = "Y";	// 대리점 여부
 	}
	
   	// 공통 버튼 권한 설정 - |1.입력|2.수정|3.삭제|4.결재|5.취소|6.인쇄|7.엑셀   총 7개
	gfn_btnEnable(false, false, false, false, false, false, true);
	sToday = WebSquare.date.getCurrentServerDate("yyyyMMdd"); 		// global 현재일자
	//gsSysDate = WebSquare.date.getCurrentServerDate("yyyyMMdd"); 		// global 현재일자 
	
	// 장기보험 인수권한
	n22040Auth = nfn_checkAuthByID("ds_code", util.getGdsValue("gUserID"), "22040");
	 
	// DPM 인경우 권한 재조회.	2013.09.26
    if (util.getGdsValue("gUserDuty") == "49" || util.getGdsValue("gUserDuty") == "64" || util.getGdsValue("gUserDuty") == "66") {
        bAuthFlag = nfn_checkAuthByID("ds_code", util.getGdsValue("gUserID"), "34009");
    }
       
    bAuthFlag = true;
    
	if (bAuthFlag) { 
        cmb_Gubun.setValue("1");	 // 첫번째 조회조건 setting
        scwin.cmb_Gubun_OnCharChanged(obj, "", "");
    } else {
        cmb_Gubun.setValue("7");		// 취급자코드 셋팅
        scwin.cmb_Gubun_OnCharChanged("", "", "");
        cmb_Gubun.setDisabled(true);
        medt_Str.setDisabled(true);
        btn_Doer.setDisabled(true);
        medt_Str.setValue(util.getGdsValue("gUserID")); 	//본인 사원번호로 세팅
        cal_From.setValue(wconv.addDateSimple(sToday, -7));
        cal_To.setValue(sToday); 	//Mid(sToday,0,8);		
    }
 
    /* 2014.05.22 START [장기고도화-연금] 심사화면에서 O210_Pop1에서 청약조회시 넘어옴. */
   // if (window.top.gDs_LinkArg.getRowCount() != 0) {
    if (gds.gDs_LinkArg.getRowCount() != 0) {	 	// gDs_LinkArg가 존재하면 
        medt_Str.setValue(gds.gDs_LinkArg.getCellData(0, "sInsuredNo"));
        if (medt_Str.getValue().length > 0 && medt_Str.getValue().length != 13) {
            medt_Str.focus();
            return;
        }
        cmb_Gubun.setValue("1"); 	// 피보험자코드 셋팅
        gds.gDs_LinkArg.removeAll();
        scwin.lfn_Search(); // 계약기본사항을 조회한다.
    }
 
    //대리점인지
    //if(gUserDuty == "30" || gUserDuty == "33" || gUserDuty == "35"){
    if (false) {
        grd_PlanList.SetCellProp("body", 2, "mask", "");
        grd_PlanList.SetCellProp("body", 3, "mask", "");
        grd_PlanList.SetCellProp("body", 2, "Expr", "lfn_InrpsCd_display(sInrpsCd)");
        grd_PlanList.SetCellProp("body", 3, "Expr", "lfn_InrpsCd_display(sCrtorCd)");
    }

    //대리점인지 여부(30:대리점,33:사용인,35:TM사용인)
    if (util.getGdsValue("gUserDuty") == "30" || util.getGdsValue("gUserDuty") == "33" || util.getGdsValue("gUserDuty") == "35") {
        // 대리점일때 버튼 감추기.(3자통화 버튼 감추거나 disable 처리)
        btn_IvrInput.setDisabled(true);
    }
    
    btn_Doer.hide(); 		// 조직, 사용자 찾기 버튼 숨기기
	grd_PlanListExl.hide(); 	// 엑셀 다운로드 Grid 숨기기
	 
    //medt_Str.setValue("6603262927447"); 		// 계약자코드	// TEST @@@ ===>
    
//    cmb_Gubun.setValue("7"); 	// 취급자코드 셋팅 // TEST @@@ ===> 
//    medt_Str.setValue("5170058"); 		//  취급자코드: 5170058(정해인)  	// TEST @@@ ===> 
   // console.log("[/CBSC014M.xml] [init()] ==> [폼 로딩] [TEST_end]" );
};	
 
//---------------------------------------------------------------------------
// function 명 : lfn_Search
// 내용        : 조회버튼 클릭시 처리
//---------------------------------------------------------------------------
scwin.lfn_Search = function(e) { 
	//console.log("[/CBSC014M.xml] [lfn_Search()] ==> [조회버튼 클릭시 처리] [TEST_01]" );
	
	util.eventAsyncCall(this, scwin.lfn_Search_Sync, arguments);		// 비동기 방식 호출 
}

//---------------------------------------------------------------------------
// function 명 : lfn_Search_Sync
// 내용        : 비동기 방식 호출 처리
//---------------------------------------------------------------------------
scwin.lfn_Search_Sync = function(e) {
	//console.log("[/CBSC014M.xml] [lfn_Search_Sync()] ==> [조회버튼 클릭시 처리] [TEST_01]" );
	
    //특정그룹 설계금지
    if (gfn_isCA(util.getGdsValue("gUserID"), util.getGdsValue("gUserDuty"))) {
        wprom.alert("현재 상담그룹은 청약사항조회가 불가합니다.");
        return;
    }
 
	wconv.clear(Ds_PlanList);
	wconv.clear(Ds_PlanListCnt); 
 
    scwin.lfn_SearchData(1);		// 조회버튼 클릭시 처리 
 
  	// 전체 건수 얻어오기(Paging 처리)
	gfn_MakePagingData(Ds_Page, Ds_PlanListCnt.getCellData(0, "nCount"), "10", "10"); 
 
    Cmb_Page.setValue("1"); //----- End   
   // console.log("[/CBSC014M.xml] [lfn_Search()] ==> [조회버튼 클릭시 처리] [TEST_end]" );
};

//---------------------------------------------------------------------------
// function 명 : lfn_SearchData
// 내용        : 조회버튼 클릭시 처리
//---------------------------------------------------------------------------
scwin.lfn_SearchData = function(pageNo) {
	//console.log("[/CBSC014M.xml] [lfn_SearchData()] ==> [조회 처리] [TEST_01] [pageNo]"+ pageNo );
	
	var sStr;
 
    if(util.isNull(medt_Str.getValue()) == false) {
        if (cmb_Gubun.getValue() == "6") {			// 06. 조직코드 이면
            sStr = wconv.replace(medt_Str.getValue(), "-", "");
        } else {
            sStr = medt_Str.getValue();
        } 
    } else {
        sStr = edt_Str.getValue();
    }

	if(util.isNull(sStr)) {
		wprom.alert("조회조건을 입력하세요");
		return;
    }
    
	//대리점 or 설계사 인지
    if (util.getGdsValue("gUserDuty") == "30" || util.getGdsValue("gUserDuty") == "33" || util.getGdsValue("gUserDuty") == "35" 
    	|| util.getGdsValue("gUserDuty") == "48" || util.getGdsValue("gUserDuty") == "49" || util.getGdsValue("gUserDuty") == "50" 
    	|| util.getGdsValue("gUserDuty") == "62" || util.getGdsValue("gUserDuty") == "65" || util.getGdsValue("gUserDuty") == "64" 
    	|| util.getGdsValue("gUserDuty") == "66") { 
        if (cmb_Gubun.getValue() == "7" || cmb_Gubun.getValue() == "9") {
            if (gfn_chekDoerInqrAuth("DsWs_chekCrInqrAuth", sStr) == false) {	  //취급자조회시 권한 체크
                wprom.alert("조회 권한이 없습니다.");
                return;
            }
        } 
       
        if (cmb_Gubun.getValue() == "6") {	  //청약번호조회 권한 체크
            if (gfn_chekCrInqrAuth("DsWs_chekCrInqrAuth", "1", sStr) == false) {
                wprom.alert("조회 권한이 없습니다.");
                return;
            }
        }
	}   
   
   	var sTeamCd = scwin.getTeamCd();  	// 로그인 ID에 해당하는 팀코드 조회 처리 결과값 받기  
 
	var sJobCode = scwin.getJobCode();  	// 로그인 ID에 해당하는 잡코드 조회 처리 결과값 받기  
 
    var sAuthFlag = scwin.getAuthFlag200196();  	// 권한코드(200196)에 대한 권한 여부 조회 처리 결과값 받기 
 	//console.log("[/CBSC014M.xml] [lfn_SearchData()] ==> [TEST_03] [sStr]"+ sStr );
 	
	if (cmb_Gubun.getValue() == "6") {	// 청약번호 이면
		 if (nfn_checkAuthByID("ds_code", util.getGdsValue("gUserID"), "34009") && (sAuthFlag == "Y")) {        	 
            //직영 TM실 실장들 개별 조건 - 취급자로 조회시
            wconv.clear(Ds_Doer); 
         	     
			var MethodObj = new callService("com.inswave.longterm.com.com.task.AXR930Task", "getAgentList");  	// 01. 로그인 ID에 해당하는 팀코드 조회 Obj 
			MethodObj.setId("getAgentList");		// ID 셋팅
			MethodObj.setParam("sAgentCode",  sStr); //조직구조 
			MethodObj.setUrl("/contract/CBSC014MController.do");	 // 서버단 호출 URL
			MethodObj.addXPath("//*/ADMAC03");	// XPath
			MethodObj.addXPath("//WARNING");	// XPath
			MethodObj.sync();		// 동기 처리[기본(async:비동기)]
			MethodObj.send();		// 최종 전송 
			//console.log("[/CBSC014M.xml] [lfn_SearchData()] ==> [01. 로그인 ID에 해당하는 팀코드 조회_완료] [TEST_91]");  
		 
			util.interfaceKey(_tranSync.result.serviceDs); 		// interface 조회 후 Data 리스트 Display
		 
		 	Ds_Doer.setJSON(_tranSync.getDsJson("ADMAC03"));		// DS 셋팅(조회 결과)  
			DsWs_Warning.setJSON(_tranSync.getDsJson("WARNING"));		// DS 셋팅(조회 결과)  
			console.log("[/CBSC014M.xml] [lfn_SearchData()] ==> [I/F 조회 완료] [Ds_Doer, 갯수]"+ Ds_Doer.getRowCount() );  
			console.log("[/CBSC014M.xml] [lfn_SearchData()] ==> [Ds_Doer_갯수_3]"+ Ds_Doer.getRowCount() +"[Ds_Doer]"+ WebSquare.xml.serialize(Ds_Doer.getAllXML()) ); 
		     
			var sDoerTeamCd = Ds_Doer.getCellData(0, "sTeamCode");		// 팀코드
	 
            if (sDoerTeamCd != sTeamCd) {
                wprom.alert("직영TM 실장의 경우, 본인 소속 취급자로 조회해 주세요");
                return false;
            }
       	}
    }   
	//console.log("\n\n 		[/CBSC014M.xml] [lfn_SearchData()] ==> [M. 개인청약사항조회] [TEST_01] #############] =====> ");  
 
 	var sKeyDoer = "";
 	var sKeyDoerUser = "";
 	var sFrstDoerTeamCd = "";
  
	//대리점인지 여부(30:대리점,33:사용인,35:TM사용인)
    //설계자 여부 (48:DP, 49:DPM, 50:재정전문위원)
    if (util.getGdsValue("gUserDuty") == "30" || util.getGdsValue("gUserDuty") == "33" || util.getGdsValue("gUserDuty") == "35" 
    	|| util.getGdsValue("gUserDuty") == "48" || util.getGdsValue("gUserDuty") == "49" || util.getGdsValue("gUserDuty") == "50" 
    	|| util.getGdsValue("gUserDuty") == "62" || util.getGdsValue("gUserDuty") == "65" || util.getGdsValue("gUserDuty") == "64" 
    	|| util.getGdsValue("gUserDuty") == "66") {
       
        if (nfn_checkAuthByID("ds_code", util.getGdsValue("gUserID"), "21013")) { 	  //대리점 관리자
            sKeyDoer = util.getGdsValue("gDoer");
        } else if (nfn_checkAuthByID("ds_code", util.getGdsValue("gUserID"), "34009") && (sAuthFlag == "Y")) { 
            sFrstDoerTeamCd = sTeamCd;
        } else if (nfn_checkAuthByID("ds_code", util.getGdsValue("gUserID"), "34009")) { 
             sKeyDoer = "";
        } else if (nfn_checkAuthByID("ds_code", util.getGdsValue("gUserID"), "34011")) { 
            sKeyDoer = util.getGdsValue("gDoer");
        } else if (nfn_checkAuthByID("ds_code", util.getGdsValue("gUserID"), "34030") && (sJobCode == "200205")) {} else if (nfn_checkAuthByID("ds_code", util.getGdsValue("gUserID"), "34030")) {
       		sKeyDoer = util.getGdsValue("gDoer");	; //사용인
        } else {
          sKeyDoerUser = util.getGdsValue("gDoerUser"); 
        }
 
        if (nfn_checkAuthByID("ds_code", util.getGdsValue("gUserID"), "34024")) {	  //대면총무 
            sFrstDoerTeamCd = sTeamCd;
        }
    } 
 
  	wconv.clear(Ds_PlanList);
   
	var MethodObj = new callService("com.inswave.longterm.ssr.pln.task.DBB120Task", "getPlanList",  pageSize, pageNo);	// 개인청약사항조회 Obj
 	MethodObj.setId("getPlanList");	// ID 셋팅  
	MethodObj.setParam("gubun", cmb_Gubun.getValue());	// Param 셋팅(계약자코드) 
	MethodObj.setParam("sStr",	sStr);		//Param 셋팅(계약자코드)
	MethodObj.setParam("sInsurStrtdate", cal_From.getValue());	// 조회기간   
	MethodObj.setParam("sInsurEndDate",	cal_To.getValue());	 
	MethodObj.setParam("sPlanProgRankCd", cmb_PlanProg.getValue());	//Param 셋팅 (청약상태코드) 
	MethodObj.setParam("slevel",	slevel);			// Param 셋팅 
	MethodObj.setParam("sKeyDoer",	sKeyDoer);								// Param 셋팅
	MethodObj.setParam("sKeyDoerUser",	sKeyDoerUser);				// Param 셋팅 
	MethodObj.setParam("sFrstDoerTeamCd",	sFrstDoerTeamCd);		// Param 셋팅  
	MethodObj.setUrl("/contract/CBSC014MController.do");  // 서버단 호출 URL 
 	MethodObj.MsgShow();							// PROGRASSBAR 표시 
	MethodObj.setMsg("조회 중");    		 		// 동기, 비동기시 PROGRASSBAR에 표시할 메시지 셋팅  
	MethodObj.setXPath("//hashtable/data[@hashkey='lTIDA00ListDoc']/vector/data/LTIDA00");			// XPath
	MethodObj.addXPath("//hashtable/data[@hashkey='lTIDA00ListDocCnt']/LTIDA00CNT");		// XPath  
	MethodObj.addXPath("//*/WARNING");		// XPath
	MethodObj.sync();		// 동기 처리[기본(async:비동기)]
	MethodObj.send();		// 최종 전송  
 	//console.log("[/CBSC014M.xml] [lfn_SearchData()] ==> [01. 개인청약사항조회, 전송_완료] [TEST_91]")
 	 
	//util.interfaceKey(_tranSync.result.serviceDs); 		// interface 조회 후 Data 리스트 Display
	 
	Ds_PlanList.setJSON(_tranSync.getDsJson("LTIDA00"));				// 조회 DS 셋팅(조회 결과)  
	Ds_PlanListCnt.setJSON(_tranSync.getDsJson("LTIDA00CNT")); 	// 조회 전체 건수 DS 셋팅(조회 결과)  
 	DsWs_Warning.setJSON(_tranSync.getDsJson("WARNING"));  	// Warning DS 셋팅(조회 결과)  
 	//console.log("[/CBSC014M.xml] [lfn_SearchData()] ==> [I/F 조회 완료] [Ds_PlanListCnt, 조회수]"+ Ds_PlanListCnt.getRowCount() +"[Ds_PlanListCnt]"+ WebSquare.xml.serialize(Ds_PlanListCnt.getAllXML()) );  
	console.log("[/CBSC014M.xml] [lfn_SearchData()] ==> [I/F 조회 완료] [Ds_PlanList, 갯수]"+ Ds_PlanList.getRowCount() );  
	//console.log("[/CBSC014M.xml] [lfn_SearchData()] ==> [I/F 조회 완료] [Ds_PlanListCnt, 갯수]"+ Ds_PlanListCnt.getRowCount() );  
 		
	if (Ds_PlanListCnt.getRowCount() != 0) {
		wconv.copy(Ds_PlanListCntExl, Ds_PlanListCnt); 	  // Ds 복사
    }
	//console.log("[/CBSC014M.xml] [lfn_SearchData()] ==> [I/F 조회 완료] [Ds_PlanListCntExl, 갯수]"+ Ds_PlanListCntExl.getRowCount() +"[Ds_PlanListCntExl]"+ WebSquare.xml.serialize(Ds_PlanListCntExl.getAllXML()) ); 
    
  	if (DsWs_Warning.getRowCount() != 0) {
        wprom.alert(DsWs_Warning.getCellData(0, "msg"));
        return;
    }
    if (Ds_PlanList.getRowCount() == 0) {
        wprom.alert("청약사항 조회건이 없습니다.");
    }
 
	//고객정보 조회 이력쌓기
    gfn_LogCreditInfoVt(Ds_PlanList, "", "S", "sInrpsCd");
    gfn_LogCreditInfoVt(Ds_PlanList, "", "S", "sCrtorCd");
 
    //console.log("[/CBSC014M.xml] [lfn_SearchData()] ==> [TEST_end]" ); 
  };
     
//---------------------------------------------------------------------------
// function 명 : getJobCode()
// 내용        : 로그인 ID에 해당하는 잡코드 조회 처리
//--------------------------------------------------------------------------- 
scwin.getJobCode = function() { 
 
	//console.log("\n\n 		[/CBSC014M.xml] [getJobCode()] ==> [01. 로그인 ID에 해당하는 잡코드 조회] [TEST_01] #############] =====> ");  
 
	wconv.clear(Ds_JobCode);
     
	var MethodObj = new callService("com.inswave.longterm.dpt.com.task.FAF000Task", "getEmpName");  	// 01. 로그인 ID에 해당하는 잡코드  조회 Obj 
	MethodObj.setId("getEmpName");		// ID 셋팅 
	MethodObj.setParam("sEmpNo", util.getGdsValue("gUserID"));			// 조직구조 
	MethodObj.setUrl("/contract/CBSC014MController.do");  // // 서버단 호출 URL 
	MethodObj.addXPath("//*/ADMAB01");	// XPath
	MethodObj.addXPath("//WARNING");	// XPath
	MethodObj.sync();		// 동기 처리[기본(async:비동기)]
	MethodObj.send();		// 최종 전송 
	//console.log("[/CBSC014M.xml] [getJobCode()] ==> [01. 로그인 ID에 해당하는 팀코드 조회_완료] [TEST_91]");  
 
	//util.interfaceKey(_tranSync.result.serviceDs); 		// interface 조회 후 Data 리스트 Display    -> dsTest.setJSON(e.serviceDs.data[0].ADMAC01);
 
 	Ds_JobCode.setJSON(_tranSync.getDsJson("ADMAB01"));		// DS 셋팅(조회 결과)  
	DsWs_Warning.setJSON(_tranSync.getDsJson("WARNING"));		// DS 셋팅(조회 결과)
	//console.log("[/CBSC014M.xml] [getJobCode()] ==> [DS_갯수]"+ Ds_JobCode.getRowCount() +"[Ds_JobCode]"+ WebSquare.xml.serialize(Ds_JobCode.getAllXML()) ); 
     
    var sJobCode = Ds_JobCode.getCellData(0, "sJobCode");		// 잡코드
	//console.log("[/CBSC014M.xml] [getJobCode()] ==>  [TEST_end] [sJobCode]"+ sJobCode );  
    
	return sJobCode;
};

//---------------------------------------------------------------------------
// function 명 : getTeamCd()
// 내용        : 로그인 ID에 해당하는 팀코드 조회 처리
//--------------------------------------------------------------------------- 
scwin.getTeamCd = function() {  
	//console.log("\n\n 		[/CBSC014M.xml] [getTeamCd()] ==> [01. 로그인 ID에 해당하는 팀코드 조회] [TEST_01] #############] =====> ");  
 
	wconv.clear(Ds_Team);
     
	var MethodObj = new callService("com.inswave.longterm.com.com.task.AXR930Task", "getAgentList");  	// 01. 로그인 ID에 해당하는 팀코드 조회 Obj 
	MethodObj.setId("getAgentList");		// ID 셋팅 
	MethodObj.setParam("sAgentCode", util.getGdsValue("gUserID"));			// 조직구조 
	MethodObj.setUrl("/contract/CBSC014MController.do");  	// 서버단 호출 URL  
	MethodObj.addXPath("//*/ADMAC03");	// XPath
	MethodObj.addXPath("//WARNING");	// XPath
	MethodObj.sync();		// 동기 처리[기본(async:비동기)]
	MethodObj.send();		// 최종 전송 
	//console.log("[/CBSC014M.xml] [getTeamCd()] ==> [01. 로그인 ID에 해당하는 팀코드 조회_완료] [TEST_91]");  
 
	//util.interfaceKey(_tranSync.result.serviceDs); 		// interface 조회 후 Data 리스트 Display
 
 	Ds_Team.setJSON(_tranSync.getDsJson("ADMAC03"));		// DS 셋팅(조회 결과)  
	DsWs_Warning.setJSON(_tranSync.getDsJson("WARNING"));		// DS 셋팅(조회 결과)  
	//console.log("[/CBSC014M.xml] [getTeamCd()] ==> [DS_갯수_3]"+ Ds_Team.getRowCount() +"[Ds_Team]"+ WebSquare.xml.serialize(Ds_Team.getAllXML()) ); 
     
    var sTeamCd = Ds_Team.getCellData(0, "sTeamCode");		// 팀코드
	//console.log("[/CBSC014M.xml] [getTeamCd()] ==>  [TEST_end] [sTeamCd]"+ sTeamCd );  
    
	return sTeamCd;
};      

//---------------------------------------------------------------------------
// function 명 : getAuthFlag200196()
// 내용        : 권한코드(200196)에 대한 권한 여부 조회 처리
//---------------------------------------------------------------------------
scwin.getAuthFlag200196 = function() { 
	//console.log("\n\n 		[/CBSC014M.xml] [getAuthFlag200196()] ==> [01. 조직구조 조회] [TEST_01] #############] =====> ");  
 
	wconv.clear(Ds_TMAuth);
 		
	var MethodObj = new callService("com.inswave.longterm.pay.pdg.task.GAG021Task", "selectForAuthCheck");  	// 01. 권한코드(200196)에 대한 권한 여부 조회 Obj 
	MethodObj.setId("selectForAuthCheck");		// ID 셋팅
	MethodObj.setParam("nAuthType", "1");	
	MethodObj.setParam("nAuthID",  "200196");	 	// 권한ID
	MethodObj.setParam("sUserID", util.getGdsValue("gUserID"));			// 취급자 
	MethodObj.setUrl("/contract/CBSC014MController.do");  // URL 설정  
	MethodObj.addXPath("//*/GAG021");	// XPath
	MethodObj.addXPath("//WARNING");	// XPath
	MethodObj.sync();		// 동기 처리[기본(async:비동기)]
	MethodObj.send();		// 최종 전송 
	//console.log("[/CBSC014M.xml] [getAuthFlag200196()] ==> [01. 조직구조 조회_완료] [TEST_91]");  
 
	//util.interfaceKey(_tranSync.result.serviceDs); 		// interface 조회 후 Data 리스트 Display
 
 	Ds_TMAuth.setJSON(_tranSync.getDsJson("GAG021"));		// DS 셋팅(조회 결과)  
	DsWs_Warning.setJSON(_tranSync.getDsJson("WARNING"));		// DS 셋팅(조회 결과)  
    
    var sAuthFlag = Ds_TMAuth.getCellData(0, "sAuthFlag");	// 권한여부
   // console.log("[/CBSC014M.xml] [getAuthFlag200196()] ==> [TEST_92] [sAuthFlag]"+ sAuthFlag );   
    
    return sAuthFlag;
};   
 
//---------------------------------------------------------------------------
// function 명 : cmb_Gubun_OnClick()
// 내용        : 콤보값 변경시 처리
//--------------------------------------------------------------------------- 
scwin.cmb_Gubun_OnCharChanged = function() {
  	//console.log("[/CBSC014M.xml] [cmb_Gubun_OnCharChanged()] ==> [조회기준 콤보값 변경 이벤트] [TEST_01]" );  
 
    medt_Str.show();
    medt_Str.setDisabled(false);
    medt_Str.setValue(""); 
    
	cal_From.setValue("");		 
    cal_To.setValue("");		 
    cal_From.hide();		// 조회기간 달력 From
    cal_To.hide(); 		// 조회기간 달력 To 
    Static12.hide();		// 조회기간 Static 
	Static1.hide();			// ~ (조회기간)  Static  
    btn_IvrInput.hide();		// IVR 3자 통화를 위한 버튼 
    btn_Doer.hide(); 		// 조직, 사용자 찾기 버튼 숨기기
	 
    switch (cmb_Gubun.getValue()) {
    	case "1":	// 피보험자코드 이면	######-#ZZZZZZ
        	edt_Str.hide();
			medt_Str.show();    
			medt_Str_Event.setIndex(0);  	// medt_Str(InputBox) MaskEdit 정규식 입력 0번째(01. 피보험자코드)
			medt_Str.setPlaceholder("______-_______");		// Placeholder 설정   
            medt_Str.setDisplayFormat("######-#######"); 
           // btn_IvrInput.show();	// IVR 3자 통화를 위한 버튼 
            btn_Doer.hide();			// 사원찾기 팝업 버튼
            medt_Str.focus();		// focus 설정
			break;
			
//		case "2":	// 피보험자명 이면
//        	edt_Str.hide();
//			medt_Str.show();    
//			medt_Str_Event.setIndex(6);  	// medt_Str(InputBox) MaskEdit 정규식 입력 0번째(01. 피보험자코드)  
//			medt_Str.setPlaceholder("");		// Placeholder 설정
//        	medt_Str.setDisplayFormat(""); 
//            btn_Doer.hide();			// 사원찾기 팝업 버튼
//            medt_Str.focus();		// focus 설정
//			break;	
			  
  		case "3":	// 계약자코드 이면
            edt_Str.hide();
            medt_Str.show();  
            medt_Str_Event.setIndex(1);  	// medt_Str(InputBox) MaskEdit 정규식 입력 2번째(02. 계약자코드)
			medt_Str.setPlaceholder("______-_______");		// Placeholder 설정   
            medt_Str.setDisplayFormat("######-#######"); 
   			//btn_IvrInput.show();	// IVR 3자 통화를 위한 버튼 
   			btn_Doer.hide();			// 사원찾기 팝업 버튼
   			medt_Str.focus();		// focus 설정
            break; 
            
   		case "6":	// 청약번호 이면
            edt_Str.hide();
            medt_Str.show(); 
            medt_Str_Event.setIndex(2);  	// medt_Str(InputBox) MaskEdit 정규식 입력 0번째(03. 청약번호)     	 
         	medt_Str.setPlaceholder("_-____-_______");		// Placeholder 설정
       		medt_Str.setDisplayFormat("#-####-#######");   //	_-____-_______": 1-4-7
       		btn_Doer.hide();			// 사원찾기 팝업 버튼
       		medt_Str.focus();		// focus 설정
       		//console.log("[/CBSC014M.xml] [cmb_Gubun_OnCharChanged()] ==> [청약번호 이면] [cmb_Gubun.getValue()]"+ cmb_Gubun.getValue() );   
   		 break;
             
        case "7":		// 취급자코드 이면 
        	btn_Doer.show();	// 사원찾기 팝업 버튼
            edt_Str.hide();
            medt_Str.show();
        	medt_Str_Event.setIndex(3);  	// medt_Str(InputBox) MaskEdit 정규식 입력 0번째(04. 취급자코드)     	 
         	medt_Str.setPlaceholder("_______");		// Placeholder 설정
        	medt_Str.setDisplayFormat("#######"); 
        	cal_From.show();	// 조회기간 달력 From
            cal_To.show(); 
            var tmpDate1 = $w.dateAdd( sToday, -7 ); 	
          	cal_From.setValue(tmpDate1);   
            cal_To.setValue(sToday);  
            Static12.show();		// 조회기간 Static 
            Static1.show();		// ~ (조회기간)  Static
            cal_From.show();	// 조회기간 달력 From
            cal_To.show();		// 조회기간 달력 To
            btn_Doer.show(); 		// 조직, 사용자 찾기 버튼
            medt_Str.focus();		// focus 설정 
    		break;
    		
        case "9": 		// 사용인 이면 
        	btn_Doer.show();	// 사원찾기 팝업 버튼
            edt_Str.hide();
            medt_Str.show();
        	medt_Str_Event.setIndex(3);  	// medt_Str(InputBox) MaskEdit 정규식 입력 0번째(04. 취급자코드)     	 
         	medt_Str.setPlaceholder("_______");		// Placeholder 설정
        	medt_Str.setDisplayFormat("#######"); 
        	cal_From.show();	// 조회기간 달력 From
            cal_To.show(); 
            var tmpDate1 = $w.dateAdd( sToday, -7 ); 	
          	cal_From.setValue(tmpDate1);   
            cal_To.setValue(sToday);  
            Static12.show();		// 조회기간 Static 
            Static1.show();		// ~ (조회기간)  Static
            cal_From.show();	// 조회기간 달력 From
            cal_To.show();		// 조회기간 달력 To
            btn_Doer.show(); 		// 조직, 사용자 찾기 버튼 
            medt_Str.focus();		// focus 설정
    		break;
        
  		case "10":		// 조직코드 이면 
       		btn_Doer.show();
            edt_Str.hide();
            medt_Str.show();
        	medt_Str_Event.setIndex(5);  	// medt_Str(InputBox) MaskEdit 정규식 입력 0번째(06. 조직코드)     	 
         	medt_Str.setPlaceholder("_______");		// Placeholder 설정
         	medt_Str.setDisplayFormat("#######");
         	
         	cal_From.show();	// 조회기간 달력 From
            cal_To.show();
            var tmpDate1 = $w.dateAdd( sToday, -7 ); 	
          	cal_From.setValue(tmpDate1);   
            cal_To.setValue(sToday); 
            Static12.show();		// 조회기간 Static
            Static1.show();		// ~ (조회기간)  Static
            cal_From.show();	// 조회기간 달력 From
            cal_To.show();		// 조회기간 달력 To
            cmb_PlanProg.show();	// 청약상태 Combo 
            btn_Doer.show(); 		// 조직, 사용자 찾기 버튼 
            medt_Str.focus();		// focus 설정
            break;
         
        default:
            edt_Str.setValue("");
            edt_Str.show();
            medt_Str.hide();
            btn_Doer.hide(); 		// 조직, 사용자 찾기 버튼 
            break;
    }
    
    if (cmb_Gubun.getValue() == "7") {	 //취급자 조회면
        //대리점인지
        // DPM 인경우 권한 재조회.	2013.09.26
        if (util.getGdsValue("gUserDuty") == "30" || util.getGdsValue("gUserDuty") == "33" || util.getGdsValue("gUserDuty") == "35"
        	 || util.getGdsValue("gUserDuty") == "48" || util.getGdsValue("gUserDuty") == "50" || util.getGdsValue("gUserDuty") == "62" 
        	 || util.getGdsValue("gUserDuty") == "65") {
            medt_Str.setValue(util.getGdsValue("gDoer"));
            medt_Str.setDisabled(true);
            btn_Doer.setDisabled(true);
        }
    }
      
    if (medt_Str.visible(true)) {
        medt_Str.focus();
    } else {
        edt_Str.focus();
    }
};
 
//---------------------------------------------------------------------------
// function 명 : medt_Str_onkeydown()
// 내용        : keyDown시 처리
//---------------------------------------------------------------------------
scwin.medt_Str_onkeydown = function(e) {
	//console.log("[/CBSC014M.xml] [medt_Str_onkeydown()] ==> [keyDown시 처리] [TEST_01]" );  
		
	if (e.keyCode == 13 ) { 		// 엔터 키를 쳤으면
		 scwin.lfn_Search();
	} 
 }; 
	
//---------------------------------------------------------------------------
// function 명 : grd_PlanList_OnCellClick()
// 내용        : 그리드 클릭시 처리
//--------------------------------------------------------------------------- 
scwin.grd_PlanList_OnCellClick = function(row,col) {
	//console.log("[/CBSC014M.xml] [grd_PlanList_OnCellClick()] ==> [Grid 클릭 이벤트] [TEST_01] [col]"+ col ); 
 	
 	var nRow = row;
 	
    //2015.01.23 (N1501-00121)
    /*if(gfn_chekAcesCntrAuth(SOBJ_chekCrInqrAuth, DOBJ_chekCrInqrAuth, "DsWs_chekCrInqrAuth", "1", Ds_PlanList.getCellData(nRow, "sPlanNo")) == false){
 		alert("접근 권한이 없습니다.");
	 	return;
	}*/
    //END (N1501-00121)
 
    switch (grd_PlanList.getColumnID(col)) {
        case "sPlanProgRankCdName":		// '진행상태' 칼럼 이면
        	//console.log("[/CBSC014M.xml] [grd_PlanList_OnCellClick()] ==> [Grid 클릭 이벤트] ['진행상태' 칼럼 이면]" ); 
        	
            var sVvalue = Ds_PlanList.getCellData(nRow, "sPlanNo");	   //청약번호 
            var sBunsMetdDocuClsfCd = Ds_PlanList.getCellData(nRow, "sBunsMetdDocuClsfCd");	  //사업방법서 구분
         
            //대리점일때 권한 체크
            //DP, DPM일 때 권한체크 추가(N1301-00008:장기보험 신계약 대면프로세스 개발 요청)
            if (util.getGdsValue("gUserDuty") == "30" || util.getGdsValue("gUserDuty") == "33" || util.getGdsValue("gUserDuty") == "35" 
            	|| util.getGdsValue("gUserDuty") == "48" || util.getGdsValue("gUserDuty") == "49" || util.getGdsValue("gUserDuty") == "50" 
            	|| util.getGdsValue("gUserDuty") == "62" || util.getGdsValue("gUserDuty") == "65" || util.getGdsValue("gUserDuty") == "64" 
            	|| util.getGdsValue("gUserDuty") == "66") { 
                if (gfn_chekCrInqrAuth("DsWs_chekCrInqrAuth", "1", sVvalue) == false) {   //설계번호 권한 체크
                    wprom.alert("조회 권한이 없습니다.");
                    return;
                }
            }
        
            if ((Ds_PlanList.getCellData(nRow, "sPlanProgRankCd") == "52") || //인수요청
                (Ds_PlanList.getCellData(nRow, "sPlanProgRankCd") == "53") || //진단심사중
                (Ds_PlanList.getCellData(nRow, "sPlanProgRankCd") == "54") || //실사심사중
                (Ds_PlanList.getCellData(nRow, "sPlanProgRankCd") == "55") || //인수심사중
                (Ds_PlanList.getCellData(nRow, "sPlanProgRankCd") == "56") || //인수승인
                (Ds_PlanList.getCellData(nRow, "sPlanProgRankCd") == "57") || //인수불가
                (Ds_PlanList.getCellData(nRow, "sPlanProgRankCd") == "58")) {	    //조건부승인
           		//console.log("[/CBSC014M.xml] [grd_PlanList_OnCellClick()] ==> [Grid 클릭 이벤트] [TEST_04]" ); 
           		
         		var strHandlerID ="";
				if(!util.isNull(util.getGdsValue("gUserID"))) {   // 3. 로그인사번 존재하면
		  			strHandlerID = util.getGdsValue("gUserID");
		   		}
				if(!util.isNull(Ds_PlanList.getCellData(nRow, "sDoerUser"))) {   // 2. 취급자ID(사용인코드) 존재하면
		  			strHandlerID = Ds_PlanList.getCellData(nRow, "sDoerUser");
		   		}
		  		if(!util.isNull(Ds_PlanList.getCellData(nRow, "sDoer"))) {   // 1. 사용인ID(취급자코드)이 존재하면
		  			strHandlerID = Ds_PlanList.getCellData(nRow, "sDoer");
		   		}		
				//console.log("[/CBSC111M.xml] [grd_PlanList_OnCellClick()] ==> [진행상태 이면] [TEST_91] [팝업 전] [strHandlerID]"+ strHandlerID );
		            		 
		  		var promise = Promise.resolve();   // Promise 설정
			
			    promise = promise.then(function(rtnVal) { 
			     	var arg = {"sPlanNo": Ds_PlanList.getCellData(nRow, "sPlanNo")
				              	 ,"rqstFlag": "56"	 		//요청승인구분(52:인수요청  56:인수승인)
				                 ,"sOnlySrarch": "1"	 
				                  ,"sHandlerID": strHandlerID		// Handler ID[우선순위(1. 사용인ID, 2. 취급자ID, 3. 로그인사번): 추가(2017.12.04)]
				               };	 // 팝업 창으로 보낼 자료 
				                		               
					var popInfo = {
						"width"     : 1320,
						"height"    : 800,
						"top"       : 0,
						"left"      : 0,
						"indata"    : arg,		 //indata
						"callback"  : "",
						"title"     : "인수심사결재"
					};
					//return wprom.popupOpen("/ui/cbsc/CBSC084P.xml", popInfo);		// 인수심사결재 팝업 처리 ==> 인수심사결재[O210_Pop1]
					return wprom.windowOpen("/ui/cbsc/CBSC084P.xml", popInfo);	// 인수심사결재 팝업 처리 ==> 인수심사결재[O210_Pop1] 
			    });	 // end of promise()
			    
			    promise = promise.then(function(rst) { 
			        if (wconv.length(rst) != 0) { 
			        }
			    });	 // end of promise()
			}
            break;
            
        case "sPlanNo":	// '청약번호' 칼럼 이면
        	//console.log("[/CBSC014M.xml] [grd_PlanList_OnCellClick()] ==> ['청약번호' 칼럼] [TEST_02_1]" ); 
        	
            var sVvalue = Ds_PlanList.getCellData(nRow, "sPlanNo");  //청약번호
            var sBunsMetdDocuClsfCd = Ds_PlanList.getCellData(nRow, "sBunsMetdDocuClsfCd"); 	//사업방법서 구분			
            var sBunsMetdClsfCd = Ds_PlanList.getCellData(nRow, "sBunsMetdClsfCd");  //화재저축 구분
            //console.log("[/CBSC014M.xml] [grd_PlanList_OnCellClick()] ==> ['청약번호' 칼럼] [TEST_03]" ); 
             
            //대리점일때 권한 체크
            //DP, DPM일 때 권한체크 추가(N1301-00008:장기보험 신계약 대면프로세스 개발 요청)
            if (util.getGdsValue("gUserDuty") == "30" || util.getGdsValue("gUserDuty") == "33" || util.getGdsValue("gUserDuty") == "35" || util.getGdsValue("gUserDuty") == "48" || util.getGdsValue("gUserDuty") == "49" || util.getGdsValue("gUserDuty") == "50" || util.getGdsValue("gUserDuty") == "62" || util.getGdsValue("gUserDuty") == "65" || util.getGdsValue("gUserDuty") == "64" || util.getGdsValue("gUserDuty") == "66") {
                //설계번호 권한 체크
                if (gfn_chekCrInqrAuth("DsWs_chekCrInqrAuth", "1", sVvalue) == false) {
                    wprom.alert("조회 권한이 없습니다.");
                    return;
                }
            }
       
            //대면/배대면 채널별 처리 구분 (N1301-00008:장기보험 신계약 대면프로세스 개발 요청)
            //심사자 권한은 제외
            if (nfn_checkAuthByID("ds_code", util.getGdsValue("gUserID"), "22040") == false) {
                if (gfn_checkFaceSales(util.getGdsValue("gFaceSalesYN"), Ds_PlanList.getCellData(nRow, "sScanObjtYn")) == false) {
                    if (util.getGdsValue("gFaceSalesYN") == "Y") {
                        wprom.alert("비대면 채널로 설계한 청약입니다. 상담원시스템으로 로그인하세요.");
                    } else {
                        wprom.alert("대면 채널로 설계한 청약입니다. 장기보험시스템으로 로그인하세요.");
                    }
                    return false;
                }
            }
           // console.log("[/CBSC014M.xml] [grd_PlanList_OnCellClick()] ==> ['청약번호' 칼럼] [TEST_05] [청약번호(Ds_PlanList.sPlanNo)]"+ Ds_PlanList.getCellData(row, "sPlanNo") ); 
  			  	
 			var popInfo = {};
  			var oDsJson=[{"PrigId":"CBSC014M"
              		, "sInsuredNo": Ds_PlanList.getCellData(row, "sPlanNo")		// 청약번호
              		, "sKey": Ds_PlanList.getCellData(row, "sPlanNo") 				// 청약번호
       			 }];  		// 필드 Json에 담기(gDs_LinkArg 함수 사용)

	 		gds.gDs_LinkArg.setJSON(oDsJson);
	       									 
  			if(wconv.substr(Ds_PlanList.getCellData(nRow,"sInrpsCd"),7,6) == "000000"){  		// 추가: 2017.11.07, by 진태만 
//				if(parent.Id == "global"){
//					if(  sBunsMetdDocuClsfCd == "3" || sBunsMetdClsfCd == "1"){
//						UserNotify(5, sVvalue);
//					} else if(sBunsMetdDocuClsfCd == "7") {	//장기보험고도화-연금청약화면 이동
//						UserNotify(6, sVvalue);	// 청약번호로 연금청약 link
//					}else{
//						UserNotify(7, sVvalue);  
//					}
//				}else{			 
					if (sBunsMetdDocuClsfCd == "3" || sBunsMetdClsfCd == "1") { 
						//gfn_OpenLinkPage("B030");
						gfn_OpenLinkPage("CBSC094M");		// 재물청약설계(/CBSC094M.xml, /B030.xml)     
					}else if(sBunsMetdDocuClsfCd == "7"){	//장기보험고도화-연금청약화면 이동
						//gfn_OpenLinkPage("C020");
						 gfn_OpenLinkPage("CBSC073M");		// 연금간편설계	(/CBSC073M.xml, /C020.xml)
					}else{
						//gfn_OpenLinkPage("B020"); //8500
						gfn_OpenLinkPage("CBSC012M"); 	 // 개인간편설계(/CBSC012M.xml,  /B020.xml))
					}
				//}
	 
			}else{ 
//				if(parent.Id == "global"){
//					if(  sBunsMetdDocuClsfCd == "3" || sBunsMetdClsfCd == "1"){
//						UserNotify(2, sVvalue);
//					} else if(sBunsMetdDocuClsfCd == "7") {	//장기보험고도화-연금청약화면 이동
//						UserNotify(4, sVvalue);	// 청약번호로 연금청약 link
//					}else{
//						UserNotify(0, sVvalue);  
//					}
//				}else{

//					var popInfo = {};
//   					var oDsJson=[{"PrigId":"CBSC014M"
//                		, "sInsuredNo": Ds_PlanList.getCellData(row, "sPlanNo")		// 청약번호
//                		, "sKey": Ds_PlanList.getCellData(row, "sPlanNo") 				// 청약번호
//         			 }];  		// 필드 Json에 담기(gDs_LinkArg 함수 사용)
//
//	       			gds.gDs_LinkArg.setJSON(oDsJson);
		  
					if (sBunsMetdDocuClsfCd == "3" || sBunsMetdClsfCd == "1") { 
						//gfn_OpenLinkPage("B030");
						gfn_OpenLinkPage("CBSC094M");		// 재물청약설계(/CBSC094M.xml, /B030.xml)         	
					}else if(sBunsMetdDocuClsfCd == "7"){	//장기보험고도화-연금청약화면 이동
						//gfn_OpenLinkPage("C010");
						 gfn_OpenLinkPage("CBSC075M");		// 연금청약설계(/CBSC075M.xml, /C010.xml)
					}else{
						//gfn_OpenLinkPage("B010"); //8500
						gfn_OpenLinkPage("CBSC015M"); 	 		// 개인청약설계(/CBSC015M.xml, 개인청약(/B010.xml))
					}
					//gfn_OpenLinkPage("B010"); //8500				
				//}
			}  
            //lfn_Search();
            break;
            
        case "sCrNo":		// '계약번호' 칼럼 이면
    		//console.log("[/CBSC014M.xml] [grd_PlanList_OnCellClick()] ==> ['계약번호' 칼럼] [TEST_02_1]" ); 
        		
            var sCrNo = Ds_PlanList.getCellData(nRow, "sCrNo"); //계약번호
            
            //대리점일때 권한 체크
            if (util.getGdsValue("gUserDuty") == "30" || util.getGdsValue("gUserDuty") == "33" || util.getGdsValue("gUserDuty") == "35" || util.getGdsValue("gUserDuty") == "48" || util.getGdsValue("gUserDuty") == "49" || util.getGdsValue("gUserDuty") == "50" || util.getGdsValue("gUserDuty") == "62" || util.getGdsValue("gUserDuty") == "65" || util.getGdsValue("gUserDuty") == "64" || util.getGdsValue("gUserDuty") == "66") {
                if (gfn_chekCrInqrAuth("DsWs_chekCrInqrAuth", "2", sCrNo) == false) {	  //계약번호 권한 체크
                    wprom.alert("조회 권한이 없습니다.");
                    return;
                }
            }
            
            if (wconv.length(sCrNo) > 0) { 
            
   				var oDsJson=[{"PrigId":"CBSC014M"
			                		, "sCrNo": sCrNo
			                		, "sScrnId":  "B010"
			         				}];  		// 필드 Json에 담기(gDs_LinkArg 함수 사용)

		        window.top.util.jSonDsCreate(oDsJson, "gDs_LinkArg");      
  
	        	gfn_OpenLinkPage("CBSC028M");		// 계약사항상세내역(/CBSC028M.xml, /D020.xm) 
	        }
            break;
            
        case "sImagJugmResltNm":		// '스캔상태' 칼럼 이면
      		//console.log("[/CBSC014M.xml] [grd_PlanList_OnCellClick()] ==> ['스캔상태' 칼럼] [TEST_02_1]" ); 
      	  
            var sVvalue = Ds_PlanList.getCellData(nRow, "sPlanNo");   //청약번호
            var sBunsMetdDocuClsfCd = Ds_PlanList.getCellData(nRow, "sBunsMetdDocuClsfCd");   //사업방법서 구분
            
            //대리점일때 권한 체크
            //DP, DPM일 때 권한체크 추가(N1301-00008:장기보험 신계약 대면프로세스 개발 요청)
            if (util.getGdsValue("gUserDuty") == "30" || util.getGdsValue("gUserDuty") == "33" || util.getGdsValue("gUserDuty") == "35" 
            	|| util.getGdsValue("gUserDuty") == "48" || util.getGdsValue("gUserDuty") == "49" || util.getGdsValue("gUserDuty") == "50" 
            	|| util.getGdsValue("gUserDuty") == "62" || util.getGdsValue("gUserDuty") == "65" || util.getGdsValue("gUserDuty") == "64" 
            	|| util.getGdsValue("gUserDuty") == "66") {
                
                if (gfn_chekCrInqrAuth("DsWs_chekCrInqrAuth", "1", sVvalue) == false) {		 //설계번호 권한 체크
                    wprom.alert("조회 권한이 없습니다.");
                    return;
                }
            }
           
            if ((Ds_PlanList.getCellData(nRow, "sImagJugmResltNm") != "")) {  
        		var oDsJson=[{"PrigId":"CBSC014M"
			                		, "sPlanNo": Ds_PlanList.getCellData(nRow, "sPlanNo")
			                		, "sScrnId":  "B010"
			         				}];  		// 필드 Json에 담기(gDs_LinkArg 함수 사용)
		 
		        window.top.util.jSonDsCreate(oDsJson, "gDs_LinkArg");     
		    
				var arg = {"sPlanNo": Ds_PlanList.getCellData(nRow, "sPlanNo")
		               ,"rqstFlag": "56"	 		//요청승인구분(52:인수요청  56:인수승인)
		                 ,"sOnlySrarch": "1"	 
		               };	 // 팝업 창으로 보낼 자료 
         
		        var popInfo = {
				"width"     : 835,		// 수정(width, height): 2017.11.10, by 진태만   --> 612, 300
				"height"    : 280,
				"indata"    : arg,		 //indata
				"callback"  : "",
				"title"     : "인수심사결재"
			};
			 
		 	 //Open("uwt_uwm::O311.xml", arg, 612, 300);    //C BSC109P	청약서 이미지 심사결과 
			return wprom.popupOpen("/ui/cbsc/CBSC109P.xml", popInfo);		// 인수심사결재 팝업 처리 ==> 인수심사결재[O210_Pop1]  
      	}
    	break;
            
        default:
            break;
    }
};

//**************************************************************************************************
// 페이징 처리 - 페이지 콤보 박스(Paging 처리 시작)
//**************************************************************************************************
scwin.Cmb_Page_OnChanged = function(info) { 
    scwin.lfn_SearchData(info.newValue);
};

//**************************************************************************************************
// 페이징 처리 - 이전 페이지 리스트
//**************************************************************************************************
scwin.Btn_PreV_OnClick = function(obj) { 
	var ftVal = wconv.toNumber(Ds_Page.getCellData(0, "FILTERCD")) - 1;
    if (wconv.toNumber(maxFilterVal) < wconv.toNumber(ftVal)) {
        wprom.alert("조회의 처음입니다.");
        return;
    } else if (wconv.toNumber(ftVal) < 1) {
        wprom.alert("조회의 처음입니다.");
        return;
    }
    wconv.filter(Ds_Page, "FILTERCD=='" + ftVal + "'", true);
    Cmb_Page.setValue(Ds_Page.getCellData(0, "CODE"));
    scwin.lfn_SearchData(Cmb_Page.getValue());
};

//**************************************************************************************************
// 페이징 처리 - 이전 페이지
//**************************************************************************************************
scwin.Btn_Pre_OnClick = function(obj) { 
	var Idx = Cmb_Page.getValue();
    if (wconv.toNumber(Idx) - 1 < 1) {
        wprom.alert("조회의 처음입니다.");
        return;
    }
    scwin.lfn_SearchData(wconv.toString(wconv.toNumber(Idx) - 1));
    if (Ds_Page.getCellData(0, "CODE") == Idx) {
        wconv.filter(Ds_Page, "FILTERCD=='" + wconv.toString(wconv.toNumber(Ds_Page.getCellData(0, "FILTERCD")) - 1) + "'", true);
        Cmb_Page.setValue(Ds_Page.getCellData((Ds_Page.getRowCount() - 1), "CODE"));
    } else {
        Cmb_Page.setValue(wconv.toNumber(Idx) - 1);
	}
};

//**************************************************************************************************
// 페이징 처리 - 다음 페이지
//**************************************************************************************************
scwin.Btn_Next_OnClick = function(obj) {
 
	var Idx = Cmb_Page.getValue();
	 	
	if (wconv.toNumber(maxPage) < wconv.toNumber(Idx) + 1) {
		wprom.alert("더이상 자료가 존재하지 않습니다");
		return;
	}
	 
	scwin.lfn_SearchData(wconv.toString(wconv.toNumber(Idx) + 1));
 
	if (Ds_Page.getCellData((Ds_Page.getRowCount() - 1), "CODE") == Idx) {
		wconv.filter(Ds_Page, "FILTERCD=='" + wconv.toString(wconv.toNumber(Ds_Page.getCellData((Ds_Page.getRowCount() - 1), "FILTERCD")) + 1) + "'", true);
	}
	Cmb_Page.setValue(wconv.toNumber(Idx) + 1); 
};

//**************************************************************************************************
// 페이징 처리 - 다음 페이지 리스트(Paging 처리 끝)
//**************************************************************************************************
scwin.Btn_NextV_OnClick = function(obj) { 
	var ftVal = wconv.toNumber(Ds_Page.getCellData((Ds_Page.getRowCount() - 1), "FILTERCD")) + 1;
    if (wconv.toNumber(maxFilterVal) < wconv.toNumber(ftVal)) {
        wprom.alert("더이상 자료가 존재하지 않습니다");
        return;
    }
    wconv.filter(Ds_Page, "FILTERCD=='" + ftVal + "'", true);
    Cmb_Page.setValue(Ds_Page.getCellData(0, "CODE"));
    scwin.lfn_SearchData(Cmb_Page.getValue());
};

//---------------------------------------------------------------------------
// function 명 : lfn_cmb_linkMenu_OnChanged
// 내용        : 링크페이지 선택시 Event처리
//---------------------------------------------------------------------------
scwin.lfn_cmb_linkMenu_OnChanged = function(obj, strCode, strText, nOldIndex, nNewIndex) {
    gfn_OpenLinkPage(strCode);
};

//---------------------------------------------------------------------------
// function 명 : lfn_SearchDoer_OnClick()
// 내용        : 조회조건 버튼 클릭시 처리: 버튼 클릭 이벤트: 조회 기준(사원찾기, 조직 찾기) 팝업
//---------------------------------------------------------------------------
scwin.lfn_SearchDoer_OnClick = function(obj) {
	//console.log("[/CBSC014M.xml] [lfn_SearchDoer_OnClick()] ==> [조회조건 버튼 클릭시 처리] [TEST_01] [cmb_Gubun.getValue()"+ cmb_Gubun.getValue() );
 
    if (cmb_Gubun.getValue() == "10") {  	// 조회 기준(사원찾기, 조직 찾기) 콤보가 '조직찾기' 이면 
    		 
   		var promise = Promise.resolve(); 
   		var sTeamCd = scwin.getTeamCd();  	// 로그인 ID에 해당하는 팀코드 조회 처리 결과값 받기 
    	var sAuthFlag = scwin.getAuthFlag200196();  // 권한코드(200196)에 대한 권한 여부 조회 처리 결과값 받기 
  
 	  	promise = promise.then(function(result) {
		    var sArg = {};
			var popInfo = {
					"width"     : 730,
					"height"    : 500,  
					"callback"  : "",
					"title"     : "조직 찾기",
				};
				return wprom.popupOpen("/ui/cbso/CBSO020P.xml", popInfo);		// 조직 찾기 팝업 처리[/com_pop::0120.xml]
   		});
 
    	promise = promise.then(function(result) { 
	  		//console.log("[/CBSC111M.xml] [btn_Doer_onclick()] ==> [조직 찾기] [result.length]"+ result.length );  
	 		
	 		if(result.length > 0 ) {
	 			var arrRst = result.split("^");
	 			
				if (wconv.length(arrRst) != 0) { 
	                //console.log("[/CBSC111M.xml] [btn_Doer_onclick()] ==> [조직 찾기] [arrRst[0]]"+ arrRst[0] +"[arrRst[1]]"+ arrRst[1] +"[arrRst[2]]"+ arrRst[2] );  
	                
	                if (sAuthFlag == "Y" && (sTeamCd != arrRst[0])) {
	                    wprom.alert("직영TM 실장의 경우, 본인 소속 TM실을 선택해주세요.");
	                    medt_Str.setValue("");
	                    slevel = "";
	                } else { 
	                	medt_Str.setValue(arrRst[0]);
						slevel  = arrRst[2]; 
	                }
	            }
            }
        }); 
        
    } else if (cmb_Gubun.getValue() == "7" ||  cmb_Gubun.getValue() == "9") {  	// 조회 기준(사원찾기, 조직 찾기) 콤보가 '취급자코드', '사용인' 이면  
	     var promise = Promise.resolve();
	 	
	    promise = promise.then(function(result) { 
			var popInfo = {
					"width"     : 660,
					"height"    : 430, 
					"callback"  : "",
					"title"     : "사원찾기",
				};
				return wprom.popupOpen("/ui/cbso/CBSO015P.xml", popInfo);			// 사원 찾기 팝업 처리[/popup::R960_Pop.xml]
	    });
	 
	    promise = promise.then(function(result) {
	        var arrRst = result.split("^"); 
			medt_Str.setValue(arrRst[0]);		// 사원코드
	    }); 
    } 
};
 
//---------------------------------------------------------------------------
// function 명 : medt_Str_OnCharChanged
// 내용        : 계약자코드조회시 
//---------------------------------------------------------------------------
scwin.medt_Str_OnCharChanged = function(obj, strPreText, strPostText) {
    if (cmb_Gubun.getValue() == 3) {
        if (wconv.Length(medt_Str.getValue()) == 10) {
            if (isBizRegNo(medt_Str.getValue())) {
                medt_Str.setDisplayFormat("###-##-#####");
            } else {
                medt_Str.setDisplayFormat("######-#ZZZZZZ");
            }
        }
    }
};

//---------------------------------------------------------------------------
// function 명 : medt_Str_OnKillFocus
// 내용        : 계약자코드OnKillFocus시 처리
//---------------------------------------------------------------------------
scwin.medt_Str_OnKillFocus = function(obj) {
    scwin.medt_Str_OnCharChanged();
};

//---------------------------------------------------------------------------
// function 명 : medt_Str_OnKillFocus
// 내용        : 계약자코드OnKillFocus시 처리
//---------------------------------------------------------------------------
scwin.medt_Str_OnFocus = function(obj) {
    if (cmb_Gubun.getValue() == 3) {
        medt_Str.setDisplayFormat("######-#ZZZZZZ");
    }
};

//---------------------------------------------------------------------------
// function 명 : lfn_InrpsCd_display
// 내용        : 주민번호 "*"처리
//---------------------------------------------------------------------------
scwin.lfn_InrpsCd_display = function(sInrpsCd) {
    //대리점인지
    //if(gUserDuty == "30" || gUserDuty == "33" || gUserDuty == "35"){
    if (false) {
        smask = "######-#******";
        if (wconv.Length(sInrpsCd) == 10) {
            smask = "###-##-*****";
        }
        return gfn_convert_mask(sInrpsCd, smask);
    } else {
        return sInrpsCd;
    }
};

//---------------------------------------------------------------------------
// function 명 : Btn_IVR_OnClick
// 내용        :  IVR 3자 통화를 위한 버튼 이벤트 발생
// param 
// 1: (J : 주민등록번호, C : 카드번호, A : 계좌번호)
// 2: lfn_IVR_CallBack (콜백 함수명)
// 3 : ""  (콜백 받는 변수명 1)
// 4 : nRow (콜백 받는 변수명 2)
//---------------------------------------------------------------------------
scwin.Btn_IVR_OnClick = function(obj, nRow) {
	
	ivrOpenPop ("J", "", "lfn_IVR_CallBack", "", ""); 	// IVR 3자 통화 팝업 호출  (J : 주민등록번호, C : 카드번호, A : 계좌번호) 
    // obj는 결과값을 셋팅할 fieldName				
};

//---------------------------------------------------------------------------
// function 명 : lfn_IVR_CallBack
// 내용        :  IVR 콜백함수
//---------------------------------------------------------------------------
scwin.lfn_IVR_CallBack = function(id, nRow, val) {
    if (wconv.Length(val) > 0) {
        medt_Str.setValue(val);
    }
};

//---------------------------------------------------------------------------
// function 명 : lfn_SlctYnCheckColor
// 내용        : 스캔여부로 채널별 선택가능여부 체크 후 컬러 지정
//---------------------------------------------------------------------------
scwin.lfn_SlctYnCheckColor = function(sScanObjtYn) {
    var sColor = "user27";
    if (gfn_checkFaceSales(gFaceSalesYN, sScanObjtYn) == false) {
        sColor = "User25";
    }
    return sColor;
};

scwin.lfn_PlanProgRankCheck = function(CurRow) {
    var rslt = 0;
    if ((Ds_PlanList.getCellData(CurRow, "sPlanProgRankCd") == "52") || //인수요청
        (Ds_PlanList.getCellData(CurRow, "sPlanProgRankCd") == "53") || //진단심사중
        (Ds_PlanList.getCellData(CurRow, "sPlanProgRankCd") == "54") || //실사심사중
        (Ds_PlanList.getCellData(CurRow, "sPlanProgRankCd") == "55") || //인수심사중
        (Ds_PlanList.getCellData(CurRow, "sPlanProgRankCd") == "56") || //인수승인
        (Ds_PlanList.getCellData(CurRow, "sPlanProgRankCd") == "57") || //인수불가
        (Ds_PlanList.getCellData(CurRow, "sPlanProgRankCd") == "58")) {
        //조건부승인
        rslt = 1;
    }
    return rslt;
};

//---------------------------------------------------------------------------
// function 명 : lfn_ScanSimsaCheck
// 내용        : 스캔심사여부
//---------------------------------------------------------------------------
scwin.lfn_ScanSimsaCheck = function(CurRow) {

    var rslt = 0;
    if ((Ds_PlanList.getCellData(CurRow, "sImagJugmResltNm") != "")) {
        // 스캔심사 진행여부
        rslt = 1;
    }
    return rslt;
};
 
//---------------------------------------------------------------------------
// function 명 : lfn_excel
// 내용        : 엑셀
//--------------------------------------------------------------------------- 
scwin.cm_btnExDown = function(){	
	var sRslt = "";		
	var option={};
	var infoArr = {}; 	
 
	scwin.lfn_ExelSearchData(1); 	// 엑셀 다운로드 조회
 	
	option.fileName= "청약사항조회.xlsx";		// 파일명  Ds_PlanListExl2
	console.log("[/CBSC014M.xml] [cm_btnExDown()] ==> [엑셀 다운로드할 총 건수(Ds_PlanListExl2.getRowCount()]"+ Ds_PlanListExl2.getRowCount() );	   
	 	
 	if (Ds_PlanListExl2.getRowCount() > 0) {   
		for (var i = 0; i < Ds_PlanListExl2.getRowCount(); i++) { 		// 재가공 해야하는 데이타는 for 돌면서 Ds_PlanListExl2.setCellData를 해줘야 다운로드된 엑셀에서 데이타 보임
			var sPlanNo = Ds_PlanListExl2.getCellData(i, "sPlanNo");   	// 청약번호 
			var sInrpsCd = Ds_PlanListExl2.getCellData(i, "sInrpsCd");   	// 피보험자코드 
			var sInrpsName = Ds_PlanListExl2.getCellData(i, "sInrpsName");     
			var sCrtorCd = Ds_PlanListExl2.getCellData(i, "sCrtorCd");	 	// 계악자코드 
	 		var sInsurEndDate = Ds_PlanListExl2.getCellData(i, "sInsurEndDate");   
			var sSsrtDate = Ds_PlanListExl2.getCellData(i, "sSsrtDate");		// 청약일 
			var sApplyPrtDate = Ds_PlanListExl2.getCellData(i, "sApplyPrtDate");	// 발행일 
			var sInsurStrtdate = Ds_PlanListExl2.getCellData(i, "sInsurStrtdate");		// 수납확정일
			var sCrNo = Ds_PlanListExl2.getCellData(i, "sCrNo"); //계약번호 
			//console.log("[/CBSC014M.xml] [lfn_ExelSearchData()] ==> [엑셀 다운로드] [TEST_50] [sCrtorCd]"+ sCrtorCd +"[sInrpsCd]"+ sInrpsCd +"[sInrpsName]"+ sInrpsName );
	 	 
			if(!util.isNull(sPlanNo)) {		// Grid에서 칼럼이 '청약번호'(2번째 칼럼) 이면   
				sRslt = wconv.substr(sPlanNo, 0, 1) + "-"+  wconv.substr(sPlanNo, 1, 5) + "-"+  wconv.substr(sPlanNo, 6, 7);			 
				Ds_PlanListExl2.setCellData( i , "sPlanNo", sRslt);
			 	//console.log("[/CBSC014M.xml] [lfn_getColumnValueExcel()] ==> [Grid에서 칼럼이 '청약번호' 이면] [sRslt]"+ sRslt ); 
		 	} 		 	
			if(!util.isNull(sInrpsCd)) {		// Grid에서 칼럼이 '피보험자코드'(2번째 칼럼) 이면    
				if (wconv.length(sInrpsName) > 0) {  
					sRslt = gfn_changeMask(sInrpsCd, 1);		 // 마스크 처리[1. 주민번호: 뒷번호 6자리] 
				} else {
					sRslt = ""; 
				}	  
				Ds_PlanListExl2.setCellData( i , "sInrpsCd", sRslt);
				//console.log("[/CBSC014M.xml] [lfn_getColumnValueExcel()] ==> [Grid에서 칼럼이 '피보험자코드' 이면] [sRslt]"+ sRslt ); 
		 	} 		 	
		 	if(!util.isNull(sCrtorCd)) {		// Grid에서 칼럼이 '계악자코드(3번째 칼럼) 이면  
				if (wconv.length(sInrpsName) > 0) {  
					sRslt = gfn_changeMask(sInrpsCd, 1);		 // 마스크 처리[1. 주민번호: 뒷번호 6자리] 
				} else {
					sRslt = ""; 
				}	  
				Ds_PlanListExl2.setCellData( i , "sCrtorCd", sRslt);
				//console.log("[/CBSC014M.xml] [lfn_getColumnValueExcel()] ==> [Grid에서 칼럼이 '계악자코드' 이면] [sRslt]"+ sRslt ); 
		 	} 		 
			if(!util.isNull(sSsrtDate)) {// Grid에서 칼럼이  '청약일/발행일'(5번째 칼럼) 이면 
				sRslt = wconv.substr(sSsrtDate, 0, 4) +"-"+ wconv.substr(sSsrtDate, 4, 2) +"-"+  wconv.substr(sSsrtDate, 6, 2)
					 		 +"/"+ wconv.substr(sApplyPrtDate, 0, 4) +"-"+ wconv.substr(sApplyPrtDate, 4, 2) +"-"+  wconv.substr(sApplyPrtDate, 6, 2);			// 청약일/발행일		
			  	Ds_PlanListExl2.setCellData( i , "sSsrtDate", sRslt);
			  	//console.log("[/CBSC014M.xml] [lfn_getColumnValueExcel()] ==> [Grid에서 칼럼이 '청약일/발행일' 이면] [sRslt]"+ sRslt ); 
			 } 
			 if(!util.isNull(sInsurStrtdate)) {// Grid에서 칼럼이  '청약일/발행일'(5번째 칼럼) 이면 
				if (wconv.length(sCrNo) > 0) { 
					sRslt = wconv.substr(sInsurStrtdate, 0, 4) +"-"+ wconv.substr(sInsurStrtdate, 4, 2) +"-"+  wconv.substr(sInsurStrtdate, 6, 2); 	// 수납확정일 
				} else {
					sRslt = "";
				}	  
				Ds_PlanListExl2.setCellData( i , "sInsurStrtdate", sRslt);
			  	//console.log("[/CBSC014M.xml] [lfn_getColumnValueExcel()] ==> [Grid에서 칼럼이 '수납확정일' 이면] [sRslt]"+ sRslt );   
			  	
			 } else {  // Grid에서 칼럼이  '보험기간'(4번째 칼럼) 이면  
				sRslt = wconv.substr(sInsurStrtdate, 0, 4) +"."+ wconv.substr(sInsurStrtdate, 4, 2) +"."+  wconv.substr(sInsurStrtdate, 6, 2)
					 		 +"~"+ wconv.substr(sInsurEndDate, 0, 4) +"."+ wconv.substr(sInsurEndDate, 4, 2) +"."+  wconv.substr(sInsurEndDate, 6, 2);			// 보험기간 
				Ds_PlanListExl2.setCellData( i , "sInsureTerm", sRslt);
				//console.log("[/CBSC014M.xml] [lfn_getColumnValueExcel()] ==> [Grid에서 칼럼이 '보험기간' 이면] [sRslt]"+ sRslt );  	 
			 }			 
		} // end of for ()
		
		common.downLoadExcel("grd_PlanListExl", option, infoArr);
		wprom.alert("엑셀저장이 완료되었습니다.");
 	}  
 	
	wconv.clear(Ds_PlanListExl2);
	//console.log("[/CBSC014M.xml] [cm_btnExDown()] ==> [엑셀 버튼 클릭] [TEST_end]" );	     
};

//---------------------------------------------------------------------------
// function 명 : ExcelData
// 내용        : 엑셀 다운로드 조회
//---------------------------------------------------------------------------
scwin.lfn_ExelSearchData = function(pageNo) {
	//console.log("[/CBSC014M.xml] [lfn_ExelSearchData()] ==> [엑셀 다운로드] [TEST_01] [pageNo]"+ pageNo );
	
	var sStr;
	var cnt = 0;
	var npageSize = Ds_PlanListCntExl.getCellData(0, "nCount");    	 // 청약사항 엑셀 조회수 
	//console.log("[/CBSC014M.xml] [lfn_ExelSearchData()] ==> [TEST_03] [엑셀 조회수_Ds_PlanListCntExl.nCount]"+ Ds_PlanListCntExl.getCellData(0,"nCount"));  
 
    var nTotPageCnt = WebSquare.util.parseInt(WebSquare.util.parseInt(npageSize) / WebSquare.util.parseInt(pageSize));		// 총 수
  	//console.log("[/CBSC014M.xml] [lfn_ExelSearchData()] ==> [TEST_04] [엑셀출력] [nTotPageCnt]"+ nTotPageCnt +"[엑셀 조회수_Ds_PlanListCntExl.nCount]"+ Ds_PlanListCntExl.getCellData(0,"nCount"));  
	
	if (npageSize % pageSize != 0) {
        nTotPageCnt = nTotPageCnt + 1;
    }
 
	wconv.clear(Ds_PlanListExl2);
 
    for (i = 1; i <= nTotPageCnt; i++) {   
        if(util.isNull(medt_Str.getValue()) == false) {
            if (cmb_Gubun.getValue() == "6") {
              sStr = wconv.replace(medt_Str.getValue(), "-", "");
            } else {
                sStr = medt_Str.getValue();
            }
        } else {
            sStr = edt_Str.getValue();
        }
        
		if(util.isNull(sStr)) {
			wprom.alert("조회조건을 입력하세요");
			return;
	    }
	    
	    //대리점 or 설계사 인지
    	if (util.getGdsValue("gUserDuty") == "30" || util.getGdsValue("gUserDuty") == "33" || util.getGdsValue("gUserDuty") == "35" 
	    	|| util.getGdsValue("gUserDuty") == "48" || util.getGdsValue("gUserDuty") == "49" || util.getGdsValue("gUserDuty") == "50" 
	    	|| util.getGdsValue("gUserDuty") == "62" || util.getGdsValue("gUserDuty") == "65" || util.getGdsValue("gUserDuty") == "64" 
	    	|| util.getGdsValue("gUserDuty") == "66") { 
	        if (cmb_Gubun.getValue() == "7" || cmb_Gubun.getValue() == "9") {
	            if (gfn_chekDoerInqrAuth("DsWs_chekCrInqrAuth", sStr) == false) {	  //취급자조회시 권한 체크
	                wprom.alert("조회 권한이 없습니다.");
	                return;
	            }
	        } 
	       
	        if (cmb_Gubun.getValue() == "6") {	  //청약번호조회 권한 체크
	            if (gfn_chekCrInqrAuth("DsWs_chekCrInqrAuth", "1", sStr) == false) {
	                wprom.alert("조회 권한이 없습니다.");
	                return;
	            }
	        }
		}   
	    
		var sTeamCd = scwin.getTeamCd();  	// 로그인 ID에 해당하는 팀코드 조회 처리 결과값 받기  
	 
		var sJobCode = scwin.getJobCode();  	// 로그인 ID에 해당하는 잡코드 조회 처리 결과값 받기   
	 	//console.log("[/CBSC014M.xml] [lfn_ExelSearchData()] ==> [TEST_03] [sTeamCd]"+ sTeamCd +"[sJobCode]"+ sJobCode +"[sAuthFlag]"+ sAuthFlag );
 
	    //console.log("\n\n 		[/CBSC014M.xml] [lfn_SearchData()] ==> [M. 개인청약사항조회] [TEST_01] #############] =====> ");  
 
	 	var sKeyDoer = "";
	 	var sKeyDoerUser = "";
	 	var sFrstDoerTeamCd = "";
	  
		//대리점인지 여부(30:대리점,33:사용인,35:TM사용인)
	    //설계자 여부 (48:DP, 49:DPM, 50:재정전문위원)
	    if (util.getGdsValue("gUserDuty") == "30" || util.getGdsValue("gUserDuty") == "33" || util.getGdsValue("gUserDuty") == "35" 
	    	|| util.getGdsValue("gUserDuty") == "48" || util.getGdsValue("gUserDuty") == "49" || util.getGdsValue("gUserDuty") == "50" 
	    	|| util.getGdsValue("gUserDuty") == "62" || util.getGdsValue("gUserDuty") == "65" || util.getGdsValue("gUserDuty") == "64" 
	    	|| util.getGdsValue("gUserDuty") == "66") { 
	        if (nfn_checkAuthByID("ds_code", util.getGdsValue("gUserID"), "21013")) { 	  //대리점 관리자
	            sKeyDoer = util.getGdsValue("gDoer");
	        } else if (nfn_checkAuthByID("ds_code", util.getGdsValue("gUserID"), "34009") && (sAuthFlag == "Y")) { 
	            sFrstDoerTeamCd = sTeamCd;
	        } else if (nfn_checkAuthByID("ds_code", util.getGdsValue("gUserID"), "34009")) { 
	             sKeyDoer = "";
	        } else if (nfn_checkAuthByID("ds_code", util.getGdsValue("gUserID"), "34011")) { 
	            sKeyDoer = util.getGdsValue("gDoer");
	        } else if (nfn_checkAuthByID("ds_code", util.getGdsValue("gUserID"), "34030") && (sJobCode == "200205")) {} else if (nfn_checkAuthByID("ds_code", util.getGdsValue("gUserID"), "34030")) {
	       		sKeyDoer = util.getGdsValue("gDoer");	; //사용인
	        } else {
	          sKeyDoerUser = util.getGdsValue("gDoerUser"); 
	        }
	 
	        if (nfn_checkAuthByID("ds_code", util.getGdsValue("gUserID"), "34024")) {	  //대면총무 
	            sFrstDoerTeamCd = sTeamCd;
	        }
	    } 
	 
	  	wconv.clear(Ds_PlanListExl);
	  	wconv.clear(Ds_PlanListCntExl);
	   
		var MethodObj = new callService("com.inswave.longterm.ssr.pln.task.DBB120Task", "getPlanList", pageSize, i);		// 개인청약사항조회 Obj
	 	MethodObj.setId("getPlanList");	// ID 셋팅  
		MethodObj.setParam("gubun", cmb_Gubun.getValue());	// Param 셋팅(계약자코드) 
		MethodObj.setParam("sStr",	sStr);		//Param 셋팅(계약자코드)
		MethodObj.setParam("sInsurStrtdate", cal_From.getValue());	// 조회기간   
		MethodObj.setParam("sInsurEndDate",	cal_To.getValue());	 
		MethodObj.setParam("sPlanProgRankCd", cmb_PlanProg.getValue());	//Param 셋팅 (청약상태코드) 
		MethodObj.setParam("slevel",	slevel);			// Param 셋팅 
		MethodObj.setParam("sKeyDoer",	sKeyDoer);								// Param 셋팅
		MethodObj.setParam("sKeyDoerUser",	sKeyDoerUser);				// Param 셋팅 
		MethodObj.setParam("sFrstDoerTeamCd",	sFrstDoerTeamCd);		// Param 셋팅 
		MethodObj.setUrl("/contract/CBSC014MController.do");  // URL 설정
	 	MethodObj.MsgShow();							// PROGRASSBAR 표시 
		MethodObj.setMsg("조회 중");    		 		// 동기, 비동기시 PROGRASSBAR에 표시할 메시지 셋팅  
		MethodObj.setXPath("//hashtable/data[@hashkey='lTIDA00ListDoc']/vector/data/LTIDA00");			// XPath 
		MethodObj.addXPath("//hashtable/data[@hashkey='lTIDA00ListDocCnt']/LTIDA00CNT");		// XPath  
		MethodObj.addXPath("//*/WARNING");		// XPath
		MethodObj.sync();		// 동기 처리[기본(async:비동기)]
		MethodObj.send();		// 최종 전송 
	 	//console.log("[/CBSC014M.xml] [lfn_ExelSearchData()] ==> [01. 개인청약사항조회, 전송_완료] [TEST_91]")
	 	 
		//util.interfaceKey(_tranSync.result.serviceDs); 		// interface 조회 후 Data 리스트 Display
		
		Ds_PlanListExl.setJSON(_tranSync.getDsJson("LTIDA00"));				// 조회 DS 셋팅(조회 결과)   
		Ds_PlanListCntExl.setJSON(_tranSync.getDsJson("LTIDA00CNT")); 	// 조회 전체 건수 DS 셋팅(조회 결과)  
	 	DsWs_Warning.setJSON(_tranSync.getDsJson("WARNING"));  	// Warning DS 셋팅(조회 결과)   
		//console.log("[/CBSC014M.xml] [lfn_ExelSearchData()] ==> [엑셀 다운로드] [TEST_05] [Ds_PlanListExl, 갯수]"+ Ds_PlanListExl.getRowCount() +"[Ds_PlanListExl]"+ WebSquare.xml.serialize(Ds_PlanListExl.getAllXML()) ); 
		//console.log("[/CBSC014M.xml] [lfn_ExelSearchData()] ==> [엑셀 다운로드] [Ds_PlanListCntExl, 갯수]"+ Ds_PlanListCntExl.getRowCount() +"[Ds_PlanListCntExl]"+ WebSquare.xml.serialize(Ds_PlanListCntExl.getAllXML()) ); 
		console.log("[/CBSC014M.xml] [lfn_SearchData()] ==> [I/F 조회 완료] [Ds_PlanListCntExl, 갯수]"+ Ds_PlanListCntExl.getRowCount() );  
	  
	  	if (DsWs_Warning.getRowCount() != 0) {
	        wprom.alert(DsWs_Warning.getCellData(0, "msg"));
	        return;
	    }
	    
	    if (Ds_PlanListExl.getRowCount() == 0) {
	        wprom.alert("청약사항 조회건이 없습니다.");
	    }
 
	    //Ds_PlanListExl2.AppendDataset("Ds_PlanListExl");
	    Ds_PlanListExl2.setJSON(Ds_PlanListExl.getAllJSON(), true);		// JSON Data를 set 또는 append 처리(false: 추가) 
		//console.log("[/CBSC014M.xml] [lfn_ExelSearchData()] ==> [엑셀 다운로드] [TEST_73] [i_번째]"+ i +"[Ds_PlanListExl2, 갯수]"+ Ds_PlanListExl2.getRowCount() +"[Ds_PlanListExl2]"+ WebSquare.xml.serialize(Ds_PlanListExl2.getAllXML()) ); 
	  
 	}  // end of for()
  	//console.log("[/CBSC014M.xml] [lfn_ExelSearchData()] ==> [엑셀 다운로드] [TEST_91] [Ds_PlanListExl2, 갯수]"+ Ds_PlanListExl2.getRowCount() +"[Ds_PlanListExl2]"+ WebSquare.xml.serialize(Ds_PlanListExl2.getAllXML()) ); 
	 		
	//console.log("[/CBSC014M.xml] [lfn_ExelSearchData()] ==> [엑셀 다운로드] [TEST_end]" );
};

//**************************************************************************************************
// lfn_getCellDataValue:  칼럼 expression  처리 함수
//**************************************************************************************************
scwin.lfn_getColumnValue = function(data, formattedData, rowIndex, colIndex) { 
	//console.log("[/CBSC014M.xml] [lfn_getColumnValue()] ==> [TEST_01] [rowIndex]"+ rowIndex +"[colIndex]"+ colIndex +"[grd_PlanList.getColumnID(colIndex)]"+ grd_PlanList.getColumnID(colIndex)  ); 
 	   
 	var colNm = WebSquare.util.getComponentById(this.id).getColumnID(colIndex);	 // 칼럼명 
	 //console.log("[/CBSC014M.xml] [lfn_getColumnValue()] ==> [TEST_02] [Objects]"+ Objects +"[this.id]"+ this.id +"[rowIndex]"+ rowIndex +"[colIndex]"+ colIndex ); 
 
 	if (colNm == "sInrpsCd") {		// Grid에서 칼럼이 '피보험자코드'(2번째 칼럼) 이면  
		var sInrpsCd = Ds_PlanList.getCellData(rowIndex, "sInrpsCd");   	// 피보험자코드 
		var sInrpsName = Ds_PlanList.getCellData(rowIndex, "sInrpsName");   
	 	//console.log("[/CBSC014M.xml] [lfn_getCellDataValue()] ==> [Grid에서 칼럼이 '피보험자코드' 이면] [sInrpsCd]"+ sInrpsCd +"[sInrpsName]"+ sInrpsName );
	  
	 	if (wconv.length(sInrpsName) > 0) { 
			formattedData = gfn_changeMask(sInrpsCd, 1);		 // 마스크 처리[1. 주민번호: 뒷번호 6자리]
		} else {
			formattedData = ""; 
		}	  
 
	} else if (colNm == "sCrtorCd") {	// Grid에서 칼럼이 '계악자코드(3번째 칼럼) 이면  
		var sCrtorCd = Ds_PlanList.getCellData(rowIndex, "sCrtorCd");	 	// 계악자코드 
		var sCrtorName = Ds_PlanList.getCellData(rowIndex, "sCrtorName");
		 
		//if (util.isNull(sCrtorName) == false) {  
		if (wconv.length(sCrtorName) > 0) {
			formattedData = gfn_changeMask(sCrtorCd, 1);	  	 // 마스크 처리[1. 주민번호: 뒷번호 6자리]
		} else {
			formattedData = ""; 
		}	 
		//console.log("[/CBSC014M.xml] [lfn_getCellDataValue()] ==> [Grid에서 칼럼이 '계악자코드' 이면] [formattedData]"+ formattedData ); 
					
	} else if (colNm == "sInsureTerm") {	// Grid에서 칼럼이 '보험기간'(4번째 칼럼) 이면 
		var sInsurStrtdate = Ds_PlanList.getCellData(rowIndex, "sInsurStrtdate");
		var sInsurEndDate = Ds_PlanList.getCellData(rowIndex, "sInsurEndDate");  
	 
		formattedData = wconv.substr(sInsurStrtdate, 0, 4) +"."+ wconv.substr(sInsurStrtdate, 4, 2) +"."+  wconv.substr(sInsurStrtdate, 6, 2)
			 		 +"~"+ wconv.substr(sInsurEndDate, 0, 4) +"."+ wconv.substr(sInsurEndDate, 4, 2) +"."+  wconv.substr(sInsurEndDate, 6, 2);			// 보험기간 
		//console.log("[/CBSC014M.xml] [lfn_getCellDataValue()] ==> [Grid에서 칼럼이 '보험기간' 이면] [formattedData]"+ formattedData ); 

	} else if (colNm == "sSsrtDate") {	// Grid에서 칼럼이 '청약일/발행일'(5번째 칼럼) 이면
		var sSsrtDate = Ds_PlanList.getCellData(rowIndex, "sSsrtDate");		// 청약일 
		var sApplyPrtDate = Ds_PlanList.getCellData(rowIndex, "sApplyPrtDate");	// 발행일 
	
		formattedData = wconv.substr(sSsrtDate, 0, 4) +"-"+ wconv.substr(sSsrtDate, 4, 2) +"-"+  wconv.substr(sSsrtDate, 6, 2)
			 		 +"/"+ wconv.substr(sApplyPrtDate, 0, 4) +"-"+ wconv.substr(sApplyPrtDate, 4, 2) +"-"+  wconv.substr(sApplyPrtDate, 6, 2);			// 청약일/발행일		
	  	//console.log("[/CBSC014M.xml] [lfn_getCellDataValue()] ==> [Grid에서 칼럼이 '청약일/발행일' 이면] [formattedData]"+ formattedData );   
	  	
	 } else if (colNm =="sInsurStrtdate") {	// Grid에서 칼럼이 '수납확정일'(14번째 칼럼) 이면
	 	//console.log("[/CBSC014M.xml] [lfn_getCellDataValue()] ==> [Grid에서 칼럼이 '수납확정일' 이면]" );    
		var sInsurStrtdate = Ds_PlanList.getCellData(rowIndex, "sInsurStrtdate");		// 수납확정일
		var sCrNo = Ds_PlanList.getCellData(rowIndex, "sCrNo"); //계약번호
           	
		if (wconv.length(sCrNo) > 0) { 
			formattedData = wconv.substr(sInsurStrtdate, 0, 4) +"-"+ wconv.substr(sInsurStrtdate, 4, 2) +"-"+  wconv.substr(sInsurStrtdate, 6, 2); 	// 수납확정일 
		} else {
			formattedData = "";
		}	 
	  	//console.log("[/CBSC014M.xml] [lfn_getCellDataValue()] ==> [Grid에서 칼럼이 '수납확정일' 이면] [formattedData]"+ formattedData );   
	  	
	  } else if (colNm == "sPlanProgRankCdName") {		// Grid에서 칼럼이 '진행상태 ' 이면
		var sPlanProgRankCd = Ds_PlanList.getCellData(rowIndex, "sPlanProgRankCd");   	// 진행상태 코드  
		var sPlanProgRankCdName = Ds_PlanList.getCellData(rowIndex, "sPlanProgRankCdName");   	// 진행상태 
		//console.log("[/CBSC014M.xml] [lfn_getColumnValue()] ==> [Grid에서 칼럼이 '진행상태' 이면]  ===> [sPlanProgRankCd]"+ sPlanProgRankCd );
		 
		 if( (sPlanProgRankCd == "52")  || //인수요청 
			   	(sPlanProgRankCd == "53") || //진단심사중 
			    (sPlanProgRankCd == "54") || //실사심사중
			    (sPlanProgRankCd == "55") || //인수심사중
			    (sPlanProgRankCd == "56") || //인수승인
			    (sPlanProgRankCd == "57") || //인수불가
			    (sPlanProgRankCd == "58") ) { //조건부승인  
			formattedData  = "<a href='javascript:void(null)' class='bold underline'>"+ sPlanProgRankCdName +"</a>"; 	//  진행상태  
			//sRslt = sPlanProgRankCdName; 		//  진행상태  
		} else { 
			//sRslt  = "<a href='#' class='bold underline'>"+ sPlanProgRankCdName +"</a>"; 	//  진행상태  
			formattedData = sPlanProgRankCdName;  	//  진행상태  
		} 
		//console.log("[/CBSC014M.xml] [lfn_getColumnValue()] ==> [Grid에서 칼럼이 '진행상태' 이면]===> [sPlanProgRankCd]"+ sPlanProgRankCd +"[sRslt]"+ sRslt ); 
	 }	 
 	
	return formattedData;
};
	 ]]></script>
    </head>
      <body>
      	<w2:wframe id="" initScript="scwin.wfTitleFavInit();"
      		src="/cm/common/wf_titleFav.xml" style=""
      		class="common_bu_area">
      	</w2:wframe><!-- 메뉴 제목, 공통 버튼 Display 설정 -->
      	<xf:group class="cont_wrap" id="B120"
      		style="position:absolute; WorkArea:true;  Ver:1.0;  PidAttrib:7;left:0px;top:61px;width:100.0%;"
      		userData1="청약사항조회"
      		userData2=" OnLoadCompleted:scwin.chung01_OnLoadCompleted; ">
      		<DataObjects>
      			<DataObject></DataObject>
      			<DataObject></DataObject>
      			<DataObject></DataObject>
      			<DataObject></DataObject>
      			<DataObject></DataObject>
      			<DataObject></DataObject>
      			<DataObject></DataObject>
      			<DataObject></DataObject>
      		</DataObjects>
      		<ServiceObjects>
      			<ServiceObject></ServiceObject>
      			<ServiceObject></ServiceObject>
      			<ServiceObject></ServiceObject>
      			<ServiceObject></ServiceObject>
      			<ServiceObject></ServiceObject>
      			<ServiceObject></ServiceObject>
      			<ServiceObject></ServiceObject>
      			<ServiceObject></ServiceObject>
      			<ServiceObject></ServiceObject>
      		</ServiceObjects>
      		<xf:group arcsize="6" class="search_area" id="Shape9"
      			style="top:-28px;left:0px;" userData3="RoundRect">
      			<w2:anchor class="btn_search" disabled=""
      				id="lfn_Search" outerDiv="false" style="" tabIndex="7"
      				ev:onclick="scwin.lfn_Search">
      				<xf:label><![CDATA[조회]]></xf:label>
      			</w2:anchor>
      		</xf:group>
      		<xf:trigger id="btn_IvrInput"
      			style="position:absolute;ImageID:btn_Input_IVR;height:20px;Transparent:TRUE;width:20px;left:314px;top:-17px;"
      			tabIndex="21" ev:onclick="scwin.Btn_IVR_OnClick"
      			class="detail_phone" type="anchor">
      		</xf:trigger>
      		<xf:trigger class="detail_search"
      			ev:onclick="scwin.lfn_SearchDoer_OnClick" id='btn_Doer'
      			style="position:absolute;ImageID:btn_Input_IVR;height:20px;Transparent:TRUE;width:20px;left:314px;top:-17px;"
      			tabIndex="21" type="anchor">
      		</xf:trigger>

      		<xf:group arcsize="8" class="" id="Shape5"
      			style="position:absolute;left:0px;top:50px;width:100.0%;"
      			userData3="RoundRect">
      			<w2:gridView id="grd_PlanList" dataList="Ds_PlanList"
      				scrollByColumn="false" summaryAuto="false"
      				scrollByColumnAdaptive="false"
      				style="height: 530px;left:0px; box-sizing:border-box;"
      				ignoreCellClick="false" ignoreToggleOnDisabled="false"
      				fixedColumnWithHidden="true" useShiftKey="true"
      				autoFit="allColumn" autoFitMinWidth="100" class="sty_Grid"
      				evenRowBackgroundColor="" rowMouseOverColor=""
      				selectedCellColor=""
      				ev:oncellclick="scwin.grd_PlanList_OnCellClick">
      				<w2:header id="header1" style="">
      					<w2:row id="row3" style="">
      						<w2:column blockSelect="false"
      							id="column57" style="height:20px;" width="40"
      							inputType="text" displayMode="label" rowSpan="2"
      							value="No" />
      						<w2:column blockSelect="false"
      							id="column56" style="height:20px;" width="120"
      							inputType="text" displayMode="label" value="상품명" />
      						<w2:column blockSelect="false"
      							id="column55" style="height:20px;" width="90"
      							inputType="text" displayMode="label" value="피보험자코드" />
      						<w2:column blockSelect="false"
      							id="column54" style="height:20px;" width="90"
      							inputType="text" displayMode="label" value="계약자코드" />
      						<w2:column blockSelect="false"
      							id="column53" style="height:23px;" width="100"
      							inputType="text" displayMode="label" value="보험기간" />
      						<w2:column blockSelect="false"
      							id="column52" style="height:23px;" width="70"
      							inputType="text" displayMode="label" value="청약일/발행일" />
      						<w2:column blockSelect="false"
      							id="column51" style="height:23px;" width="70"
      							inputType="text" displayMode="label" value="적용보험료" />
      						<w2:column blockSelect="false"
      							id="column50" style="height:23px;" width="70"
      							inputType="text" displayMode="label" value="취급자코드" />
      						<w2:column blockSelect="false"
      							id="column49" style="height:20px;" width="70"
      							inputType="text" displayMode="label" value="사용인코드" />
      						<w2:column blockSelect="false"
      							id="column48" style="height:20px;" width="70"
      							inputType="text" displayMode="label" value="진행상태" />
      					</w2:row>
      					<w2:row id="row1" style="">
      						<w2:column blockSelect="false"
      							id="column35" style="height:20px;" inputType="text"
      							width="120" displayMode="label" value="청약번호" />
      						<w2:column blockSelect="false"
      							id="column33" style="height:20px;" inputType="text"
      							width="90" displayMode="label" value="피보험자명" />
      						<w2:column blockSelect="false"
      							id="column31" style="height:20px;" inputType="text"
      							width="90" displayMode="label" value="계약자" />
      						<w2:column blockSelect="false"
      							id="column29" style="height:20px;" inputType="text"
      							width="100" displayMode="label" value="계약번호" />
      						<w2:column blockSelect="false"
      							id="column27" style="height:20px;" inputType="text"
      							width="70" displayMode="label" value="수납확정일" />
      						<w2:column blockSelect="false"
      							id="column25" style="height:20px;" inputType="text"
      							width="70" displayMode="label" value="가입유형" />
      						<w2:column blockSelect="false"
      							id="column23" style="height:20px;" inputType="text"
      							width="70" displayMode="label" value="취급자명" />
      						<w2:column blockSelect="false"
      							id="column21" style="height:20px;" inputType="text"
      							width="70" displayMode="label" value="사용인명" />
      						<w2:column blockSelect="false"
      							id="column19" style="height:20px;" inputType="text"
      							width="70" displayMode="label" value="스캔상태" />
      					</w2:row>
      				</w2:header>
      				<w2:gBody id="gBody1" style="">
      					<w2:row id="row2" style="">
      						<w2:column blockSelect="false" id="No"
      							style="height:20px" inputType="expression" width="40"
      							rowSpan="2" displayMode="label" expression="rowIndex+1" />
      						<!-- No  -->
      						<w2:column blockSelect="false"
      							id="sGdCdName" style="height:20px" inputType="text"
      							width="120" displayMode="label" />
      						<!-- 상품명  -->
      						<w2:column blockSelect="false"
      							id="sInrpsCd" style="height:20px" inputType="text"
      							customFormatter="scwin.lfn_getColumnValue" width="90"
      							displayMode="label" /><!-- 피보험자코드  -->
      						<w2:column blockSelect="false"
      							id="sCrtorCd" style="height:20px" inputType="text"
      							customFormatter="scwin.lfn_getColumnValue" width="90"
      							displayMode="label" /><!-- 계약자코드  -->
      						<w2:column blockSelect="false"
      							id="sInsureTerm" style="height:20px" inputType="text"
      							customFormatter="scwin.lfn_getColumnValue" width="100"
      							displayMode="label" /><!-- 보험기간  -->
      						<w2:column blockSelect="false"
      							id="sSsrtDate" style="height:20px" inputType="text"
      							customFormatter="scwin.lfn_getColumnValue" width="70"
      							displayMode="label" /><!-- 청약일/발행일  -->
      						<w2:column blockSelect="false"
      							id="nApplPrem" style="height:20px" inputType="text"
      							width="70" displayMode="label" dataType="number"
      							displayFormat="#,###" textAlign="right" />
      						<!-- 적용보험료  -->
      						<w2:column blockSelect="false" id="sDoer"
      							style="height:20px" inputType="text" width="70"
      							displayMode="label" /><!-- 취급자코드  -->
      						<w2:column blockSelect="false"
      							id="sDoerUser" style="height:20px" inputType="text"
      							width="70" displayMode="label" />
      						<!-- 사용인코드  -->
      						<w2:column blockSelect="false"
      							id="sPlanProgRankCdName" style="height:20px"
      							inputType="text" width="70" displayMode="label"
      							customFormatter="scwin.lfn_getColumnValue" />
      						<!-- 진행상태  -->
      					</w2:row>
      					<w2:row id="row4" style="">
      						<w2:column blockSelect="false"
      							id="sPlanNo" style="height:20px" inputType="link"
      							width="120" displayMode="label" class="bold underline"
      							displayFormat="#-####-#######" />
      						<!-- 청약번호  -->
      						<w2:column blockSelect="false"
      							id="sInrpsName" style="height:20px" inputType="text"
      							width="90" displayMode="label" />
      						<!-- 피보험자명  -->
      						<w2:column blockSelect="false"
      							id="sCrtorName" style="height:20px" inputType="text"
      							width="90" displayMode="label" />
      						<!-- 계약자  -->
      						<w2:column blockSelect="false" id="sCrNo"
      							style="height:20px" inputType="link" width="100"
      							displayMode="label" class="bold underline"
      							displayFormat="#-####-#######" />
      						<!-- 계약번호  -->
      						<w2:column blockSelect="false"
      							id="sInsurStrtdate" style="height:20px" inputType="text"
      							customFormatter="scwin.lfn_getColumnValue" width="70"
      							displayMode="label" /><!-- 수납확정일  -->
      						<w2:column blockSelect="false"
      							id="sInsTypeName" style="height:20px" inputType="text"
      							width="70" displayMode="label" />
      						<!-- 가입유형  -->
      						<w2:column blockSelect="false"
      							id="sDoerName" style="height:20px" inputType="text"
      							width="70" displayMode="label" textAlign="left"/>
      						<!-- 취급자명  -->
      						<w2:column blockSelect="false"
      							id="sDoerUserName" style="height:20px" inputType="text"
      							width="70" displayMode="label" />
      						<!-- 사용인명  -->
      						<w2:column blockSelect="false"
      							id="sImagJugmResltNm" style="height:20px" width="70"
      							inputType="text" displayMode="label"
      							customFormatter="scwin.lfn_getColumnValue " />
      						<!-- 스캔상태  -->
      					</w2:row>
      				</w2:gBody>
      			</w2:gridView>
      			
      			<!-- 엑셀 실제 다운로드 Grid(grd_PlanListExl) -->
      			<w2:gridView adaptiveThreshold="" autoFit="allColumn" autoFitMinWidth="100" class="sty_Grid" dataList="Ds_PlanListExl2" evenRowBackgroundColor="#FFFFFF"
      				fixedColumnWithHidden="true" id="grd_PlanListExl" ignoreCellClick="false" ignoreToggleOnDisabled="false" rowMouseOverColor="#FFFFEF" scrollByColumn="false" scrollByColumnAdaptive="false"
      				selectedCellColor="#F7F7C2" style="height:0px;left:0px;top:0px;margin-top:14px;" summaryAuto="false" useShiftKey="true">
      				<w2:header id="header1" style="">
      					<w2:row id="row1" style="">
      						<w2:column blockSelect="false" displayMode="label" id="column37" inputType="text" style="height:20px;" value="No" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="column35" inputType="text" style="height:20px;" value="상품명" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="column33" inputType="text" style="height:20px;" value="청약번호" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="column31" inputType="text" style="height:20px;" value="계약번호" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="column29" inputType="text" style="height:20px;" value="피보험자명" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="column27" inputType="text" style="height:20px;" value="피보험자코드" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="column25" inputType="text" style="height:20px;" value="계약자" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="column23" inputType="text" style="height:20px;" value="계약자코드" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="column21" inputType="text" style="height:20px;" value="보험기간" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="column19" inputType="text" style="height:20px;" value="청약일/발행일" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="column17" inputType="text" style="height:20px;" value="수납확정일" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="column15" inputType="text" style="height:20px;" value="가입유형" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="column13" inputType="text" style="height:20px;" value="적용보험료" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="column11" inputType="text" style="height:20px;" value="취급자명" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="column9" inputType="text" style="height:20px;" value="취급자코드" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="column7" inputType="text" style="height:20px;" value="사용인명" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="column5" inputType="text" style="height:20px;" value="사용인코드" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="column3" inputType="text" style="height:20px;" value="진행상태" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="column1" inputType="text" style="height:20px;" value="스캔상태" width="70"/>
      					</w2:row>
      				</w2:header>
      				<w2:gBody id="gBody1" style="">
      					<w2:row id="row2" style="">
      						<w2:column blockSelect="false" displayMode="label" id="No" inputType="expression" style="height:20px" width="70" expression="rowIndex + 1"/>
      						<w2:column blockSelect="false" displayMode="label" id="sGdCdName" inputType="text" style="height:20px" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="sPlanNo" inputType="link" style="height:20px" width="70" class="bold underline" customFormatter="" displayFormat="#-####-#######"/>
      						<w2:column blockSelect="false" displayMode="label" id="sCrNo" inputType="link" style="height:20px" width="70" displayFormat="#-####-#######" class="bold underline"/>
      						<w2:column blockSelect="false" displayMode="label" id="sInrpsName" inputType="text" style="height:20px" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="sInrpsCd" inputType="text" style="height:20px" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="sCrtorName" inputType="text" style="height:20px" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="sCrtorCd" inputType="text" style="height:20px" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="sInsureTerm" inputType="text" style="height:20px" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="sSsrtDate" inputType="text" style="height:20px" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="sInsurStrtdate" inputType="text" style="height:20px" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="sInsTypeName" inputType="text" style="height:20px" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="nApplPrem" inputType="text" style="height:20px" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="sDoerName" inputType="text" style="height:20px" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="sDoer" inputType="text" style="height:20px" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="sDoerUserName" inputType="text" style="height:20px" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="sDoerUser" inputType="text" style="height:20px" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="sPlanProgRankCdName" inputType="link" style="height:20px" width="70"/>
      						<w2:column blockSelect="false" displayMode="label" id="sImagJugmResltNm" inputType="link" style="height:20px" width="70"/>
      					</w2:row>
      				</w2:gBody>
      			</w2:gridView>
      		</xf:group>
      		<xf:select1 appearance="minimal" class="sty_ipt_form"
      			emptyItem="true" id="cmb_PlanProg"
      			style="position:absolute; ImeMode:none;  INDEX:0;  border-style:solid;  height:20px;left:760px;top:-19px; width:108px;"
      			tabIndex="13" renderType="native">
      			<xf:choices>
      				<xf:itemset nodeset="data:Ds_PlanProg">
      					<xf:label ref="id_nm"></xf:label>
      					<xf:value ref="id_cd"></xf:value>
      				</xf:itemset>
      			</xf:choices>
      			<Record></Record>
      			<Record></Record>
      		</xf:select1>
      		<w2:textbox class="sty_lb_Search" id="sta_PlanProg"
      			label="청약상태"
      			style="position:absolute; VAlign:Middle;  text-align:right; height:20px;left:677px;top:-19px; width:64px;"
      			tagname="">
      		</w2:textbox>
      		<w2:inputCalendar class="sty_cal_search" id="cal_To"
      			style="position:absolute; SundayTextColor:red;  SaturdayTextColor:blue;  border-style:solid;  height:22px;left:554px;top:-18px; width:105px;"
      			tabIndex="11" validCheck="true">
      		</w2:inputCalendar>
      		<w2:textbox id="Static1" label="~"
      			style="position:absolute; VAlign:Middle;  text-align:center; height:20px;left:538px;top:-18px; width:16px;"
      			tagname="">
      		</w2:textbox>
      		<w2:inputCalendar class="sty_cal_search" id="cal_From"
      			style="position:absolute; SundayTextColor:red;  SaturdayTextColor:blue;  border-style:solid;  height:22px;left:437px;top:-18px; width:105px;"
      			tabIndex="12" validCheck="true">
      		</w2:inputCalendar>
      		<w2:textbox class="sty_lb_Search" id="Static12"
      			label="조회기간"
      			style="position:absolute; VAlign:Middle;  text-align:right; height:20px;left:368px;top:-18px; width:52px;"
      			tagname="">
      		</w2:textbox>
      		<xf:select1 appearance="minimal" class="sty_ipt_form"
      			emptyItem="true" ev:onchange="scwin.cmb_Gubun_OnCharChanged"
      			id="cmb_Gubun"
      			style="position:absolute; ImeMode:none;  INDEX:0;  border-style:solid;  height:20px;left:87px;top:-18px; width:100px;"
      			tabIndex="10" renderType="native">
      			<xf:choices>
      				<xf:itemset nodeset="data:ds_combo">
      					<xf:label ref="id_nm"></xf:label>
      					<xf:value ref="id_cd"></xf:value>
      				</xf:itemset>
      			</xf:choices>
      		</xf:select1>
      		<w2:textbox class="sty_lb_Search" id="Static0"
      			label="조회조건"
      			style="position:absolute; VAlign:Middle;  text-align:right; height:20px;left:11px;top:-18px; width:58px;"
      			tagname="">
      		</w2:textbox>
      		<!--      		<xf:trigger class="detail_search"-->
      		<!--      			ev:onclick="scwin.Btn_IVR_OnClick" id="btn_IvrInput"-->
      		<!--      			style="position:absolute; Transparent:TRUE;  ImageID:btn_Search_Search;  height:20px;left:313px;top:-17px; width:20px;"-->
      		<!--      			tabIndex="19" type="anchor">-->
      		<!--      		</xf:trigger>-->
      		<xf:switch id="switch_123" style=" ">
      			<xf:case id="Default_124" style=" "></xf:case>
      		</xf:switch>
      		<xf:switch id="switch_124" style=" ">
      			<xf:case id="Default_125" style=" "></xf:case>
      		</xf:switch>
      		<xf:input dataType="text" id="medt_Str"
      			ev:onkeydown="scwin.medt_Str_onkeydown"
      			ev:onfocus="scwin.medt_Str_onfocus" placeholder=""
      			style="position:absolute; border-style:solid;  height:20px;left:192px;top:-18px; width:120px;"
      			tabIndex="17" ev:onblur="scwin.medt_Str_OnFocus">
      		</xf:input>
      		<xf:input id="edt_Str"
      			style="position:absolute; border-style:solid;  height:20px;left:192px;top:-18px; width:120px;"
      			tabIndex="18" ev:onblur="" ev:onkeydown="scwin.medt_Str_onkeydown">
      		</xf:input>

      	</xf:group>
      	<w2:wframe id="div1" scope="false"
      		src="/cm/common/Main_btn_GridControl.xml"
      		style="position:absolute; height:30px;right:52px;top:75px; width:219px;">
      	</w2:wframe>
      </body>
</html>