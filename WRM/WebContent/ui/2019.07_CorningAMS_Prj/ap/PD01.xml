<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="/cm/css/all.css" type="text/css"?>  
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
 	<head style="">
    <!--
  		###################################################
  		파일명 : PD01.xml
    	프로그램명 : 조성 조회
    	설 명 :  조성 내역을 조회하고 저장한다.
    	작성자 : 진태만
        작성일 : 2019.08.05
 		수정일자     수정자    수정내용
        ==================================================
        2019.08.05       진태만      최초작성
        ###################################################
     -->
  <w2:type>DEFAULT</w2:type>
        <w2:buildDate/>
        <xf:model>
         <xf:instance>
          <data xmlns="" />
         </xf:instance>
         <w2:dataCollection baseNode="map">
          <!-- 조회 dataMap -->
          <w2:dataMap baseNode="map" id="dma_Search">
           <w2:keyInfo>
            <w2:key id="sAreaCode" name="name1" dataType="text"></w2:key>
            <w2:key id="START_DATE" name="name2" dataType="text"></w2:key>
            <w2:key id="END_DATE" name="name3" dataType="text"></w2:key>
            <w2:key id="AREA_CODE" name="name4" dataType="text"></w2:key>
            <w2:key id="LINE_CODE" name="name5" dataType="text"></w2:key>
            <w2:key id="GUBUN" name="name6" dataType="text"></w2:key>
            <w2:key id="BASIS_DATE" name="name7" dataType="text"></w2:key>
            <w2:key id="GLASS_CODE" name="name8" dataType="text"></w2:key>
            <w2:key id="INSPECT_DATE" name="측정일시" dataType="text"></w2:key>
            <w2:key id="PRE_INSPECT_DATE" name="측정일시2" dataType="text"></w2:key>
            <w2:key id="ETC" name="특이사항" dataType="text"></w2:key> 
           </w2:keyInfo>
          </w2:dataMap>
          <w2:dataMap baseNode="map" id="dma_BaseMap">
           <w2:keyInfo>
            <w2:key id="GLASS_CODE" name="name1" dataType="text"></w2:key>
            <w2:key id="BASIS_DATE" name="name2" dataType="text"></w2:key>
           </w2:keyInfo>
          </w2:dataMap> 
             <!--// 0. 그리드 헤더 Ds //-->
             <w2:dataList id="dlt_GlassList" baseNode="list" saveRemovedData="true" repeatNode="map">
              <w2:columnInfo>
               <w2:column id="ITEM_CODE" name="name1" dataType="text"></w2:column>
               <w2:column id="ITEM_NAME" name="name2" dataType="text"></w2:column>
               <w2:column id="HEAD_NAME" name="name3" dataType="text"></w2:column>
              </w2:columnInfo>
             </w2:dataList>
    <w2:dataList id="dlt_TankGlassList" baseNode="list" saveRemovedData="true" repeatNode="map">
           <w2:columnInfo>
            <w2:column id="ITEM_CODE" name="name1" dataType="text"></w2:column>
            <w2:column id="ITEM_NAME" name="name2" dataType="text"></w2:column>
            <w2:column id="HEAD_NAME" name="name3" dataType="text"></w2:column>
           </w2:columnInfo>
          </w2:dataList>
          <w2:dataList id="dlt_TankList" baseNode="list" saveRemovedData="true" repeatNode="map">
           <w2:columnInfo>
            <w2:column id="AREA_CODE" name="name1" dataType="text"></w2:column>
            <w2:column id="LINE_CODE" name="name2" dataType="text"></w2:column>
            <w2:column id="LINE_KNAME" name="name3" dataType="text"></w2:column>
            <w2:column id="LINE_ENAME" name="name4" dataType="text"></w2:column>
            <w2:column id="STD_PROC" name="name5" dataType="text"></w2:column>
            <w2:column id="USING_YN" name="name6" dataType="text"></w2:column>
            <w2:column id="REMARK" name="name7" dataType="text"></w2:column>
            <w2:column id="INITIAL_ID" name="name8" dataType="text"></w2:column>
            <w2:column id="LATEST_ID" name="name9" dataType="text"></w2:column>
           </w2:columnInfo>
          </w2:dataList>
          <w2:dataList id="dlt_TarGdList" baseNode="list" saveRemovedData="true" repeatNode="map">
           <w2:columnInfo>
            <w2:column id="GLASS_CODE" name="name1" dataType="text"></w2:column>
            <w2:column id="GLASS_NAME" name="name2" dataType="text"></w2:column>
            <w2:column id="BASIS_DATE" name="name3" dataType="text"></w2:column>
            <w2:column id="START_DATE" name="name4" dataType="text"></w2:column>
            <w2:column id="T1" name="name6" dataType="text"></w2:column>
           </w2:columnInfo>
          </w2:dataList>
          <!-- 2. 날자별 시료 정보 Ds -->
          <w2:dataList id="dlt_ProGdList" baseNode="list" saveRemovedData="true" repeatNode="map">
           <w2:columnInfo>
            <w2:column id="LINE_CODE" name="name1" dataType="text"></w2:column>
            <w2:column id="INSPECT_DATE" name="name2" dataType="text"></w2:column>
            <w2:column id="INSPECT_DATE2" name="name3" dataType="text"></w2:column>
            <w2:column id="PRE_INSPECT_DATE" name="name3" dataType="text"></w2:column>
            <w2:column id="INSPECT_TIME" name="name4" dataType="text"></w2:column>
            <w2:column id="AREA_CODE" name="name5" dataType="text"></w2:column>
            <w2:column id="PROGD_SQL" name="name6" dataType="text"></w2:column>
            <w2:column id="TOTAL" name="name7" dataType="text"></w2:column>
            <w2:column id="START_DATE" name="name8" dataType="text"></w2:column>
            <w2:column id="ETC" name="name9" dataType="text"></w2:column>
            <w2:column id="SUB_ETC" name="name10" dataType="text"></w2:column>
            <w2:column id="ETC_FLGE" name="name11" dataType="text"></w2:column>
           </w2:columnInfo>
          </w2:dataList>
         </w2:dataCollection>
         <w2:workflowCollection></w2:workflowCollection>
         
          <!--  조성 초기화  -->
         <xf:submission id="sbm_getSelectPd01Onload" ref="data:json,dlt_VcodeListArea" target="data:json,dlt_VcodeListArea"
          action="/pd01/pd01Onload.do" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler=""
          customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="scwin.sbm_getSelectPd01Onload_submitdone"
          ev:submiterror="" abortTrigger="">
         </xf:submission>
         <!--  tank 정보 조회  -->
         <xf:submission id="sbm_selectTankList" ref="data:json,dma_Search" target="data:json,dlt_TankList"
             action="/selectTankList.do" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler=""
          mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="scwin.sbm_selectTankList_submitdone" ev:submiterror=""
          abortTrigger="">
         </xf:submission>
   <!--  DataList & Grid 동적 Column 생성 조회  -->
         <xf:submission id="sbm_getSelectPdTextList1" ref="data:json,dma_Search"
          target='data:json,["dlt_TankList","dma_BaseMap","dlt_GlassList","dlt_TarGdList","dlt_ProGdList","dlt_TotGdCPKList","dlt_TotGdList","dlt_CpkList"]'
          action="/pd01/pd01Text.do" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler=""
          customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="scwin.sbm_getSelectPdTextList1_submitdone"
          ev:submiterror="" abortTrigger="">
         </xf:submission> 
   <!--  조성 조회 처리  -->
         <xf:submission id="sbm_getSelectPdSearch" ref="data:json,dma_Search" target='data:json,["dma_BaseMap","dlt_GlassList"]'
          action="/pd01/pd01Search.do" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler=""
          customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="scwin.sbm_getSelectPdSearch_submitdone" ev:submiterror="" abortTrigger="">
         </xf:submission> 
         <!--  Graph 출력 함수 호출 조회  -->
         <xf:submission id="sbm_getSelectPdGraphList" ref="data:json,dma_Search" target='data:json,["dma_BaseMap","dlt_GlassList","dlt_GraphList"]'
          action="/pd01/pd01Graph.do" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler=""
          customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="scwin.sbm_getSelectPdGraphList_submitdone" ev:submiterror="" abortTrigger="">
         </xf:submission> 
        </xf:model>
  
    <script type="text/javascript"><![CDATA[
 /**
  * 초기화 함수(셀렉트 박스의 항목을 가져온다)
  */
scwin.init = function() {
	console.log("[/PD01P01.xml] [init()] ==> [TEST_01] [조성 Data Impor 화면_초기화]");
	
	scwin.parentObj = opener || parent;
	scwin.popupID = $w.getParameter("popupID");
	scwin.messageObj = $w.getParameter("messageObj");   
	
	dma_Search.setJSON(scwin.messageObj.VdltMaster); 
	//console.log("[/PD01P01.xml] [init()] ==> [TEST_06] [AREA_CODE]"+ dma_Search.get("AREA_CODE") +"[LINE_CODE]"+ dma_Search.get("LINE_CODE") );
	
	dlt_GlassList.setJSON(scwin.messageObj.VbaseCount);
	
	scwin.Search_onclick(); // 자동 조회 
};
 
 /**
  * 01. 조회
  */
 scwin.Search_onclick = function() { 
  console.log("[/PD01.xml] [btn_Search_onclick()] ==>  [TEST_01] [조회버튼 클릭시 이벤트]" );
  
  if( initSearch == 0)   // 최초 로딩시 조회 이면 @@@  =
  {
   sbx_slincd.setValue("KC16");   // 탱크 KC16 디폴스 설정
  } 
 
   initSearch = 1;   // 최초 로딩시 횟수 ===>
  
  dma_Search.setEmptyValue();
  dma_Search.set("AREA_CODE" , sbm_sAreaCode.getValue());  // 사업장 코드
  dma_Search.set("LINE_CODE" , sbx_slincd.getValue());     // LINE_CODE(탱크 코드)
  dma_Search.set("START_DATE" , cal_startReqDate.getValue());
  dma_Search.set("END_DATE" , cal_endReqDate.getValue());
 
  common.executeSubmission("sbm_getSelectPdSearch");    // 조성 조회  ===> target='data:json,["dma_BaseMap","dlt_GlassList"]'
 };
 
 /**
  * 그리드 헤더부분 조회 후 데이터셋 동적 셋팅 함수 호츌
  */
 scwin.sbm_getSelectPdSearch_submitdone = function(e) {
  console.log("[/PD01.xml] [sbm_getSelectPdSearch_submitdone()] ==> [TEST_01]" );
  
  scwin.setColumnID();  // DataList & Grid 동적 Column 생성
 };
  
 //DataList & Grid 동적 Column 생성
 scwin.setColumnID = function() {
  console.log("[/PD01.xml] [setColumnID()] ==> [DataList & Grid 동적 Column 생성]  [TEST_01]" );
  
  var column = {};
  var columnArr = [];
  var gridHeader ="", gridBody="";
  var cntGR = dma_BaseMap.getCount();
  var cntPO = dma_BaseMap.getCount();
  var GlassCount = dlt_GlassList.getRowCount();
  var glass_code = dma_BaseMap.get("GLASS_CODE");
  console.log("[/PD01.xml] [setColumnID()] ==> [TEST_03] [GlassCount]"+ GlassCount );
  
  //주의사항
  //1. 각 DataList, GridView 생성에 사용될 xml tag (<w2:dataList>,  <w2:columnInfo>, <w2:column> 등)들은 현재 "Source"탭에 그려져 있는 그대로를 사용해야 함
  //2. <w2:gridView> 생성 시 아래 속성을 필히! 추가하여야 함
  //   <w2:gridView xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms"
  
  // 1. DataList 생성 시작 =============================================================================
  // 1.1. DataList 고정 Column 생성     
        var dataListStr = '<w2:dataList baseNode="list" id="dlt_TarGdList" repeatNode="map" saveRemovedData="true" style="">'
  + '         <w2:columnInfo>'
        + '       <w2:column dataType="text" id="GLASS_CODE" name=""></w2:column>'
        + '       <w2:column dataType="text" id="GLASS_NAME" name=""></w2:column>'
        + '       <w2:column dataType="text" id="BASIS_DATE" name=""></w2:column>'
        + '       <w2:column dataType="text" id="START_DATE" name=""></w2:column>'
        + '       <w2:column dataType="text" id="T" name=""></w2:column>'

  // 1.2. DataList 동적 Column 생성 (Grinding)
  for( var g=1; g<=GlassCount+1; g++ ) {
   var T = "T"+ g;
   //console.log("[/PD01.xml] [setColumnID()] ==> [TEST_51] [g_번째]"+ g +"[T]"+ T );
   dataListStr += '  <w2:column dataType="text" id="'+T+'" name=""></w2:column>'
  }
  
  //1.3. DataList 동적 Column 생성 (Polishing
  //1.4. DataList 모든 Column 생성 마무리
        dataListStr += '  </w2:columnInfo>'
        + '      <w2:data use="false"></w2:data>'
        + '       </w2:dataList>';
  
    var dataListStr1 = '<w2:dataList baseNode="list" id="dlt_ProGdList" repeatNode="map" saveRemovedData="true" style="">'
  + '         <w2:columnInfo>'
        + '       <w2:column dataType="text" id="LINE_CODE" name=""></w2:column>'
        + '       <w2:column dataType="text" id="INSPECT_DATE" name=""></w2:column>'
        + '       <w2:column dataType="text" id="INSPECT_DATE2" name=""></w2:column>'
   + '       <w2:column dataType="text" id="PRE_INSPECT_DATE" name=""></w2:column>'
        + '       <w2:column dataType="text" id="INSPECT_TIME" name=""></w2:column>'
        + '       <w2:column dataType="text" id="AREA_CODE" name=""></w2:column>'
        + '       <w2:column dataType="text" id="PROGD_SQL" name=""></w2:column>'
        + '       <w2:column dataType="text" id="TOTAL" name=""></w2:column>'
        + '       <w2:column dataType="text" id="START_DATE" name=""></w2:column>'
     + '       <w2:column dataType="text" id="ETC" name=""></w2:column>'
        + '       <w2:column dataType="text" id="SUB_ETC" name=""></w2:column>'
        + '       <w2:column dataType="text" id="ETC_FLGE" name=""></w2:column>'
  
  for( var g=1; g<=GlassCount+1; g++ ) {
   var T = "T"+ g;
   dataListStr1 += '  <w2:column dataType="text" id="'+T+'" name=""></w2:column>'
  }
   
  //1.4. DataList 모든 Column 생성 마무리
        dataListStr1 += '  </w2:columnInfo>'
        + '      <w2:data use="false"></w2:data>'
        + '       </w2:dataList>';
              
        var dataListStr2 = '<w2:dataList baseNode="list" id="dlt_TotGdList" repeatNode="map" saveRemovedData="true" style="">'
  + '         <w2:columnInfo>'
        + '       <w2:column dataType="text" id="NO" name=""></w2:column>'
        + '       <w2:column dataType="text" id="GUBUN" name=""></w2:column>'
            
  for( var g=1; g<=GlassCount+1; g++ ) {
   var T = "T"+ g;
   dataListStr2 += '  <w2:column dataType="text" id="'+T+'" name=""></w2:column>'
  }
 
  //1.4. DataList 모든 Column 생성 마무리
        dataListStr2 += '  </w2:columnInfo>'
        + '      <w2:data use="false"></w2:data>'
        + '       </w2:dataList>';
 
        for( var f=0; f<=GlassCount+1; f++ )
        {
         var dataListStr4 = '<w2:dataList baseNode="list" id="dlt_GraphList'+f+'" repeatNode="map" saveRemovedData="true" style="">'
   + '         <w2:columnInfo>'
         + '       <w2:column dataType="text" id="LINE1" name=""></w2:column>'
         + '       <w2:column dataType="text" id="LINE_CODE1" name=""></w2:column>'
         + '       <w2:column dataType="text" id="INSPECT_DATE" name=""></w2:column>'
         + '       <w2:column dataType="text" id="BASISDATA" name=""></w2:column>'
     
   //1.3. DataList 동적 Column 생성 (Polishing)
   //1.4. DataList 모든 Column 생성 마무리
         dataListStr4 += '  </w2:columnInfo>'
         + '      <w2:data use="false"></w2:data>'
         + '       </w2:dataList>';
        
         var  datalistname;
            datalistname += ",\dlt_GraphList"+f;
             datalistname =  wconv.replace(datalistname,"undefined","");

           scwin.makeDataList( "dlt_GraphList"+f, dataListStr4 );
           scwin.dataListStrname =  "data:json,[\"dma_BaseMap\",\"dlt_GlassList\"" + datalistname + "]";
     }   
             
   scwin.makeDataList( "dlt_TarGdList", dataListStr );     // 1. 주제별 아이템 코드 조회 Dtl
   scwin.makeDataList( "dlt_ProGdList", dataListStr1 );   // 2. 날자별 아이템 코드 조회 Dtl
   scwin.makeDataList( "dlt_TotGdList", dataListStr2 );  // 3. 평균, 표준편차, CPK 아이템 코드 조회 Dtl  ==> 추가: 2019.07.23, by 진태만
 
   common.executeSubmission("sbm_getSelectPdTextList1");   // DataList & Grid 동적 Column 생성 조회 ===> target='data:json,["dlt_TankList","dma_BaseMap","dlt_GlassList","dlt_TarGdList","dlt_ProGdList","dlt_TotGdCPKList","dlt_TotGdList","dlt_CpkList"]'
   //console.log("[/PD01.xml] [setColumnID()] ==> [DataList & Grid 동적 Column 생성]  [TEST_91]" );   
  //1. DataList 생성 종료 =============================================================================
 }
   
 /**
  *  77.  Grid 다시 생성(동적 Grid)
 */    
 scwin.sbm_getSelectPdTextList1_submitdone = function(e) {
  console.log("[/PD01.xml] [sbm_getSelectPdTextList1_submitdone()] ==> [TEST_01]" );
  
  var column = {};
  var columnArr = [];
  var gridHeader ="", gridBody="";
  var cntGR = dma_BaseMap.getCount();
  var cntPO = dma_BaseMap.getCount();
  var GlassCount = dlt_GlassList.getRowCount();
  var glass_code = dma_BaseMap.get("GLASS_CODE");   // Glass 코드
  //console.log("[/PD01.xml] [sbm_getSelectPdTextList1_submitdone()] ==> [TEST_05] [glass_code]"+ glass_code );
  
  // 1. 주제별 아이템 코드 Grid 생성 시작 =============================================================================
        // 1. 주제별 아이템 코드 Grid 생성
        //     : xml 형식을 정의 하면 <w2:gridView 에 xmlns:w2="http://www.inswave.com/websquare" xmlns:ev="http://www.w3.org/2001/xml-events" 포함 합니다.
       var gridStr = '<w2:gridView id="grd_list" xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms" '
        + '               style="height:185px;" width="100" autoFit="" class="cm_grid1" dataList="data:dlt_TarGdList" defaultCellHeight="30" ev:onafteredit="" ev:oncellclick="scwin.grd_list_oncellclick" ev:onrowindexchange="" fixedColumnWithHidden="true" ignoreCellClick="false" overflowX="auto" overflowY="auto" readOnly="true" rowStatusHeaderValue="" rowStatusVisible="" scrollByColumn="false" showSortableImage="" sortEvent="onclick" sortable="true" useShiftKey="true" visibleRowNum="">'
        + ' <w2:header id="header1" style="">'
        // 1-1. 주제별 아이템 코드 Grid 오른쪽 Header 칼럼명(glass_code: 첫번? 칼럼, Time 칼럼) 생성
       + '<w2:row id="row1" style="">'
        + '   <w2:column blockSelect="false" id="REQ_NUMBER" removeBorderStyle="false" style="height:25px;" width="100" inputType="text" value="'+glass_code+'" displayMode="label" colSpan="" rowSpan="1" sortLabel="" sortable=""></w2:column>'   //  glass_code
     + '   <w2:column blockSelect="false" id="REQ_DATE" removeBorderStyle="false" style="height:25px;" width="100" inputType="text" value="Time" displayMode="label" colSpan="" rowSpan="1" sortLabel="" sortable=""></w2:column>'   // Time
      
  // 1-2. 주제별 아이템 코드 Grid 오른쪽 Header 칼럼명 생성(왼쪽부터 차례로 아이템 코드 데이타 넣기))[SiO2, Al2O3, B2O3 ....]
  for( var r=0; r<=GlassCount-1; r++ ) {
   var headame = dlt_GlassList.getCellData( r, "ITEM_CODE");
   gridStr += '<w2:column blockSelect="false" id="" removeBorderStyle="false" style="height:25px;" width="100" inputType="text" value="'+headame+'" displayMode="label" colSpan="" rowSpan="1"></w2:column>';
  }
   
  // 1-3. 주제별 아이템 코드 Grid 오른쪽 Header 칼럼명(TOTAL 칼럼, 특이사항 칼럼) 생성
     gridStr += '  <w2:column blockSelect="false" id="" removeBorderStyle="false" style="height:25px;" inputType="text" width="100" value="TOTAL" displayMode="label" sortable=""></w2:column>'
     + '     <w2:column blockSelect="false" id="" removeBorderStyle="false" style="height:25px;" inputType="text" width="100" value="특이사항" displayMode="label" sortable=""></w2:column>'
     + '</w2:row>'
        + ' </w2:header>'
 
        // 1. 주제별 아이템 코드 Grid Body 생성 시작 ===============================================================================
        // 1-4. 주제별 아이템 코드 Grid Body 생성(DATE, T1)
        + '<w2:gBody id="gBody1" style="">'
        + '<w2:row id="row1" style="">'
     + '    <w2:column blockSelect="false" id="LOT_NO" width="100" value="DATE" removeBorderStyle="false" style="" inputType="text" displayMode="label"></w2:column>'    // DATE
     + '    <w2:column blockSelect="false" id="T1" width="100" removeBorderStyle="false" footerDiv="false" inputType="text" displayMode="label" disabled="true" textAlign="left"></w2:column>'  // T1(TARGET, UCL, UICL....)
        
       // 1-4. 주제별 아이템 코드 Grid Body 데이타 생성(왼쪽부터 차례로 수치 데이타 넣기)
  for( var r=2; r<=GlassCount+1; r++ ) {
      var T1 = "T"  + wconv.toNumber(r);
   gridStr += ' <w2:column blockSelect="false" id="'+T1+'" removeBorderStyle="false" style="" inputType="text" width="100" value="" dataType="number" displayFormat="##.##0" allowChar="0-9." maxlength="7" displayMode="label" textAlign="right"></w2:column>'; 
  } // end of for()
  
  // 1-5. 주제별 아이템 코드 Grid Body 데이타 칼럼(마지막 칼럼) 생성
     gridStr += '  <w2:column blockSelect="false" id="SAMPLE_NO" removeBorderStyle="false" style="" inputType="text" width="100" value="" displayMode="label"> </w2:column>'
      gridStr += '  <w2:column blockSelect="false" id="SAMPLE_NO1" removeBorderStyle="false" style="" inputType="text" width="100" value="" displayMode="label"> </w2:column>' 
        + '</w2:row>'
        + '</w2:gBody>'
        + '</w2:gridView>';
       // grd_list.setCellBackgroundColor( rowIndex , colIndex , color ); // 배경색 셋팅(상위 Grid row에 배경색 설정)
      grd_list.setCellBackgroundColor( 1, 2 ,"#FFFF00" );    // 배경색 셋팅(상위 Grid row에 배경색 설정)
   
  // 2. 날자별 아이템 코드 Grid 생성 시작 =============================================================================
        // 2. 날자별 아이템 코드 Grid 생성
  var gridStr1 = '<w2:gridView id="grd_list2" xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms" '
        + '                        style="height:320px;" editModeEvent="onclick" autoFit="" class="cm_grid" dataList="data:dlt_ProGdList"  ev:onafteredit="" ev:oncellclick="scwin.grd_list2_oncellclick" ev:onviewchang="scwin.grd_list2_onviewchange" ev:onrowindexchange="scwin.grd_list2_onrowindexchange"'
  + '         ev:oneditkeyup="scwin.grd_list2_oneditkeyup"'
        + '         fixedColumnWithHidden="true" ignoreCellClick="false" overflowX="auto" overflowY="auto" readOnly="true" rowStatusHeaderValue="" rowStatusVisible="" scrollByColumn="false" showSortableImage="" sortEvent="onclick" sortable="true" useShiftKey="true" visibleRowNum="">'
        + ' <w2:header id="header1" style="">'
       + '<w2:row id="row1" style="">' 
     gridStr1 += ''
        + '</w2:row>'
        + ' </w2:header>'
  // 2. 날자별 아이템 코드 Grid 칼럼명 생성(측정일시, 측정시)
        + '<w2:gBody id="gBody1" style="">'
        + '<w2:row id="row1" style="">'
     + '    <w2:column blockSelect="false" id="INSPECT_DATE2" width="100" removeBorderStyle="false" style="" inputType="text" value="" displayMode="label"></w2:column>'  // DATE
     + '    <w2:column blockSelect="false" id="INSPECT_TIME" width="100" dataType="number" displayFormat="0#" allowChar="0-9." maxlength="2" removeBorderStyle="false" footerDiv="false" inputType="text" displayMode="label" readOnly="false" disabled="false"></w2:column>'   // Time
    
        // 2. 날자별 아이템  Body Column 생성(왼쪽부터 차례로 수치 데이타 넣기)
  for( var r=2; r<=GlassCount+1; r++ ) {
   var T1 = "T"+ r;
   gridStr1 += ' <w2:column blockSelect="false" id="'+T1+'" removeBorderStyle="false" style="" disabled="false" inputType="text"  dataType="number"  displayFormat="##.##0" allowChar="0-9." maxlength="7" width="100" readOnly="false" value="" displayMode="label" textAlign="right"></w2:column>';
  } // end of for()
  
  // 2. 날자별 아이템 고정 Body Column 생성[TOTAL 칼럼, 특이사항 칼럼]
     gridStr1 += '  <w2:column blockSelect="false" id="TOTAL" removeBorderStyle="false" style="" disabled="false" inputType="text" width="100" value="" dataType="number" displayFormat="##.##0" displayMode="label" textAlign="right"> </w2:column>'
     + '     <w2:column blockSelect="false" id="ETC" removeBorderStyle="false" style="" inputType="text" width="100" value="" displayMode="label"  textAlign="left"></w2:column>'
        + '</w2:row>'
        + '</w2:gBody>'
        + '</w2:gridView>';
         //grd_list2.setCellColor( 1, 2 , "#0054FF" );   // 글자색 셋팅
        
        // 3. 평균, 표준편차, CPK 아이템 생성 시작 ===============================================================================
        // 3. 평균, 표준편차, CPK 아이템 Body Column 생성
        var gridStr2 = '<w2:gridView id="grd_list3" xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms" '
        + '                       style="height:98px;" autoFit="" class="cm_grid3" dataList="data:dlt_TotGdList" defaultCellHeight="30" ev:onafteredit="" ev:oncellclick="scwin.grd_list_oncellclick" ev:onrowindexchange="" fixedColumnWithHidden="true" ignoreCellClick="false" overflowX="auto" overflowY="auto" readOnly="true" rowStatusHeaderValue="" rowStatusVisible="" scrollByColumn="false" showSortableImage="" sortEvent="onclick" sortable="true" useShiftKey="true" visibleRowNum="">'
        + ' <w2:header id="header1" style="">'
       + '<w2:row id="row1" style="">'
     gridStr2 += ''
        + '</w2:row>'
        + ' </w2:header>'
 
        // 3. 평균, 표준편차, CPK 아이템 고정 Body Column 생성(왼쪽 제목: 평균, 표준편차, CPK)
        + '<w2:gBody id="gBody1" style="">'
        + '<w2:row id="row1" style="">'
     + '    <w2:column blockSelect="false" id="GUBUN" colsapn="2" removeBorderStyle="false" footerDiv="false" width="200" inputType="text" displayMode="label" disabled="true"></w2:column>'    // 평균, 표준편차, CPK
   
        // 3. 평균, 표준편차, CPK 아이템 동적 Body Column 데이타 생성(왼쪽부터 차례로 수치 데이타 넣기)
  for( var r=2; r <= GlassCount+1; r++ ) {
   var T1 = "T"+ r;
   // console.log("[/PD01.xml] [sbm_getSelectPdTextList1_submitdone()] ==> [TEST_51] [r_번째]"+ r +"[T1]"+ T1 );
   gridStr2 += ' <w2:column blockSelect="false" id="'+T1+'" removeBorderStyle="false" style="" inputType="text" width="100" dataType="number" displayFormat="##.##0" allowChar="0-9." maxlength="7"  value="" displayMode="label" textAlign="right"></w2:column>';
  } // end of for()
   
  // 3. 평균, 표준편차, CPK 아이템  Body Column 생성
     gridStr2 += '  <w2:column blockSelect="false" id="TOTAL" removeBorderStyle="false" style="" inputType="text" width="100" value="" displayMode="label"> </w2:column>'
     + '      <w2:column blockSelect="false" id="ETC" removeBorderStyle="false" style="" inputType="text" width="100" value="" displayMode="label" textAlign="left"></w2:column>'   // ETC
        + '</w2:row>'
        + '</w2:gBody>'
        + '</w2:gridView>';
 
  grd_list.setGridStyle( WebSquare.xml.parse( gridStr , true ) );    // 1. 주제별 아이템 코드 조회
  grd_list2.setGridStyle( WebSquare.xml.parse( gridStr1 , true ) );   // 2. 날자별 아이템 코드 조회
  grd_list3.setGridStyle( WebSquare.xml.parse( gridStr2 , true ) );  // 3. 평균, 표준편차, CPK 아이템 코드 조회
  // console.log("[/PD01.xml] [sbm_getSelectPdTextList1_submitdone()] ==> [TEST_91] [dlt_ProGdList.getRowCount()]"+ dlt_ProGdList.getRowCount() );
 
  for( var i=0; i< dlt_ProGdList.getRowCount(); i++ ) {
   // console.log("[/PD01.xml] [sbm_getSelectPdTextList1_submitdone()] ==> [TEST_51] [i_번째]"+ i );  
   grd_list2.setCellColor(i, 2 , "#FF0000" );  // 글자색 셋팅(빨간색 셋팅)
   grd_list2.setCellColor(i, 3 , "#FF0000" );  // 글자색 셋팅 (빨간색 셋팅)
   grd_list2.setCellColor(i, 4 , "#FF0000" );  // 글자색 셋팅 (빨간색 셋팅)
   grd_list2.setCellColor(i, 9 , "#0054FF" );  // 글자색 셋팅 (파란색 셋팅)
   grd_list2.setCellColor(i, 10 , "#FF0000" ); // 글자색 셋팅 (빨간색 셋팅)
  }
  //console.log("[/PD01.xml] [sbm_getSelectPdTextList1_submitdone()] ==> [TEST_99]" );
 };
 
 //동적 DataList 객체 생성
 scwin.makeDataList = function(id, xmlStr) {
  //console.log("[/PD01.xml] [makeDataList()] ==> [TEST_01] [동적 DataList 객체 생성] [id]"+ id +"[xmlStr]"+ xmlStr );
  
  //동일 DataList 존재시 삭제
  if( !wconv.isNull( WebSquare.util.getComponentById( id ) ) ) {
   $w.data.remove( id );
  }

  $w.data.create( xmlStr );
  //console.log("[/PD01.xml] [makeDataList()] ==> [TEST_91] " );
 };
 /************************************************************************************************
■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■
+-------------------------------------------// Script 종료 //---------------------------------------------------+
■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■
************************************************************************************************/
 ]]></script>
    </head>
    <body>
     <xf:group class="contentWrap" id="" style="w">
      <w2:wframe id="" initScript="scwin.wfTitleFavInit();" src="/cm/common/wf_titleFav.xml" style=""></w2:wframe>
      <xf:group class="RR_w2tb" id="group4" style="width:100.00%;height: 20px;margin-top:  5px;" tagname="table">
       <w2:attributes>
        <w2:summary></w2:summary>
       </w2:attributes>
       <xf:group tagname="caption"></xf:group>
       <xf:group tagname="colgroup">
        <xf:group style="width:0.50%;" tagname="col"></xf:group>
        <xf:group style="width:4%;" tagname="col"></xf:group>
        <xf:group style="width:69%;" tagname="col"></xf:group>
        <xf:group style="width:9.21%;" tagname="col"></xf:group>
       </xf:group>
       <xf:group style="" tagname="tr">
        <xf:group style="background-color:#4467A7;" tagname="td"></xf:group>
        <xf:group style="font-weight:bold;padding-left: 5px" tagname="td">분석일정</xf:group>
        <xf:group style="" tagname="td">[의뢰분석&amp;nbsp;&gt;&amp;nbsp;의뢰통계분석&amp;nbsp;&gt;&amp;nbsp;분석일정(RS01)]</xf:group>
        <xf:group style="float: right;" tagname="td">
         <w2:textbox id="" label="대외비"
          style="width:80px;height:18px;text-align:center;padding-top:2px;padding-bottom:0px;text-align:center;border-top:0.5pt solid #000000;border-bottom:0.5pt solid #000000;border-left:0.5pt solid #000000;border-right:0.5pt solid #000000;color:#FF0000;">
         </w2:textbox>
        </xf:group>
       </xf:group>
      </xf:group>
      <w2:textbox id="textbox5" label="" style="height: 3px;background-color: #4467a7;"></w2:textbox>
      <xf:group class="w2tb" id="group5" style="width:100.00%;" tagname="table">
       <w2:attributes>
        <w2:summary></w2:summary>
       </w2:attributes>
       <xf:group tagname="caption"></xf:group>
       <xf:group tagname="colgroup">
        <xf:group style="width:6.99%;" tagname="col"></xf:group>
        <xf:group style="width:18.39%;" tagname="col"></xf:group>
        <xf:group style="width:10.99%;" tagname="col"></xf:group>
        <xf:group style="width:21.67%;" tagname="col"></xf:group>
        <xf:group style="width:9.00%;" tagname="col"></xf:group>
        <xf:group style="width:0.75%;" tagname="col"></xf:group>
        <xf:group style="width:7.00%;" tagname="col"></xf:group>
        <xf:group style="width:20.00%;" tagname="col"></xf:group>
       </xf:group>
       <xf:group style="height:40px;" tagname="tr">
        <xf:group class="w2tb_th" style="height:21px;background-color:#eaf3fc;" tagname="th">
         분석년월
         <w2:attributes>
          <w2:scope>row</w2:scope>
         </w2:attributes>
        </xf:group>
        <xf:group class="w2tb_td" style="" tagname="td">
         <xf:select1 allOption="" appearance="minimal" chooseOption="" chooseOptionLabel="--------------" direction="auto"
          disabled="false" disabledClass="w2selectbox_disabled" id="sbx_schyyyy" ref=""
          style="width:100px;height: 30px;margin-left:5px;float: left;" submenuSize="auto" visibleRowNum="8">
          <xf:choices>
           <xf:itemset nodeset="data:dlt_Rh01YyList">
            <xf:label ref="YYYY"></xf:label>
            <xf:value ref="YYYY"></xf:value>
           </xf:itemset>
          </xf:choices>
         </xf:select1>
         <w2:textbox id="" label="년"
          style="width:15px;height:18px;float: left;margin-left:8px;padding-top:5px;padding-bottom:0px;text-align:center;margin-top:8px;">
         </w2:textbox>
         <xf:select1 allOption="" appearance="minimal" chooseOption="" chooseOptionLabel="--------------" direction="auto"
          disabled="false" disabledClass="w2selectbox_disabled" id="sbx_ssch_mm" ref=""
          style="width:60px;height: 30px;margin-left:15px;float: left;" submenuSize="auto" visibleRowNum="8">
          <xf:choices>
           <xf:itemset nodeset="data:dlt_Rh01MontList">
            <xf:label ref="lable"></xf:label>
            <xf:value ref="code"></xf:value>
           </xf:itemset>
          </xf:choices>
         </xf:select1>
         <w2:textbox id="" label="월"
          style="width:15px;height:18px;float: left;margin-left:8px;padding-top:5px;padding-bottom:0px;text-align:center;margin-top:6px;">
         </w2:textbox>
        </xf:group>
        <xf:group class="w2tb_th" style="background-color:#eaf3fc;" tagname="th">
         분석설비
         <w2:attributes>
          <w2:scope>row</w2:scope>
         </w2:attributes>
        </xf:group>
        <xf:group class="w2tb_td" style="vertical-align:middle;" tagname="td">
         <xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="---전체---" direction="auto"
          disabled="false" disabledClass="w2selectbox_disabled" ev:onchange="scwin.sbx_analEquip_onchange" id="sbx_sequip" ref=""
          style="width:180px;height: 30px;margin-left:5px;" submenuSize="auto" visibleRowNum="10">
          <xf:choices>
           <xf:itemset nodeset="data:dlt_VCodeListXX04">
            <xf:label ref="LOCAL_KNAME"></xf:label>
            <xf:value ref="LOCAL_CODE"></xf:value>
           </xf:itemset>
          </xf:choices>
         </xf:select1>
        </xf:group>
        <xf:group class="w2tb_th" style="background-color:#eaf3fc;" tagname="th">분석자<w2:attributes>
          <w2:scope>row</w2:scope>
         </w2:attributes></xf:group>
        <xf:group class="w2tb_td" style="" tagname="td">
         <w2:attributes>
          <w2:colspan>3</w2:colspan>
          <w2:rowspan>1</w2:rowspan>
         </w2:attributes>
         <xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="---전체---" direction="auto"
          disabled="false" disabledClass="w2selectbox_disabled" id="sbx_sanlaplys" ref="" style="width:245px;height: 30px;margin-left:5px;"
          submenuSize="auto" visibleRowNum="8">
          <xf:choices>
           <xf:itemset nodeset="data:dlt_VCodeListAM01">
            <xf:label ref="LOCAL_KNAME"></xf:label>
            <xf:value ref="LOCAL_CODE"></xf:value>
           </xf:itemset>
          </xf:choices>
         </xf:select1>
        </xf:group>
       </xf:group>
      </xf:group>
      <xf:group class="w2tb" id="" style="width:100%;margin-top:10px;" tagname="table">
       <w2:attributes>
        <w2:summary></w2:summary>
       </w2:attributes>
       <xf:group tagname="caption"></xf:group>
       <xf:group tagname="colgroup">
        <xf:group style="width:100.00%" tagname="col"></xf:group>
       </xf:group>
       <xf:group tagname="tr">
        <xf:group class="w2tb_td"
         style="text-align:right;border-top:1pt none #000000;border-bottom:1pt none #000000;border-left:1pt none #000000;border-right:1pt none #000000;"
         tagname="td">
         <w2:anchor class="btn_gcm" clickEventElement="outerDiv" ev:onclick="scwin.btn_Download_onclick" id="btn_Download"
          outerDiv="true" style="">
          <xf:label><![CDATA[신규일정]]></xf:label>
         </w2:anchor>
         <w2:anchor class="btn_gcm" clickEventElement="outerDiv" ev:onclick="scwin.btn_Search_onclick" id="btn_Search"
          outerDiv="true" style="">
          <xf:label><![CDATA[조 &nbsp; &nbsp;회]]></xf:label>
         </w2:anchor>
        </xf:group>
       </xf:group>
      </xf:group>
      <w2:textbox id="textbox6" label="" style="height: 3px;background-color: #4467a7;"></w2:textbox>
      
      <!--// 분석일정 Grid //--> 
		<w2:gridView ignoreCellClick="false" autoFit="allColumn" rowStatusWidth="20" visibleRowNum="" class="cm_grid" fixedColumnWithHidden="true" dataList="data:dlt_Rh01List" id="grd_list" readOnly="" 
			style="height:600px;width:100%;left:5px;top:3px;"  scrollByColumn="false" useShiftKey="true" rowStatusVisible="false" rowStatusHeaderValue="" ev:oncellclick="scwin.grd_MenuAccess_oncellclick">
       <w2:caption id="caption1" style="" value="this is a grid caption."></w2:caption>
       <w2:header id="header1" style="">
       <w2:row id="row1" style="">
			   <w2:column blockSelect="false" id="WEEK_SUN" width="170" value="일" style="height:40px;border-bottom:1.5pt solid #b3b3b3;" removeBorderStyle="false" inputType="text" displayMode="label"></w2:column>   
			   <w2:column blockSelect="false" id="WEEK_MON" width="170" value="월" style="height:40px;border-bottom:1.5pt solid #b3b3b3;" removeBorderStyle="false" inputType="text" displayMode="label"></w2:column>  
			   <w2:column blockSelect="false" id="WEEK_TUE" width="170" value="화" style="height:40px;border-bottom:1.5pt solid #b3b3b3;" removeBorderStyle="false" inputType="text" displayMode="label"></w2:column>  
			   <w2:column blockSelect="false" id="WEEK_WEN" width="170" value="수" style="height:40px;border-bottom:1.5pt solid #b3b3b3;" removeBorderStyle="false" inputType="text" displayMode="label"></w2:column>   
			   <w2:column blockSelect="false" id="WEEK_THU" width="170" value="목" style="height:40px;border-bottom:1.5pt solid #b3b3b3;" removeBorderStyle="false" inputType="text" displayMode="label"></w2:column>  
			   <w2:column blockSelect="false" id="WEEK_FRI" width="170" value="금" style="height:40px;border-bottom:1.5pt solid #b3b3b3;" removeBorderStyle="false" inputType="text" displayMode="label"></w2:column>  
			   <w2:column blockSelect="false" id="WEEK_SAT" width="170" value="토" style="height:40px;border-bottom:1.5pt solid #b3b3b3;" removeBorderStyle="false" inputType="text" displayMode="label"></w2:column>
			</w2:row> 
       </w2:header>
   	<w2:gBody id="gBody4" style="">
 		<w2:row id="row2"  style="height:20px;width:100%;"> 	<!--// 01. 날짜 칼럼 Row //-->
			<w2:column id="day0" blockSelect="false" readOnly="true" style="height:25px;border-top:none;color"  width="120" inputType="text" displayMode="label" textAlign="left">
			</w2:column> 
			<w2:column id="day1" blockSelect="false" readOnly="true"  width="120" inputType="text" displayMode="label" textAlign="left">
			</w2:column>
			<w2:column id="day2" blockSelect="false" readOnly="true"  width="120" inputType="text" displayMode="label" textAlign="left">
			</w2:column>
			<w2:column id="day3" blockSelect="false" readOnly="true"  width="120" inputType="text" displayMode="label" textAlign="left">
			</w2:column>
			<w2:column id="day4" blockSelect="false" readOnly="true"  width="120" inputType="text" displayMode="label" textAlign="left" >
			</w2:column>
			<w2:column id="day5" blockSelect="false"  readOnly="true"  width="120" inputType="text" displayMode="label" textAlign="left">
			</w2:column>
			<w2:column id="day6" blockSelect="false" readOnly="true"  width="120" inputType="text" displayMode="label" textAlign="left">
			</w2:column>
		</w2:row>
		<w2:row id="row3" style="height:30px;width:100%;">		<!--// 02. 메모 칼럼 Row //-->
			<w2:column id="memo0" blockSelect="false" readOnly="true" style="height:25px;border-width:0px 0 0 0px;" inputType="text" displayMode="label" textAlign="left" >
			</w2:column> 
			<w2:column id="memo1" blockSelect="false" readOnly="true" style="height:25px;" width="80" inputType="text" displayMode="label" textAlign="left">
			</w2:column>
			<w2:column id="memo2" blockSelect="false" readOnly="true" style="height:25px;" width= "120" inputType="text" displayMode="label" textAlign="left">
			</w2:column>
			<w2:column id="memo3" blockSelect="false" readOnly="true" style="height:25px;" width="120" inputType="text" displayMode="label" textAlign="left">
			</w2:column>
			<w2:column id="memo4" blockSelect="false" readOnly="true" style="height:25px;" width="120" inputType="text" displayMode="label" textAlign="left">
			</w2:column>
			<w2:column id="memo5" blockSelect="false" readOnly="true" style="height:25px;" width="120" inputType="text" displayMode="label" textAlign="left">
			</w2:column>
			<w2:column id="memo6" blockSelect="false" readOnly="true" style="height:25px;" width="120" inputType="text" displayMode="label" textAlign="left">
			</w2:column>
		</w2:row>
		<w2:row id="row4" style="height:30px;width:100%;">		<!--// 03. 배경색 칼럼 Row //--> 
			<w2:column id="clnmBgcolor0" blockSelect="false" readOnly="true" style="height:25px;border:0px;" width="80" inputType="text" displayMode="label">
			</w2:column> 
			<w2:column id="clnmBgcolor1" blockSelect="false" readOnly="true" style="height:25px;border:0px;" width="80" inputType="text" displayMode="label">
			</w2:column>
			<w2:column id="clnmBgcolor2" blockSelect="false" readOnly="true" style="height:25px;" width="120" inputType="text" displayMode="label">
			</w2:column>
			<w2:column id="clnmBgcolor3" blockSelect="false" readOnly="true" style="height:25px;" width="120" inputType="text" displayMode="label">
			</w2:column>
			<w2:column id="clnmBgcolor4" blockSelect="false" readOnly="true" style="height:25px;" width="120" inputType="text" displayMode="label">
			</w2:column>
			<w2:column id="clnmBgcolor5" blockSelect="false" readOnly="true" style="height:25px;" width="120" inputType="text" displayMode="label">
			</w2:column>
			<w2:column id="clnmBgcolor6" blockSelect="false" readOnly="true" style="height:25px;" width="120" inputType="text" displayMode="label">
			</w2:column>
		</w2:row>
	</w2:gBody>
      </w2:gridView>
     </xf:group>
    </body>
</html>