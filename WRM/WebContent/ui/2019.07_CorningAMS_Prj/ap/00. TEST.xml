<?xml-stylesheet href="/cm/css/all.css" type="text/css"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head style="">
        <w2:type>DEFAULT</w2:type>
        <w2:buildDate/>
        <xf:model>
            <xf:instance>
                <data xmlns=""/>
            </xf:instance>
            <w2:dataCollection baseNode="map"><!-- 조회 dataMap -->
                <w2:dataMap baseNode="map" id="dma_Search">
                    <w2:keyInfo>
                        <w2:key id="dma_Search??dataList_SCH_YYYY" name="name1" dataType="text" col_id="SCH_YYYY"/>
                        <w2:key id="dma_Search??dataList_SCH_MM" name="name2" dataType="text" col_id="SCH_MM"/>
                        <w2:key id="dma_Search??dataList_SCH_EQUIP" name="name3" dataType="text" col_id="SCH_EQUIP"/>
                        <w2:key id="dma_Search??dataList_ANALYSIS_EMPNO" name="name4" dataType="text" col_id="ANALYSIS_EMPNO"/>
                    </w2:keyInfo>
                </w2:dataMap><!--// 분석년월 - 년 정보 Ds -->
                <w2:dataList id="dlt_Rh01YyList" baseNode="list" saveRemovedData="true" repeatNode="map">
                    <w2:columnInfo>
                        <w2:column id="dlt_Rh01YyList_YYYY" name="name1" dataType="text" col_id="YYYY"/>
                    </w2:columnInfo>
                </w2:dataList><!--// 분석설비 정보 Ds -->
                <w2:dataList id="dlt_VCodeListXX04" baseNode="list" saveRemovedData="true" repeatNode="map">
                    <w2:columnInfo>
                        <w2:column id="dlt_VCodeListXX04_CODE_GROUP" name="name1" dataType="text" col_id="CODE_GROUP"/>
                        <w2:column id="dlt_VCodeListXX04_LOCAL_CODE" name="name2" dataType="text" col_id="LOCAL_CODE"/>
                        <w2:column id="dlt_VCodeListXX04_LOCAL_KNAME" name="name3" dataType="text" col_id="LOCAL_KNAME"/>
                        <w2:column id="dlt_VCodeListXX04_BUFFER1" name="name4" dataType="text" col_id="BUFFER1"/>
                        <w2:column id="dlt_VCodeListXX04_BUFFER2" name="name5" dataType="text" col_id="BUFFER2"/>
                        <w2:column id="dlt_VCodeListXX04_BUFFER3" name="name6" dataType="text" col_id="BUFFER3"/>
                        <w2:column id="dlt_VCodeListXX04_BUFFER4" name="name7" dataType="text" col_id="BUFFER4"/>
                    </w2:columnInfo>
                </w2:dataList><!--// 분석자 정보 Ds -->
                <w2:dataList id="dlt_VCodeListAM01" baseNode="list" saveRemovedData="true" repeatNode="map">
                    <w2:columnInfo>
                        <w2:column id="dlt_VCodeListAM01_CODE_GROUP" name="name1" dataType="text" col_id="CODE_GROUP"/>
                        <w2:column id="dlt_VCodeListAM01_LOCAL_CODE" name="name2" dataType="text" col_id="LOCAL_CODE"/>
                        <w2:column id="dlt_VCodeListAM01_LOCAL_KNAME" name="name3" dataType="text" col_id="LOCAL_KNAME"/>
                        <w2:column id="dlt_VCodeListAM01_BUFFER1" name="name4" dataType="text" col_id="BUFFER1"/>
                        <w2:column id="dlt_VCodeListAM01_BUFFER2" name="name5" dataType="text" col_id="BUFFER2"/>
                        <w2:column id="dlt_VCodeListAM01_BUFFER3" name="name6" dataType="text" col_id="BUFFER3"/>
                        <w2:column id="dlt_VCodeListAM01_BUFFER4" name="name7" dataType="text" col_id="BUFFER4"/>
                    </w2:columnInfo>
                </w2:dataList><!--// 분석년월 - 월 정보 Ds -->
                <w2:dataList id="dlt_month" baseNode="list" saveRemovedData="true" repeatNode="map">
                    <w2:columnInfo>
                        <w2:column id="dlt_month_code" name="name1" dataType="text" col_id="code"/>
                        <w2:column id="dlt_month_lable" name="name2" dataType="text" col_id="lable"/>
                    </w2:columnInfo>
                    <w2:data use="true">
                        <w2:row>
                            <code><![CDATA[01]]></code>
                            <lable><![CDATA[01]]></lable>
                        </w2:row>
                        <w2:row>
                            <code><![CDATA[02]]></code>
                            <lable><![CDATA[02]]></lable>
                        </w2:row>
                        <w2:row>
                            <code><![CDATA[03]]></code>
                            <lable><![CDATA[03]]></lable>
                        </w2:row>
                        <w2:row>
                            <code><![CDATA[04]]></code>
                            <lable><![CDATA[04]]></lable>
                        </w2:row>
                        <w2:row>
                            <code><![CDATA[05]]></code>
                            <lable><![CDATA[05]]></lable>
                        </w2:row>
                        <w2:row>
                            <code><![CDATA[06]]></code>
                            <lable><![CDATA[06]]></lable>
                        </w2:row>
                        <w2:row>
                            <code><![CDATA[07]]></code>
                            <lable><![CDATA[07]]></lable>
                        </w2:row>
                        <w2:row>
                            <code><![CDATA[08]]></code>
                            <lable><![CDATA[08]]></lable>
                        </w2:row>
                        <w2:row>
                            <code><![CDATA[09]]></code>
                            <lable><![CDATA[09]]></lable>
                        </w2:row>
                        <w2:row>
                            <code><![CDATA[10]]></code>
                            <lable><![CDATA[10]]></lable>
                        </w2:row>
                        <w2:row>
                            <code><![CDATA[110]]></code>
                            <lable><![CDATA[110]]></lable>
                        </w2:row>
                        <w2:row>
                            <code><![CDATA[12]]></code>
                            <lable><![CDATA[12]]></lable>
                        </w2:row>
                    </w2:data>
                </w2:dataList><!--// 분석일정 정보 Ds -->
                <w2:dataList id="dlt_Rh01List" baseNode="list" saveRemovedData="true" repeatNode="map">
                    <w2:columnInfo>
                        <w2:column id="dlt_Rh01List_MMODAT" name="날짜" dataType="text" col_id="MMODAT"/>
                        <w2:column id="dlt_Rh01List_DD" name="name1" dataType="text" col_id="DD"/>
                        <w2:column id="dlt_Rh01List_WEEK" name="name2" dataType="text" col_id="WEEK"/>
                        <w2:column id="dlt_Rh01List_SEQ_AM" name="오전 시각 " dataType="text" col_id="SEQ_AM"/>
                        <w2:column id="dlt_Rh01List_BGCOLOR_AM" name="오전 배경색" dataType="text" col_id="BGCOLOR_AM"/>
                        <w2:column id="dlt_Rh01List_TITLE_AM" name="오전 제목" dataType="text" col_id="TITLE_AM"/>
                        <w2:column id="dlt_Rh01List_SEQ_PM" name="오후 시각  " dataType="text" col_id="SEQ_PM"/>
                        <w2:column id="dlt_Rh01List_BGCOLOR_PM" name="오후 배경색" dataType="text" col_id="BGCOLOR_PM"/>
                        <w2:column id="dlt_Rh01List_TITLE_PM" name="오후 제목 " dataType="text" col_id="TITLE_PM"/>
                        <w2:column id="dlt_Rh01List_SEQAM0" name="name9" dataType="text" col_id="SEQAM0"/>
                        <w2:column id="dlt_Rh01List_SEQAM1" name="name10" dataType="text" col_id="SEQAM1"/>
                        <w2:column id="dlt_Rh01List_SEQAM2" name="name11" dataType="text" col_id="SEQAM2"/>
                        <w2:column id="dlt_Rh01List_day0" name="날짜0" dataType="text" col_id="day0"/>
                        <w2:column id="dlt_Rh01List_day1" name="name13" dataType="text" col_id="day1"/>
                        <w2:column id="dlt_Rh01List_day2" name="name14" dataType="text" col_id="day2"/>
                        <w2:column id="dlt_Rh01List_day3" name="name15" dataType="text" col_id="day3"/>
                        <w2:column id="dlt_Rh01List_day4" name="name13" dataType="text" col_id="day4"/>
                        <w2:column id="dlt_Rh01List_day5" name="name14" dataType="text" col_id="day5"/>
                        <w2:column id="dlt_Rh01List_day6" name="name15" dataType="text" col_id="day6"/>
                        <w2:column id="dlt_Rh01List_memo0" name="메모0" dataType="text" col_id="memo0"/>
                        <w2:column id="dlt_Rh01List_memo1" name="name13" dataType="text" col_id="memo1"/>
                        <w2:column id="dlt_Rh01List_memo2" name="name14" dataType="text" col_id="memo2"/>
                        <w2:column id="dlt_Rh01List_memo3" name="name15" dataType="text" col_id="memo3"/>
                        <w2:column id="dlt_Rh01List_memo4" name="name13" dataType="text" col_id="memo4"/>
                        <w2:column id="dlt_Rh01List_memo5" name="name14" dataType="text" col_id="memo5"/>
                        <w2:column id="dlt_Rh01List_memo6" name="name15" dataType="text" col_id="memo6"/>
                        <w2:column id="dlt_Rh01List_clnmBgcolor0" name="칼럼배경색0" dataType="text" col_id="clnmBgcolor0"/>
                        <w2:column id="dlt_Rh01List_clnmBgcolor1" name="name13" dataType="text" col_id="clnmBgcolor1"/>
                        <w2:column id="dlt_Rh01List_clnmBgcolor2" name="name14" dataType="text" col_id="clnmBgcolor2"/>
                        <w2:column id="dlt_Rh01List_clnmBgcolor3" name="name15" dataType="text" col_id="clnmBgcolor3"/>
                        <w2:column id="dlt_Rh01List_clnmBgcolor4" name="name13" dataType="text" col_id="clnmBgcolor4"/>
                        <w2:column id="dlt_Rh01List_clnmBgcolor5" name="name14" dataType="text" col_id="clnmBgcolor5"/>
                        <w2:column id="dlt_Rh01List_clnmBgcolor6" name="name15" dataType="text" col_id="clnmBgcolor6"/>
                    </w2:columnInfo>
                </w2:dataList>
            </w2:dataCollection>
            <w2:workflowCollection/><!--  분석일정 초기화  -->
            <xf:submission id="sbm_getSelectBo01Onload" ref="data:json,[&quot;dlt_Rh01YyList&quot;,&quot;dlt_VCodeListXX04&quot;,&quot;dlt_VCodeListAM01&quot;]" target="data:json,[&quot;dlt_Rh01YyList&quot;,&quot;dlt_VCodeListXX04&quot;,&quot;dlt_VCodeListAM01&quot;]" action="/rh01/rh01Onload.do" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="scwin.sbm_getSelectBo01Onload_submitdone" ev:submiterror="" abortTrigger=""><!--  분석일정  조회  --></xf:submission>
            <xf:submission id="sbm_selectRh01CalendarList" ref="data:json,dma_Search" target="data:json,dlt_Rh01List" action="/rh01/rh01List.do" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="scwin.sbm_selectRh01CalendarList_submitdone" ev:submiterror="" abortTrigger=""></xf:submission>
        </xf:model>
        <script type="text/javascript"><![CDATA[
  
	//**********************************************************
	// 초기화 함수(셀렉트 박스의 항목을 가져온다)
	//**********************************************************
	 scwin.init = function() {
	 	console.log("[/RH01.xml] [init()] ==> [TEST_01] [분석일정 화면_초기화]");
	  
	  	// common.executeSubmission("sbm_getSelectBo01Onload"); 
	  	
	  	scwin.resetLoad(); 		// 자동 조회 
	 };
 
	//**********************************************************
	// 분석일정 초기화 정보 조회 결과
	//**********************************************************
	 scwin.resetLoad = function() {
		console.log("[/RH01.xml] [resetLoad()] ==> [TEST_01]");
	  
		var sToday = new Date();   // 오늘 날짜		  
		var sYear = sToday.getFullYear();
		var sMonth = sToday.getMonth()+1;
		var sDay = sToday.getDate(); 
		if ((sMonth + "").length < 2)  sMonth = "0" + sMonth;
		if ((sDay + "").length < 2)  sDay = "0" + sDay;
	 
//		sbx_schyyyy.setValue(sYear);    // 분석년월 - 년
//		sbx_ssch_mm.setValue(sMonth); // 분석년월 - 월
//		sbx_sequip.setValue("EQ002");   // 분석설비  ==> TEST @@@ ===>
//		console.log("[/RH01.xml] [resetLoad()] ==>  [TEST_03] [sbx_schyyyy.getValue()]"+ sbx_schyyyy.getValue() );
		   
		dlt_Rh01List.removeAll();  
		var nRow = dlt_Rh01List.insertRow();  
		dlt_Rh01List.setCellData( nRow , "MMODAT", "20190801");    // 분석일정 데이타 입력 ===> TEST @@@ ===>
		dlt_Rh01List.setCellData( nRow , "DD" ,  "01" );   
		dlt_Rh01List.setCellData( nRow , "WEEK" ,  "1" ); 
		dlt_Rh01List.setCellData( nRow , "SEQ_AM" ,  "07" ); 						 // 오전 시각 
		dlt_Rh01List.setCellData( nRow , "TITLE_AM" ,  "TEST_01" );   		 // 오전 제목 
		dlt_Rh01List.setCellData( nRow , "BGCOLOR_AM" ,  "#00B4A4" );   // 오전 배경색(녹색)
		dlt_Rh01List.setCellData( nRow , "SEQ_PM" ,  "14" ); 						 // 오후 시각  
		dlt_Rh01List.setCellData( nRow , "BGCOLOR_PM" ,  "#F5937A" );   // 오후 배경색(주황색)
		dlt_Rh01List.setCellData( nRow , "TITLE_PM" ,  "TEST_01" );   		 // 오후 제목 
	 	
		nRow = dlt_Rh01List.insertRow();  
		dlt_Rh01List.setCellData( nRow , "MMODAT", "20190802");
	    dlt_Rh01List.setCellData( nRow , "DD" ,  "02" );   
		dlt_Rh01List.setCellData( nRow , "WEEK" ,  "2" ); 
		dlt_Rh01List.setCellData( nRow , "SEQ_AM" ,  "08" ); 						 // 오전 시각 
		dlt_Rh01List.setCellData( nRow , "TITLE_AM" ,  "TEST_02" );   		 // 오전 제목 
		dlt_Rh01List.setCellData( nRow , "BGCOLOR_AM" ,  "#00B4A4" );   // 오전 배경색(녹색)
		dlt_Rh01List.setCellData( nRow , "SEQ_PM" ,  "15" ); 						 // 오후 시각  
		dlt_Rh01List.setCellData( nRow , "BGCOLOR_PM" ,  "#F5937A" );   // 오후 배경색(주황색)
		dlt_Rh01List.setCellData( nRow , "TITLE_PM" ,  "TEST_02" );   		 // 오후 제목  
		console.log("[/RH01.xml] [resetLoad()] ==>  [TEST_41] [dlt_Rh01List.getValue()]"+ dlt_Rh01List.getRowCount() );
		   	
		dma_Search.set("SCH_YYYY" , sYear);   // 분석년월 - 년
		dma_Search.set("SCH_MM" , sMonth);   // 분석년월 - 월 
		//scwin.makeGrid();  		// 77.  Grid 다시 생성(동적 Grid)
		
		scwin.fnDrawCalendar();  		// 77.  Grid 다시 생성(동적 Grid)
	 };
 
 	//**********************************************************
	// 77.  Grid 다시 생성(동적 Grid)
	//**********************************************************
	 scwin.fnDrawCalendar = function() {
	 	console.log("[/RH01.xml] [fnDrawCalendar()] ==> [TEST_01]" );
	 	 
		var start_day, end_dater;
		var day, holiday, memo;
		var aMemo = new Array();
		var aClnmBgcolorAM = new Array();
		var aClnmBgcolorPM = new Array();
		var sToday = new Date();   // 오늘 날짜		  
		var sYear = sToday.getFullYear();
		var sMonth = sToday.getMonth()+1;
		var sDay = sToday.getDate();
		
		if ((sMonth + "").length < 2)  sMonth = "0" + sMonth;
		if ((sDay + "").length < 2)  sDay = "0" + sDay;
		console.log("[/RH01.xml] [fnDrawCalendar()] ==> [TEST_12] [오늘 날짜]"+ sToday +"[sYear]"+ sYear +"[sMonth]"+ sMonth +"[dlt_Rh01List.CNT]"+ dlt_Rh01List.getRowCount() );
	 	
		for(var i = 0; i < dlt_Rh01List.getRowCount(); i++)	 	// 날짜별 메모 Ds(ds_CalendarMemo) Loop
		{ 
			aMemo[i] = dlt_Rh01List.getCellData(i, "MMODAT") + dlt_Rh01List.getCellData(i, "TITLE_AM");   // 날짜(20190828) + 메모
			aClnmBgcolorAM[i] = dlt_Rh01List.getCellData(i, "MMODAT") + dlt_Rh01List.getCellData(i, "BGCOLOR_AM");   // 날짜(20190828) + AM 배경색
			aClnmBgcolorPM[i] = dlt_Rh01List.getCellData(i, "MMODAT") + dlt_Rh01List.getCellData(i, "BGCOLOR_PM");   // 날짜(20190828) + PM 배경색 
			//console.log("[/RH01.xml] [n_DrawCalendar()] ==> [TEST_12] [i_번째]"+ i +"[02. dlt_Rh01List.CNT]"+ dlt_Rh01List.getRowCount() +"[aClnmBgcolorPM[i]]"+ aClnmBgcolorPM[i] );
		}	 // end fo for()
 		//console.log("[/RH01.xml] [fnDrawCalendar()] ==> [TEST_21]" ); 
  
		var sFirstDate = new Date(sToday.getFullYear(), sToday.getMonth(), 1);  		// 이번 달의 첫째 날
		var sLastDate = new Date(sToday.getFullYear(), sToday.getMonth()+1, 0); 	// 이번 달의 마지막 날  
		var nFirstDateWeek = parseInt(sFirstDate.getDay());      // 이번 달의 첫째 날_요일  
		start_day = nFirstDateWeek;      // 이번 달의 첫째 날_요일[ex: 0:일, 1:월, 2:화...]   
		end_date = parseInt(sLastDate.getDate());      // 이번 달의 마지막 날_일[ex: 31]
		//console.log("[/RH01.xml] [fnDrawCalendar()] ==> [TEST_23] [시작 요일]"+ start_day +"[종료일]"+ end_date );
	
		var nRow =0;	
		console.log("[/RH01.xml] [n_DrawCalendar()] ==> [TEST_41] [nRow]"+ nRow );
		
		// nRow = dlt_Rh01List.insertRow();
		console.log("[/RH01.xml] [n_DrawCalendar()] ==> [TEST_42] [nRow]"+ nRow );
		
		for( i = 1, day = start_day; i <= end_date; i++)    // 1부터 말일까지 Loop
		{  
			if ((i + "").length < 2) sDay = "0" + i;
			var sDateThisMonth = sYear + sMonth + sDay;   // 해당 월의 날짜
			//console.log("[/RH01.xml] [n_DrawCalendar()] ==> [TEST_51] [i_번째]"+ i +"[sDateThisMonth]"+ sDateThisMonth +"[메모]" +aMemo );
			
			// 휴일 및 달력 Data 설정
			//holiday = this.fn_IsHoliday(sDateThisMonth, aHolidays); 	// 휴일  ==> TEST @@@ ===>
			var memo = scwin.fn_IsMemo(sDateThisMonth, aMemo);	// 메모 
			var slnmBgcolorAM = scwin.fn_IsClnmBgcolor(sDateThisMonth, aClnmBgcolorAM);		// AM 배경색 ==> aClnmBgcolorAM 
			var slnmBgcolorPM = scwin.fn_IsClnmBgcolor(sDateThisMonth, aClnmBgcolorPM);		// PM 배경색 ==> aClnmBgcolorPM 
			console.log("[/RH01.xml] [n_DrawCalendar()] ==> [TEST_52] [i_번째]"+ i +"[nRow]"+ nRow +"[메모]"+ memo +"[PM 배경색]"+ slnmBgcolorPM );
			
//			if( holiday != "" ) {		// 휴일이 존재하면 
//				dlt_Rh01List.setColumn(nRow, "day"+day, holiday + String.fromCharCode(32) + i); 		// 날짜 칼럼 셋팅(휴일명, 날짜)
//			} else {
				//dlt_Rh01List.setColumn(nRow, "day"+day, i);	// 날짜 칼럼 셋팅(날짜)
				dlt_Rh01List.setCellData(nRow, "day"+day, i);	  	// 날짜 칼럼 셋팅(날짜) 
		//	}
			//console.log("[/RH01.xml] [n_DrawCalendar()] ==> [TEST_53] [i_번째]"+ i +"[nRow]"+ nRow +"[day]"+day );
			
			if( slnmBgcolorAM != "")		// AM 배경색이 존재하면
			{ 
				grd_list.setCellBackgroundColor(nRow, "memo"+day, slnmBgcolorAM);		// PM 배경색		   
				//console.log("[/RH01.xml] [fnDrawCalendar()] ==> [TEST_73] [i_번째]"+ i +"[day]"+ day +"[slnmBgcolorAM]"+ slnmBgcolorAM );
			}
			if( slnmBgcolorPM != "")		// PM 배경색이 존재하면
			{ 
				grd_list.setCellBackgroundColor(nRow, "clnmBgcolor"+day, slnmBgcolorPM);		// PM 배경색		   
				//console.log("[/RH01.xml] [fnDrawCalendar()] ==> [TEST_73] [i_번째]"+ i +"[day]"+ day +"[slnmBgcolorPM]"+ slnmBgcolorPM );
			}
			
			if( memo != "")	// 메모가 존재하면
			{ 
				dlt_Rh01List.setCellData(nRow, "memo"+day, memo);		// 메모 칼럼 셋팅(메모) 			   
				//console.log("[/RH01.xml] [fnDrawCalendar()] ==> [TEST_73] [i_번째]"+ i +"[day]"+ day +"[메모]"+memo );
			}
			
			if(nRow == 4)	 // 줄이 4줄이면 ==> 높이 줄이기
			{
				//this.div_Main.form.grdCal.set_height(593);
			}
			else
				//this.div_Main.form.grdCal.set_height(704);
			console.log("[/RH01.xml] [fnDrawCalendar()] ==> [TEST_90] [day]"+ day );
		 
			// 달력 Data Row추가
			day = (day+1)%7;	 // 시작 요일 변경 
	 		console.log("[/RH01.xml] [fnDrawCalendar()] ==> [TEST_91] [nRow]"+ nRow +"[day]"+ day +"[i]"+  i +"[end_date]"+ end_date );
	 	
			if( day == 0 && i != end_date )	  // 요일이 일요일이고 i가 말일이 아니면 ==> 줄 바꿈
			{
				dlt_Rh01List.insertRow(); 
				nRow = nRow + 1;
				console.log("[/RH01.xml] [fnDrawCalendar()] ==> [TEST_93]  [줄 바꿈 처리 완료] [nRow]"+ nRow +"[day]"+ day );
			}
		}  // end fo for()
	};
	
	/************************************
	* Even : aClnmBgcolor
	* Desc : 배경색이 있는지 확인
	****************************************/
	scwin.fn_IsClnmBgcolor = function(sDate, aClnmBgcolor)
	{ 
		//console.log("[/BB00401M.xfdl] [fn_IsClnmBgcolor()] ==> [TEST_01] [AM 배경색이 확인] [sDate]"+ sDate +"[aClnmBgcolor]"+ aClnmBgcolor +"[aClnmBgcolor.length]"+ aClnmBgcolor.length );
 
		var rtnMemo = ""; 
		var subMemo = new Array();
 		
		for(var i = 0; i < aClnmBgcolor.length; i++)
		{ 
			if( aClnmBgcolor[i].substr(0,8) == sDate )	  // 메모 작성일자와 날짜가 같으면
			{ 
					rtnMemo += aClnmBgcolor[i].substr(8) + String.fromCharCode(13) + String.fromCharCode(10); 
			}
		}
		//console.log("[/BB00401M.xfdl] [fn_IsClnmBgcolor()] ==> [TEST_91] [rtnMemo]"+ rtnMemo );
		
		return rtnMemo;
	};
	 
	/************************************
	* Even : fn_IsMemo
	* Desc : 메모가 있는지 확인
	****************************************/
	scwin.fn_IsMemo = function(sDate, aMemo)
	{ 
		//console.log("[/BB00401M.xfdl] [fn_IsMemo()] ==> [TEST_01] [메모가 있는지 확인] [sDate]"+ sDate +"[aMemo]"+ aMemo +"[aMemo.length]"+ aMemo.length );
 
		var rtnMemo = "";
		var chkForYn = "";
		var subMemo = new Array();
 		
		for(var i = 0; i < aMemo.length; i++)
		{
			if(chkForYn == "Y") break;
			
			if( aMemo[i].substr(0,8) == sDate )	  // 메모 작성일자와 날짜가 같으면
			{
				if(aMemo[i].substr(8).length > 10)
				 {
					subMemo[i] = aMemo[i].substr(8).substr(0,10) + '...';
					rtnMemo += subMemo[i] + String.fromCharCode(13) + String.fromCharCode(10);
				}
				else 
				{
					rtnMemo += aMemo[i].substr(8) + String.fromCharCode(13) + String.fromCharCode(10);
				}
			} else if(chkForYn == "N") {
				chkForYn = "Y";
			}
		}
		//console.log("[/BB00401M.xfdl] [fn_IsMemo()] ==> [TEST_91] [rtnMemo]"+ rtnMemo );
		
		return rtnMemo;
	};
		 	  
	/**
	  * 조회 버튼 클릭시 이벤트
	 */             
	 scwin.btn_Search_onclick = function() {
	  console.log("[/RH01.xml] [btn_Search_onclick()] ==>  [TEST_01] [조회]");
	  
	  dlt_Rh01List.removeAll();  
	 
	  dma_Search.setEmptyValue();
	  dma_Search.set("SCH_YYYY" , sbx_schyyyy.getValue() );  // 분석년월 - 년
	  dma_Search.set("SCH_MM" , sbx_ssch_mm.getValue() );  // 분석년월 - 월
	  dma_Search.set("SCH_EQUIP" , sbx_sequip.getValue());    // 분석설비
	  dma_Search.set("ANALYSIS_EMPNO" , sbx_sanlaplys.getValue());
	  
	  common.executeSubmission("sbm_selectRh01CalendarList");
	 };
	 
	 /**
	  * 조회 후 콜백을 호출한다.
	 */
	 scwin.sbm_selectRh01CalendarList_submitdone = function(e) {
		 console.log("[/RH01.xml] [sbm_selectRh01CalendarList_submitdone()] ==>  [TEST_01] [조회 결과]");
		 console.log("[/RH01.xml] [sbm_selectRh01CalendarList_submitdone()] ==>  [TEST_41] [dlt_Rh01List.getValue()]"+ dlt_Rh01List.getRowCount() );
		
		 //var count = dlt_Rh01List.getRowCount();   // 분석일정 Dlt 갯수
		 
		 var sToday = new Date();   // 오늘 날짜
		 var nFirstDay4Month = new Date(sToday.getFullYear(), sToday.getMonth(), 1);  // 이번 달의 첫째 날
		 var nLastDatey4Month = new Date(sToday.getFullYear(), sToday.getMonth()+1, 0); // 이번 달의 마지막 날
		 console.log("[/RH01.xml] [sbm_getSelectBo01Onload_submitdone()] ==> [TEST_21] [이번 달의 첫째 날]"+ nFirstDay4Month +"[이번 달의 마지막 날]"+ nLastDatey4Month );
		 console.log("[/RH01.xml] [sbm_getSelectBo01Onload_submitdone()] ==> [TEST_21] [이번 달의 첫째 날_주]"+ nFirstDay4Month.getDay()  +"[이번 달의 마지막 날_주]"+ nLastDatey4Month.getDay()  );
	  
	  	// 1일이 시작되는 칸을 맞추어 줌
		for (i=0; i<nFirstDay4Month.getDay(); i++) {
	    	dlt_Rh01List.setCellData(0, 0, "test");
	    
	     //cell = nRow.insertCell();
	     //cnt = cnt + 1;    //col_11
	   }
	   dlt_Rh01List.setCellData(col_11, "test_2");
	   
	   console.log("[/RH01.xml] [sbm_getSelectBo01Onload_submitdone()] ==> [TEST_41] [dlt_Rh01List.getCellData(0, 0)]"+ dlt_Rh01List.getCellData(0, 0) );
	  
	   for (i=1; i<=nLastDatey4Month.getDate(); i++) {
		    //cell = nRow.insertCell();
		 
		    //cell.innerHTML = i;
		    //cnt = cnt + 1;
		 
		    //if (cnt%7 == 0)// 1주일이 7일 이므로
		    // nRow = calendar.insertRow();// 줄 추가
		}
	 
		 for(var i=0; i<=dlt_Rh01List.getRowCount(); i++)
		 {
			  var DD = dlt_Rh01List.getCellData(i , "DD");
			  var WEEK = dlt_Rh01List.getCellData(i , "WEEK");
			  
			  //dlt_Rh01List.setCellData(WEEK , "SEQAM"+WEEK , DD );
		 }  // end fo for()
	};
	]]></script>
    </head>
    <body>
        <xf:group class="contentWrap" id="" style="w">
            <w2:wframe id="" initScript="scwin.wfTitleFavInit();" src="/cm/common/wf_titleFav.xml" style=""/>
            <xf:group class="RR_w2tb" id="group4" style="width:100.00%;height: 20px;margin-top:  5px;" tagname="table">
                <w2:attributes>
                    <w2:summary/>
                </w2:attributes>
                <xf:group tagname="caption"/>
                <xf:group tagname="colgroup">
                    <xf:group style="width:0.50%;" tagname="col"/>
                    <xf:group style="width:4%;" tagname="col"/>
                    <xf:group style="width:69%;" tagname="col"/>
                    <xf:group style="width:9.21%;" tagname="col"/>
                </xf:group>
                <xf:group style="" tagname="tr">
                    <xf:group style="background-color:#4467A7;" tagname="td"/>
                    <xf:group style="font-weight:bold;padding-left: 5px" tagname="td">분석일정</xf:group>
                    <xf:group style="" tagname="td">[의뢰분석&amp;nbsp;&gt;&amp;nbsp;의뢰통계분석&amp;nbsp;&gt;&amp;nbsp;분석일정(RS01)]</xf:group>
                    <xf:group style="float: right;" tagname="td">
                        <w2:textbox id="" label="대외비" style="width:80px;height:18px;text-align:center;padding-top:2px;padding-bottom:0px;text-align:center;border-top:0.5pt solid #000000;border-bottom:0.5pt solid #000000;border-left:0.5pt solid #000000;border-right:0.5pt solid #000000;color:#FF0000;"></w2:textbox>
                    </xf:group>
                </xf:group>
            </xf:group>
            <w2:textbox id="textbox5" label="" style="height: 3px;background-color: #4467a7;"/>
            <xf:group class="w2tb" id="group5" style="width:100.00%;" tagname="table">
                <w2:attributes>
                    <w2:summary/>
                </w2:attributes>
                <xf:group tagname="caption"/>
                <xf:group tagname="colgroup">
                    <xf:group style="width:6.99%;" tagname="col"/>
                    <xf:group style="width:18.39%;" tagname="col"/>
                    <xf:group style="width:10.99%;" tagname="col"/>
                    <xf:group style="width:21.67%;" tagname="col"/>
                    <xf:group style="width:9.00%;" tagname="col"/>
                    <xf:group style="width:0.75%;" tagname="col"/>
                    <xf:group style="width:7.00%;" tagname="col"/>
                    <xf:group style="width:20.00%;" tagname="col"/>
                </xf:group>
                <xf:group style="height:40px;" tagname="tr">
                    <xf:group class="w2tb_th" style="height:21px;background-color:#eaf3fc;" tagname="th">분석년월
                        <w2:attributes>
                            <w2:scope>row</w2:scope>
                        </w2:attributes>
                    </xf:group>
                    <xf:group class="w2tb_td" style="" tagname="td">
                        <xf:select1 allOption="" appearance="minimal" chooseOption="" chooseOptionLabel="--------------" direction="auto" disabled="false" disabledClass="w2selectbox_disabled" id="sbx_schyyyy" ref="" style="width:120px;height: 30px;margin-left:5px;float: left;" submenuSize="auto" visibleRowNum="8">
                            <xf:choices>
                                <xf:itemset nodeset="data:dlt_Rh01YyList">
                                    <xf:label ref="YYYY"/>
                                    <xf:value ref="YYYY"/>
                                </xf:itemset>
                            </xf:choices>
                        </xf:select1>
                        <w2:textbox id="" label="년" style="width:15px;height:18px;float: left;margin-left:8px;padding-top:5px;padding-bottom:0px;text-align:center;margin-top:8px;"></w2:textbox>
                        <xf:select1 allOption="" appearance="minimal" chooseOption="" chooseOptionLabel="--------------" direction="auto" disabled="false" disabledClass="w2selectbox_disabled" id="sbx_ssch_mm" ref="" style="width:60px;height: 30px;margin-left:15px;float: left;" submenuSize="auto" visibleRowNum="8">
                            <xf:choices>
                                <xf:itemset nodeset="data:dlt_month">
                                    <xf:label ref="lable"/>
                                    <xf:value ref="code"/>
                                </xf:itemset>
                            </xf:choices>
                        </xf:select1>
                        <w2:textbox id="" label="월" style="width:15px;height:18px;float: left;margin-left:8px;padding-top:5px;padding-bottom:0px;text-align:center;margin-top:6px;"></w2:textbox>
                    </xf:group>
                    <xf:group class="w2tb_th" style="background-color:#eaf3fc;" tagname="th">분석설비
                        <w2:attributes>
                            <w2:scope>row</w2:scope>
                        </w2:attributes>
                    </xf:group>
                    <xf:group class="w2tb_td" style="vertical-align:middle;" tagname="td">
                        <xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="---전체---" direction="auto" disabled="false" disabledClass="w2selectbox_disabled" ev:onchange="scwin.sbx_analEquip_onchange" id="sbx_sequip" ref="" style="width:180px;height: 30px;margin-left:5px;" submenuSize="auto" visibleRowNum="10">
                            <xf:choices>
                                <xf:itemset nodeset="data:dlt_VCodeListXX04">
                                    <xf:label ref="LOCAL_KNAME"/>
                                    <xf:value ref="LOCAL_CODE"/>
                                </xf:itemset>
                            </xf:choices>
                        </xf:select1>
                    </xf:group>
                    <xf:group class="w2tb_th" style="background-color:#eaf3fc;" tagname="th">분석자
                        <w2:attributes>
                            <w2:scope>row</w2:scope>
                        </w2:attributes>
                    </xf:group>
                    <xf:group class="w2tb_td" style="" tagname="td">
                        <w2:attributes>
                            <w2:colspan>3</w2:colspan>
                            <w2:rowspan>1</w2:rowspan>
                        </w2:attributes>
                        <xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="---전체---" direction="auto" disabled="false" disabledClass="w2selectbox_disabled" id="sbx_sanlaplys" ref="" style="width:245px;height: 30px;margin-left:5px;" submenuSize="auto" visibleRowNum="8">
                            <xf:choices>
                                <xf:itemset nodeset="data:dlt_VCodeListAM01">
                                    <xf:label ref="LOCAL_KNAME"/>
                                    <xf:value ref="LOCAL_CODE"/>
                                </xf:itemset>
                            </xf:choices>
                        </xf:select1>
                    </xf:group>
                </xf:group>
            </xf:group>
            <xf:group class="w2tb" id="" style="width:100%;margin-top:10px;" tagname="table">
                <w2:attributes>
                    <w2:summary/>
                </w2:attributes>
                <xf:group tagname="caption"/>
                <xf:group tagname="colgroup">
                    <xf:group style="width:100.00%" tagname="col"/>
                </xf:group>
                <xf:group tagname="tr">
                    <xf:group class="w2tb_td" style="text-align:right;border-top:1pt none #000000;border-bottom:1pt none #000000;border-left:1pt none #000000;border-right:1pt none #000000;" tagname="td">
                        <w2:anchor class="btn_gcm" clickEventElement="outerDiv" ev:onclick="scwin.btn_Download_onclick" id="btn_Download" outerDiv="true" style="">
                            <xf:label><![CDATA[신규일정]]></xf:label>
                        </w2:anchor>
                        <w2:anchor class="btn_gcm" clickEventElement="outerDiv" ev:onclick="scwin.btn_Search_onclick" id="btn_Search" outerDiv="true" style="">
                            <xf:label><![CDATA[조 &nbsp; &nbsp;회]]></xf:label>
                        </w2:anchor>
                    </xf:group>
                </xf:group>
            </xf:group>
            <w2:textbox id="textbox6" label="" style="height: 3px;background-color: #4467a7;"/><!--// 분석일정 Grid //--><!--      <w2:gridView autoFit="" autoFitMinWidth="" class="cm_grid2" dataList="data:dlt_Rh01List" defaultCellHeight="20"--><!--       id="grd_list" overflowX="hidden" overflowY="hidden" rowNumHeaderValue="" rowNumVisible="" scrollByColumn="false"--><!--        showSortableImage="false" sortable="false" style="width: 100%;height: 660px;" selectedRowOverColor="#FFFFFF" selectedRowColor="#FFFFFF" --><!--        selectedCellColor="#FFFFFF" selectedCellOverColor="#FFFFFF" evenRowBackgroundColor="#FFFFFF" oddEvenColorDisplay="false" oddRowBackgroundColor="#FFFFFF" readOnly="true">--><!--      -->
            <w2:gridView ignoreCellClick="false" autoFit="allColumn" rowStatusWidth="20" visibleRowNum="" class="cm_grid" fixedColumnWithHidden="true" dataList="data:dlt_Rh01List" id="grd_list" readOnly="" style="height:600px;width:100%;left:5px;top:3px;" scrollByColumn="false" useShiftKey="true" rowStatusVisible="false" rowStatusHeaderValue="" ev:oncellclick="scwin.grd_MenuAccess_oncellclick">
                <w2:caption id="caption1" style="" value="this is a grid caption."/>
                <w2:header id="header1" style="">
                    <w2:row id="row1" style="">
                        <w2:column blockSelect="false" displayMode="label" id="column23" inputType="text" removeBorderStyle="false" style="height:40px;border-bottom:1.5pt solid #b3b3b3;" value="일" width="170"></w2:column>
                        <w2:column blockSelect="false" id="column343" removeBorderStyle="false" style="height:40px;border-bottom:1.5pt solid #b3b3b3;" inputType="text" width="170" value="월" displayMode="label"></w2:column>
                        <w2:column blockSelect="false" id="column359" removeBorderStyle="false" style="height:40px;border-bottom:1.5pt solid #b3b3b3;" inputType="text" width="170" value="화" displayMode="label"></w2:column>
                        <w2:column blockSelect="false" id="column375" removeBorderStyle="false" style="height:40px;border-bottom:1.5pt solid #b3b3b3;" inputType="text" width="170" value="수" displayMode="label"></w2:column>
                        <w2:column blockSelect="false" id="column391" removeBorderStyle="false" style="height:40px;border-bottom:1.5pt solid #b3b3b3;" inputType="text" width="170" value="목" displayMode="label"></w2:column>
                        <w2:column blockSelect="false" id="column407" removeBorderStyle="false" style="height:40px;border-bottom:1.5pt solid #b3b3b3;" inputType="text" width="170" value="금" displayMode="label"></w2:column>
                        <w2:column removeBorderStyle="false" width="187" inputType="text" style="height:40px;border-bottom:1.5pt solid #b3b3b3;" id="column459" value="토" blockSelect="false" displayMode="label"></w2:column>
                    </w2:row>
                </w2:header>
                <w2:gBody id="gBody4" style="">
                    <w2:row id="row2" style="height:20px;width:100%;">
                        <w2:column id="grd_list_day0" blockSelect="false" readOnly="true" style="height:25px;" width="80" inputType="text" displayMode="label" textAlign="left" col_id="day0"></w2:column>
                        <w2:column id="grd_list_day1" blockSelect="false" readOnly="true" style="height:25px;" width="80" inputType="text" displayMode="label" textAlign="left" col_id="day1"></w2:column>
                        <w2:column id="grd_list_day2" blockSelect="false" readOnly="true" style="height:25px;" width="120" inputType="text" displayMode="label" textAlign="left" col_id="day2"></w2:column>
                        <w2:column id="grd_list_day3" blockSelect="false" readOnly="true" style="height:25px;" width="120" inputType="text" displayMode="label" textAlign="left" col_id="day3"></w2:column>
                        <w2:column id="grd_list_day4" blockSelect="false" readOnly="true" style="height:25px;" width="120" inputType="text" displayMode="label" textAlign="left" col_id="day4"></w2:column>
                        <w2:column id="grd_list_day5" blockSelect="false" readOnly="true" style="height:25px;" width="120" inputType="text" displayMode="label" textAlign="left" col_id="day5"></w2:column>
                        <w2:column id="grd_list_day6" blockSelect="false" readOnly="true" style="height:25px;" width="120" inputType="text" displayMode="label" textAlign="left" col_id="day6"></w2:column>
                    </w2:row>
                    <w2:row id="row3" style="height:30px;width:100%;">
                        <w2:column id="grd_list_memo0" blockSelect="false" readOnly="true" style="height:25px;" width="80" inputType="text" displayMode="label" textAlign="left" col_id="memo0"></w2:column>
                        <w2:column id="grd_list_memo1" blockSelect="false" readOnly="true" style="height:25px;" width="80" inputType="text" displayMode="label" textAlign="left" col_id="memo1"></w2:column>
                        <w2:column id="grd_list_memo2" blockSelect="false" readOnly="true" style="height:25px;" width="120" inputType="text" displayMode="label" textAlign="left" col_id="memo2"></w2:column>
                        <w2:column id="grd_list_memo3" blockSelect="false" readOnly="true" style="height:25px;" width="120" inputType="text" displayMode="label" textAlign="left" col_id="memo3"></w2:column>
                        <w2:column id="grd_list_memo4" blockSelect="false" readOnly="true" style="height:25px;" width="120" inputType="text" displayMode="label" textAlign="left" col_id="memo4"></w2:column>
                        <w2:column id="grd_list_memo5" blockSelect="false" readOnly="true" style="height:25px;" width="120" inputType="text" displayMode="label" textAlign="left" col_id="memo5"></w2:column>
                        <w2:column id="grd_list_memo6" blockSelect="false" readOnly="true" style="height:25px;" width="120" inputType="text" displayMode="label" textAlign="left" col_id="memo6"></w2:column>
                    </w2:row>
                    <w2:row id="row4" style="height:30px;width:100%;">
                        <w2:column id="grd_list_clnmBgcolor0" blockSelect="false" readOnly="true" style="height:25px;" width="80" inputType="text" displayMode="label" col_id="clnmBgcolor0"></w2:column>
                        <w2:column id="grd_list_clnmBgcolor1" blockSelect="false" readOnly="true" style="height:25px;" width="80" inputType="text" displayMode="label" col_id="clnmBgcolor1"></w2:column>
                        <w2:column id="grd_list_clnmBgcolor2" blockSelect="false" readOnly="true" style="height:25px;" width="120" inputType="text" displayMode="label" col_id="clnmBgcolor2"></w2:column>
                        <w2:column id="grd_list_clnmBgcolor3" blockSelect="false" readOnly="true" style="height:25px;" width="120" inputType="text" displayMode="label" col_id="clnmBgcolor3"></w2:column>
                        <w2:column id="grd_list_clnmBgcolor4" blockSelect="false" readOnly="true" style="height:25px;" width="120" inputType="text" displayMode="label" col_id="clnmBgcolor4"></w2:column>
                        <w2:column id="grd_list_clnmBgcolor5" blockSelect="false" readOnly="true" style="height:25px;" width="120" inputType="text" displayMode="label" col_id="clnmBgcolor5"></w2:column>
                        <w2:column id="grd_list_clnmBgcolor6" blockSelect="false" readOnly="true" style="height:25px;" width="120" inputType="text" displayMode="label" col_id="clnmBgcolor6"></w2:column>
                    </w2:row>
                </w2:gBody>
            </w2:gridView>
        </xf:group>
    </body>
</html>