<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="/cm/css/all.css" type="text/css"?>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
	<head>
		<w2:type>DEFAULT</w2:type>
		<w2:buildDate />
		<xf:model>
			<xf:instance>
				<data xmlns="" />
			</xf:instance>
			<w2:dataCollection baseNode="map">
				<w2:dataMap baseNode="map" id="dma_fileDesc">
					<w2:keyInfo>
						<w2:key id="desc" name="" dataType="text"></w2:key>
						<w2:key id="test" name="" dataType="text"></w2:key>
					</w2:keyInfo>
					<w2:data use="true">
						<desc><![CDATA[
<pre class="textNor" style="">
<div class="etcbox">본 화면은 GridView의 ExcelDownload 기능 중 Image가 포함된 data에 대해 Excel로 download하는 방법을 제공한다.
Excel Image Data Download 설정 방법 및 실행방법을 확인한다.
</div>
<div class="etc_tit">1. Excel ImageData Download 설정</div>
  - C:\WS5_SAMPLE\RESOURCE\websquare_home\config\websquare.xml 에 아래 설정을 확인한다.
	(설정 변경 후 반드시 was를 리부팅한다.)
  - &lt;excel&gt;
		&lt;download&gt;
			&lt;-- 로컬의 WebRoot 경로로 셋팅하여 적용한다. --&gt;
			&lt;baseDir value="C:\WRM\WORKSPACE\.metadata\.plugins\org.eclipse.wst.server.core\tmp0\wtpwebapps"/&gt;
		&lt;/download&gt;
	&lt;/excel&gt;
<div class="etc_tit">2. Excel ImageData Download 소스</div>
  - advancedExcel download API 호출시  headerRowHeight, rowHeight, useImage 3가지 옵션을 필수로 넣어 주어야 한다.
    ex)
    var options = {};
    options.fileName = "ExcelImgDownload.xlsx";
    <b>options.headerRowHeight = 40;     // [필수] header 높이 </b>
    <b>options.rowHeight = "50";         // [필수] body 높이 </b> 
    <b>options.useImage = "true";        // [필수] inputType="image"인 경우 이미지 다운로드 사용 </b>
    grd_Excel.advancedExcelDownload( options );
				
<div class="etc_tit">3. 주의사항</div>
  - 메모리 사용량이 큰 기능이므로 대용량의 데이터에서는 사용을 권장하지 않는다. 
</pre>
						]]></desc>
						<test><![CDATA[
<pre class="textNor" style="">						
<div class="etc_tit">1. 과정</div>
1. 조회된 데이터를 엑셀 파일로 다운로드 한다.
2. 다운로드 받은 엑셀파일을 열어본다.
<div class="etc_tit">2. 결과</div>
1. 다운로드 받은 엑셀파일을 열어서 이미지 포함된 부분을 확인한다.
</pre>
						]]></test>
					</w2:data>
				</w2:dataMap>
				<w2:dataList baseNode="list" id="dlt_ExcelData" repeatNode="map" saveRemovedData="true" style="">
					<w2:columnInfo>
						<w2:column dataType="text" id="picture" name="사진"></w2:column>
						<w2:column dataType="text" id="type" name="종류"></w2:column>
						<w2:column dataType="text" id="Money" name="가격"></w2:column>
						<w2:column dataType="text" id="manufacturer" name="제조사"></w2:column>
						<w2:column dataType="text" id="Trading" name="거래량"></w2:column>
						<w2:column dataType="text" id="Market" name="시장"></w2:column>
						<w2:column dataType="text" id="Inputdate" name="기준일"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
			</w2:dataCollection>
			<w2:workflowCollection></w2:workflowCollection>
			<xf:submission id="sbm_imgDownExcel" ref="" target="data:json,dlt_ExcelData" action="/ui/SP/JsonData/excelImg.json" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg=""
				ev:submit="" ev:submitdone="scwin.sbm_submitdone" ev:submiterror="" abortTrigger="">
			</xf:submission>
		</xf:model>
		<script type="text/javascript" lazy="false"><![CDATA[
	/**
	 * 초기 스크립트 수행 함수 정의
	 */
	scwin.onpageload = function() {
		scwin.btn_search_onclick();
	};
	
	scwin.onpageunload = function() {
		
	};
	
	/** 
	 * /ui/SP/Data/advancedExcel.json 파일을 읽어온다.
	 */ 
	scwin.btn_search_onclick = function() {
		$p.executeSubmission("sbm_imgDownExcel");
	};
	
	/**
	 * sbm_advancedExcel의 submitdone, 조회된 행의 총 갯수를 count한다.
	 */
	scwin.sbm_advancedExcel_submitdone = function(e) {
		
	};
	
	/** 
	 * 그리드뷰의 데이터를 엑셀로 다운로드 한다.
	 * 필요한 옵션이 있다면 options, infoArr배열에 옵션을 넣는다.
	 */
	scwin.btn_downloadExcelBasic_onclick = function() {
		var options = {};
		options.fileName = "ExcelImgDownload.xlsx";
		options.headerRowHeight = 40;     // [필수] header 높이 
		options.rowHeight = "50";         // [필수] body 높이 
		options.useImage = "true";        // [필수] inputType="image"인 경우 이미지 다운로드 사용
		
		grd_excelGrid.advancedExcelDownload(options);
	};
	
	]]></script>
		<style type="text/css"><![CDATA[
			/* .w2grid_image {cursor:pointer; height: 30px !important;} */
		 ]]></style>
	</head>
	<body ev:onpageload="scwin.onpageload" ev:onpageunload="scwin.onpageunload">
		<xf:group class="contentWrap" id="" style="">
			<w2:wframe id="" style="" src="/cm/common/wf_titleFav.xml"></w2:wframe>
			<w2:wframe id="" src="/cm/common/wf_titleDesc.xml"></w2:wframe>
			<xf:group class="defaultbox" id="" style="">
				<xf:group class="ofh" id="" style="">
					<w2:span class="df_total" displayFormat="총 #,###건" id="spn_excelBasicCnt" label="" style="" dataType="number"></w2:span>
					<xf:group class="ml5 fr" id="" style="">
						<w2:anchor class="btn_gcm mr5" clickEventElement="outerDiv" ev:onclick="scwin.btn_downloadExcelBasic_onclick" id="btn_downloadExcelBasic" outerDiv="true" style="" toolTip="그리드의 데이터를 엑셀로 다운로드 한다.">
							<xf:label><![CDATA[엑셀 다운로드(이미지 포함)]]></xf:label>
						</w2:anchor>
						<w2:anchor class="btn_sh" clickEventElement="outerDiv" ev:onclick="scwin.btn_search_onclick" id="btn_search" outerDiv="true" style="" toolTip="">
							<xf:label><![CDATA[조회]]></xf:label>
						</w2:anchor>
					</xf:group>
				</xf:group>
			</xf:group>
			<w2:gridView autoFit="allColumn" class="cm_grid" dataList="data:dlt_ExcelData" ev:onafteredit=""
				ev:onrowindexchange="scwin.grd_Authority_onrowindexchange" fixedColumnWithHidden="true" id="grd_excelGrid" ignoreCellClick="false"
				rowStatusHeaderValue="" rowStatusVisible="" scrollByColumn="false" sortEvent="ondblclick" sortable="true" style="height:400px;"
				useShiftKey="true" visibleRowNum="10" rowNumVisible="true" rowNumHeaderValue="순서" ev:onfilereadend="scwin.grd_excelGrid_onfilereadend"
				rowNumWidth="">
				<w2:caption style="" id="caption1" value="this is a grid caption."></w2:caption>
				<w2:header style="" id="header1">
					<w2:row style="" id="row1">
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:20px" id="column13" value="사진"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:20px" id="column11" value="종류"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:20px" id="column9" value="가격"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:20px" id="column7" value="제조사"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:20px" id="column5" value="거래량"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:20px" id="column3" value="시장"
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:20px" id="column1" value="기준일"
							blockSelect="false" displayMode="label">
						</w2:column>
					</w2:row>
				</w2:header>
				<w2:gBody style="" id="gBody1">
					<w2:row style="" id="row2">
						<w2:column removeBorderStyle="false" width="70" inputType="image" style="height:20px;" id="picture" value=""
							blockSelect="false" displayMode="label" imageHeight="30" imageWidth="30">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:20px;" id="type" value=""
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:20px;" id="Money" value=""
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:20px;" id="manufacturer" value=""
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:20px;" id="Trading" value=""
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:20px;" id="Market" value=""
							blockSelect="false" displayMode="label">
						</w2:column>
						<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:20px;" id="Inputdate" value=""
							blockSelect="false" displayMode="label">
						</w2:column>
					</w2:row>
				</w2:gBody>
			</w2:gridView>
		</xf:group>
	</body>
</html>