<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="/cm/css/all.css" type="text/css"?>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
	<head>
		<w2:type>DEFAULT</w2:type>
		<w2:buildDate />
		<xf:model>
			<xf:instance>
				<data xmlns="" />
			</xf:instance>
			<w2:dataCollection baseNode="map">
				<w2:dataMap baseNode="map" id="dma_fileDesc">
					<w2:keyInfo>
						<w2:key id="desc" name="파일 설명" dataType="text"></w2:key>
						<w2:key id="test" name="파일 테스트 방법" dataType="text"></w2:key>
					</w2:keyInfo>
					<w2:data use="true">
						<desc><![CDATA[
<pre class="textNor" style="">
<div class="etcbox">Generator를 이용하여 2중 Grid의 형태를 나타낸 화면이다.
</div>
<div class="etc_tit">Generator를 이용한 2중 Grid </div>
  - gridView로는  2중 Grid를 나타낼 수 없기에 Generator를 이용하여 나타낸다.
</pre>
						]]></desc>
						<test><![CDATA[
<pre class="textNor">
<div class="etc_tit">1. 과정</div>
- data 조회 후 callback함수에서 generator를 활용하여 2중 grid의 모양을 만들어 준다.
</div>
<div class="etc_tit">2. 결과</div>
- 2중 grid의 형태를 확인한다.
<div class="etc_tit">3. 주의사항</div>
  - generator는 Excel 기능이 없으므로, 엑셀 기능을 구현하실 때에는 직접 구현해야 한다.
</pre>
						]]></test>
					</w2:data>
				</w2:dataMap>
				<w2:dataMap baseNode="map" id="dma_request">
					<w2:keyInfo>
						<w2:key id="req" name="요청" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataList baseNode="list" repeatNode="map" id="dltList1" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="val1" name="name1" dataType="text"></w2:column>
						<w2:column id="val2" name="name2" dataType="text"></w2:column>
						<w2:column id="val3" name="name3" dataType="text"></w2:column>
						<w2:column id="val4" name="name4" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dltList2" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="grval1" name="name1" dataType="text"></w2:column>
						<w2:column id="grval2" name="name2" dataType="text"></w2:column>
						<w2:column id="grval3" name="name3" dataType="text"></w2:column>
						<w2:column id="grval4" name="name4" dataType="text"></w2:column>
						<w2:column id="grval5" name="name5" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dltList3" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="grval1" name="name1" dataType="text"></w2:column>
						<w2:column id="grval2" name="name2" dataType="text"></w2:column>
						<w2:column id="grval3" name="name3" dataType="text"></w2:column>
						<w2:column id="grval4" name="name4" dataType="text"></w2:column>
						<w2:column id="grval5" name="name5" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
			</w2:dataCollection>
			<w2:workflowCollection></w2:workflowCollection>
			<xf:submission id="sbm_generator" ref=""
				target='data:json,[{"id":"dltList1","key":"dltList1"},{"id":"dltList2","key":"dltList2"},{"id":"dltList3","key":"dltList3"}]'
				action="/ui/SP/JsonData/generator.json" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace=""
				errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="scwin.sbm_generator_submitdone"
				ev:submiterror="" abortTrigger="">
			</xf:submission>
			<xf:submission abortTrigger="" action="/util/genExcel.do" customHandler="" encoding="UTF-8" errorHandler="" ev:submit=""
				ev:submitdone="scwin.sbm_genExcel_submitdone" ev:submiterror="" id="sbm_genExcel" instance="" mediatype="application/json" method="post"
				mode="asynchronous" processMsg="Down..." ref="data:json,dma_request" replace="" target='' style="">
			</xf:submission>
		</xf:model>
		<script type="text/javascript" lazy="false"><![CDATA[ 
	//화면 초기 로딩 시 호출 - config.xml 설정에 화면 로딩 후 자동 호출된다.
	scwin.onpageload = function() {
		scwin.btn_search_onclick();
	};
	
	scwin.onpageunload = function() {
	
	};
	
	scwin.btn_search_onclick = function() {
		generator1.removeAll();
		$p.executeSubmission( "sbm_generator" );
	};
	
	scwin.sbm_generator_submitdone = function(e) {
		var _len1 = dltList1.getRowCount();
		var _len2 = dltList2.getRowCount();
		var _len3 = dltList3.getRowCount();
		
		for(var i=0; i<_len1; i++ ){
       		generator1.insert();
       		
       		generator1.getChild( i , "textbox1" ).setValue(dltList1.getCellData( i , "val1" ));
       		generator1.getChild( i , "textbox2" ).setValue(dltList1.getCellData( i , "val2" ));
       		generator1.getChild( i , "textbox3" ).setValue(dltList1.getCellData( i , "val3" ));
       		
       		var _val4 = dltList1.getCellData( i , "val4" );
       		generator1.getChild( i , "textbox4" ).setValue(_val4);
       		
       		if(_val4 == "인생은 아름다워"){
       			
       			for(var j=0; j<_len2; j++){
       				generator1.getChild( i , "generator2" ).insert();
       				generator1.getChild( i , "generator2" ).getChild( j , "textbox10" ).setValue(dltList2.getCellData( j , "grval1" ));
	        		generator1.getChild( i , "generator2" ).getChild( j , "textbox11" ).setValue(dltList2.getCellData( j , "grval2" ));
	        		generator1.getChild( i , "generator2" ).getChild( j , "textbox12" ).setValue(dltList2.getCellData( j , "grval3" ));
	        		generator1.getChild( i , "generator2" ).getChild( j , "textbox13" ).setValue(dltList2.getCellData( j , "grval4" ));
	        		generator1.getChild( i , "generator2" ).getChild( j , "textbox14" ).setValue(dltList2.getCellData( j , "grval5" ));
       			}
       			
       		}else if(_val4 == "테스트"){
       			
       			for(var k=0; k<_len3; k++){
       				generator1.getChild( i , "generator2" ).insert();
       				generator1.getChild( i , "generator2" ).getChild( k , "textbox10" ).setValue(dltList3.getCellData( k , "grval1" ));
	        		generator1.getChild( i , "generator2" ).getChild( k , "textbox11" ).setValue(dltList3.getCellData( k , "grval2" ));
	        		generator1.getChild( i , "generator2" ).getChild( k , "textbox12" ).setValue(dltList3.getCellData( k , "grval3" ));
	        		generator1.getChild( i , "generator2" ).getChild( k , "textbox13" ).setValue(dltList3.getCellData( k , "grval4" ));
	        		generator1.getChild( i , "generator2" ).getChild( k , "textbox14" ).setValue(dltList3.getCellData( k , "grval5" ));
       			}
       			
       		}else{
       			generator1.getChild( i , "group3" ).hide();
       			generator1.getChild( i , "generator2" ).hide();
       		}
       	}
	};
	
	// generator는 엑셀 기능이 없으므로 해당 기능은 직접 구현해야 한다.
	scwin.btn_downloadExcel_onclick = function() {
		// 직접 구현 예시
		var str = generator1.render.innerHTML;
		dma_request.set( "req" , str );
		// generator를 엑셀 파일 만드는 class => com.inswave.edu.util.excelUtilController.java 파일 참조 
		$p.executeSubmission( "sbm_genExcel" );
	};
	
	scwin.sbm_genExcel_submitdone = function(e) {
		if(e.responseJSON.rsMsg.statusCode == "S"){
			WebSquare.net.download( "/ui/SP/Generator/download.jsp" , null , "post" );
		}
	};
	]]></script>
		<style type="text/css"><![CDATA[
			.tablestyle1 {position:relative;width:100%;border-collapse: collapse}
			.tablestyle1 th {width:20%; border-top:1px solid #b6bfcc; border-left:1px solid #b6bfcc; border-right:1px solid #b6bfcc; background:#edeef3; padding:5px;}
			.tablestyle1 td {padding:5px; border:1px solid #b6bfcc;}
		 ]]></style>
	</head>
	<body ev:onpageload="scwin.onpageload" ev:onpageunload="scwin.onpageunload">
		<xf:group class="contentWrap" id="" style="">
			<w2:wframe id="" style="" src="/cm/common/wf_titleFav.xml"></w2:wframe>
			<w2:wframe id="" style="" initScript="" src="/cm/common/wf_titleDesc.xml"></w2:wframe>
			<xf:group id="" style="" class="section">
				<xf:group id="" style="" class="tbl_search">
					<xf:group id="grp_search" style="" adaptive="layout" class="w2tb tbl_sc" adaptiveThreshold="768" tagname="table">
						<w2:attributes>
							<w2:summary></w2:summary>
						</w2:attributes>
						<xf:group tagname="colgroup">
							<xf:group style="width:80px;" tagname="col"></xf:group>
							<xf:group style="" tagname="col"></xf:group>
							<xf:group style="width:200px;" tagname="col"></xf:group>
						</xf:group>
						<xf:group style="" tagname="tr">
							<xf:group style="" class="w2tb_th" tagname="th"><w2:attributes><w2:colspan>2</w2:colspan><w2:rowspan>1</w2:rowspan></w2:attributes></xf:group>
							<xf:group style="" class="w2tb_td" tagname="td">
								<xf:group id="" class="fr"></xf:group>
								<w2:anchor id="btn_search" style="" clickEventElement="outerDiv" ev:onclick="scwin.btn_search_onclick"
									class="btn_sh" outerDiv="true">
									<xf:label><![CDATA[조회]]></xf:label>
								</w2:anchor>
								<w2:anchor class="btn_gcm mr5" clickEventElement="outerDiv"
									ev:onclick="scwin.btn_downloadExcel_onclick" id="btn_downloadExcel" outerDiv="true" style=""
									toolTip="그리드의 데이터를 엑셀로 다운로드 한다.">
									<xf:label><![CDATA[다운로드]]></xf:label>
								</w2:anchor>
							</xf:group>
						</xf:group>
					</xf:group>
				</xf:group>
			</xf:group>
			<xf:group id="" style="" class="section">
				<w2:generator id="generator1" style="">
					<xf:group class="tablestyle1" id="group1" style="" tagname="table">
						<xf:group id="group2" style="" tagname="tr">
							<w2:textbox id="textbox1" label="" style="width:20%;" tagname="th">
								<w2:attributes>
									<w2:colspan>2</w2:colspan>
								</w2:attributes>
							</w2:textbox>
							<w2:textbox id="textbox2" label="" style="width:20%;" tagname="th"></w2:textbox>
							<w2:textbox id="textbox3" label="" style="width:30%;" tagname="th"></w2:textbox>
							<w2:textbox id="textbox4" label="" style="width:30%;" tagname="th"></w2:textbox>
						</xf:group>
						<xf:group id="group3" style="" tagname="tr">
							<w2:textbox id="textbox5" label="cm구분" style="width:10%;" tagname="th"></w2:textbox>
							<w2:textbox id="textbox6" label="길이" style="width:10%;" tagname="th"></w2:textbox>
							<w2:textbox id="textbox7" label="광고주" style="width:20%;" tagname="th"></w2:textbox>
							<w2:textbox id="textbox8" label="소재명" style="width:30%;" tagname="th"></w2:textbox>
							<w2:textbox id="textbox9" label="비고" style="width:30%;" tagname="th"></w2:textbox>
						</xf:group>
						<w2:generator id="generator2" style="" tagname="tbody">
							<xf:group class="" id="group4" style="" tagname="tr">
								<xf:group class="" id="group25" style="" tagname="td">
									<w2:textbox id="textbox10" label="" style="" tagname=""></w2:textbox>
								</xf:group>
								<xf:group class="" id="group26" style="" tagname="td">
									<w2:textbox id="textbox11" label="" style="" tagname=""></w2:textbox>
								</xf:group>
								<xf:group class="" id="group30" style="" tagname="td">
									<w2:textbox id="textbox12" label="" style="" tagname=""></w2:textbox>
								</xf:group>
								<xf:group class="" id="group31" style="" tagname="td">
									<w2:textbox id="textbox13" label="" style="" tagname=""></w2:textbox>
								</xf:group>
								<xf:group class="" id="group32" style="" tagname="td">
									<w2:textbox id="textbox14" label="" style="" tagname=""></w2:textbox>
								</xf:group>
							</xf:group>
						</w2:generator>
					</xf:group>
				</w2:generator>
			</xf:group>
		</xf:group>
	</body>
</html>