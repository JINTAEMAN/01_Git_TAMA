<%@ page language="java" contentType="text/html; charset=UTF-8"  pageEncoding="UTF-8"%><% request.setCharacterEncoding("UTF-8");%><%@ page import="java.io.*" %><%@ page import="java.util.*" %><%@ page import="java.lang.*" %><%@ page import="java.lang.String" %><%@ page import="java.security.*" %><%@ page import="org.w3c.dom.*" %><%@ page import="websquare.util.*" %><%    String fileName = "doubleGridExcel.xls"; //    /xvfs/ser-poc/webapps/ROOT/template/down/testExcel.xls        try {    	File file = new File("C:\\WRM\\RESOURCE\\doubleGrid\\doubleGridExcel.xls");    	//File file = new File("/xvfs/ser-poc/webapps/ROOT/template/down/testExcel.xls");        byte b[] = new byte[(int)file.length()];        fileName  =  new String (fileName.getBytes("euc-kr"), "8859_1");        response.setHeader("Content-Disposition","attachment;filename=" + fileName);		        if (file.isFile()) {        	BufferedInputStream fin = new BufferedInputStream(new FileInputStream(file) );        	out.clear();        	out=pageContext.pushBody();        	BufferedOutputStream outs = new BufferedOutputStream(response.getOutputStream());            int read = 0;            while ((read = fin.read(b)) != -1) {                outs.write(b,0,read);            }            outs.close();            fin.close();        } else {            response.setHeader("Content-Disposition","");            out.println("<script language=javascript>");            out.println("alert('File does not exist!');");            out.println("history.back();");            out.println("</script>");        }    } catch (IOException e) {        response.setHeader("Content-Disposition","");        out.println("<script language=javascript>");        out.println("alert('Does not file !');");        out.println("history.back();");        out.println("</script>");    }%>